import{r as l,o as $,g as q,c as P,j as e,L as I,s as B,a as G,b as H,d as M,e as O,f as V,h as W,u as X,i as _}from"./index-erPB1_Qx.js";const S=({message:n,type:i,onDismiss:m})=>{if(!n)return null;const c="fixed top-5 right-5 p-4 rounded-lg shadow-lg text-white transition-opacity duration-300",f=i==="success"?"bg-green-500":"bg-red-500";return e.jsxs("div",{className:`${c} ${f}`,children:[e.jsx("span",{children:n}),e.jsx("button",{onClick:m,className:"ml-4 font-bold",children:"X"})]})};function J({db:n,auth:i,storage:m}){const[c,f]=l.useState(null),[k,L]=l.useState(!0),[b,j]=l.useState([]),[d,u]=l.useState({message:"",type:""}),[y,A]=l.useState(""),[w,C]=l.useState(""),[r,p]=l.useState({title:"",description:"",link:""}),[g,x]=l.useState(!1),[N,v]=l.useState(!1),a=(s,t="error")=>{u({message:s,type:t}),setTimeout(()=>u({message:"",type:""}),5e3)};l.useEffect(()=>{const s=$(i,t=>{f(t),L(!1)});return()=>s()},[i]);const h=l.useCallback(async()=>{try{const t=(await q(P(n,"projects"))).docs.map(o=>({id:o.id,...o.data()}));j(t)}catch(s){console.error("Error fetching projects:",s),a("Failed to fetch projects.")}},[n]);l.useEffect(()=>{c&&h()},[c,h]);const D=async s=>{s.preventDefault(),x(!0);try{await B(i,y,w)}catch{a("Login failed: Invalid credentials.")}finally{x(!1)}},E=async()=>{await G(i)},U=async s=>{if(s.preventDefault(),!r.title.trim())return a("Project title is required.");x(!0);try{await H(P(n,"projects"),{...r,createdAt:M()}),p({title:"",description:"",link:""}),a("Project added successfully!","success"),h()}catch(t){console.error("Error adding project:",t),a("Failed to add project.")}finally{x(!1)}},F=async s=>{if(window.confirm("Are you sure you want to delete this project?"))try{await O(V(n,"projects",s)),j(t=>t.filter(o=>o.id!==s)),a("Project deleted successfully.","success")}catch(t){console.error("Error deleting project:",t),a("Failed to delete project.")}},R=async s=>{const t=s.target.files[0];if(t){v(!0);try{const o=W(m,`project-assets/${Date.now()}-${t.name}`);await X(o,t);const T=await _(o);navigator.clipboard.writeText(T),a("File uploaded! URL copied to clipboard.","success")}catch(o){console.error("Upload error:",o),a("File upload failed.")}finally{v(!1)}}};return k?e.jsx(I,{}):c?e.jsxs("div",{className:"min-h-screen bg-slate-100 p-4 sm:p-6 md:p-8",children:[e.jsx(S,{message:d.message,type:d.type,onDismiss:()=>u({message:"",type:""})}),e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("header",{className:"flex justify-between items-center mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold text-slate-800",children:"Admin Dashboard"}),e.jsx("button",{onClick:E,className:"bg-red-500 text-white px-5 py-2 rounded-lg font-semibold hover:bg-red-600 transition-colors",children:"Logout"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-1 space-y-8",children:[e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-700 mb-4",children:"Add New Project"}),e.jsxs("form",{onSubmit:U,className:"space-y-4",children:[e.jsx("input",{type:"text",placeholder:"Project Title",value:r.title,onChange:s=>p({...r,title:s.target.value}),className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("textarea",{placeholder:"Description",value:r.description,onChange:s=>p({...r,description:s.target.value}),className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",rows:"3"}),e.jsx("input",{type:"url",placeholder:"Project Link (e.g., GitHub)",value:r.link,onChange:s=>p({...r,link:s.target.value}),className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("button",{type:"submit",disabled:g,className:"w-full bg-green-500 text-white py-2 rounded-lg font-semibold hover:bg-green-600 transition disabled:bg-slate-400",children:g?"Adding...":"Add Project"})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-700 mb-4",children:"Upload Asset"}),e.jsx("input",{type:"file",onChange:R,disabled:N,className:"block w-full text-sm text-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"}),N&&e.jsx("p",{className:"text-sm text-slate-500 mt-2",children:"Uploading..."})]})]}),e.jsxs("div",{className:"lg:col-span-2 bg-white p-6 rounded-xl shadow-lg",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-700 mb-4",children:"Manage Projects"}),e.jsx("div",{className:"space-y-4",children:b.length>0?b.map(s=>e.jsxs("div",{className:"flex items-center justify-between border-b border-slate-200 py-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg text-slate-800",children:s.title}),e.jsx("p",{className:"text-slate-600 text-sm",children:s.description}),s.link&&e.jsx("a",{href:s.link,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:underline text-sm",children:"View Link"})]}),e.jsx("button",{onClick:()=>F(s.id),className:"bg-red-500 text-white px-3 py-1 rounded-md text-sm font-semibold hover:bg-red-600 transition",children:"Delete"})]},s.id)):e.jsx("p",{className:"text-slate-500",children:"No projects found. Add one to get started!"})})]})]})]})]}):e.jsxs("div",{className:"min-h-screen bg-slate-100 flex items-center justify-center p-4",children:[e.jsx(S,{message:d.message,type:d.type,onDismiss:()=>u({message:"",type:""})}),e.jsx("div",{className:"w-full max-w-md",children:e.jsxs("div",{className:"bg-white shadow-2xl rounded-xl p-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-slate-700 text-center mb-6",children:"Admin Login"}),e.jsxs("form",{onSubmit:D,className:"space-y-4",children:[e.jsx("input",{type:"email",placeholder:"Email",value:y,onChange:s=>A(s.target.value),className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition",required:!0}),e.jsx("input",{type:"password",placeholder:"Password",value:w,onChange:s=>C(s.target.value),className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition",required:!0}),e.jsx("button",{type:"submit",disabled:g,className:"w-full bg-blue-600 text-white px-4 py-3 rounded-lg font-semibold hover:bg-blue-700 transition-colors disabled:bg-slate-400",children:g?"Logging in...":"Login"})]})]})})]})}export{J as default};
