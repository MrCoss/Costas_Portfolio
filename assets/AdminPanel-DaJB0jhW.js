import{r as a,g as de,c as z,d as C,a as oe,o as ce,j as e,L as ge,m as x,s as me,b as pe,e as xe,f as he,h as ue,i as ye,A as ke}from"./index-BTMFz911.js";const K=({message:n,type:d,onDismiss:c})=>{if(!n)return null;const h="fixed top-5 right-5 p-4 rounded-lg shadow-lg text-text-primary-dark transition-opacity duration-300 z-50",u=d==="success"?"bg-primary-light dark:bg-primary-dark":"bg-red-500";return e.jsxs("div",{className:`${h} ${u}`,children:[e.jsx("span",{children:n}),e.jsx("button",{onClick:c,className:"ml-4 font-bold",children:"X"})]})},be=({isOpen:n,onConfirm:d,onCancel:c,title:h,message:u})=>e.jsx(ke,{children:n&&e.jsx(x.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex justify-center items-center z-50 p-4",onClick:c,children:e.jsxs(x.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:w=>w.stopPropagation(),className:"bg-background-light dark:bg-background-alt-dark rounded-xl shadow-2xl w-full max-w-md p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-text-primary-light dark:text-text-primary-dark mb-4",children:h}),e.jsx("p",{className:"text-text-secondary-light dark:text-text-secondary-dark mb-6",children:u}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx("button",{onClick:c,className:"px-4 py-2 rounded-lg bg-background-alt-light dark:bg-background-alt-dark hover:bg-slate-300 dark:hover:bg-slate-600 transition text-text-primary-light dark:text-text-primary-dark",children:"Cancel"}),e.jsx("button",{onClick:d,className:"px-4 py-2 rounded-lg bg-red-500 text-white hover:bg-red-600 transition",children:"Confirm"})]})]})})});function je({db:n,auth:d}){const[c,h]=a.useState(null),[u,w]=a.useState(!0),[F,P]=a.useState([]),[y,S]=a.useState({licensesImageUrls:[],internshipsImageUrls:[]}),[A,V]=a.useState(""),[U,W]=a.useState(""),[D,B]=a.useState(""),[k,b]=a.useState({message:"",type:""}),[f,N]=a.useState({isOpen:!1,onConfirm:()=>{}}),[L,Q]=a.useState(""),[E,H]=a.useState(""),[i,o]=a.useState({title:"",description:"",link:"",tags:[],mediaUrls:[]}),[j,M]=a.useState(""),[g,m]=a.useState(!1),[T,J]=a.useState(!1),[$,X]=a.useState(!1),[O,R]=a.useState(!1),G="https://script.google.com/macros/s/AKfycbwuK-vnJgVWmi24i3TncPipUQmBgm-InattxenChbhBcvd4pzM05pQTTFeWxsMiniuG/exec",s=a.useCallback((t,r="error")=>{b({message:t,type:r}),setTimeout(()=>b({message:"",type:""}),5e3)},[]),I=a.useCallback(async()=>{try{const t=await de(z(n,"projects"));P(t.docs.map(r=>({id:r.id,...r.data()})))}catch{s("Failed to fetch projects.")}},[n,s]),_=a.useCallback(async()=>{try{const t=C(n,"portfolioAssets","main"),r=await oe(t);if(r.exists()){const l=r.data();S({licensesImageUrls:l.licensesImageUrls||[],internshipsImageUrls:l.internshipsImageUrls||[]})}}catch{s("Failed to fetch asset links.")}},[n,s]);a.useEffect(()=>{const t=ce(d,r=>{h(r),r&&(I(),_()),w(!1)});return()=>t()},[d,I,_]);const Y=async t=>{t.preventDefault(),m(!0);try{await me(d,L,E)}catch{s("Login failed: Invalid credentials.")}finally{m(!1)}},Z=async()=>{await pe(d)},ee=t=>{t.key==="Enter"&&j&&(t.preventDefault(),i.tags.includes(j.trim())||o({...i,tags:[...i.tags,j.trim()]}),M(""))},te=t=>{o({...i,tags:i.tags.filter(r=>r!==t)})},re=async t=>{if(t.preventDefault(),!i.title.trim())return s("Project title is required.");m(!0);try{await xe(z(n,"projects"),{...i,createdAt:he()}),o({title:"",description:"",link:"",tags:[],mediaUrls:[]}),t.target.reset(),s("Project added successfully!","success"),I()}catch{s("Failed to add project.")}finally{m(!1)}},ae=t=>{N({isOpen:!0,onConfirm:()=>se(t),title:"Confirm Deletion",message:"Are you sure you want to delete this project? This action cannot be undone."})},se=async t=>{try{await ue(C(n,"projects",t)),P(r=>r.filter(l=>l.id!==t)),s("Project deleted successfully.","success")}catch{s("Failed to delete project.")}finally{N({isOpen:!1,onConfirm:()=>{}})}},q=async(t,r)=>{if(!t)return s(`Please enter a Folder ID for ${r==="licenses"?"Licenses & Certs":"Internships"}.`);const l=r==="licenses"?J:X;l(!0);try{const p=await fetch(`${G}?folderId=${t}`);if(!p.ok)throw new Error("Failed to fetch from Google Apps Script.");const v=await p.json();if(v.error)throw new Error(v.error);S(le=>({...le,[r==="licenses"?"licensesImageUrls":"internshipsImageUrls"]:v.urls})),s(`Successfully loaded ${v.urls.length} images. Remember to save!`,"success")}catch(p){s(`Error fetching images: ${p.message}`)}finally{l(!1)}},ie=async t=>{if(!t)return s("Please enter a Project Media Folder ID.");R(!0);try{const r=await fetch(`${G}?folderId=${t}`);if(!r.ok)throw new Error("Failed to fetch from Google Apps Script.");const l=await r.json();if(l.error)throw new Error(l.error);o(p=>({...p,mediaUrls:l.urls})),s(`Successfully loaded ${l.urls.length} media links.`,"success")}catch(r){s(`Error fetching project media: ${r.message}`)}finally{R(!1)}},ne=async t=>{t.preventDefault(),m(!0);try{const r=C(n,"portfolioAssets","main");await ye(r,y,{merge:!0}),s("Asset links updated successfully!","success")}catch{s("Failed to update asset links.")}finally{m(!1)}};return u?e.jsx(ge,{}):c?e.jsxs(e.Fragment,{children:[e.jsx(be,{isOpen:f.isOpen,onConfirm:f.onConfirm,onCancel:()=>N({isOpen:!1,onConfirm:()=>{}}),title:f.title,message:f.message}),e.jsxs("div",{className:"min-h-screen bg-background-alt-light dark:bg-background-alt-dark p-4 sm:p-6 md:p-8",children:[e.jsx(K,{message:k.message,type:k.type,onDismiss:()=>b({message:"",type:""})}),e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("header",{className:"flex justify-between items-center mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold text-text-primary-light dark:text-text-primary-dark",children:"Admin Dashboard"}),e.jsx("button",{onClick:Z,className:"bg-secondary-light dark:bg-secondary-dark text-white dark:text-text-primary-dark px-5 py-2 rounded-lg font-semibold hover:bg-secondary-hover dark:hover:bg-secondary-dark-hover transition-colors",children:"Logout"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-1 space-y-8",children:[e.jsxs(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-background-light dark:bg-background-dark p-6 rounded-xl shadow-lg",children:[e.jsx("h2",{className:"text-2xl font-bold text-text-primary-light dark:text-text-primary-dark mb-4",children:"Add New Project"}),e.jsxs("form",{onSubmit:re,className:"space-y-4",children:[e.jsx("input",{type:"text",placeholder:"Project Title",value:i.title,onChange:t=>o({...i,title:t.target.value}),className:"w-full px-4 py-2 bg-transparent border border-slate-300 dark:border-slate-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-light dark:focus:ring-primary-dark text-text-primary-light dark:text-text-primary-dark"}),e.jsx("textarea",{placeholder:"Description",value:i.description,onChange:t=>o({...i,description:t.target.value}),className:"w-full px-4 py-2 bg-transparent border border-slate-300 dark:border-slate-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-light dark:focus:ring-primary-dark text-text-primary-light dark:text-text-primary-dark",rows:"3"}),e.jsx("input",{type:"url",placeholder:"Project Link (e.g., GitHub)",value:i.link,onChange:t=>o({...i,link:t.target.value}),className:"w-full px-4 py-2 bg-transparent border border-slate-300 dark:border-slate-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-light dark:focus:ring-primary-dark text-text-primary-light dark:text-text-primary-dark"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{type:"text",placeholder:"Project Media Folder ID",value:D,onChange:t=>B(t.target.value),className:"w-full px-4 py-2 bg-transparent border border-slate-300 dark:border-slate-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-light dark:focus:ring-primary-dark text-text-primary-light dark:text-text-primary-dark"}),e.jsx("button",{type:"button",onClick:()=>ie(D),disabled:O,className:"w-full bg-primary-light dark:bg-primary-dark text-white dark:text-text-primary-dark py-2 rounded-lg font-semibold hover:bg-primary-hover dark:hover:bg-primary-dark-hover transition disabled:opacity-50",children:O?"Fetching...":"Fetch Project Media"}),i.mediaUrls.length>0&&e.jsxs("div",{className:"mt-2 text-sm text-text-secondary-light dark:text-text-secondary-dark",children:[i.mediaUrls.length," media links loaded."]})]}),e.jsxs("div",{children:[e.jsx("input",{type:"text",placeholder:"Add skills/tags and press Enter",value:j,onChange:t=>M(t.target.value),onKeyDown:ee,className:"w-full px-4 py-2 bg-transparent border border-slate-300 dark:border-slate-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-light dark:focus:ring-primary-dark text-text-primary-light dark:text-text-primary-dark"}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:i.tags.map(t=>e.jsxs("span",{className:"bg-primary-light/10 dark:bg-primary-dark/10 text-primary-light dark:text-primary-dark text-xs font-semibold px-2.5 py-1 rounded-full flex items-center",children:[t,e.jsx("button",{type:"button",onClick:()=>te(t),className:"ml-2 text-primary-light/70 dark:text-primary-dark/70 hover:text-primary-light dark:hover:text-primary-dark",children:"x"})]},t))})]}),e.jsx("button",{type:"submit",disabled:g,className:"w-full bg-primary-light dark:bg-primary-dark text-text-primary-dark dark:text-text-primary-light py-2 rounded-lg font-semibold hover:bg-primary-hover dark:hover:bg-primary-dark-hover transition disabled:opacity-50",children:g?"Adding Project...":"Add Project"})]})]}),e.jsxs(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-background-light dark:bg-background-dark p-6 rounded-xl shadow-lg",children:[e.jsx("h2",{className:"text-2xl font-bold text-text-primary-light dark:text-text-primary-dark mb-4",children:"Manage Asset Links"}),e.jsxs("form",{onSubmit:ne,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("input",{type:"text",placeholder:"Licenses Folder ID",value:A,onChange:t=>V(t.target.value),className:"w-full px-4 py-2 bg-transparent border border-slate-300 dark:border-slate-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-light dark:focus:ring-primary-dark text-text-primary-light dark:text-text-primary-dark"}),e.jsx("button",{type:"button",onClick:()=>q(A,"licenses"),disabled:T,className:"w-full mt-2 bg-primary-light dark:bg-primary-dark text-white dark:text-text-primary-dark py-2 rounded-lg font-semibold hover:bg-primary-hover dark:hover:bg-primary-dark-hover transition disabled:opacity-50",children:T?"Fetching...":"Fetch Licenses Images"}),y.licensesImageUrls.length>0&&e.jsxs("div",{className:"mt-2 text-sm text-text-secondary-light dark:text-text-secondary-dark",children:[y.licensesImageUrls.length," links loaded."]})]}),e.jsxs("div",{children:[e.jsx("input",{type:"text",placeholder:"Internships Folder ID",value:U,onChange:t=>W(t.target.value),className:"w-full px-4 py-2 bg-transparent border border-slate-300 dark:border-slate-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-light dark:focus:ring-primary-dark text-text-primary-light dark:text-text-primary-dark"}),e.jsx("button",{type:"button",onClick:()=>q(U,"internships"),disabled:$,className:"w-full mt-2 bg-primary-light dark:bg-primary-dark text-white dark:text-text-primary-dark py-2 rounded-lg font-semibold hover:bg-primary-hover dark:hover:bg-primary-dark-hover transition disabled:opacity-50",children:$?"Fetching...":"Fetch Internships Images"}),y.internshipsImageUrls.length>0&&e.jsxs("div",{className:"mt-2 text-sm text-text-secondary-light dark:text-text-secondary-dark",children:[y.internshipsImageUrls.length," links loaded."]})]}),e.jsx("button",{type:"submit",disabled:g,className:"w-full bg-primary-light dark:bg-primary-dark text-text-primary-dark dark:text-text-primary-light py-2 rounded-lg font-semibold hover:bg-primary-hover dark:hover:bg-primary-dark-hover transition disabled:opacity-50",children:g?"Saving...":"Save Links to Firestore"})]})]})]}),e.jsxs(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"lg:col-span-2 bg-background-light dark:bg-background-dark p-6 rounded-xl shadow-lg",children:[e.jsx("h2",{className:"text-2xl font-bold text-text-primary-light dark:text-text-primary-dark mb-4",children:"Manage Projects"}),e.jsx("div",{className:"space-y-4",children:F.length>0?F.map(t=>e.jsxs("div",{className:"flex items-start justify-between border-b border-slate-200 dark:border-slate-700 py-3",children:[e.jsxs("div",{className:"flex-1 pr-4",children:[e.jsx("h3",{className:"font-bold text-lg text-text-primary-light dark:text-text-primary-dark",children:t.title}),e.jsx("p",{className:"text-text-secondary-light dark:text-text-secondary-dark text-sm mt-1",children:t.description}),t.link&&e.jsx("a",{href:t.link,target:"_blank",rel:"noopener noreferrer",className:"text-secondary-light dark:text-secondary-dark hover:underline text-sm",children:"View Project"}),t.mediaUrls&&t.mediaUrls.length>0&&e.jsxs("a",{href:t.mediaUrls[0],target:"_blank",rel:"noopener noreferrer",className:"text-primary-light dark:text-primary-dark hover:underline text-sm ml-2",children:["View Media (",t.mediaUrls.length,")"]}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:t.tags?.map(r=>e.jsx("span",{className:"bg-background-alt-light dark:bg-background-alt-dark text-text-primary-light dark:text-text-primary-dark text-xs font-medium px-2 py-0.5 rounded-full",children:r},r))})]}),e.jsx("button",{onClick:()=>ae(t.id),className:"bg-red-500 text-white px-3 py-1 rounded-md text-sm font-semibold hover:bg-red-600 transition flex-shrink-0",children:"Delete"})]},t.id)):e.jsx("p",{className:"text-text-secondary-light dark:text-text-secondary-dark",children:"No projects found. Add one to get started!"})})]})]})]})]})]}):e.jsxs("div",{className:"min-h-screen bg-background-alt-light dark:bg-background-alt-dark flex items-center justify-center p-4",children:[e.jsx(K,{message:k.message,type:k.type,onDismiss:()=>b({message:"",type:""})}),e.jsx(x.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"w-full max-w-md",children:e.jsxs("div",{className:"bg-background-light dark:bg-background-dark shadow-2xl rounded-xl p-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-text-primary-light dark:text-text-primary-dark text-center mb-6",children:"Admin Login"}),e.jsxs("form",{onSubmit:Y,className:"space-y-4",children:[e.jsx("input",{type:"email",placeholder:"Email",value:L,onChange:t=>Q(t.target.value),className:"w-full px-4 py-3 bg-transparent border border-slate-300 dark:border-slate-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-light dark:focus:ring-primary-dark transition text-text-primary-light dark:text-text-primary-dark",required:!0}),e.jsx("input",{type:"password",placeholder:"Password",value:E,onChange:t=>H(t.target.value),className:"w-full px-4 py-3 bg-transparent border border-slate-300 dark:border-slate-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-light dark:focus:ring-primary-dark transition text-text-primary-light dark:text-text-primary-dark",required:!0}),e.jsx("button",{type:"submit",disabled:g,className:"w-full bg-primary-light dark:bg-primary-dark text-white dark:text-text-primary-dark px-4 py-3 rounded-lg font-semibold hover:bg-primary-hover dark:hover:bg-primary-dark-hover transition-colors disabled:opacity-50",children:g?"Logging in...":"Login"})]})]})})]})}export{je as default};
