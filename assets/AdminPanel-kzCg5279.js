import{r as a,g as te,c as O,d as D,a as se,o as ae,j as e,L as ne,m as p,s as le,b as ie,e as re,u as oe,f as ce,h as de,i as me,k as ue,l as pe,A as xe}from"./index-CV7DLjtm.js";const $=({message:l,type:r,onDismiss:d})=>{if(!l)return null;const x="fixed top-5 right-5 p-4 rounded-lg shadow-lg text-white transition-opacity duration-300 z-50",f=r==="success"?"bg-primary":"bg-red-500";return e.jsxs("div",{className:`${x} ${f}`,children:[e.jsx("span",{children:l}),e.jsx("button",{onClick:d,className:"ml-4 font-bold",children:"X"})]})},fe=({isOpen:l,onConfirm:r,onCancel:d,title:x,message:f})=>e.jsx(xe,{children:l&&e.jsx(p.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex justify-center items-center z-50 p-4",onClick:d,children:e.jsxs(p.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:v=>v.stopPropagation(),className:"bg-background rounded-xl shadow-2xl w-full max-w-md p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-text-primary mb-4",children:x}),e.jsx("p",{className:"text-text-secondary mb-6",children:f}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx("button",{onClick:d,className:"px-4 py-2 rounded-lg bg-slate-200 hover:bg-slate-300 transition text-text-primary",children:"Cancel"}),e.jsx("button",{onClick:r,className:"px-4 py-2 rounded-lg bg-red-500 text-white hover:bg-red-600 transition",children:"Confirm"})]})]})})});function he({db:l,auth:r,storage:d}){const[x,f]=a.useState(null),[v,_]=a.useState(!0),[L,U]=a.useState([]),[g,w]=a.useState({licensesPdfUrl:"",internshipsPdfUrl:""}),[y,b]=a.useState({message:"",type:""}),[j,k]=a.useState({isOpen:!1,onConfirm:()=>{}}),[F,q]=a.useState(""),[R,V]=a.useState(""),[n,m]=a.useState({title:"",description:"",link:"",tags:[]}),[h,E]=a.useState(null),[C,P]=a.useState(0),[N,T]=a.useState(""),[o,u]=a.useState(!1),i=a.useCallback((t,s="error")=>{b({message:t,type:s}),setTimeout(()=>b({message:"",type:""}),5e3)},[]),S=a.useCallback(async()=>{try{const t=await te(O(l,"projects"));U(t.docs.map(s=>({id:s.id,...s.data()})))}catch{i("Failed to fetch projects.")}},[l,i]),M=a.useCallback(async()=>{try{const t=D(l,"portfolioAssets","main"),s=await se(t);s.exists()&&w(s.data())}catch{i("Failed to fetch asset links.")}},[l,i]);a.useEffect(()=>{const t=ae(r,s=>{f(s),s&&(S(),M()),_(!1)});return()=>t()},[r,S,M]);const z=async t=>{t.preventDefault(),u(!0);try{await le(r,F,R)}catch{i("Login failed: Invalid credentials.")}finally{u(!1)}},B=async()=>{await ie(r)},G=t=>{t.key==="Enter"&&N&&(t.preventDefault(),n.tags.includes(N.trim())||m({...n,tags:[...n.tags,N.trim()]}),T(""))},H=t=>{m({...n,tags:n.tags.filter(s=>s!==t)})},K=t=>{t.target.files[0]&&E(t.target.files[0])},W=async t=>{if(t.preventDefault(),!n.title.trim())return i("Project title is required.");u(!0),P(0);try{let s="";if(h){const A=re(d,`project_media/${Date.now()}_${h.name}`),I=oe(A,h);s=await new Promise((Y,Z)=>{I.on("state_changed",c=>{const ee=c.bytesTransferred/c.totalBytes*100;P(ee)},c=>{console.error("Upload Error:",c),Z(c)},async()=>{const c=await ce(I.snapshot.ref);Y(c)})})}await de(O(l,"projects"),{...n,mediaUrl:s,createdAt:me()}),m({title:"",description:"",link:"",tags:[]}),E(null),t.target.reset(),i("Project added successfully!","success"),S()}catch(s){i("Failed to add project. Check console for details."),console.error(s)}finally{u(!1),P(0)}},X=t=>{k({isOpen:!0,onConfirm:()=>J(t),title:"Confirm Deletion",message:"Are you sure you want to delete this project? This action cannot be undone."})},J=async t=>{try{await ue(D(l,"projects",t)),U(s=>s.filter(A=>A.id!==t)),i("Project deleted successfully.","success")}catch{i("Failed to delete project.")}finally{k({isOpen:!1,onConfirm:()=>{}})}},Q=async t=>{t.preventDefault(),u(!0);try{const s=D(l,"portfolioAssets","main");await pe(s,g,{merge:!0}),i("Asset links updated successfully!","success")}catch{i("Failed to update asset links.")}finally{u(!1)}};return v?e.jsx(ne,{}):x?e.jsxs(e.Fragment,{children:[e.jsx(fe,{isOpen:j.isOpen,onConfirm:j.onConfirm,onCancel:()=>k({isOpen:!1,onConfirm:()=>{}}),title:j.title,message:j.message}),e.jsxs("div",{className:"min-h-screen bg-background-alt p-4 sm:p-6 md:p-8",children:[e.jsx($,{message:y.message,type:y.type,onDismiss:()=>b({message:"",type:""})}),e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("header",{className:"flex justify-between items-center mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold text-text-primary",children:"Admin Dashboard"}),e.jsx("button",{onClick:B,className:"bg-secondary text-white px-5 py-2 rounded-lg font-semibold hover:bg-secondary-hover transition-colors",children:"Logout"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-1 space-y-8",children:[e.jsxs(p.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-background p-6 rounded-xl shadow-lg",children:[e.jsx("h2",{className:"text-2xl font-bold text-text-primary mb-4",children:"Add New Project"}),e.jsxs("form",{onSubmit:W,className:"space-y-4",children:[e.jsx("input",{type:"text",placeholder:"Project Title",value:n.title,onChange:t=>m({...n,title:t.target.value}),className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"}),e.jsx("textarea",{placeholder:"Description",value:n.description,onChange:t=>m({...n,description:t.target.value}),className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary",rows:"3"}),e.jsx("input",{type:"url",placeholder:"Project Link (e.g., GitHub)",value:n.link,onChange:t=>m({...n,link:t.target.value}),className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Project Media (Image/Video)"}),e.jsx("input",{type:"file",onChange:K,accept:"image/*,video/*",className:"w-full text-sm text-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-primary/10 file:text-primary hover:file:bg-primary/20"}),h&&e.jsxs("p",{className:"text-xs text-text-secondary mt-1",children:["Selected: ",h.name]})]}),e.jsxs("div",{children:[e.jsx("input",{type:"text",placeholder:"Add skills/tags and press Enter",value:N,onChange:t=>T(t.target.value),onKeyDown:G,className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:n.tags.map(t=>e.jsxs("span",{className:"bg-primary/10 text-primary text-xs font-semibold px-2.5 py-1 rounded-full flex items-center",children:[t,e.jsx("button",{type:"button",onClick:()=>H(t),className:"ml-2 text-primary/70 hover:text-primary",children:"x"})]},t))})]}),o&&C>0&&e.jsx("div",{className:"w-full bg-slate-200 rounded-full h-2.5",children:e.jsx("div",{className:"bg-primary h-2.5 rounded-full",style:{width:`${C}%`}})}),e.jsx("button",{type:"submit",disabled:o,className:"w-full bg-primary text-white py-2 rounded-lg font-semibold hover:bg-primary-hover transition disabled:bg-slate-400",children:o?`Uploading... ${Math.round(C)}%`:"Add Project"})]})]}),e.jsxs(p.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-background p-6 rounded-xl shadow-lg",children:[e.jsx("h2",{className:"text-2xl font-bold text-text-primary mb-4",children:"Manage Asset Links"}),e.jsxs("form",{onSubmit:Q,className:"space-y-4",children:[e.jsx("input",{type:"url",placeholder:"Licenses & Certs PDF URL",value:g.licensesPdfUrl,onChange:t=>w({...g,licensesPdfUrl:t.target.value}),className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"}),e.jsx("input",{type:"url",placeholder:"Internship Certs PDF URL",value:g.internshipsPdfUrl,onChange:t=>w({...g,internshipsPdfUrl:t.target.value}),className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"}),e.jsx("button",{type:"submit",disabled:o,className:"w-full bg-primary text-white py-2 rounded-lg font-semibold hover:bg-primary-hover transition disabled:bg-slate-400",children:o?"Saving...":"Save Links"})]})]})]}),e.jsxs(p.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"lg:col-span-2 bg-background p-6 rounded-xl shadow-lg",children:[e.jsx("h2",{className:"text-2xl font-bold text-text-primary mb-4",children:"Manage Projects"}),e.jsx("div",{className:"space-y-4",children:L.length>0?L.map(t=>e.jsxs("div",{className:"flex items-start justify-between border-b border-slate-200 py-3",children:[e.jsxs("div",{className:"flex-1 pr-4",children:[e.jsx("h3",{className:"font-bold text-lg text-text-primary",children:t.title}),e.jsx("p",{className:"text-text-secondary text-sm mt-1",children:t.description}),t.link&&e.jsx("a",{href:t.link,target:"_blank",rel:"noopener noreferrer",className:"text-secondary hover:underline text-sm",children:"View Project"}),t.mediaUrl&&e.jsx("a",{href:t.mediaUrl,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline text-sm ml-2",children:"View Media"}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:t.tags?.map(s=>e.jsx("span",{className:"bg-slate-200 text-slate-700 text-xs font-medium px-2 py-0.5 rounded-full",children:s},s))})]}),e.jsx("button",{onClick:()=>X(t.id),className:"bg-red-500 text-white px-3 py-1 rounded-md text-sm font-semibold hover:bg-red-600 transition flex-shrink-0",children:"Delete"})]},t.id)):e.jsx("p",{className:"text-text-secondary",children:"No projects found. Add one to get started!"})})]})]})]})]})]}):e.jsxs("div",{className:"min-h-screen bg-background-alt flex items-center justify-center p-4",children:[e.jsx($,{message:y.message,type:y.type,onDismiss:()=>b({message:"",type:""})}),e.jsx(p.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"w-full max-w-md",children:e.jsxs("div",{className:"bg-background shadow-2xl rounded-xl p-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-text-primary text-center mb-6",children:"Admin Login"}),e.jsxs("form",{onSubmit:z,className:"space-y-4",children:[e.jsx("input",{type:"email",placeholder:"Email",value:F,onChange:t=>q(t.target.value),className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary transition",required:!0}),e.jsx("input",{type:"password",placeholder:"Password",value:R,onChange:t=>V(t.target.value),className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary transition",required:!0}),e.jsx("button",{type:"submit",disabled:o,className:"w-full bg-primary text-white px-4 py-3 rounded-lg font-semibold hover:bg-primary-hover transition-colors disabled:bg-slate-400",children:o?"Logging in...":"Login"})]})]})})]})}export{he as default};
