var h1=r=>{throw TypeError(r)};var dg=(r,e,t)=>e.has(r)||h1("Cannot "+t);var wt=(r,e,t)=>(dg(r,e,"read from private field"),t?t.call(r):e.get(r)),gs=(r,e,t)=>e.has(r)?h1("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),Xn=(r,e,t,n)=>(dg(r,e,"write to private field"),n?n.call(r,t):e.set(r,t),t),ys=(r,e,t)=>(dg(r,e,"access private method"),t);var d1=(r,e,t,n)=>({set _(s){Xn(r,e,s,t)},get _(){return wt(r,e,n)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();function rv(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var fg={exports:{}},Jc={},pg={exports:{}},He={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f1;function DP(){if(f1)return He;f1=1;var r=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),o=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),m=Symbol.iterator;function y(W){return W===null||typeof W!="object"?null:(W=m&&W[m]||W["@@iterator"],typeof W=="function"?W:null)}var _={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},A=Object.assign,b={};function T(W,Y,ae){this.props=W,this.context=Y,this.refs=b,this.updater=ae||_}T.prototype.isReactComponent={},T.prototype.setState=function(W,Y){if(typeof W!="object"&&typeof W!="function"&&W!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,W,Y,"setState")},T.prototype.forceUpdate=function(W){this.updater.enqueueForceUpdate(this,W,"forceUpdate")};function x(){}x.prototype=T.prototype;function M(W,Y,ae){this.props=W,this.context=Y,this.refs=b,this.updater=ae||_}var R=M.prototype=new x;R.constructor=M,A(R,T.prototype),R.isPureReactComponent=!0;var B=Array.isArray,O=Object.prototype.hasOwnProperty,$={current:null},k={key:!0,ref:!0,__self:!0,__source:!0};function C(W,Y,ae){var _e,Te={},Pe=null,Ee=null;if(Y!=null)for(_e in Y.ref!==void 0&&(Ee=Y.ref),Y.key!==void 0&&(Pe=""+Y.key),Y)O.call(Y,_e)&&!k.hasOwnProperty(_e)&&(Te[_e]=Y[_e]);var Be=arguments.length-2;if(Be===1)Te.children=ae;else if(1<Be){for(var $e=Array(Be),Ue=0;Ue<Be;Ue++)$e[Ue]=arguments[Ue+2];Te.children=$e}if(W&&W.defaultProps)for(_e in Be=W.defaultProps,Be)Te[_e]===void 0&&(Te[_e]=Be[_e]);return{$$typeof:r,type:W,key:Pe,ref:Ee,props:Te,_owner:$.current}}function P(W,Y){return{$$typeof:r,type:W.type,key:Y,ref:W.ref,props:W.props,_owner:W._owner}}function N(W){return typeof W=="object"&&W!==null&&W.$$typeof===r}function j(W){var Y={"=":"=0",":":"=2"};return"$"+W.replace(/[=:]/g,function(ae){return Y[ae]})}var z=/\/+/g;function F(W,Y){return typeof W=="object"&&W!==null&&W.key!=null?j(""+W.key):Y.toString(36)}function ue(W,Y,ae,_e,Te){var Pe=typeof W;(Pe==="undefined"||Pe==="boolean")&&(W=null);var Ee=!1;if(W===null)Ee=!0;else switch(Pe){case"string":case"number":Ee=!0;break;case"object":switch(W.$$typeof){case r:case e:Ee=!0}}if(Ee)return Ee=W,Te=Te(Ee),W=_e===""?"."+F(Ee,0):_e,B(Te)?(ae="",W!=null&&(ae=W.replace(z,"$&/")+"/"),ue(Te,Y,ae,"",function(Ue){return Ue})):Te!=null&&(N(Te)&&(Te=P(Te,ae+(!Te.key||Ee&&Ee.key===Te.key?"":(""+Te.key).replace(z,"$&/")+"/")+W)),Y.push(Te)),1;if(Ee=0,_e=_e===""?".":_e+":",B(W))for(var Be=0;Be<W.length;Be++){Pe=W[Be];var $e=_e+F(Pe,Be);Ee+=ue(Pe,Y,ae,$e,Te)}else if($e=y(W),typeof $e=="function")for(W=$e.call(W),Be=0;!(Pe=W.next()).done;)Pe=Pe.value,$e=_e+F(Pe,Be++),Ee+=ue(Pe,Y,ae,$e,Te);else if(Pe==="object")throw Y=String(W),Error("Objects are not valid as a React child (found: "+(Y==="[object Object]"?"object with keys {"+Object.keys(W).join(", ")+"}":Y)+"). If you meant to render a collection of children, use an array instead.");return Ee}function ke(W,Y,ae){if(W==null)return W;var _e=[],Te=0;return ue(W,_e,"","",function(Pe){return Y.call(ae,Pe,Te++)}),_e}function ie(W){if(W._status===-1){var Y=W._result;Y=Y(),Y.then(function(ae){(W._status===0||W._status===-1)&&(W._status=1,W._result=ae)},function(ae){(W._status===0||W._status===-1)&&(W._status=2,W._result=ae)}),W._status===-1&&(W._status=0,W._result=Y)}if(W._status===1)return W._result.default;throw W._result}var Z={current:null},te={transition:null},de={ReactCurrentDispatcher:Z,ReactCurrentBatchConfig:te,ReactCurrentOwner:$};function ee(){throw Error("act(...) is not supported in production builds of React.")}return He.Children={map:ke,forEach:function(W,Y,ae){ke(W,function(){Y.apply(this,arguments)},ae)},count:function(W){var Y=0;return ke(W,function(){Y++}),Y},toArray:function(W){return ke(W,function(Y){return Y})||[]},only:function(W){if(!N(W))throw Error("React.Children.only expected to receive a single React element child.");return W}},He.Component=T,He.Fragment=t,He.Profiler=s,He.PureComponent=M,He.StrictMode=n,He.Suspense=u,He.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=de,He.act=ee,He.cloneElement=function(W,Y,ae){if(W==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+W+".");var _e=A({},W.props),Te=W.key,Pe=W.ref,Ee=W._owner;if(Y!=null){if(Y.ref!==void 0&&(Pe=Y.ref,Ee=$.current),Y.key!==void 0&&(Te=""+Y.key),W.type&&W.type.defaultProps)var Be=W.type.defaultProps;for($e in Y)O.call(Y,$e)&&!k.hasOwnProperty($e)&&(_e[$e]=Y[$e]===void 0&&Be!==void 0?Be[$e]:Y[$e])}var $e=arguments.length-2;if($e===1)_e.children=ae;else if(1<$e){Be=Array($e);for(var Ue=0;Ue<$e;Ue++)Be[Ue]=arguments[Ue+2];_e.children=Be}return{$$typeof:r,type:W.type,key:Te,ref:Pe,props:_e,_owner:Ee}},He.createContext=function(W){return W={$$typeof:o,_currentValue:W,_currentValue2:W,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},W.Provider={$$typeof:i,_context:W},W.Consumer=W},He.createElement=C,He.createFactory=function(W){var Y=C.bind(null,W);return Y.type=W,Y},He.createRef=function(){return{current:null}},He.forwardRef=function(W){return{$$typeof:c,render:W}},He.isValidElement=N,He.lazy=function(W){return{$$typeof:f,_payload:{_status:-1,_result:W},_init:ie}},He.memo=function(W,Y){return{$$typeof:h,type:W,compare:Y===void 0?null:Y}},He.startTransition=function(W){var Y=te.transition;te.transition={};try{W()}finally{te.transition=Y}},He.unstable_act=ee,He.useCallback=function(W,Y){return Z.current.useCallback(W,Y)},He.useContext=function(W){return Z.current.useContext(W)},He.useDebugValue=function(){},He.useDeferredValue=function(W){return Z.current.useDeferredValue(W)},He.useEffect=function(W,Y){return Z.current.useEffect(W,Y)},He.useId=function(){return Z.current.useId()},He.useImperativeHandle=function(W,Y,ae){return Z.current.useImperativeHandle(W,Y,ae)},He.useInsertionEffect=function(W,Y){return Z.current.useInsertionEffect(W,Y)},He.useLayoutEffect=function(W,Y){return Z.current.useLayoutEffect(W,Y)},He.useMemo=function(W,Y){return Z.current.useMemo(W,Y)},He.useReducer=function(W,Y,ae){return Z.current.useReducer(W,Y,ae)},He.useRef=function(W){return Z.current.useRef(W)},He.useState=function(W){return Z.current.useState(W)},He.useSyncExternalStore=function(W,Y,ae){return Z.current.useSyncExternalStore(W,Y,ae)},He.useTransition=function(){return Z.current.useTransition()},He.version="18.3.1",He}var p1;function sv(){return p1||(p1=1,pg.exports=DP()),pg.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var m1;function LP(){if(m1)return Jc;m1=1;var r=sv(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function o(c,u,h){var f,m={},y=null,_=null;h!==void 0&&(y=""+h),u.key!==void 0&&(y=""+u.key),u.ref!==void 0&&(_=u.ref);for(f in u)n.call(u,f)&&!i.hasOwnProperty(f)&&(m[f]=u[f]);if(c&&c.defaultProps)for(f in u=c.defaultProps,u)m[f]===void 0&&(m[f]=u[f]);return{$$typeof:e,type:c,key:y,ref:_,props:m,_owner:s.current}}return Jc.Fragment=t,Jc.jsx=o,Jc.jsxs=o,Jc}var g1;function MP(){return g1||(g1=1,fg.exports=LP()),fg.exports}var L=MP(),V=sv();const ht=rv(V);var Fd={},mg={exports:{}},Yn={},gg={exports:{}},yg={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var y1;function NP(){return y1||(y1=1,function(r){function e(te,de){var ee=te.length;te.push(de);e:for(;0<ee;){var W=ee-1>>>1,Y=te[W];if(0<s(Y,de))te[W]=de,te[ee]=Y,ee=W;else break e}}function t(te){return te.length===0?null:te[0]}function n(te){if(te.length===0)return null;var de=te[0],ee=te.pop();if(ee!==de){te[0]=ee;e:for(var W=0,Y=te.length,ae=Y>>>1;W<ae;){var _e=2*(W+1)-1,Te=te[_e],Pe=_e+1,Ee=te[Pe];if(0>s(Te,ee))Pe<Y&&0>s(Ee,Te)?(te[W]=Ee,te[Pe]=ee,W=Pe):(te[W]=Te,te[_e]=ee,W=_e);else if(Pe<Y&&0>s(Ee,ee))te[W]=Ee,te[Pe]=ee,W=Pe;else break e}}return de}function s(te,de){var ee=te.sortIndex-de.sortIndex;return ee!==0?ee:te.id-de.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;r.unstable_now=function(){return i.now()}}else{var o=Date,c=o.now();r.unstable_now=function(){return o.now()-c}}var u=[],h=[],f=1,m=null,y=3,_=!1,A=!1,b=!1,T=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,M=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function R(te){for(var de=t(h);de!==null;){if(de.callback===null)n(h);else if(de.startTime<=te)n(h),de.sortIndex=de.expirationTime,e(u,de);else break;de=t(h)}}function B(te){if(b=!1,R(te),!A)if(t(u)!==null)A=!0,ie(O);else{var de=t(h);de!==null&&Z(B,de.startTime-te)}}function O(te,de){A=!1,b&&(b=!1,x(C),C=-1),_=!0;var ee=y;try{for(R(de),m=t(u);m!==null&&(!(m.expirationTime>de)||te&&!j());){var W=m.callback;if(typeof W=="function"){m.callback=null,y=m.priorityLevel;var Y=W(m.expirationTime<=de);de=r.unstable_now(),typeof Y=="function"?m.callback=Y:m===t(u)&&n(u),R(de)}else n(u);m=t(u)}if(m!==null)var ae=!0;else{var _e=t(h);_e!==null&&Z(B,_e.startTime-de),ae=!1}return ae}finally{m=null,y=ee,_=!1}}var $=!1,k=null,C=-1,P=5,N=-1;function j(){return!(r.unstable_now()-N<P)}function z(){if(k!==null){var te=r.unstable_now();N=te;var de=!0;try{de=k(!0,te)}finally{de?F():($=!1,k=null)}}else $=!1}var F;if(typeof M=="function")F=function(){M(z)};else if(typeof MessageChannel<"u"){var ue=new MessageChannel,ke=ue.port2;ue.port1.onmessage=z,F=function(){ke.postMessage(null)}}else F=function(){T(z,0)};function ie(te){k=te,$||($=!0,F())}function Z(te,de){C=T(function(){te(r.unstable_now())},de)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(te){te.callback=null},r.unstable_continueExecution=function(){A||_||(A=!0,ie(O))},r.unstable_forceFrameRate=function(te){0>te||125<te?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<te?Math.floor(1e3/te):5},r.unstable_getCurrentPriorityLevel=function(){return y},r.unstable_getFirstCallbackNode=function(){return t(u)},r.unstable_next=function(te){switch(y){case 1:case 2:case 3:var de=3;break;default:de=y}var ee=y;y=de;try{return te()}finally{y=ee}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(te,de){switch(te){case 1:case 2:case 3:case 4:case 5:break;default:te=3}var ee=y;y=te;try{return de()}finally{y=ee}},r.unstable_scheduleCallback=function(te,de,ee){var W=r.unstable_now();switch(typeof ee=="object"&&ee!==null?(ee=ee.delay,ee=typeof ee=="number"&&0<ee?W+ee:W):ee=W,te){case 1:var Y=-1;break;case 2:Y=250;break;case 5:Y=1073741823;break;case 4:Y=1e4;break;default:Y=5e3}return Y=ee+Y,te={id:f++,callback:de,priorityLevel:te,startTime:ee,expirationTime:Y,sortIndex:-1},ee>W?(te.sortIndex=ee,e(h,te),t(u)===null&&te===t(h)&&(b?(x(C),C=-1):b=!0,Z(B,ee-W))):(te.sortIndex=Y,e(u,te),A||_||(A=!0,ie(O))),te},r.unstable_shouldYield=j,r.unstable_wrapCallback=function(te){var de=y;return function(){var ee=y;y=de;try{return te.apply(this,arguments)}finally{y=ee}}}}(yg)),yg}var v1;function OP(){return v1||(v1=1,gg.exports=NP()),gg.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _1;function FP(){if(_1)return Yn;_1=1;var r=sv(),e=OP();function t(a){for(var l="https://reactjs.org/docs/error-decoder.html?invariant="+a,d=1;d<arguments.length;d++)l+="&args[]="+encodeURIComponent(arguments[d]);return"Minified React error #"+a+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,s={};function i(a,l){o(a,l),o(a+"Capture",l)}function o(a,l){for(s[a]=l,a=0;a<l.length;a++)n.add(l[a])}var c=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},m={};function y(a){return u.call(m,a)?!0:u.call(f,a)?!1:h.test(a)?m[a]=!0:(f[a]=!0,!1)}function _(a,l,d,g){if(d!==null&&d.type===0)return!1;switch(typeof l){case"function":case"symbol":return!0;case"boolean":return g?!1:d!==null?!d.acceptsBooleans:(a=a.toLowerCase().slice(0,5),a!=="data-"&&a!=="aria-");default:return!1}}function A(a,l,d,g){if(l===null||typeof l>"u"||_(a,l,d,g))return!0;if(g)return!1;if(d!==null)switch(d.type){case 3:return!l;case 4:return l===!1;case 5:return isNaN(l);case 6:return isNaN(l)||1>l}return!1}function b(a,l,d,g,v,E,I){this.acceptsBooleans=l===2||l===3||l===4,this.attributeName=g,this.attributeNamespace=v,this.mustUseProperty=d,this.propertyName=a,this.type=l,this.sanitizeURL=E,this.removeEmptyString=I}var T={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(a){T[a]=new b(a,0,!1,a,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(a){var l=a[0];T[l]=new b(l,1,!1,a[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(a){T[a]=new b(a,2,!1,a.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(a){T[a]=new b(a,2,!1,a,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(a){T[a]=new b(a,3,!1,a.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(a){T[a]=new b(a,3,!0,a,null,!1,!1)}),["capture","download"].forEach(function(a){T[a]=new b(a,4,!1,a,null,!1,!1)}),["cols","rows","size","span"].forEach(function(a){T[a]=new b(a,6,!1,a,null,!1,!1)}),["rowSpan","start"].forEach(function(a){T[a]=new b(a,5,!1,a.toLowerCase(),null,!1,!1)});var x=/[\-:]([a-z])/g;function M(a){return a[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(a){var l=a.replace(x,M);T[l]=new b(l,1,!1,a,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(a){var l=a.replace(x,M);T[l]=new b(l,1,!1,a,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(a){var l=a.replace(x,M);T[l]=new b(l,1,!1,a,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(a){T[a]=new b(a,1,!1,a.toLowerCase(),null,!1,!1)}),T.xlinkHref=new b("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(a){T[a]=new b(a,1,!1,a.toLowerCase(),null,!0,!0)});function R(a,l,d,g){var v=T.hasOwnProperty(l)?T[l]:null;(v!==null?v.type!==0:g||!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(A(l,d,v,g)&&(d=null),g||v===null?y(l)&&(d===null?a.removeAttribute(l):a.setAttribute(l,""+d)):v.mustUseProperty?a[v.propertyName]=d===null?v.type===3?!1:"":d:(l=v.attributeName,g=v.attributeNamespace,d===null?a.removeAttribute(l):(v=v.type,d=v===3||v===4&&d===!0?"":""+d,g?a.setAttributeNS(g,l,d):a.setAttribute(l,d))))}var B=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,O=Symbol.for("react.element"),$=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),P=Symbol.for("react.profiler"),N=Symbol.for("react.provider"),j=Symbol.for("react.context"),z=Symbol.for("react.forward_ref"),F=Symbol.for("react.suspense"),ue=Symbol.for("react.suspense_list"),ke=Symbol.for("react.memo"),ie=Symbol.for("react.lazy"),Z=Symbol.for("react.offscreen"),te=Symbol.iterator;function de(a){return a===null||typeof a!="object"?null:(a=te&&a[te]||a["@@iterator"],typeof a=="function"?a:null)}var ee=Object.assign,W;function Y(a){if(W===void 0)try{throw Error()}catch(d){var l=d.stack.trim().match(/\n( *(at )?)/);W=l&&l[1]||""}return`
`+W+a}var ae=!1;function _e(a,l){if(!a||ae)return"";ae=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(l)if(l=function(){throw Error()},Object.defineProperty(l.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(l,[])}catch(Q){var g=Q}Reflect.construct(a,[],l)}else{try{l.call()}catch(Q){g=Q}a.call(l.prototype)}else{try{throw Error()}catch(Q){g=Q}a()}}catch(Q){if(Q&&g&&typeof Q.stack=="string"){for(var v=Q.stack.split(`
`),E=g.stack.split(`
`),I=v.length-1,U=E.length-1;1<=I&&0<=U&&v[I]!==E[U];)U--;for(;1<=I&&0<=U;I--,U--)if(v[I]!==E[U]){if(I!==1||U!==1)do if(I--,U--,0>U||v[I]!==E[U]){var H=`
`+v[I].replace(" at new "," at ");return a.displayName&&H.includes("<anonymous>")&&(H=H.replace("<anonymous>",a.displayName)),H}while(1<=I&&0<=U);break}}}finally{ae=!1,Error.prepareStackTrace=d}return(a=a?a.displayName||a.name:"")?Y(a):""}function Te(a){switch(a.tag){case 5:return Y(a.type);case 16:return Y("Lazy");case 13:return Y("Suspense");case 19:return Y("SuspenseList");case 0:case 2:case 15:return a=_e(a.type,!1),a;case 11:return a=_e(a.type.render,!1),a;case 1:return a=_e(a.type,!0),a;default:return""}}function Pe(a){if(a==null)return null;if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case k:return"Fragment";case $:return"Portal";case P:return"Profiler";case C:return"StrictMode";case F:return"Suspense";case ue:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case j:return(a.displayName||"Context")+".Consumer";case N:return(a._context.displayName||"Context")+".Provider";case z:var l=a.render;return a=a.displayName,a||(a=l.displayName||l.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case ke:return l=a.displayName||null,l!==null?l:Pe(a.type)||"Memo";case ie:l=a._payload,a=a._init;try{return Pe(a(l))}catch{}}return null}function Ee(a){var l=a.type;switch(a.tag){case 24:return"Cache";case 9:return(l.displayName||"Context")+".Consumer";case 10:return(l._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return a=l.render,a=a.displayName||a.name||"",l.displayName||(a!==""?"ForwardRef("+a+")":"ForwardRef");case 7:return"Fragment";case 5:return l;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Pe(l);case 8:return l===C?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l}return null}function Be(a){switch(typeof a){case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function $e(a){var l=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function Ue(a){var l=$e(a)?"checked":"value",d=Object.getOwnPropertyDescriptor(a.constructor.prototype,l),g=""+a[l];if(!a.hasOwnProperty(l)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var v=d.get,E=d.set;return Object.defineProperty(a,l,{configurable:!0,get:function(){return v.call(this)},set:function(I){g=""+I,E.call(this,I)}}),Object.defineProperty(a,l,{enumerable:d.enumerable}),{getValue:function(){return g},setValue:function(I){g=""+I},stopTracking:function(){a._valueTracker=null,delete a[l]}}}}function qt(a){a._valueTracker||(a._valueTracker=Ue(a))}function vn(a){if(!a)return!1;var l=a._valueTracker;if(!l)return!0;var d=l.getValue(),g="";return a&&(g=$e(a)?a.checked?"true":"false":a.value),a=g,a!==d?(l.setValue(a),!0):!1}function ze(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}function et(a,l){var d=l.checked;return ee({},l,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:d??a._wrapperState.initialChecked})}function lt(a,l){var d=l.defaultValue==null?"":l.defaultValue,g=l.checked!=null?l.checked:l.defaultChecked;d=Be(l.value!=null?l.value:d),a._wrapperState={initialChecked:g,initialValue:d,controlled:l.type==="checkbox"||l.type==="radio"?l.checked!=null:l.value!=null}}function yt(a,l){l=l.checked,l!=null&&R(a,"checked",l,!1)}function dr(a,l){yt(a,l);var d=Be(l.value),g=l.type;if(d!=null)g==="number"?(d===0&&a.value===""||a.value!=d)&&(a.value=""+d):a.value!==""+d&&(a.value=""+d);else if(g==="submit"||g==="reset"){a.removeAttribute("value");return}l.hasOwnProperty("value")?ss(a,l.type,d):l.hasOwnProperty("defaultValue")&&ss(a,l.type,Be(l.defaultValue)),l.checked==null&&l.defaultChecked!=null&&(a.defaultChecked=!!l.defaultChecked)}function rs(a,l,d){if(l.hasOwnProperty("value")||l.hasOwnProperty("defaultValue")){var g=l.type;if(!(g!=="submit"&&g!=="reset"||l.value!==void 0&&l.value!==null))return;l=""+a._wrapperState.initialValue,d||l===a.value||(a.value=l),a.defaultValue=l}d=a.name,d!==""&&(a.name=""),a.defaultChecked=!!a._wrapperState.initialChecked,d!==""&&(a.name=d)}function ss(a,l,d){(l!=="number"||ze(a.ownerDocument)!==a)&&(d==null?a.defaultValue=""+a._wrapperState.initialValue:a.defaultValue!==""+d&&(a.defaultValue=""+d))}var Dr=Array.isArray;function Bn(a,l,d,g){if(a=a.options,l){l={};for(var v=0;v<d.length;v++)l["$"+d[v]]=!0;for(d=0;d<a.length;d++)v=l.hasOwnProperty("$"+a[d].value),a[d].selected!==v&&(a[d].selected=v),v&&g&&(a[d].defaultSelected=!0)}else{for(d=""+Be(d),l=null,v=0;v<a.length;v++){if(a[v].value===d){a[v].selected=!0,g&&(a[v].defaultSelected=!0);return}l!==null||a[v].disabled||(l=a[v])}l!==null&&(l.selected=!0)}}function Eo(a,l){if(l.dangerouslySetInnerHTML!=null)throw Error(t(91));return ee({},l,{value:void 0,defaultValue:void 0,children:""+a._wrapperState.initialValue})}function wi(a,l){var d=l.value;if(d==null){if(d=l.children,l=l.defaultValue,d!=null){if(l!=null)throw Error(t(92));if(Dr(d)){if(1<d.length)throw Error(t(93));d=d[0]}l=d}l==null&&(l=""),d=l}a._wrapperState={initialValue:Be(d)}}function Ei(a,l){var d=Be(l.value),g=Be(l.defaultValue);d!=null&&(d=""+d,d!==a.value&&(a.value=d),l.defaultValue==null&&a.defaultValue!==d&&(a.defaultValue=d)),g!=null&&(a.defaultValue=""+g)}function Ao(a){var l=a.textContent;l===a._wrapperState.initialValue&&l!==""&&l!==null&&(a.value=l)}function Rt(a){switch(a){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function st(a,l){return a==null||a==="http://www.w3.org/1999/xhtml"?Rt(l):a==="http://www.w3.org/2000/svg"&&l==="foreignObject"?"http://www.w3.org/1999/xhtml":a}var _n,Un=function(a){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(l,d,g,v){MSApp.execUnsafeLocalFunction(function(){return a(l,d,g,v)})}:a}(function(a,l){if(a.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in a)a.innerHTML=l;else{for(_n=_n||document.createElement("div"),_n.innerHTML="<svg>"+l.valueOf().toString()+"</svg>",l=_n.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;l.firstChild;)a.appendChild(l.firstChild)}});function fr(a,l){if(l){var d=a.firstChild;if(d&&d===a.lastChild&&d.nodeType===3){d.nodeValue=l;return}}a.textContent=l}var bo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},To=["Webkit","ms","Moz","O"];Object.keys(bo).forEach(function(a){To.forEach(function(l){l=l+a.charAt(0).toUpperCase()+a.substring(1),bo[l]=bo[a]})});function cc(a,l,d){return l==null||typeof l=="boolean"||l===""?"":d||typeof l!="number"||l===0||bo.hasOwnProperty(a)&&bo[a]?(""+l).trim():l+"px"}function uc(a,l){a=a.style;for(var d in l)if(l.hasOwnProperty(d)){var g=d.indexOf("--")===0,v=cc(d,l[d],g);d==="float"&&(d="cssFloat"),g?a.setProperty(d,v):a[d]=v}}var hc=ee({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function dc(a,l){if(l){if(hc[a]&&(l.children!=null||l.dangerouslySetInnerHTML!=null))throw Error(t(137,a));if(l.dangerouslySetInnerHTML!=null){if(l.children!=null)throw Error(t(60));if(typeof l.dangerouslySetInnerHTML!="object"||!("__html"in l.dangerouslySetInnerHTML))throw Error(t(61))}if(l.style!=null&&typeof l.style!="object")throw Error(t(62))}}function fc(a,l){if(a.indexOf("-")===-1)return typeof l.is=="string";switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var So=null;function ka(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var Pa=null,pr=null,is=null;function Ra(a){if(a=Fc(a)){if(typeof Pa!="function")throw Error(t(280));var l=a.stateNode;l&&(l=Jh(l),Pa(a.stateNode,a.type,l))}}function os(a){pr?is?is.push(a):is=[a]:pr=a}function pc(){if(pr){var a=pr,l=is;if(is=pr=null,Ra(a),l)for(a=0;a<l.length;a++)Ra(l[a])}}function xo(a,l){return a(l)}function mc(){}var zs=!1;function gc(a,l,d){if(zs)return a(l,d);zs=!0;try{return xo(a,l,d)}finally{zs=!1,(pr!==null||is!==null)&&(mc(),pc())}}function Dt(a,l){var d=a.stateNode;if(d===null)return null;var g=Jh(d);if(g===null)return null;d=g[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(a=a.type,g=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!g;break e;default:a=!1}if(a)return null;if(d&&typeof d!="function")throw Error(t(231,l,typeof d));return d}var Da=!1;if(c)try{var Lr={};Object.defineProperty(Lr,"passive",{get:function(){Da=!0}}),window.addEventListener("test",Lr,Lr),window.removeEventListener("test",Lr,Lr)}catch{Da=!1}function Co(a,l,d,g,v,E,I,U,H){var Q=Array.prototype.slice.call(arguments,3);try{l.apply(d,Q)}catch(oe){this.onError(oe)}}var Io=!1,La=null,Mr=!1,yc=null,Bp={onError:function(a){Io=!0,La=a}};function Ma(a,l,d,g,v,E,I,U,H){Io=!1,La=null,Co.apply(Bp,arguments)}function bh(a,l,d,g,v,E,I,U,H){if(Ma.apply(this,arguments),Io){if(Io){var Q=La;Io=!1,La=null}else throw Error(t(198));Mr||(Mr=!0,yc=Q)}}function Nr(a){var l=a,d=a;if(a.alternate)for(;l.return;)l=l.return;else{a=l;do l=a,(l.flags&4098)!==0&&(d=l.return),a=l.return;while(a)}return l.tag===3?d:null}function ko(a){if(a.tag===13){var l=a.memoizedState;if(l===null&&(a=a.alternate,a!==null&&(l=a.memoizedState)),l!==null)return l.dehydrated}return null}function Or(a){if(Nr(a)!==a)throw Error(t(188))}function Th(a){var l=a.alternate;if(!l){if(l=Nr(a),l===null)throw Error(t(188));return l!==a?null:a}for(var d=a,g=l;;){var v=d.return;if(v===null)break;var E=v.alternate;if(E===null){if(g=v.return,g!==null){d=g;continue}break}if(v.child===E.child){for(E=v.child;E;){if(E===d)return Or(v),a;if(E===g)return Or(v),l;E=E.sibling}throw Error(t(188))}if(d.return!==g.return)d=v,g=E;else{for(var I=!1,U=v.child;U;){if(U===d){I=!0,d=v,g=E;break}if(U===g){I=!0,g=v,d=E;break}U=U.sibling}if(!I){for(U=E.child;U;){if(U===d){I=!0,d=E,g=v;break}if(U===g){I=!0,g=E,d=v;break}U=U.sibling}if(!I)throw Error(t(189))}}if(d.alternate!==g)throw Error(t(190))}if(d.tag!==3)throw Error(t(188));return d.stateNode.current===d?a:l}function vc(a){return a=Th(a),a!==null?Na(a):null}function Na(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){var l=Na(a);if(l!==null)return l;a=a.sibling}return null}var Oa=e.unstable_scheduleCallback,_c=e.unstable_cancelCallback,Sh=e.unstable_shouldYield,Up=e.unstable_requestPaint,ct=e.unstable_now,xh=e.unstable_getCurrentPriorityLevel,Po=e.unstable_ImmediatePriority,Ai=e.unstable_UserBlockingPriority,mr=e.unstable_NormalPriority,wc=e.unstable_LowPriority,Ch=e.unstable_IdlePriority,Ro=null,er=null;function Ih(a){if(er&&typeof er.onCommitFiberRoot=="function")try{er.onCommitFiberRoot(Ro,a,void 0,(a.current.flags&128)===128)}catch{}}var Ln=Math.clz32?Math.clz32:Ph,Ec=Math.log,kh=Math.LN2;function Ph(a){return a>>>=0,a===0?32:31-(Ec(a)/kh|0)|0}var Fa=64,Va=4194304;function bi(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return a&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return a}}function Do(a,l){var d=a.pendingLanes;if(d===0)return 0;var g=0,v=a.suspendedLanes,E=a.pingedLanes,I=d&268435455;if(I!==0){var U=I&~v;U!==0?g=bi(U):(E&=I,E!==0&&(g=bi(E)))}else I=d&~v,I!==0?g=bi(I):E!==0&&(g=bi(E));if(g===0)return 0;if(l!==0&&l!==g&&(l&v)===0&&(v=g&-g,E=l&-l,v>=E||v===16&&(E&4194240)!==0))return l;if((g&4)!==0&&(g|=d&16),l=a.entangledLanes,l!==0)for(a=a.entanglements,l&=g;0<l;)d=31-Ln(l),v=1<<d,g|=a[d],l&=~v;return g}function zp(a,l){switch(a){case 1:case 2:case 4:return l+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function $s(a,l){for(var d=a.suspendedLanes,g=a.pingedLanes,v=a.expirationTimes,E=a.pendingLanes;0<E;){var I=31-Ln(E),U=1<<I,H=v[I];H===-1?((U&d)===0||(U&g)!==0)&&(v[I]=zp(U,l)):H<=l&&(a.expiredLanes|=U),E&=~U}}function tr(a){return a=a.pendingLanes&-1073741825,a!==0?a:a&1073741824?1073741824:0}function Lo(){var a=Fa;return Fa<<=1,(Fa&4194240)===0&&(Fa=64),a}function Ti(a){for(var l=[],d=0;31>d;d++)l.push(a);return l}function Si(a,l,d){a.pendingLanes|=l,l!==536870912&&(a.suspendedLanes=0,a.pingedLanes=0),a=a.eventTimes,l=31-Ln(l),a[l]=d}function ot(a,l){var d=a.pendingLanes&~l;a.pendingLanes=l,a.suspendedLanes=0,a.pingedLanes=0,a.expiredLanes&=l,a.mutableReadLanes&=l,a.entangledLanes&=l,l=a.entanglements;var g=a.eventTimes;for(a=a.expirationTimes;0<d;){var v=31-Ln(d),E=1<<v;l[v]=0,g[v]=-1,a[v]=-1,d&=~E}}function xi(a,l){var d=a.entangledLanes|=l;for(a=a.entanglements;d;){var g=31-Ln(d),v=1<<g;v&l|a[g]&l&&(a[g]|=l),d&=~v}}var Ye=0;function Ci(a){return a&=-a,1<a?4<a?(a&268435455)!==0?16:536870912:4:1}var Rh,ja,Dh,Lh,Mh,Ac=!1,as=[],cn=null,Fr=null,Vr=null,Ii=new Map,gr=new Map,ls=[],$p="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Nh(a,l){switch(a){case"focusin":case"focusout":cn=null;break;case"dragenter":case"dragleave":Fr=null;break;case"mouseover":case"mouseout":Vr=null;break;case"pointerover":case"pointerout":Ii.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":gr.delete(l.pointerId)}}function zn(a,l,d,g,v,E){return a===null||a.nativeEvent!==E?(a={blockedOn:l,domEventName:d,eventSystemFlags:g,nativeEvent:E,targetContainers:[v]},l!==null&&(l=Fc(l),l!==null&&ja(l)),a):(a.eventSystemFlags|=g,l=a.targetContainers,v!==null&&l.indexOf(v)===-1&&l.push(v),a)}function Hp(a,l,d,g,v){switch(l){case"focusin":return cn=zn(cn,a,l,d,g,v),!0;case"dragenter":return Fr=zn(Fr,a,l,d,g,v),!0;case"mouseover":return Vr=zn(Vr,a,l,d,g,v),!0;case"pointerover":var E=v.pointerId;return Ii.set(E,zn(Ii.get(E)||null,a,l,d,g,v)),!0;case"gotpointercapture":return E=v.pointerId,gr.set(E,zn(gr.get(E)||null,a,l,d,g,v)),!0}return!1}function Oh(a){var l=Vo(a.target);if(l!==null){var d=Nr(l);if(d!==null){if(l=d.tag,l===13){if(l=ko(d),l!==null){a.blockedOn=l,Mh(a.priority,function(){Dh(d)});return}}else if(l===3&&d.stateNode.current.memoizedState.isDehydrated){a.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}a.blockedOn=null}function Hs(a){if(a.blockedOn!==null)return!1;for(var l=a.targetContainers;0<l.length;){var d=Ba(a.domEventName,a.eventSystemFlags,l[0],a.nativeEvent);if(d===null){d=a.nativeEvent;var g=new d.constructor(d.type,d);So=g,d.target.dispatchEvent(g),So=null}else return l=Fc(d),l!==null&&ja(l),a.blockedOn=d,!1;l.shift()}return!0}function Mo(a,l,d){Hs(a)&&d.delete(l)}function Fh(){Ac=!1,cn!==null&&Hs(cn)&&(cn=null),Fr!==null&&Hs(Fr)&&(Fr=null),Vr!==null&&Hs(Vr)&&(Vr=null),Ii.forEach(Mo),gr.forEach(Mo)}function jr(a,l){a.blockedOn===l&&(a.blockedOn=null,Ac||(Ac=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Fh)))}function Br(a){function l(v){return jr(v,a)}if(0<as.length){jr(as[0],a);for(var d=1;d<as.length;d++){var g=as[d];g.blockedOn===a&&(g.blockedOn=null)}}for(cn!==null&&jr(cn,a),Fr!==null&&jr(Fr,a),Vr!==null&&jr(Vr,a),Ii.forEach(l),gr.forEach(l),d=0;d<ls.length;d++)g=ls[d],g.blockedOn===a&&(g.blockedOn=null);for(;0<ls.length&&(d=ls[0],d.blockedOn===null);)Oh(d),d.blockedOn===null&&ls.shift()}var Ws=B.ReactCurrentBatchConfig,ki=!0;function vt(a,l,d,g){var v=Ye,E=Ws.transition;Ws.transition=null;try{Ye=1,bc(a,l,d,g)}finally{Ye=v,Ws.transition=E}}function Wp(a,l,d,g){var v=Ye,E=Ws.transition;Ws.transition=null;try{Ye=4,bc(a,l,d,g)}finally{Ye=v,Ws.transition=E}}function bc(a,l,d,g){if(ki){var v=Ba(a,l,d,g);if(v===null)nm(a,l,g,No,d),Nh(a,g);else if(Hp(v,a,l,d,g))g.stopPropagation();else if(Nh(a,g),l&4&&-1<$p.indexOf(a)){for(;v!==null;){var E=Fc(v);if(E!==null&&Rh(E),E=Ba(a,l,d,g),E===null&&nm(a,l,g,No,d),E===v)break;v=E}v!==null&&g.stopPropagation()}else nm(a,l,g,null,d)}}var No=null;function Ba(a,l,d,g){if(No=null,a=ka(g),a=Vo(a),a!==null)if(l=Nr(a),l===null)a=null;else if(d=l.tag,d===13){if(a=ko(l),a!==null)return a;a=null}else if(d===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;a=null}else l!==a&&(a=null);return No=a,null}function Tc(a){switch(a){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(xh()){case Po:return 1;case Ai:return 4;case mr:case wc:return 16;case Ch:return 536870912;default:return 16}default:return 16}}var nr=null,Ua=null,$n=null;function Sc(){if($n)return $n;var a,l=Ua,d=l.length,g,v="value"in nr?nr.value:nr.textContent,E=v.length;for(a=0;a<d&&l[a]===v[a];a++);var I=d-a;for(g=1;g<=I&&l[d-g]===v[E-g];g++);return $n=v.slice(a,1<g?1-g:void 0)}function za(a){var l=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&l===13&&(a=13)):a=l,a===10&&(a=13),32<=a||a===13?a:0}function cs(){return!0}function xc(){return!1}function un(a){function l(d,g,v,E,I){this._reactName=d,this._targetInst=v,this.type=g,this.nativeEvent=E,this.target=I,this.currentTarget=null;for(var U in a)a.hasOwnProperty(U)&&(d=a[U],this[U]=d?d(E):E[U]);return this.isDefaultPrevented=(E.defaultPrevented!=null?E.defaultPrevented:E.returnValue===!1)?cs:xc,this.isPropagationStopped=xc,this}return ee(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=cs)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=cs)},persist:function(){},isPersistent:cs}),l}var Ur={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},$a=un(Ur),us=ee({},Ur,{view:0,detail:0}),Gp=un(us),Ha,Gs,Pi,Oo=ee({},us,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:hs,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==Pi&&(Pi&&a.type==="mousemove"?(Ha=a.screenX-Pi.screenX,Gs=a.screenY-Pi.screenY):Gs=Ha=0,Pi=a),Ha)},movementY:function(a){return"movementY"in a?a.movementY:Gs}}),Wa=un(Oo),Cc=ee({},Oo,{dataTransfer:0}),Vh=un(Cc),Ga=ee({},us,{relatedTarget:0}),qa=un(Ga),jh=ee({},Ur,{animationName:0,elapsedTime:0,pseudoElement:0}),qs=un(jh),Bh=ee({},Ur,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),Uh=un(Bh),zh=ee({},Ur,{data:0}),Ic=un(zh),Ka={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Mn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},$h={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Hh(a){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(a):(a=$h[a])?!!l[a]:!1}function hs(){return Hh}var p=ee({},us,{key:function(a){if(a.key){var l=Ka[a.key]||a.key;if(l!=="Unidentified")return l}return a.type==="keypress"?(a=za(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?Mn[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:hs,charCode:function(a){return a.type==="keypress"?za(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?za(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),w=un(p),S=ee({},Oo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),D=un(S),q=ee({},us,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:hs}),J=un(q),he=ee({},Ur,{propertyName:0,elapsedTime:0,pseudoElement:0}),rt=un(he),Kt=ee({},Oo,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),Qe=un(Kt),tn=[9,13,27,32],Ut=c&&"CompositionEvent"in window,yr=null;c&&"documentMode"in document&&(yr=document.documentMode);var rr=c&&"TextEvent"in window&&!yr,Fo=c&&(!Ut||yr&&8<yr&&11>=yr),Xa=" ",i_=!1;function o_(a,l){switch(a){case"keyup":return tn.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function a_(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Ya=!1;function kk(a,l){switch(a){case"compositionend":return a_(l);case"keypress":return l.which!==32?null:(i_=!0,Xa);case"textInput":return a=l.data,a===Xa&&i_?null:a;default:return null}}function Pk(a,l){if(Ya)return a==="compositionend"||!Ut&&o_(a,l)?(a=Sc(),$n=Ua=nr=null,Ya=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return Fo&&l.locale!=="ko"?null:l.data;default:return null}}var Rk={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function l_(a){var l=a&&a.nodeName&&a.nodeName.toLowerCase();return l==="input"?!!Rk[a.type]:l==="textarea"}function c_(a,l,d,g){os(g),l=Xh(l,"onChange"),0<l.length&&(d=new $a("onChange","change",null,d,g),a.push({event:d,listeners:l}))}var kc=null,Pc=null;function Dk(a){C_(a,0)}function Wh(a){var l=tl(a);if(vn(l))return a}function Lk(a,l){if(a==="change")return l}var u_=!1;if(c){var qp;if(c){var Kp="oninput"in document;if(!Kp){var h_=document.createElement("div");h_.setAttribute("oninput","return;"),Kp=typeof h_.oninput=="function"}qp=Kp}else qp=!1;u_=qp&&(!document.documentMode||9<document.documentMode)}function d_(){kc&&(kc.detachEvent("onpropertychange",f_),Pc=kc=null)}function f_(a){if(a.propertyName==="value"&&Wh(Pc)){var l=[];c_(l,Pc,a,ka(a)),gc(Dk,l)}}function Mk(a,l,d){a==="focusin"?(d_(),kc=l,Pc=d,kc.attachEvent("onpropertychange",f_)):a==="focusout"&&d_()}function Nk(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return Wh(Pc)}function Ok(a,l){if(a==="click")return Wh(l)}function Fk(a,l){if(a==="input"||a==="change")return Wh(l)}function Vk(a,l){return a===l&&(a!==0||1/a===1/l)||a!==a&&l!==l}var zr=typeof Object.is=="function"?Object.is:Vk;function Rc(a,l){if(zr(a,l))return!0;if(typeof a!="object"||a===null||typeof l!="object"||l===null)return!1;var d=Object.keys(a),g=Object.keys(l);if(d.length!==g.length)return!1;for(g=0;g<d.length;g++){var v=d[g];if(!u.call(l,v)||!zr(a[v],l[v]))return!1}return!0}function p_(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function m_(a,l){var d=p_(a);a=0;for(var g;d;){if(d.nodeType===3){if(g=a+d.textContent.length,a<=l&&g>=l)return{node:d,offset:l-a};a=g}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=p_(d)}}function g_(a,l){return a&&l?a===l?!0:a&&a.nodeType===3?!1:l&&l.nodeType===3?g_(a,l.parentNode):"contains"in a?a.contains(l):a.compareDocumentPosition?!!(a.compareDocumentPosition(l)&16):!1:!1}function y_(){for(var a=window,l=ze();l instanceof a.HTMLIFrameElement;){try{var d=typeof l.contentWindow.location.href=="string"}catch{d=!1}if(d)a=l.contentWindow;else break;l=ze(a.document)}return l}function Xp(a){var l=a&&a.nodeName&&a.nodeName.toLowerCase();return l&&(l==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||l==="textarea"||a.contentEditable==="true")}function jk(a){var l=y_(),d=a.focusedElem,g=a.selectionRange;if(l!==d&&d&&d.ownerDocument&&g_(d.ownerDocument.documentElement,d)){if(g!==null&&Xp(d)){if(l=g.start,a=g.end,a===void 0&&(a=l),"selectionStart"in d)d.selectionStart=l,d.selectionEnd=Math.min(a,d.value.length);else if(a=(l=d.ownerDocument||document)&&l.defaultView||window,a.getSelection){a=a.getSelection();var v=d.textContent.length,E=Math.min(g.start,v);g=g.end===void 0?E:Math.min(g.end,v),!a.extend&&E>g&&(v=g,g=E,E=v),v=m_(d,E);var I=m_(d,g);v&&I&&(a.rangeCount!==1||a.anchorNode!==v.node||a.anchorOffset!==v.offset||a.focusNode!==I.node||a.focusOffset!==I.offset)&&(l=l.createRange(),l.setStart(v.node,v.offset),a.removeAllRanges(),E>g?(a.addRange(l),a.extend(I.node,I.offset)):(l.setEnd(I.node,I.offset),a.addRange(l)))}}for(l=[],a=d;a=a.parentNode;)a.nodeType===1&&l.push({element:a,left:a.scrollLeft,top:a.scrollTop});for(typeof d.focus=="function"&&d.focus(),d=0;d<l.length;d++)a=l[d],a.element.scrollLeft=a.left,a.element.scrollTop=a.top}}var Bk=c&&"documentMode"in document&&11>=document.documentMode,Qa=null,Yp=null,Dc=null,Qp=!1;function v_(a,l,d){var g=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;Qp||Qa==null||Qa!==ze(g)||(g=Qa,"selectionStart"in g&&Xp(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),Dc&&Rc(Dc,g)||(Dc=g,g=Xh(Yp,"onSelect"),0<g.length&&(l=new $a("onSelect","select",null,l,d),a.push({event:l,listeners:g}),l.target=Qa)))}function Gh(a,l){var d={};return d[a.toLowerCase()]=l.toLowerCase(),d["Webkit"+a]="webkit"+l,d["Moz"+a]="moz"+l,d}var Ja={animationend:Gh("Animation","AnimationEnd"),animationiteration:Gh("Animation","AnimationIteration"),animationstart:Gh("Animation","AnimationStart"),transitionend:Gh("Transition","TransitionEnd")},Jp={},__={};c&&(__=document.createElement("div").style,"AnimationEvent"in window||(delete Ja.animationend.animation,delete Ja.animationiteration.animation,delete Ja.animationstart.animation),"TransitionEvent"in window||delete Ja.transitionend.transition);function qh(a){if(Jp[a])return Jp[a];if(!Ja[a])return a;var l=Ja[a],d;for(d in l)if(l.hasOwnProperty(d)&&d in __)return Jp[a]=l[d];return a}var w_=qh("animationend"),E_=qh("animationiteration"),A_=qh("animationstart"),b_=qh("transitionend"),T_=new Map,S_="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ri(a,l){T_.set(a,l),i(l,[a])}for(var Zp=0;Zp<S_.length;Zp++){var em=S_[Zp],Uk=em.toLowerCase(),zk=em[0].toUpperCase()+em.slice(1);Ri(Uk,"on"+zk)}Ri(w_,"onAnimationEnd"),Ri(E_,"onAnimationIteration"),Ri(A_,"onAnimationStart"),Ri("dblclick","onDoubleClick"),Ri("focusin","onFocus"),Ri("focusout","onBlur"),Ri(b_,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),i("onBeforeInput",["compositionend","keypress","textInput","paste"]),i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),$k=new Set("cancel close invalid load scroll toggle".split(" ").concat(Lc));function x_(a,l,d){var g=a.type||"unknown-event";a.currentTarget=d,bh(g,l,void 0,a),a.currentTarget=null}function C_(a,l){l=(l&4)!==0;for(var d=0;d<a.length;d++){var g=a[d],v=g.event;g=g.listeners;e:{var E=void 0;if(l)for(var I=g.length-1;0<=I;I--){var U=g[I],H=U.instance,Q=U.currentTarget;if(U=U.listener,H!==E&&v.isPropagationStopped())break e;x_(v,U,Q),E=H}else for(I=0;I<g.length;I++){if(U=g[I],H=U.instance,Q=U.currentTarget,U=U.listener,H!==E&&v.isPropagationStopped())break e;x_(v,U,Q),E=H}}}if(Mr)throw a=yc,Mr=!1,yc=null,a}function dt(a,l){var d=l[lm];d===void 0&&(d=l[lm]=new Set);var g=a+"__bubble";d.has(g)||(I_(l,a,2,!1),d.add(g))}function tm(a,l,d){var g=0;l&&(g|=4),I_(d,a,g,l)}var Kh="_reactListening"+Math.random().toString(36).slice(2);function Mc(a){if(!a[Kh]){a[Kh]=!0,n.forEach(function(d){d!=="selectionchange"&&($k.has(d)||tm(d,!1,a),tm(d,!0,a))});var l=a.nodeType===9?a:a.ownerDocument;l===null||l[Kh]||(l[Kh]=!0,tm("selectionchange",!1,l))}}function I_(a,l,d,g){switch(Tc(l)){case 1:var v=vt;break;case 4:v=Wp;break;default:v=bc}d=v.bind(null,l,d,a),v=void 0,!Da||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(v=!0),g?v!==void 0?a.addEventListener(l,d,{capture:!0,passive:v}):a.addEventListener(l,d,!0):v!==void 0?a.addEventListener(l,d,{passive:v}):a.addEventListener(l,d,!1)}function nm(a,l,d,g,v){var E=g;if((l&1)===0&&(l&2)===0&&g!==null)e:for(;;){if(g===null)return;var I=g.tag;if(I===3||I===4){var U=g.stateNode.containerInfo;if(U===v||U.nodeType===8&&U.parentNode===v)break;if(I===4)for(I=g.return;I!==null;){var H=I.tag;if((H===3||H===4)&&(H=I.stateNode.containerInfo,H===v||H.nodeType===8&&H.parentNode===v))return;I=I.return}for(;U!==null;){if(I=Vo(U),I===null)return;if(H=I.tag,H===5||H===6){g=E=I;continue e}U=U.parentNode}}g=g.return}gc(function(){var Q=E,oe=ka(d),le=[];e:{var se=T_.get(a);if(se!==void 0){var fe=$a,ye=a;switch(a){case"keypress":if(za(d)===0)break e;case"keydown":case"keyup":fe=w;break;case"focusin":ye="focus",fe=qa;break;case"focusout":ye="blur",fe=qa;break;case"beforeblur":case"afterblur":fe=qa;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":fe=Wa;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":fe=Vh;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":fe=J;break;case w_:case E_:case A_:fe=qs;break;case b_:fe=rt;break;case"scroll":fe=Gp;break;case"wheel":fe=Qe;break;case"copy":case"cut":case"paste":fe=Uh;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":fe=D}var ve=(l&4)!==0,Lt=!ve&&a==="scroll",K=ve?se!==null?se+"Capture":null:se;ve=[];for(var G=Q,X;G!==null;){X=G;var ce=X.stateNode;if(X.tag===5&&ce!==null&&(X=ce,K!==null&&(ce=Dt(G,K),ce!=null&&ve.push(Nc(G,ce,X)))),Lt)break;G=G.return}0<ve.length&&(se=new fe(se,ye,null,d,oe),le.push({event:se,listeners:ve}))}}if((l&7)===0){e:{if(se=a==="mouseover"||a==="pointerover",fe=a==="mouseout"||a==="pointerout",se&&d!==So&&(ye=d.relatedTarget||d.fromElement)&&(Vo(ye)||ye[Ks]))break e;if((fe||se)&&(se=oe.window===oe?oe:(se=oe.ownerDocument)?se.defaultView||se.parentWindow:window,fe?(ye=d.relatedTarget||d.toElement,fe=Q,ye=ye?Vo(ye):null,ye!==null&&(Lt=Nr(ye),ye!==Lt||ye.tag!==5&&ye.tag!==6)&&(ye=null)):(fe=null,ye=Q),fe!==ye)){if(ve=Wa,ce="onMouseLeave",K="onMouseEnter",G="mouse",(a==="pointerout"||a==="pointerover")&&(ve=D,ce="onPointerLeave",K="onPointerEnter",G="pointer"),Lt=fe==null?se:tl(fe),X=ye==null?se:tl(ye),se=new ve(ce,G+"leave",fe,d,oe),se.target=Lt,se.relatedTarget=X,ce=null,Vo(oe)===Q&&(ve=new ve(K,G+"enter",ye,d,oe),ve.target=X,ve.relatedTarget=Lt,ce=ve),Lt=ce,fe&&ye)t:{for(ve=fe,K=ye,G=0,X=ve;X;X=Za(X))G++;for(X=0,ce=K;ce;ce=Za(ce))X++;for(;0<G-X;)ve=Za(ve),G--;for(;0<X-G;)K=Za(K),X--;for(;G--;){if(ve===K||K!==null&&ve===K.alternate)break t;ve=Za(ve),K=Za(K)}ve=null}else ve=null;fe!==null&&k_(le,se,fe,ve,!1),ye!==null&&Lt!==null&&k_(le,Lt,ye,ve,!0)}}e:{if(se=Q?tl(Q):window,fe=se.nodeName&&se.nodeName.toLowerCase(),fe==="select"||fe==="input"&&se.type==="file")var Ae=Lk;else if(l_(se))if(u_)Ae=Fk;else{Ae=Nk;var xe=Mk}else(fe=se.nodeName)&&fe.toLowerCase()==="input"&&(se.type==="checkbox"||se.type==="radio")&&(Ae=Ok);if(Ae&&(Ae=Ae(a,Q))){c_(le,Ae,d,oe);break e}xe&&xe(a,se,Q),a==="focusout"&&(xe=se._wrapperState)&&xe.controlled&&se.type==="number"&&ss(se,"number",se.value)}switch(xe=Q?tl(Q):window,a){case"focusin":(l_(xe)||xe.contentEditable==="true")&&(Qa=xe,Yp=Q,Dc=null);break;case"focusout":Dc=Yp=Qa=null;break;case"mousedown":Qp=!0;break;case"contextmenu":case"mouseup":case"dragend":Qp=!1,v_(le,d,oe);break;case"selectionchange":if(Bk)break;case"keydown":case"keyup":v_(le,d,oe)}var Ce;if(Ut)e:{switch(a){case"compositionstart":var Ne="onCompositionStart";break e;case"compositionend":Ne="onCompositionEnd";break e;case"compositionupdate":Ne="onCompositionUpdate";break e}Ne=void 0}else Ya?o_(a,d)&&(Ne="onCompositionEnd"):a==="keydown"&&d.keyCode===229&&(Ne="onCompositionStart");Ne&&(Fo&&d.locale!=="ko"&&(Ya||Ne!=="onCompositionStart"?Ne==="onCompositionEnd"&&Ya&&(Ce=Sc()):(nr=oe,Ua="value"in nr?nr.value:nr.textContent,Ya=!0)),xe=Xh(Q,Ne),0<xe.length&&(Ne=new Ic(Ne,a,null,d,oe),le.push({event:Ne,listeners:xe}),Ce?Ne.data=Ce:(Ce=a_(d),Ce!==null&&(Ne.data=Ce)))),(Ce=rr?kk(a,d):Pk(a,d))&&(Q=Xh(Q,"onBeforeInput"),0<Q.length&&(oe=new Ic("onBeforeInput","beforeinput",null,d,oe),le.push({event:oe,listeners:Q}),oe.data=Ce))}C_(le,l)})}function Nc(a,l,d){return{instance:a,listener:l,currentTarget:d}}function Xh(a,l){for(var d=l+"Capture",g=[];a!==null;){var v=a,E=v.stateNode;v.tag===5&&E!==null&&(v=E,E=Dt(a,d),E!=null&&g.unshift(Nc(a,E,v)),E=Dt(a,l),E!=null&&g.push(Nc(a,E,v))),a=a.return}return g}function Za(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5);return a||null}function k_(a,l,d,g,v){for(var E=l._reactName,I=[];d!==null&&d!==g;){var U=d,H=U.alternate,Q=U.stateNode;if(H!==null&&H===g)break;U.tag===5&&Q!==null&&(U=Q,v?(H=Dt(d,E),H!=null&&I.unshift(Nc(d,H,U))):v||(H=Dt(d,E),H!=null&&I.push(Nc(d,H,U)))),d=d.return}I.length!==0&&a.push({event:l,listeners:I})}var Hk=/\r\n?/g,Wk=/\u0000|\uFFFD/g;function P_(a){return(typeof a=="string"?a:""+a).replace(Hk,`
`).replace(Wk,"")}function Yh(a,l,d){if(l=P_(l),P_(a)!==l&&d)throw Error(t(425))}function Qh(){}var rm=null,sm=null;function im(a,l){return a==="textarea"||a==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var om=typeof setTimeout=="function"?setTimeout:void 0,Gk=typeof clearTimeout=="function"?clearTimeout:void 0,R_=typeof Promise=="function"?Promise:void 0,qk=typeof queueMicrotask=="function"?queueMicrotask:typeof R_<"u"?function(a){return R_.resolve(null).then(a).catch(Kk)}:om;function Kk(a){setTimeout(function(){throw a})}function am(a,l){var d=l,g=0;do{var v=d.nextSibling;if(a.removeChild(d),v&&v.nodeType===8)if(d=v.data,d==="/$"){if(g===0){a.removeChild(v),Br(l);return}g--}else d!=="$"&&d!=="$?"&&d!=="$!"||g++;d=v}while(d);Br(l)}function Di(a){for(;a!=null;a=a.nextSibling){var l=a.nodeType;if(l===1||l===3)break;if(l===8){if(l=a.data,l==="$"||l==="$!"||l==="$?")break;if(l==="/$")return null}}return a}function D_(a){a=a.previousSibling;for(var l=0;a;){if(a.nodeType===8){var d=a.data;if(d==="$"||d==="$!"||d==="$?"){if(l===0)return a;l--}else d==="/$"&&l++}a=a.previousSibling}return null}var el=Math.random().toString(36).slice(2),ds="__reactFiber$"+el,Oc="__reactProps$"+el,Ks="__reactContainer$"+el,lm="__reactEvents$"+el,Xk="__reactListeners$"+el,Yk="__reactHandles$"+el;function Vo(a){var l=a[ds];if(l)return l;for(var d=a.parentNode;d;){if(l=d[Ks]||d[ds]){if(d=l.alternate,l.child!==null||d!==null&&d.child!==null)for(a=D_(a);a!==null;){if(d=a[ds])return d;a=D_(a)}return l}a=d,d=a.parentNode}return null}function Fc(a){return a=a[ds]||a[Ks],!a||a.tag!==5&&a.tag!==6&&a.tag!==13&&a.tag!==3?null:a}function tl(a){if(a.tag===5||a.tag===6)return a.stateNode;throw Error(t(33))}function Jh(a){return a[Oc]||null}var cm=[],nl=-1;function Li(a){return{current:a}}function ft(a){0>nl||(a.current=cm[nl],cm[nl]=null,nl--)}function ut(a,l){nl++,cm[nl]=a.current,a.current=l}var Mi={},wn=Li(Mi),Hn=Li(!1),jo=Mi;function rl(a,l){var d=a.type.contextTypes;if(!d)return Mi;var g=a.stateNode;if(g&&g.__reactInternalMemoizedUnmaskedChildContext===l)return g.__reactInternalMemoizedMaskedChildContext;var v={},E;for(E in d)v[E]=l[E];return g&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=l,a.__reactInternalMemoizedMaskedChildContext=v),v}function Wn(a){return a=a.childContextTypes,a!=null}function Zh(){ft(Hn),ft(wn)}function L_(a,l,d){if(wn.current!==Mi)throw Error(t(168));ut(wn,l),ut(Hn,d)}function M_(a,l,d){var g=a.stateNode;if(l=l.childContextTypes,typeof g.getChildContext!="function")return d;g=g.getChildContext();for(var v in g)if(!(v in l))throw Error(t(108,Ee(a)||"Unknown",v));return ee({},d,g)}function ed(a){return a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||Mi,jo=wn.current,ut(wn,a),ut(Hn,Hn.current),!0}function N_(a,l,d){var g=a.stateNode;if(!g)throw Error(t(169));d?(a=M_(a,l,jo),g.__reactInternalMemoizedMergedChildContext=a,ft(Hn),ft(wn),ut(wn,a)):ft(Hn),ut(Hn,d)}var Xs=null,td=!1,um=!1;function O_(a){Xs===null?Xs=[a]:Xs.push(a)}function Qk(a){td=!0,O_(a)}function Ni(){if(!um&&Xs!==null){um=!0;var a=0,l=Ye;try{var d=Xs;for(Ye=1;a<d.length;a++){var g=d[a];do g=g(!0);while(g!==null)}Xs=null,td=!1}catch(v){throw Xs!==null&&(Xs=Xs.slice(a+1)),Oa(Po,Ni),v}finally{Ye=l,um=!1}}return null}var sl=[],il=0,nd=null,rd=0,vr=[],_r=0,Bo=null,Ys=1,Qs="";function Uo(a,l){sl[il++]=rd,sl[il++]=nd,nd=a,rd=l}function F_(a,l,d){vr[_r++]=Ys,vr[_r++]=Qs,vr[_r++]=Bo,Bo=a;var g=Ys;a=Qs;var v=32-Ln(g)-1;g&=~(1<<v),d+=1;var E=32-Ln(l)+v;if(30<E){var I=v-v%5;E=(g&(1<<I)-1).toString(32),g>>=I,v-=I,Ys=1<<32-Ln(l)+v|d<<v|g,Qs=E+a}else Ys=1<<E|d<<v|g,Qs=a}function hm(a){a.return!==null&&(Uo(a,1),F_(a,1,0))}function dm(a){for(;a===nd;)nd=sl[--il],sl[il]=null,rd=sl[--il],sl[il]=null;for(;a===Bo;)Bo=vr[--_r],vr[_r]=null,Qs=vr[--_r],vr[_r]=null,Ys=vr[--_r],vr[_r]=null}var sr=null,ir=null,_t=!1,$r=null;function V_(a,l){var d=br(5,null,null,0);d.elementType="DELETED",d.stateNode=l,d.return=a,l=a.deletions,l===null?(a.deletions=[d],a.flags|=16):l.push(d)}function j_(a,l){switch(a.tag){case 5:var d=a.type;return l=l.nodeType!==1||d.toLowerCase()!==l.nodeName.toLowerCase()?null:l,l!==null?(a.stateNode=l,sr=a,ir=Di(l.firstChild),!0):!1;case 6:return l=a.pendingProps===""||l.nodeType!==3?null:l,l!==null?(a.stateNode=l,sr=a,ir=null,!0):!1;case 13:return l=l.nodeType!==8?null:l,l!==null?(d=Bo!==null?{id:Ys,overflow:Qs}:null,a.memoizedState={dehydrated:l,treeContext:d,retryLane:1073741824},d=br(18,null,null,0),d.stateNode=l,d.return=a,a.child=d,sr=a,ir=null,!0):!1;default:return!1}}function fm(a){return(a.mode&1)!==0&&(a.flags&128)===0}function pm(a){if(_t){var l=ir;if(l){var d=l;if(!j_(a,l)){if(fm(a))throw Error(t(418));l=Di(d.nextSibling);var g=sr;l&&j_(a,l)?V_(g,d):(a.flags=a.flags&-4097|2,_t=!1,sr=a)}}else{if(fm(a))throw Error(t(418));a.flags=a.flags&-4097|2,_t=!1,sr=a}}}function B_(a){for(a=a.return;a!==null&&a.tag!==5&&a.tag!==3&&a.tag!==13;)a=a.return;sr=a}function sd(a){if(a!==sr)return!1;if(!_t)return B_(a),_t=!0,!1;var l;if((l=a.tag!==3)&&!(l=a.tag!==5)&&(l=a.type,l=l!=="head"&&l!=="body"&&!im(a.type,a.memoizedProps)),l&&(l=ir)){if(fm(a))throw U_(),Error(t(418));for(;l;)V_(a,l),l=Di(l.nextSibling)}if(B_(a),a.tag===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(t(317));e:{for(a=a.nextSibling,l=0;a;){if(a.nodeType===8){var d=a.data;if(d==="/$"){if(l===0){ir=Di(a.nextSibling);break e}l--}else d!=="$"&&d!=="$!"&&d!=="$?"||l++}a=a.nextSibling}ir=null}}else ir=sr?Di(a.stateNode.nextSibling):null;return!0}function U_(){for(var a=ir;a;)a=Di(a.nextSibling)}function ol(){ir=sr=null,_t=!1}function mm(a){$r===null?$r=[a]:$r.push(a)}var Jk=B.ReactCurrentBatchConfig;function Vc(a,l,d){if(a=d.ref,a!==null&&typeof a!="function"&&typeof a!="object"){if(d._owner){if(d=d._owner,d){if(d.tag!==1)throw Error(t(309));var g=d.stateNode}if(!g)throw Error(t(147,a));var v=g,E=""+a;return l!==null&&l.ref!==null&&typeof l.ref=="function"&&l.ref._stringRef===E?l.ref:(l=function(I){var U=v.refs;I===null?delete U[E]:U[E]=I},l._stringRef=E,l)}if(typeof a!="string")throw Error(t(284));if(!d._owner)throw Error(t(290,a))}return a}function id(a,l){throw a=Object.prototype.toString.call(l),Error(t(31,a==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":a))}function z_(a){var l=a._init;return l(a._payload)}function $_(a){function l(K,G){if(a){var X=K.deletions;X===null?(K.deletions=[G],K.flags|=16):X.push(G)}}function d(K,G){if(!a)return null;for(;G!==null;)l(K,G),G=G.sibling;return null}function g(K,G){for(K=new Map;G!==null;)G.key!==null?K.set(G.key,G):K.set(G.index,G),G=G.sibling;return K}function v(K,G){return K=$i(K,G),K.index=0,K.sibling=null,K}function E(K,G,X){return K.index=X,a?(X=K.alternate,X!==null?(X=X.index,X<G?(K.flags|=2,G):X):(K.flags|=2,G)):(K.flags|=1048576,G)}function I(K){return a&&K.alternate===null&&(K.flags|=2),K}function U(K,G,X,ce){return G===null||G.tag!==6?(G=og(X,K.mode,ce),G.return=K,G):(G=v(G,X),G.return=K,G)}function H(K,G,X,ce){var Ae=X.type;return Ae===k?oe(K,G,X.props.children,ce,X.key):G!==null&&(G.elementType===Ae||typeof Ae=="object"&&Ae!==null&&Ae.$$typeof===ie&&z_(Ae)===G.type)?(ce=v(G,X.props),ce.ref=Vc(K,G,X),ce.return=K,ce):(ce=kd(X.type,X.key,X.props,null,K.mode,ce),ce.ref=Vc(K,G,X),ce.return=K,ce)}function Q(K,G,X,ce){return G===null||G.tag!==4||G.stateNode.containerInfo!==X.containerInfo||G.stateNode.implementation!==X.implementation?(G=ag(X,K.mode,ce),G.return=K,G):(G=v(G,X.children||[]),G.return=K,G)}function oe(K,G,X,ce,Ae){return G===null||G.tag!==7?(G=Xo(X,K.mode,ce,Ae),G.return=K,G):(G=v(G,X),G.return=K,G)}function le(K,G,X){if(typeof G=="string"&&G!==""||typeof G=="number")return G=og(""+G,K.mode,X),G.return=K,G;if(typeof G=="object"&&G!==null){switch(G.$$typeof){case O:return X=kd(G.type,G.key,G.props,null,K.mode,X),X.ref=Vc(K,null,G),X.return=K,X;case $:return G=ag(G,K.mode,X),G.return=K,G;case ie:var ce=G._init;return le(K,ce(G._payload),X)}if(Dr(G)||de(G))return G=Xo(G,K.mode,X,null),G.return=K,G;id(K,G)}return null}function se(K,G,X,ce){var Ae=G!==null?G.key:null;if(typeof X=="string"&&X!==""||typeof X=="number")return Ae!==null?null:U(K,G,""+X,ce);if(typeof X=="object"&&X!==null){switch(X.$$typeof){case O:return X.key===Ae?H(K,G,X,ce):null;case $:return X.key===Ae?Q(K,G,X,ce):null;case ie:return Ae=X._init,se(K,G,Ae(X._payload),ce)}if(Dr(X)||de(X))return Ae!==null?null:oe(K,G,X,ce,null);id(K,X)}return null}function fe(K,G,X,ce,Ae){if(typeof ce=="string"&&ce!==""||typeof ce=="number")return K=K.get(X)||null,U(G,K,""+ce,Ae);if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case O:return K=K.get(ce.key===null?X:ce.key)||null,H(G,K,ce,Ae);case $:return K=K.get(ce.key===null?X:ce.key)||null,Q(G,K,ce,Ae);case ie:var xe=ce._init;return fe(K,G,X,xe(ce._payload),Ae)}if(Dr(ce)||de(ce))return K=K.get(X)||null,oe(G,K,ce,Ae,null);id(G,ce)}return null}function ye(K,G,X,ce){for(var Ae=null,xe=null,Ce=G,Ne=G=0,sn=null;Ce!==null&&Ne<X.length;Ne++){Ce.index>Ne?(sn=Ce,Ce=null):sn=Ce.sibling;var tt=se(K,Ce,X[Ne],ce);if(tt===null){Ce===null&&(Ce=sn);break}a&&Ce&&tt.alternate===null&&l(K,Ce),G=E(tt,G,Ne),xe===null?Ae=tt:xe.sibling=tt,xe=tt,Ce=sn}if(Ne===X.length)return d(K,Ce),_t&&Uo(K,Ne),Ae;if(Ce===null){for(;Ne<X.length;Ne++)Ce=le(K,X[Ne],ce),Ce!==null&&(G=E(Ce,G,Ne),xe===null?Ae=Ce:xe.sibling=Ce,xe=Ce);return _t&&Uo(K,Ne),Ae}for(Ce=g(K,Ce);Ne<X.length;Ne++)sn=fe(Ce,K,Ne,X[Ne],ce),sn!==null&&(a&&sn.alternate!==null&&Ce.delete(sn.key===null?Ne:sn.key),G=E(sn,G,Ne),xe===null?Ae=sn:xe.sibling=sn,xe=sn);return a&&Ce.forEach(function(Hi){return l(K,Hi)}),_t&&Uo(K,Ne),Ae}function ve(K,G,X,ce){var Ae=de(X);if(typeof Ae!="function")throw Error(t(150));if(X=Ae.call(X),X==null)throw Error(t(151));for(var xe=Ae=null,Ce=G,Ne=G=0,sn=null,tt=X.next();Ce!==null&&!tt.done;Ne++,tt=X.next()){Ce.index>Ne?(sn=Ce,Ce=null):sn=Ce.sibling;var Hi=se(K,Ce,tt.value,ce);if(Hi===null){Ce===null&&(Ce=sn);break}a&&Ce&&Hi.alternate===null&&l(K,Ce),G=E(Hi,G,Ne),xe===null?Ae=Hi:xe.sibling=Hi,xe=Hi,Ce=sn}if(tt.done)return d(K,Ce),_t&&Uo(K,Ne),Ae;if(Ce===null){for(;!tt.done;Ne++,tt=X.next())tt=le(K,tt.value,ce),tt!==null&&(G=E(tt,G,Ne),xe===null?Ae=tt:xe.sibling=tt,xe=tt);return _t&&Uo(K,Ne),Ae}for(Ce=g(K,Ce);!tt.done;Ne++,tt=X.next())tt=fe(Ce,K,Ne,tt.value,ce),tt!==null&&(a&&tt.alternate!==null&&Ce.delete(tt.key===null?Ne:tt.key),G=E(tt,G,Ne),xe===null?Ae=tt:xe.sibling=tt,xe=tt);return a&&Ce.forEach(function(RP){return l(K,RP)}),_t&&Uo(K,Ne),Ae}function Lt(K,G,X,ce){if(typeof X=="object"&&X!==null&&X.type===k&&X.key===null&&(X=X.props.children),typeof X=="object"&&X!==null){switch(X.$$typeof){case O:e:{for(var Ae=X.key,xe=G;xe!==null;){if(xe.key===Ae){if(Ae=X.type,Ae===k){if(xe.tag===7){d(K,xe.sibling),G=v(xe,X.props.children),G.return=K,K=G;break e}}else if(xe.elementType===Ae||typeof Ae=="object"&&Ae!==null&&Ae.$$typeof===ie&&z_(Ae)===xe.type){d(K,xe.sibling),G=v(xe,X.props),G.ref=Vc(K,xe,X),G.return=K,K=G;break e}d(K,xe);break}else l(K,xe);xe=xe.sibling}X.type===k?(G=Xo(X.props.children,K.mode,ce,X.key),G.return=K,K=G):(ce=kd(X.type,X.key,X.props,null,K.mode,ce),ce.ref=Vc(K,G,X),ce.return=K,K=ce)}return I(K);case $:e:{for(xe=X.key;G!==null;){if(G.key===xe)if(G.tag===4&&G.stateNode.containerInfo===X.containerInfo&&G.stateNode.implementation===X.implementation){d(K,G.sibling),G=v(G,X.children||[]),G.return=K,K=G;break e}else{d(K,G);break}else l(K,G);G=G.sibling}G=ag(X,K.mode,ce),G.return=K,K=G}return I(K);case ie:return xe=X._init,Lt(K,G,xe(X._payload),ce)}if(Dr(X))return ye(K,G,X,ce);if(de(X))return ve(K,G,X,ce);id(K,X)}return typeof X=="string"&&X!==""||typeof X=="number"?(X=""+X,G!==null&&G.tag===6?(d(K,G.sibling),G=v(G,X),G.return=K,K=G):(d(K,G),G=og(X,K.mode,ce),G.return=K,K=G),I(K)):d(K,G)}return Lt}var al=$_(!0),H_=$_(!1),od=Li(null),ad=null,ll=null,gm=null;function ym(){gm=ll=ad=null}function vm(a){var l=od.current;ft(od),a._currentValue=l}function _m(a,l,d){for(;a!==null;){var g=a.alternate;if((a.childLanes&l)!==l?(a.childLanes|=l,g!==null&&(g.childLanes|=l)):g!==null&&(g.childLanes&l)!==l&&(g.childLanes|=l),a===d)break;a=a.return}}function cl(a,l){ad=a,gm=ll=null,a=a.dependencies,a!==null&&a.firstContext!==null&&((a.lanes&l)!==0&&(Gn=!0),a.firstContext=null)}function wr(a){var l=a._currentValue;if(gm!==a)if(a={context:a,memoizedValue:l,next:null},ll===null){if(ad===null)throw Error(t(308));ll=a,ad.dependencies={lanes:0,firstContext:a}}else ll=ll.next=a;return l}var zo=null;function wm(a){zo===null?zo=[a]:zo.push(a)}function W_(a,l,d,g){var v=l.interleaved;return v===null?(d.next=d,wm(l)):(d.next=v.next,v.next=d),l.interleaved=d,Js(a,g)}function Js(a,l){a.lanes|=l;var d=a.alternate;for(d!==null&&(d.lanes|=l),d=a,a=a.return;a!==null;)a.childLanes|=l,d=a.alternate,d!==null&&(d.childLanes|=l),d=a,a=a.return;return d.tag===3?d.stateNode:null}var Oi=!1;function Em(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function G_(a,l){a=a.updateQueue,l.updateQueue===a&&(l.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function Zs(a,l){return{eventTime:a,lane:l,tag:0,payload:null,callback:null,next:null}}function Fi(a,l,d){var g=a.updateQueue;if(g===null)return null;if(g=g.shared,(Ze&2)!==0){var v=g.pending;return v===null?l.next=l:(l.next=v.next,v.next=l),g.pending=l,Js(a,d)}return v=g.interleaved,v===null?(l.next=l,wm(g)):(l.next=v.next,v.next=l),g.interleaved=l,Js(a,d)}function ld(a,l,d){if(l=l.updateQueue,l!==null&&(l=l.shared,(d&4194240)!==0)){var g=l.lanes;g&=a.pendingLanes,d|=g,l.lanes=d,xi(a,d)}}function q_(a,l){var d=a.updateQueue,g=a.alternate;if(g!==null&&(g=g.updateQueue,d===g)){var v=null,E=null;if(d=d.firstBaseUpdate,d!==null){do{var I={eventTime:d.eventTime,lane:d.lane,tag:d.tag,payload:d.payload,callback:d.callback,next:null};E===null?v=E=I:E=E.next=I,d=d.next}while(d!==null);E===null?v=E=l:E=E.next=l}else v=E=l;d={baseState:g.baseState,firstBaseUpdate:v,lastBaseUpdate:E,shared:g.shared,effects:g.effects},a.updateQueue=d;return}a=d.lastBaseUpdate,a===null?d.firstBaseUpdate=l:a.next=l,d.lastBaseUpdate=l}function cd(a,l,d,g){var v=a.updateQueue;Oi=!1;var E=v.firstBaseUpdate,I=v.lastBaseUpdate,U=v.shared.pending;if(U!==null){v.shared.pending=null;var H=U,Q=H.next;H.next=null,I===null?E=Q:I.next=Q,I=H;var oe=a.alternate;oe!==null&&(oe=oe.updateQueue,U=oe.lastBaseUpdate,U!==I&&(U===null?oe.firstBaseUpdate=Q:U.next=Q,oe.lastBaseUpdate=H))}if(E!==null){var le=v.baseState;I=0,oe=Q=H=null,U=E;do{var se=U.lane,fe=U.eventTime;if((g&se)===se){oe!==null&&(oe=oe.next={eventTime:fe,lane:0,tag:U.tag,payload:U.payload,callback:U.callback,next:null});e:{var ye=a,ve=U;switch(se=l,fe=d,ve.tag){case 1:if(ye=ve.payload,typeof ye=="function"){le=ye.call(fe,le,se);break e}le=ye;break e;case 3:ye.flags=ye.flags&-65537|128;case 0:if(ye=ve.payload,se=typeof ye=="function"?ye.call(fe,le,se):ye,se==null)break e;le=ee({},le,se);break e;case 2:Oi=!0}}U.callback!==null&&U.lane!==0&&(a.flags|=64,se=v.effects,se===null?v.effects=[U]:se.push(U))}else fe={eventTime:fe,lane:se,tag:U.tag,payload:U.payload,callback:U.callback,next:null},oe===null?(Q=oe=fe,H=le):oe=oe.next=fe,I|=se;if(U=U.next,U===null){if(U=v.shared.pending,U===null)break;se=U,U=se.next,se.next=null,v.lastBaseUpdate=se,v.shared.pending=null}}while(!0);if(oe===null&&(H=le),v.baseState=H,v.firstBaseUpdate=Q,v.lastBaseUpdate=oe,l=v.shared.interleaved,l!==null){v=l;do I|=v.lane,v=v.next;while(v!==l)}else E===null&&(v.shared.lanes=0);Wo|=I,a.lanes=I,a.memoizedState=le}}function K_(a,l,d){if(a=l.effects,l.effects=null,a!==null)for(l=0;l<a.length;l++){var g=a[l],v=g.callback;if(v!==null){if(g.callback=null,g=d,typeof v!="function")throw Error(t(191,v));v.call(g)}}}var jc={},fs=Li(jc),Bc=Li(jc),Uc=Li(jc);function $o(a){if(a===jc)throw Error(t(174));return a}function Am(a,l){switch(ut(Uc,l),ut(Bc,a),ut(fs,jc),a=l.nodeType,a){case 9:case 11:l=(l=l.documentElement)?l.namespaceURI:st(null,"");break;default:a=a===8?l.parentNode:l,l=a.namespaceURI||null,a=a.tagName,l=st(l,a)}ft(fs),ut(fs,l)}function ul(){ft(fs),ft(Bc),ft(Uc)}function X_(a){$o(Uc.current);var l=$o(fs.current),d=st(l,a.type);l!==d&&(ut(Bc,a),ut(fs,d))}function bm(a){Bc.current===a&&(ft(fs),ft(Bc))}var bt=Li(0);function ud(a){for(var l=a;l!==null;){if(l.tag===13){var d=l.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||d.data==="$!"))return l}else if(l.tag===19&&l.memoizedProps.revealOrder!==void 0){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===a)break;for(;l.sibling===null;){if(l.return===null||l.return===a)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var Tm=[];function Sm(){for(var a=0;a<Tm.length;a++)Tm[a]._workInProgressVersionPrimary=null;Tm.length=0}var hd=B.ReactCurrentDispatcher,xm=B.ReactCurrentBatchConfig,Ho=0,Tt=null,Xt=null,nn=null,dd=!1,zc=!1,$c=0,Zk=0;function En(){throw Error(t(321))}function Cm(a,l){if(l===null)return!1;for(var d=0;d<l.length&&d<a.length;d++)if(!zr(a[d],l[d]))return!1;return!0}function Im(a,l,d,g,v,E){if(Ho=E,Tt=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,hd.current=a===null||a.memoizedState===null?rP:sP,a=d(g,v),zc){E=0;do{if(zc=!1,$c=0,25<=E)throw Error(t(301));E+=1,nn=Xt=null,l.updateQueue=null,hd.current=iP,a=d(g,v)}while(zc)}if(hd.current=md,l=Xt!==null&&Xt.next!==null,Ho=0,nn=Xt=Tt=null,dd=!1,l)throw Error(t(300));return a}function km(){var a=$c!==0;return $c=0,a}function ps(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return nn===null?Tt.memoizedState=nn=a:nn=nn.next=a,nn}function Er(){if(Xt===null){var a=Tt.alternate;a=a!==null?a.memoizedState:null}else a=Xt.next;var l=nn===null?Tt.memoizedState:nn.next;if(l!==null)nn=l,Xt=a;else{if(a===null)throw Error(t(310));Xt=a,a={memoizedState:Xt.memoizedState,baseState:Xt.baseState,baseQueue:Xt.baseQueue,queue:Xt.queue,next:null},nn===null?Tt.memoizedState=nn=a:nn=nn.next=a}return nn}function Hc(a,l){return typeof l=="function"?l(a):l}function Pm(a){var l=Er(),d=l.queue;if(d===null)throw Error(t(311));d.lastRenderedReducer=a;var g=Xt,v=g.baseQueue,E=d.pending;if(E!==null){if(v!==null){var I=v.next;v.next=E.next,E.next=I}g.baseQueue=v=E,d.pending=null}if(v!==null){E=v.next,g=g.baseState;var U=I=null,H=null,Q=E;do{var oe=Q.lane;if((Ho&oe)===oe)H!==null&&(H=H.next={lane:0,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null}),g=Q.hasEagerState?Q.eagerState:a(g,Q.action);else{var le={lane:oe,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null};H===null?(U=H=le,I=g):H=H.next=le,Tt.lanes|=oe,Wo|=oe}Q=Q.next}while(Q!==null&&Q!==E);H===null?I=g:H.next=U,zr(g,l.memoizedState)||(Gn=!0),l.memoizedState=g,l.baseState=I,l.baseQueue=H,d.lastRenderedState=g}if(a=d.interleaved,a!==null){v=a;do E=v.lane,Tt.lanes|=E,Wo|=E,v=v.next;while(v!==a)}else v===null&&(d.lanes=0);return[l.memoizedState,d.dispatch]}function Rm(a){var l=Er(),d=l.queue;if(d===null)throw Error(t(311));d.lastRenderedReducer=a;var g=d.dispatch,v=d.pending,E=l.memoizedState;if(v!==null){d.pending=null;var I=v=v.next;do E=a(E,I.action),I=I.next;while(I!==v);zr(E,l.memoizedState)||(Gn=!0),l.memoizedState=E,l.baseQueue===null&&(l.baseState=E),d.lastRenderedState=E}return[E,g]}function Y_(){}function Q_(a,l){var d=Tt,g=Er(),v=l(),E=!zr(g.memoizedState,v);if(E&&(g.memoizedState=v,Gn=!0),g=g.queue,Dm(ew.bind(null,d,g,a),[a]),g.getSnapshot!==l||E||nn!==null&&nn.memoizedState.tag&1){if(d.flags|=2048,Wc(9,Z_.bind(null,d,g,v,l),void 0,null),rn===null)throw Error(t(349));(Ho&30)!==0||J_(d,l,v)}return v}function J_(a,l,d){a.flags|=16384,a={getSnapshot:l,value:d},l=Tt.updateQueue,l===null?(l={lastEffect:null,stores:null},Tt.updateQueue=l,l.stores=[a]):(d=l.stores,d===null?l.stores=[a]:d.push(a))}function Z_(a,l,d,g){l.value=d,l.getSnapshot=g,tw(l)&&nw(a)}function ew(a,l,d){return d(function(){tw(l)&&nw(a)})}function tw(a){var l=a.getSnapshot;a=a.value;try{var d=l();return!zr(a,d)}catch{return!0}}function nw(a){var l=Js(a,1);l!==null&&qr(l,a,1,-1)}function rw(a){var l=ps();return typeof a=="function"&&(a=a()),l.memoizedState=l.baseState=a,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Hc,lastRenderedState:a},l.queue=a,a=a.dispatch=nP.bind(null,Tt,a),[l.memoizedState,a]}function Wc(a,l,d,g){return a={tag:a,create:l,destroy:d,deps:g,next:null},l=Tt.updateQueue,l===null?(l={lastEffect:null,stores:null},Tt.updateQueue=l,l.lastEffect=a.next=a):(d=l.lastEffect,d===null?l.lastEffect=a.next=a:(g=d.next,d.next=a,a.next=g,l.lastEffect=a)),a}function sw(){return Er().memoizedState}function fd(a,l,d,g){var v=ps();Tt.flags|=a,v.memoizedState=Wc(1|l,d,void 0,g===void 0?null:g)}function pd(a,l,d,g){var v=Er();g=g===void 0?null:g;var E=void 0;if(Xt!==null){var I=Xt.memoizedState;if(E=I.destroy,g!==null&&Cm(g,I.deps)){v.memoizedState=Wc(l,d,E,g);return}}Tt.flags|=a,v.memoizedState=Wc(1|l,d,E,g)}function iw(a,l){return fd(8390656,8,a,l)}function Dm(a,l){return pd(2048,8,a,l)}function ow(a,l){return pd(4,2,a,l)}function aw(a,l){return pd(4,4,a,l)}function lw(a,l){if(typeof l=="function")return a=a(),l(a),function(){l(null)};if(l!=null)return a=a(),l.current=a,function(){l.current=null}}function cw(a,l,d){return d=d!=null?d.concat([a]):null,pd(4,4,lw.bind(null,l,a),d)}function Lm(){}function uw(a,l){var d=Er();l=l===void 0?null:l;var g=d.memoizedState;return g!==null&&l!==null&&Cm(l,g[1])?g[0]:(d.memoizedState=[a,l],a)}function hw(a,l){var d=Er();l=l===void 0?null:l;var g=d.memoizedState;return g!==null&&l!==null&&Cm(l,g[1])?g[0]:(a=a(),d.memoizedState=[a,l],a)}function dw(a,l,d){return(Ho&21)===0?(a.baseState&&(a.baseState=!1,Gn=!0),a.memoizedState=d):(zr(d,l)||(d=Lo(),Tt.lanes|=d,Wo|=d,a.baseState=!0),l)}function eP(a,l){var d=Ye;Ye=d!==0&&4>d?d:4,a(!0);var g=xm.transition;xm.transition={};try{a(!1),l()}finally{Ye=d,xm.transition=g}}function fw(){return Er().memoizedState}function tP(a,l,d){var g=Ui(a);if(d={lane:g,action:d,hasEagerState:!1,eagerState:null,next:null},pw(a))mw(l,d);else if(d=W_(a,l,d,g),d!==null){var v=On();qr(d,a,g,v),gw(d,l,g)}}function nP(a,l,d){var g=Ui(a),v={lane:g,action:d,hasEagerState:!1,eagerState:null,next:null};if(pw(a))mw(l,v);else{var E=a.alternate;if(a.lanes===0&&(E===null||E.lanes===0)&&(E=l.lastRenderedReducer,E!==null))try{var I=l.lastRenderedState,U=E(I,d);if(v.hasEagerState=!0,v.eagerState=U,zr(U,I)){var H=l.interleaved;H===null?(v.next=v,wm(l)):(v.next=H.next,H.next=v),l.interleaved=v;return}}catch{}finally{}d=W_(a,l,v,g),d!==null&&(v=On(),qr(d,a,g,v),gw(d,l,g))}}function pw(a){var l=a.alternate;return a===Tt||l!==null&&l===Tt}function mw(a,l){zc=dd=!0;var d=a.pending;d===null?l.next=l:(l.next=d.next,d.next=l),a.pending=l}function gw(a,l,d){if((d&4194240)!==0){var g=l.lanes;g&=a.pendingLanes,d|=g,l.lanes=d,xi(a,d)}}var md={readContext:wr,useCallback:En,useContext:En,useEffect:En,useImperativeHandle:En,useInsertionEffect:En,useLayoutEffect:En,useMemo:En,useReducer:En,useRef:En,useState:En,useDebugValue:En,useDeferredValue:En,useTransition:En,useMutableSource:En,useSyncExternalStore:En,useId:En,unstable_isNewReconciler:!1},rP={readContext:wr,useCallback:function(a,l){return ps().memoizedState=[a,l===void 0?null:l],a},useContext:wr,useEffect:iw,useImperativeHandle:function(a,l,d){return d=d!=null?d.concat([a]):null,fd(4194308,4,lw.bind(null,l,a),d)},useLayoutEffect:function(a,l){return fd(4194308,4,a,l)},useInsertionEffect:function(a,l){return fd(4,2,a,l)},useMemo:function(a,l){var d=ps();return l=l===void 0?null:l,a=a(),d.memoizedState=[a,l],a},useReducer:function(a,l,d){var g=ps();return l=d!==void 0?d(l):l,g.memoizedState=g.baseState=l,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:l},g.queue=a,a=a.dispatch=tP.bind(null,Tt,a),[g.memoizedState,a]},useRef:function(a){var l=ps();return a={current:a},l.memoizedState=a},useState:rw,useDebugValue:Lm,useDeferredValue:function(a){return ps().memoizedState=a},useTransition:function(){var a=rw(!1),l=a[0];return a=eP.bind(null,a[1]),ps().memoizedState=a,[l,a]},useMutableSource:function(){},useSyncExternalStore:function(a,l,d){var g=Tt,v=ps();if(_t){if(d===void 0)throw Error(t(407));d=d()}else{if(d=l(),rn===null)throw Error(t(349));(Ho&30)!==0||J_(g,l,d)}v.memoizedState=d;var E={value:d,getSnapshot:l};return v.queue=E,iw(ew.bind(null,g,E,a),[a]),g.flags|=2048,Wc(9,Z_.bind(null,g,E,d,l),void 0,null),d},useId:function(){var a=ps(),l=rn.identifierPrefix;if(_t){var d=Qs,g=Ys;d=(g&~(1<<32-Ln(g)-1)).toString(32)+d,l=":"+l+"R"+d,d=$c++,0<d&&(l+="H"+d.toString(32)),l+=":"}else d=Zk++,l=":"+l+"r"+d.toString(32)+":";return a.memoizedState=l},unstable_isNewReconciler:!1},sP={readContext:wr,useCallback:uw,useContext:wr,useEffect:Dm,useImperativeHandle:cw,useInsertionEffect:ow,useLayoutEffect:aw,useMemo:hw,useReducer:Pm,useRef:sw,useState:function(){return Pm(Hc)},useDebugValue:Lm,useDeferredValue:function(a){var l=Er();return dw(l,Xt.memoizedState,a)},useTransition:function(){var a=Pm(Hc)[0],l=Er().memoizedState;return[a,l]},useMutableSource:Y_,useSyncExternalStore:Q_,useId:fw,unstable_isNewReconciler:!1},iP={readContext:wr,useCallback:uw,useContext:wr,useEffect:Dm,useImperativeHandle:cw,useInsertionEffect:ow,useLayoutEffect:aw,useMemo:hw,useReducer:Rm,useRef:sw,useState:function(){return Rm(Hc)},useDebugValue:Lm,useDeferredValue:function(a){var l=Er();return Xt===null?l.memoizedState=a:dw(l,Xt.memoizedState,a)},useTransition:function(){var a=Rm(Hc)[0],l=Er().memoizedState;return[a,l]},useMutableSource:Y_,useSyncExternalStore:Q_,useId:fw,unstable_isNewReconciler:!1};function Hr(a,l){if(a&&a.defaultProps){l=ee({},l),a=a.defaultProps;for(var d in a)l[d]===void 0&&(l[d]=a[d]);return l}return l}function Mm(a,l,d,g){l=a.memoizedState,d=d(g,l),d=d==null?l:ee({},l,d),a.memoizedState=d,a.lanes===0&&(a.updateQueue.baseState=d)}var gd={isMounted:function(a){return(a=a._reactInternals)?Nr(a)===a:!1},enqueueSetState:function(a,l,d){a=a._reactInternals;var g=On(),v=Ui(a),E=Zs(g,v);E.payload=l,d!=null&&(E.callback=d),l=Fi(a,E,v),l!==null&&(qr(l,a,v,g),ld(l,a,v))},enqueueReplaceState:function(a,l,d){a=a._reactInternals;var g=On(),v=Ui(a),E=Zs(g,v);E.tag=1,E.payload=l,d!=null&&(E.callback=d),l=Fi(a,E,v),l!==null&&(qr(l,a,v,g),ld(l,a,v))},enqueueForceUpdate:function(a,l){a=a._reactInternals;var d=On(),g=Ui(a),v=Zs(d,g);v.tag=2,l!=null&&(v.callback=l),l=Fi(a,v,g),l!==null&&(qr(l,a,g,d),ld(l,a,g))}};function yw(a,l,d,g,v,E,I){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(g,E,I):l.prototype&&l.prototype.isPureReactComponent?!Rc(d,g)||!Rc(v,E):!0}function vw(a,l,d){var g=!1,v=Mi,E=l.contextType;return typeof E=="object"&&E!==null?E=wr(E):(v=Wn(l)?jo:wn.current,g=l.contextTypes,E=(g=g!=null)?rl(a,v):Mi),l=new l(d,E),a.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,l.updater=gd,a.stateNode=l,l._reactInternals=a,g&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=v,a.__reactInternalMemoizedMaskedChildContext=E),l}function _w(a,l,d,g){a=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(d,g),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(d,g),l.state!==a&&gd.enqueueReplaceState(l,l.state,null)}function Nm(a,l,d,g){var v=a.stateNode;v.props=d,v.state=a.memoizedState,v.refs={},Em(a);var E=l.contextType;typeof E=="object"&&E!==null?v.context=wr(E):(E=Wn(l)?jo:wn.current,v.context=rl(a,E)),v.state=a.memoizedState,E=l.getDerivedStateFromProps,typeof E=="function"&&(Mm(a,l,E,d),v.state=a.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(l=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),l!==v.state&&gd.enqueueReplaceState(v,v.state,null),cd(a,d,v,g),v.state=a.memoizedState),typeof v.componentDidMount=="function"&&(a.flags|=4194308)}function hl(a,l){try{var d="",g=l;do d+=Te(g),g=g.return;while(g);var v=d}catch(E){v=`
Error generating stack: `+E.message+`
`+E.stack}return{value:a,source:l,stack:v,digest:null}}function Om(a,l,d){return{value:a,source:null,stack:d??null,digest:l??null}}function Fm(a,l){try{console.error(l.value)}catch(d){setTimeout(function(){throw d})}}var oP=typeof WeakMap=="function"?WeakMap:Map;function ww(a,l,d){d=Zs(-1,d),d.tag=3,d.payload={element:null};var g=l.value;return d.callback=function(){bd||(bd=!0,Jm=g),Fm(a,l)},d}function Ew(a,l,d){d=Zs(-1,d),d.tag=3;var g=a.type.getDerivedStateFromError;if(typeof g=="function"){var v=l.value;d.payload=function(){return g(v)},d.callback=function(){Fm(a,l)}}var E=a.stateNode;return E!==null&&typeof E.componentDidCatch=="function"&&(d.callback=function(){Fm(a,l),typeof g!="function"&&(ji===null?ji=new Set([this]):ji.add(this));var I=l.stack;this.componentDidCatch(l.value,{componentStack:I!==null?I:""})}),d}function Aw(a,l,d){var g=a.pingCache;if(g===null){g=a.pingCache=new oP;var v=new Set;g.set(l,v)}else v=g.get(l),v===void 0&&(v=new Set,g.set(l,v));v.has(d)||(v.add(d),a=wP.bind(null,a,l,d),l.then(a,a))}function bw(a){do{var l;if((l=a.tag===13)&&(l=a.memoizedState,l=l!==null?l.dehydrated!==null:!0),l)return a;a=a.return}while(a!==null);return null}function Tw(a,l,d,g,v){return(a.mode&1)===0?(a===l?a.flags|=65536:(a.flags|=128,d.flags|=131072,d.flags&=-52805,d.tag===1&&(d.alternate===null?d.tag=17:(l=Zs(-1,1),l.tag=2,Fi(d,l,1))),d.lanes|=1),a):(a.flags|=65536,a.lanes=v,a)}var aP=B.ReactCurrentOwner,Gn=!1;function Nn(a,l,d,g){l.child=a===null?H_(l,null,d,g):al(l,a.child,d,g)}function Sw(a,l,d,g,v){d=d.render;var E=l.ref;return cl(l,v),g=Im(a,l,d,g,E,v),d=km(),a!==null&&!Gn?(l.updateQueue=a.updateQueue,l.flags&=-2053,a.lanes&=~v,ei(a,l,v)):(_t&&d&&hm(l),l.flags|=1,Nn(a,l,g,v),l.child)}function xw(a,l,d,g,v){if(a===null){var E=d.type;return typeof E=="function"&&!ig(E)&&E.defaultProps===void 0&&d.compare===null&&d.defaultProps===void 0?(l.tag=15,l.type=E,Cw(a,l,E,g,v)):(a=kd(d.type,null,g,l,l.mode,v),a.ref=l.ref,a.return=l,l.child=a)}if(E=a.child,(a.lanes&v)===0){var I=E.memoizedProps;if(d=d.compare,d=d!==null?d:Rc,d(I,g)&&a.ref===l.ref)return ei(a,l,v)}return l.flags|=1,a=$i(E,g),a.ref=l.ref,a.return=l,l.child=a}function Cw(a,l,d,g,v){if(a!==null){var E=a.memoizedProps;if(Rc(E,g)&&a.ref===l.ref)if(Gn=!1,l.pendingProps=g=E,(a.lanes&v)!==0)(a.flags&131072)!==0&&(Gn=!0);else return l.lanes=a.lanes,ei(a,l,v)}return Vm(a,l,d,g,v)}function Iw(a,l,d){var g=l.pendingProps,v=g.children,E=a!==null?a.memoizedState:null;if(g.mode==="hidden")if((l.mode&1)===0)l.memoizedState={baseLanes:0,cachePool:null,transitions:null},ut(fl,or),or|=d;else{if((d&1073741824)===0)return a=E!==null?E.baseLanes|d:d,l.lanes=l.childLanes=1073741824,l.memoizedState={baseLanes:a,cachePool:null,transitions:null},l.updateQueue=null,ut(fl,or),or|=a,null;l.memoizedState={baseLanes:0,cachePool:null,transitions:null},g=E!==null?E.baseLanes:d,ut(fl,or),or|=g}else E!==null?(g=E.baseLanes|d,l.memoizedState=null):g=d,ut(fl,or),or|=g;return Nn(a,l,v,d),l.child}function kw(a,l){var d=l.ref;(a===null&&d!==null||a!==null&&a.ref!==d)&&(l.flags|=512,l.flags|=2097152)}function Vm(a,l,d,g,v){var E=Wn(d)?jo:wn.current;return E=rl(l,E),cl(l,v),d=Im(a,l,d,g,E,v),g=km(),a!==null&&!Gn?(l.updateQueue=a.updateQueue,l.flags&=-2053,a.lanes&=~v,ei(a,l,v)):(_t&&g&&hm(l),l.flags|=1,Nn(a,l,d,v),l.child)}function Pw(a,l,d,g,v){if(Wn(d)){var E=!0;ed(l)}else E=!1;if(cl(l,v),l.stateNode===null)vd(a,l),vw(l,d,g),Nm(l,d,g,v),g=!0;else if(a===null){var I=l.stateNode,U=l.memoizedProps;I.props=U;var H=I.context,Q=d.contextType;typeof Q=="object"&&Q!==null?Q=wr(Q):(Q=Wn(d)?jo:wn.current,Q=rl(l,Q));var oe=d.getDerivedStateFromProps,le=typeof oe=="function"||typeof I.getSnapshotBeforeUpdate=="function";le||typeof I.UNSAFE_componentWillReceiveProps!="function"&&typeof I.componentWillReceiveProps!="function"||(U!==g||H!==Q)&&_w(l,I,g,Q),Oi=!1;var se=l.memoizedState;I.state=se,cd(l,g,I,v),H=l.memoizedState,U!==g||se!==H||Hn.current||Oi?(typeof oe=="function"&&(Mm(l,d,oe,g),H=l.memoizedState),(U=Oi||yw(l,d,U,g,se,H,Q))?(le||typeof I.UNSAFE_componentWillMount!="function"&&typeof I.componentWillMount!="function"||(typeof I.componentWillMount=="function"&&I.componentWillMount(),typeof I.UNSAFE_componentWillMount=="function"&&I.UNSAFE_componentWillMount()),typeof I.componentDidMount=="function"&&(l.flags|=4194308)):(typeof I.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=g,l.memoizedState=H),I.props=g,I.state=H,I.context=Q,g=U):(typeof I.componentDidMount=="function"&&(l.flags|=4194308),g=!1)}else{I=l.stateNode,G_(a,l),U=l.memoizedProps,Q=l.type===l.elementType?U:Hr(l.type,U),I.props=Q,le=l.pendingProps,se=I.context,H=d.contextType,typeof H=="object"&&H!==null?H=wr(H):(H=Wn(d)?jo:wn.current,H=rl(l,H));var fe=d.getDerivedStateFromProps;(oe=typeof fe=="function"||typeof I.getSnapshotBeforeUpdate=="function")||typeof I.UNSAFE_componentWillReceiveProps!="function"&&typeof I.componentWillReceiveProps!="function"||(U!==le||se!==H)&&_w(l,I,g,H),Oi=!1,se=l.memoizedState,I.state=se,cd(l,g,I,v);var ye=l.memoizedState;U!==le||se!==ye||Hn.current||Oi?(typeof fe=="function"&&(Mm(l,d,fe,g),ye=l.memoizedState),(Q=Oi||yw(l,d,Q,g,se,ye,H)||!1)?(oe||typeof I.UNSAFE_componentWillUpdate!="function"&&typeof I.componentWillUpdate!="function"||(typeof I.componentWillUpdate=="function"&&I.componentWillUpdate(g,ye,H),typeof I.UNSAFE_componentWillUpdate=="function"&&I.UNSAFE_componentWillUpdate(g,ye,H)),typeof I.componentDidUpdate=="function"&&(l.flags|=4),typeof I.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof I.componentDidUpdate!="function"||U===a.memoizedProps&&se===a.memoizedState||(l.flags|=4),typeof I.getSnapshotBeforeUpdate!="function"||U===a.memoizedProps&&se===a.memoizedState||(l.flags|=1024),l.memoizedProps=g,l.memoizedState=ye),I.props=g,I.state=ye,I.context=H,g=Q):(typeof I.componentDidUpdate!="function"||U===a.memoizedProps&&se===a.memoizedState||(l.flags|=4),typeof I.getSnapshotBeforeUpdate!="function"||U===a.memoizedProps&&se===a.memoizedState||(l.flags|=1024),g=!1)}return jm(a,l,d,g,E,v)}function jm(a,l,d,g,v,E){kw(a,l);var I=(l.flags&128)!==0;if(!g&&!I)return v&&N_(l,d,!1),ei(a,l,E);g=l.stateNode,aP.current=l;var U=I&&typeof d.getDerivedStateFromError!="function"?null:g.render();return l.flags|=1,a!==null&&I?(l.child=al(l,a.child,null,E),l.child=al(l,null,U,E)):Nn(a,l,U,E),l.memoizedState=g.state,v&&N_(l,d,!0),l.child}function Rw(a){var l=a.stateNode;l.pendingContext?L_(a,l.pendingContext,l.pendingContext!==l.context):l.context&&L_(a,l.context,!1),Am(a,l.containerInfo)}function Dw(a,l,d,g,v){return ol(),mm(v),l.flags|=256,Nn(a,l,d,g),l.child}var Bm={dehydrated:null,treeContext:null,retryLane:0};function Um(a){return{baseLanes:a,cachePool:null,transitions:null}}function Lw(a,l,d){var g=l.pendingProps,v=bt.current,E=!1,I=(l.flags&128)!==0,U;if((U=I)||(U=a!==null&&a.memoizedState===null?!1:(v&2)!==0),U?(E=!0,l.flags&=-129):(a===null||a.memoizedState!==null)&&(v|=1),ut(bt,v&1),a===null)return pm(l),a=l.memoizedState,a!==null&&(a=a.dehydrated,a!==null)?((l.mode&1)===0?l.lanes=1:a.data==="$!"?l.lanes=8:l.lanes=1073741824,null):(I=g.children,a=g.fallback,E?(g=l.mode,E=l.child,I={mode:"hidden",children:I},(g&1)===0&&E!==null?(E.childLanes=0,E.pendingProps=I):E=Pd(I,g,0,null),a=Xo(a,g,d,null),E.return=l,a.return=l,E.sibling=a,l.child=E,l.child.memoizedState=Um(d),l.memoizedState=Bm,a):zm(l,I));if(v=a.memoizedState,v!==null&&(U=v.dehydrated,U!==null))return lP(a,l,I,g,U,v,d);if(E){E=g.fallback,I=l.mode,v=a.child,U=v.sibling;var H={mode:"hidden",children:g.children};return(I&1)===0&&l.child!==v?(g=l.child,g.childLanes=0,g.pendingProps=H,l.deletions=null):(g=$i(v,H),g.subtreeFlags=v.subtreeFlags&14680064),U!==null?E=$i(U,E):(E=Xo(E,I,d,null),E.flags|=2),E.return=l,g.return=l,g.sibling=E,l.child=g,g=E,E=l.child,I=a.child.memoizedState,I=I===null?Um(d):{baseLanes:I.baseLanes|d,cachePool:null,transitions:I.transitions},E.memoizedState=I,E.childLanes=a.childLanes&~d,l.memoizedState=Bm,g}return E=a.child,a=E.sibling,g=$i(E,{mode:"visible",children:g.children}),(l.mode&1)===0&&(g.lanes=d),g.return=l,g.sibling=null,a!==null&&(d=l.deletions,d===null?(l.deletions=[a],l.flags|=16):d.push(a)),l.child=g,l.memoizedState=null,g}function zm(a,l){return l=Pd({mode:"visible",children:l},a.mode,0,null),l.return=a,a.child=l}function yd(a,l,d,g){return g!==null&&mm(g),al(l,a.child,null,d),a=zm(l,l.pendingProps.children),a.flags|=2,l.memoizedState=null,a}function lP(a,l,d,g,v,E,I){if(d)return l.flags&256?(l.flags&=-257,g=Om(Error(t(422))),yd(a,l,I,g)):l.memoizedState!==null?(l.child=a.child,l.flags|=128,null):(E=g.fallback,v=l.mode,g=Pd({mode:"visible",children:g.children},v,0,null),E=Xo(E,v,I,null),E.flags|=2,g.return=l,E.return=l,g.sibling=E,l.child=g,(l.mode&1)!==0&&al(l,a.child,null,I),l.child.memoizedState=Um(I),l.memoizedState=Bm,E);if((l.mode&1)===0)return yd(a,l,I,null);if(v.data==="$!"){if(g=v.nextSibling&&v.nextSibling.dataset,g)var U=g.dgst;return g=U,E=Error(t(419)),g=Om(E,g,void 0),yd(a,l,I,g)}if(U=(I&a.childLanes)!==0,Gn||U){if(g=rn,g!==null){switch(I&-I){case 4:v=2;break;case 16:v=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:v=32;break;case 536870912:v=268435456;break;default:v=0}v=(v&(g.suspendedLanes|I))!==0?0:v,v!==0&&v!==E.retryLane&&(E.retryLane=v,Js(a,v),qr(g,a,v,-1))}return sg(),g=Om(Error(t(421))),yd(a,l,I,g)}return v.data==="$?"?(l.flags|=128,l.child=a.child,l=EP.bind(null,a),v._reactRetry=l,null):(a=E.treeContext,ir=Di(v.nextSibling),sr=l,_t=!0,$r=null,a!==null&&(vr[_r++]=Ys,vr[_r++]=Qs,vr[_r++]=Bo,Ys=a.id,Qs=a.overflow,Bo=l),l=zm(l,g.children),l.flags|=4096,l)}function Mw(a,l,d){a.lanes|=l;var g=a.alternate;g!==null&&(g.lanes|=l),_m(a.return,l,d)}function $m(a,l,d,g,v){var E=a.memoizedState;E===null?a.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:g,tail:d,tailMode:v}:(E.isBackwards=l,E.rendering=null,E.renderingStartTime=0,E.last=g,E.tail=d,E.tailMode=v)}function Nw(a,l,d){var g=l.pendingProps,v=g.revealOrder,E=g.tail;if(Nn(a,l,g.children,d),g=bt.current,(g&2)!==0)g=g&1|2,l.flags|=128;else{if(a!==null&&(a.flags&128)!==0)e:for(a=l.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&Mw(a,d,l);else if(a.tag===19)Mw(a,d,l);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===l)break e;for(;a.sibling===null;){if(a.return===null||a.return===l)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}g&=1}if(ut(bt,g),(l.mode&1)===0)l.memoizedState=null;else switch(v){case"forwards":for(d=l.child,v=null;d!==null;)a=d.alternate,a!==null&&ud(a)===null&&(v=d),d=d.sibling;d=v,d===null?(v=l.child,l.child=null):(v=d.sibling,d.sibling=null),$m(l,!1,v,d,E);break;case"backwards":for(d=null,v=l.child,l.child=null;v!==null;){if(a=v.alternate,a!==null&&ud(a)===null){l.child=v;break}a=v.sibling,v.sibling=d,d=v,v=a}$m(l,!0,d,null,E);break;case"together":$m(l,!1,null,null,void 0);break;default:l.memoizedState=null}return l.child}function vd(a,l){(l.mode&1)===0&&a!==null&&(a.alternate=null,l.alternate=null,l.flags|=2)}function ei(a,l,d){if(a!==null&&(l.dependencies=a.dependencies),Wo|=l.lanes,(d&l.childLanes)===0)return null;if(a!==null&&l.child!==a.child)throw Error(t(153));if(l.child!==null){for(a=l.child,d=$i(a,a.pendingProps),l.child=d,d.return=l;a.sibling!==null;)a=a.sibling,d=d.sibling=$i(a,a.pendingProps),d.return=l;d.sibling=null}return l.child}function cP(a,l,d){switch(l.tag){case 3:Rw(l),ol();break;case 5:X_(l);break;case 1:Wn(l.type)&&ed(l);break;case 4:Am(l,l.stateNode.containerInfo);break;case 10:var g=l.type._context,v=l.memoizedProps.value;ut(od,g._currentValue),g._currentValue=v;break;case 13:if(g=l.memoizedState,g!==null)return g.dehydrated!==null?(ut(bt,bt.current&1),l.flags|=128,null):(d&l.child.childLanes)!==0?Lw(a,l,d):(ut(bt,bt.current&1),a=ei(a,l,d),a!==null?a.sibling:null);ut(bt,bt.current&1);break;case 19:if(g=(d&l.childLanes)!==0,(a.flags&128)!==0){if(g)return Nw(a,l,d);l.flags|=128}if(v=l.memoizedState,v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),ut(bt,bt.current),g)break;return null;case 22:case 23:return l.lanes=0,Iw(a,l,d)}return ei(a,l,d)}var Ow,Hm,Fw,Vw;Ow=function(a,l){for(var d=l.child;d!==null;){if(d.tag===5||d.tag===6)a.appendChild(d.stateNode);else if(d.tag!==4&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===l)break;for(;d.sibling===null;){if(d.return===null||d.return===l)return;d=d.return}d.sibling.return=d.return,d=d.sibling}},Hm=function(){},Fw=function(a,l,d,g){var v=a.memoizedProps;if(v!==g){a=l.stateNode,$o(fs.current);var E=null;switch(d){case"input":v=et(a,v),g=et(a,g),E=[];break;case"select":v=ee({},v,{value:void 0}),g=ee({},g,{value:void 0}),E=[];break;case"textarea":v=Eo(a,v),g=Eo(a,g),E=[];break;default:typeof v.onClick!="function"&&typeof g.onClick=="function"&&(a.onclick=Qh)}dc(d,g);var I;d=null;for(Q in v)if(!g.hasOwnProperty(Q)&&v.hasOwnProperty(Q)&&v[Q]!=null)if(Q==="style"){var U=v[Q];for(I in U)U.hasOwnProperty(I)&&(d||(d={}),d[I]="")}else Q!=="dangerouslySetInnerHTML"&&Q!=="children"&&Q!=="suppressContentEditableWarning"&&Q!=="suppressHydrationWarning"&&Q!=="autoFocus"&&(s.hasOwnProperty(Q)?E||(E=[]):(E=E||[]).push(Q,null));for(Q in g){var H=g[Q];if(U=v?.[Q],g.hasOwnProperty(Q)&&H!==U&&(H!=null||U!=null))if(Q==="style")if(U){for(I in U)!U.hasOwnProperty(I)||H&&H.hasOwnProperty(I)||(d||(d={}),d[I]="");for(I in H)H.hasOwnProperty(I)&&U[I]!==H[I]&&(d||(d={}),d[I]=H[I])}else d||(E||(E=[]),E.push(Q,d)),d=H;else Q==="dangerouslySetInnerHTML"?(H=H?H.__html:void 0,U=U?U.__html:void 0,H!=null&&U!==H&&(E=E||[]).push(Q,H)):Q==="children"?typeof H!="string"&&typeof H!="number"||(E=E||[]).push(Q,""+H):Q!=="suppressContentEditableWarning"&&Q!=="suppressHydrationWarning"&&(s.hasOwnProperty(Q)?(H!=null&&Q==="onScroll"&&dt("scroll",a),E||U===H||(E=[])):(E=E||[]).push(Q,H))}d&&(E=E||[]).push("style",d);var Q=E;(l.updateQueue=Q)&&(l.flags|=4)}},Vw=function(a,l,d,g){d!==g&&(l.flags|=4)};function Gc(a,l){if(!_t)switch(a.tailMode){case"hidden":l=a.tail;for(var d=null;l!==null;)l.alternate!==null&&(d=l),l=l.sibling;d===null?a.tail=null:d.sibling=null;break;case"collapsed":d=a.tail;for(var g=null;d!==null;)d.alternate!==null&&(g=d),d=d.sibling;g===null?l||a.tail===null?a.tail=null:a.tail.sibling=null:g.sibling=null}}function An(a){var l=a.alternate!==null&&a.alternate.child===a.child,d=0,g=0;if(l)for(var v=a.child;v!==null;)d|=v.lanes|v.childLanes,g|=v.subtreeFlags&14680064,g|=v.flags&14680064,v.return=a,v=v.sibling;else for(v=a.child;v!==null;)d|=v.lanes|v.childLanes,g|=v.subtreeFlags,g|=v.flags,v.return=a,v=v.sibling;return a.subtreeFlags|=g,a.childLanes=d,l}function uP(a,l,d){var g=l.pendingProps;switch(dm(l),l.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return An(l),null;case 1:return Wn(l.type)&&Zh(),An(l),null;case 3:return g=l.stateNode,ul(),ft(Hn),ft(wn),Sm(),g.pendingContext&&(g.context=g.pendingContext,g.pendingContext=null),(a===null||a.child===null)&&(sd(l)?l.flags|=4:a===null||a.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,$r!==null&&(tg($r),$r=null))),Hm(a,l),An(l),null;case 5:bm(l);var v=$o(Uc.current);if(d=l.type,a!==null&&l.stateNode!=null)Fw(a,l,d,g,v),a.ref!==l.ref&&(l.flags|=512,l.flags|=2097152);else{if(!g){if(l.stateNode===null)throw Error(t(166));return An(l),null}if(a=$o(fs.current),sd(l)){g=l.stateNode,d=l.type;var E=l.memoizedProps;switch(g[ds]=l,g[Oc]=E,a=(l.mode&1)!==0,d){case"dialog":dt("cancel",g),dt("close",g);break;case"iframe":case"object":case"embed":dt("load",g);break;case"video":case"audio":for(v=0;v<Lc.length;v++)dt(Lc[v],g);break;case"source":dt("error",g);break;case"img":case"image":case"link":dt("error",g),dt("load",g);break;case"details":dt("toggle",g);break;case"input":lt(g,E),dt("invalid",g);break;case"select":g._wrapperState={wasMultiple:!!E.multiple},dt("invalid",g);break;case"textarea":wi(g,E),dt("invalid",g)}dc(d,E),v=null;for(var I in E)if(E.hasOwnProperty(I)){var U=E[I];I==="children"?typeof U=="string"?g.textContent!==U&&(E.suppressHydrationWarning!==!0&&Yh(g.textContent,U,a),v=["children",U]):typeof U=="number"&&g.textContent!==""+U&&(E.suppressHydrationWarning!==!0&&Yh(g.textContent,U,a),v=["children",""+U]):s.hasOwnProperty(I)&&U!=null&&I==="onScroll"&&dt("scroll",g)}switch(d){case"input":qt(g),rs(g,E,!0);break;case"textarea":qt(g),Ao(g);break;case"select":case"option":break;default:typeof E.onClick=="function"&&(g.onclick=Qh)}g=v,l.updateQueue=g,g!==null&&(l.flags|=4)}else{I=v.nodeType===9?v:v.ownerDocument,a==="http://www.w3.org/1999/xhtml"&&(a=Rt(d)),a==="http://www.w3.org/1999/xhtml"?d==="script"?(a=I.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild)):typeof g.is=="string"?a=I.createElement(d,{is:g.is}):(a=I.createElement(d),d==="select"&&(I=a,g.multiple?I.multiple=!0:g.size&&(I.size=g.size))):a=I.createElementNS(a,d),a[ds]=l,a[Oc]=g,Ow(a,l,!1,!1),l.stateNode=a;e:{switch(I=fc(d,g),d){case"dialog":dt("cancel",a),dt("close",a),v=g;break;case"iframe":case"object":case"embed":dt("load",a),v=g;break;case"video":case"audio":for(v=0;v<Lc.length;v++)dt(Lc[v],a);v=g;break;case"source":dt("error",a),v=g;break;case"img":case"image":case"link":dt("error",a),dt("load",a),v=g;break;case"details":dt("toggle",a),v=g;break;case"input":lt(a,g),v=et(a,g),dt("invalid",a);break;case"option":v=g;break;case"select":a._wrapperState={wasMultiple:!!g.multiple},v=ee({},g,{value:void 0}),dt("invalid",a);break;case"textarea":wi(a,g),v=Eo(a,g),dt("invalid",a);break;default:v=g}dc(d,v),U=v;for(E in U)if(U.hasOwnProperty(E)){var H=U[E];E==="style"?uc(a,H):E==="dangerouslySetInnerHTML"?(H=H?H.__html:void 0,H!=null&&Un(a,H)):E==="children"?typeof H=="string"?(d!=="textarea"||H!=="")&&fr(a,H):typeof H=="number"&&fr(a,""+H):E!=="suppressContentEditableWarning"&&E!=="suppressHydrationWarning"&&E!=="autoFocus"&&(s.hasOwnProperty(E)?H!=null&&E==="onScroll"&&dt("scroll",a):H!=null&&R(a,E,H,I))}switch(d){case"input":qt(a),rs(a,g,!1);break;case"textarea":qt(a),Ao(a);break;case"option":g.value!=null&&a.setAttribute("value",""+Be(g.value));break;case"select":a.multiple=!!g.multiple,E=g.value,E!=null?Bn(a,!!g.multiple,E,!1):g.defaultValue!=null&&Bn(a,!!g.multiple,g.defaultValue,!0);break;default:typeof v.onClick=="function"&&(a.onclick=Qh)}switch(d){case"button":case"input":case"select":case"textarea":g=!!g.autoFocus;break e;case"img":g=!0;break e;default:g=!1}}g&&(l.flags|=4)}l.ref!==null&&(l.flags|=512,l.flags|=2097152)}return An(l),null;case 6:if(a&&l.stateNode!=null)Vw(a,l,a.memoizedProps,g);else{if(typeof g!="string"&&l.stateNode===null)throw Error(t(166));if(d=$o(Uc.current),$o(fs.current),sd(l)){if(g=l.stateNode,d=l.memoizedProps,g[ds]=l,(E=g.nodeValue!==d)&&(a=sr,a!==null))switch(a.tag){case 3:Yh(g.nodeValue,d,(a.mode&1)!==0);break;case 5:a.memoizedProps.suppressHydrationWarning!==!0&&Yh(g.nodeValue,d,(a.mode&1)!==0)}E&&(l.flags|=4)}else g=(d.nodeType===9?d:d.ownerDocument).createTextNode(g),g[ds]=l,l.stateNode=g}return An(l),null;case 13:if(ft(bt),g=l.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(_t&&ir!==null&&(l.mode&1)!==0&&(l.flags&128)===0)U_(),ol(),l.flags|=98560,E=!1;else if(E=sd(l),g!==null&&g.dehydrated!==null){if(a===null){if(!E)throw Error(t(318));if(E=l.memoizedState,E=E!==null?E.dehydrated:null,!E)throw Error(t(317));E[ds]=l}else ol(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;An(l),E=!1}else $r!==null&&(tg($r),$r=null),E=!0;if(!E)return l.flags&65536?l:null}return(l.flags&128)!==0?(l.lanes=d,l):(g=g!==null,g!==(a!==null&&a.memoizedState!==null)&&g&&(l.child.flags|=8192,(l.mode&1)!==0&&(a===null||(bt.current&1)!==0?Yt===0&&(Yt=3):sg())),l.updateQueue!==null&&(l.flags|=4),An(l),null);case 4:return ul(),Hm(a,l),a===null&&Mc(l.stateNode.containerInfo),An(l),null;case 10:return vm(l.type._context),An(l),null;case 17:return Wn(l.type)&&Zh(),An(l),null;case 19:if(ft(bt),E=l.memoizedState,E===null)return An(l),null;if(g=(l.flags&128)!==0,I=E.rendering,I===null)if(g)Gc(E,!1);else{if(Yt!==0||a!==null&&(a.flags&128)!==0)for(a=l.child;a!==null;){if(I=ud(a),I!==null){for(l.flags|=128,Gc(E,!1),g=I.updateQueue,g!==null&&(l.updateQueue=g,l.flags|=4),l.subtreeFlags=0,g=d,d=l.child;d!==null;)E=d,a=g,E.flags&=14680066,I=E.alternate,I===null?(E.childLanes=0,E.lanes=a,E.child=null,E.subtreeFlags=0,E.memoizedProps=null,E.memoizedState=null,E.updateQueue=null,E.dependencies=null,E.stateNode=null):(E.childLanes=I.childLanes,E.lanes=I.lanes,E.child=I.child,E.subtreeFlags=0,E.deletions=null,E.memoizedProps=I.memoizedProps,E.memoizedState=I.memoizedState,E.updateQueue=I.updateQueue,E.type=I.type,a=I.dependencies,E.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),d=d.sibling;return ut(bt,bt.current&1|2),l.child}a=a.sibling}E.tail!==null&&ct()>pl&&(l.flags|=128,g=!0,Gc(E,!1),l.lanes=4194304)}else{if(!g)if(a=ud(I),a!==null){if(l.flags|=128,g=!0,d=a.updateQueue,d!==null&&(l.updateQueue=d,l.flags|=4),Gc(E,!0),E.tail===null&&E.tailMode==="hidden"&&!I.alternate&&!_t)return An(l),null}else 2*ct()-E.renderingStartTime>pl&&d!==1073741824&&(l.flags|=128,g=!0,Gc(E,!1),l.lanes=4194304);E.isBackwards?(I.sibling=l.child,l.child=I):(d=E.last,d!==null?d.sibling=I:l.child=I,E.last=I)}return E.tail!==null?(l=E.tail,E.rendering=l,E.tail=l.sibling,E.renderingStartTime=ct(),l.sibling=null,d=bt.current,ut(bt,g?d&1|2:d&1),l):(An(l),null);case 22:case 23:return rg(),g=l.memoizedState!==null,a!==null&&a.memoizedState!==null!==g&&(l.flags|=8192),g&&(l.mode&1)!==0?(or&1073741824)!==0&&(An(l),l.subtreeFlags&6&&(l.flags|=8192)):An(l),null;case 24:return null;case 25:return null}throw Error(t(156,l.tag))}function hP(a,l){switch(dm(l),l.tag){case 1:return Wn(l.type)&&Zh(),a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 3:return ul(),ft(Hn),ft(wn),Sm(),a=l.flags,(a&65536)!==0&&(a&128)===0?(l.flags=a&-65537|128,l):null;case 5:return bm(l),null;case 13:if(ft(bt),a=l.memoizedState,a!==null&&a.dehydrated!==null){if(l.alternate===null)throw Error(t(340));ol()}return a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 19:return ft(bt),null;case 4:return ul(),null;case 10:return vm(l.type._context),null;case 22:case 23:return rg(),null;case 24:return null;default:return null}}var _d=!1,bn=!1,dP=typeof WeakSet=="function"?WeakSet:Set,me=null;function dl(a,l){var d=a.ref;if(d!==null)if(typeof d=="function")try{d(null)}catch(g){kt(a,l,g)}else d.current=null}function Wm(a,l,d){try{d()}catch(g){kt(a,l,g)}}var jw=!1;function fP(a,l){if(rm=ki,a=y_(),Xp(a)){if("selectionStart"in a)var d={start:a.selectionStart,end:a.selectionEnd};else e:{d=(d=a.ownerDocument)&&d.defaultView||window;var g=d.getSelection&&d.getSelection();if(g&&g.rangeCount!==0){d=g.anchorNode;var v=g.anchorOffset,E=g.focusNode;g=g.focusOffset;try{d.nodeType,E.nodeType}catch{d=null;break e}var I=0,U=-1,H=-1,Q=0,oe=0,le=a,se=null;t:for(;;){for(var fe;le!==d||v!==0&&le.nodeType!==3||(U=I+v),le!==E||g!==0&&le.nodeType!==3||(H=I+g),le.nodeType===3&&(I+=le.nodeValue.length),(fe=le.firstChild)!==null;)se=le,le=fe;for(;;){if(le===a)break t;if(se===d&&++Q===v&&(U=I),se===E&&++oe===g&&(H=I),(fe=le.nextSibling)!==null)break;le=se,se=le.parentNode}le=fe}d=U===-1||H===-1?null:{start:U,end:H}}else d=null}d=d||{start:0,end:0}}else d=null;for(sm={focusedElem:a,selectionRange:d},ki=!1,me=l;me!==null;)if(l=me,a=l.child,(l.subtreeFlags&1028)!==0&&a!==null)a.return=l,me=a;else for(;me!==null;){l=me;try{var ye=l.alternate;if((l.flags&1024)!==0)switch(l.tag){case 0:case 11:case 15:break;case 1:if(ye!==null){var ve=ye.memoizedProps,Lt=ye.memoizedState,K=l.stateNode,G=K.getSnapshotBeforeUpdate(l.elementType===l.type?ve:Hr(l.type,ve),Lt);K.__reactInternalSnapshotBeforeUpdate=G}break;case 3:var X=l.stateNode.containerInfo;X.nodeType===1?X.textContent="":X.nodeType===9&&X.documentElement&&X.removeChild(X.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(ce){kt(l,l.return,ce)}if(a=l.sibling,a!==null){a.return=l.return,me=a;break}me=l.return}return ye=jw,jw=!1,ye}function qc(a,l,d){var g=l.updateQueue;if(g=g!==null?g.lastEffect:null,g!==null){var v=g=g.next;do{if((v.tag&a)===a){var E=v.destroy;v.destroy=void 0,E!==void 0&&Wm(l,d,E)}v=v.next}while(v!==g)}}function wd(a,l){if(l=l.updateQueue,l=l!==null?l.lastEffect:null,l!==null){var d=l=l.next;do{if((d.tag&a)===a){var g=d.create;d.destroy=g()}d=d.next}while(d!==l)}}function Gm(a){var l=a.ref;if(l!==null){var d=a.stateNode;switch(a.tag){case 5:a=d;break;default:a=d}typeof l=="function"?l(a):l.current=a}}function Bw(a){var l=a.alternate;l!==null&&(a.alternate=null,Bw(l)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(l=a.stateNode,l!==null&&(delete l[ds],delete l[Oc],delete l[lm],delete l[Xk],delete l[Yk])),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}function Uw(a){return a.tag===5||a.tag===3||a.tag===4}function zw(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||Uw(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function qm(a,l,d){var g=a.tag;if(g===5||g===6)a=a.stateNode,l?d.nodeType===8?d.parentNode.insertBefore(a,l):d.insertBefore(a,l):(d.nodeType===8?(l=d.parentNode,l.insertBefore(a,d)):(l=d,l.appendChild(a)),d=d._reactRootContainer,d!=null||l.onclick!==null||(l.onclick=Qh));else if(g!==4&&(a=a.child,a!==null))for(qm(a,l,d),a=a.sibling;a!==null;)qm(a,l,d),a=a.sibling}function Km(a,l,d){var g=a.tag;if(g===5||g===6)a=a.stateNode,l?d.insertBefore(a,l):d.appendChild(a);else if(g!==4&&(a=a.child,a!==null))for(Km(a,l,d),a=a.sibling;a!==null;)Km(a,l,d),a=a.sibling}var hn=null,Wr=!1;function Vi(a,l,d){for(d=d.child;d!==null;)$w(a,l,d),d=d.sibling}function $w(a,l,d){if(er&&typeof er.onCommitFiberUnmount=="function")try{er.onCommitFiberUnmount(Ro,d)}catch{}switch(d.tag){case 5:bn||dl(d,l);case 6:var g=hn,v=Wr;hn=null,Vi(a,l,d),hn=g,Wr=v,hn!==null&&(Wr?(a=hn,d=d.stateNode,a.nodeType===8?a.parentNode.removeChild(d):a.removeChild(d)):hn.removeChild(d.stateNode));break;case 18:hn!==null&&(Wr?(a=hn,d=d.stateNode,a.nodeType===8?am(a.parentNode,d):a.nodeType===1&&am(a,d),Br(a)):am(hn,d.stateNode));break;case 4:g=hn,v=Wr,hn=d.stateNode.containerInfo,Wr=!0,Vi(a,l,d),hn=g,Wr=v;break;case 0:case 11:case 14:case 15:if(!bn&&(g=d.updateQueue,g!==null&&(g=g.lastEffect,g!==null))){v=g=g.next;do{var E=v,I=E.destroy;E=E.tag,I!==void 0&&((E&2)!==0||(E&4)!==0)&&Wm(d,l,I),v=v.next}while(v!==g)}Vi(a,l,d);break;case 1:if(!bn&&(dl(d,l),g=d.stateNode,typeof g.componentWillUnmount=="function"))try{g.props=d.memoizedProps,g.state=d.memoizedState,g.componentWillUnmount()}catch(U){kt(d,l,U)}Vi(a,l,d);break;case 21:Vi(a,l,d);break;case 22:d.mode&1?(bn=(g=bn)||d.memoizedState!==null,Vi(a,l,d),bn=g):Vi(a,l,d);break;default:Vi(a,l,d)}}function Hw(a){var l=a.updateQueue;if(l!==null){a.updateQueue=null;var d=a.stateNode;d===null&&(d=a.stateNode=new dP),l.forEach(function(g){var v=AP.bind(null,a,g);d.has(g)||(d.add(g),g.then(v,v))})}}function Gr(a,l){var d=l.deletions;if(d!==null)for(var g=0;g<d.length;g++){var v=d[g];try{var E=a,I=l,U=I;e:for(;U!==null;){switch(U.tag){case 5:hn=U.stateNode,Wr=!1;break e;case 3:hn=U.stateNode.containerInfo,Wr=!0;break e;case 4:hn=U.stateNode.containerInfo,Wr=!0;break e}U=U.return}if(hn===null)throw Error(t(160));$w(E,I,v),hn=null,Wr=!1;var H=v.alternate;H!==null&&(H.return=null),v.return=null}catch(Q){kt(v,l,Q)}}if(l.subtreeFlags&12854)for(l=l.child;l!==null;)Ww(l,a),l=l.sibling}function Ww(a,l){var d=a.alternate,g=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:if(Gr(l,a),ms(a),g&4){try{qc(3,a,a.return),wd(3,a)}catch(ve){kt(a,a.return,ve)}try{qc(5,a,a.return)}catch(ve){kt(a,a.return,ve)}}break;case 1:Gr(l,a),ms(a),g&512&&d!==null&&dl(d,d.return);break;case 5:if(Gr(l,a),ms(a),g&512&&d!==null&&dl(d,d.return),a.flags&32){var v=a.stateNode;try{fr(v,"")}catch(ve){kt(a,a.return,ve)}}if(g&4&&(v=a.stateNode,v!=null)){var E=a.memoizedProps,I=d!==null?d.memoizedProps:E,U=a.type,H=a.updateQueue;if(a.updateQueue=null,H!==null)try{U==="input"&&E.type==="radio"&&E.name!=null&&yt(v,E),fc(U,I);var Q=fc(U,E);for(I=0;I<H.length;I+=2){var oe=H[I],le=H[I+1];oe==="style"?uc(v,le):oe==="dangerouslySetInnerHTML"?Un(v,le):oe==="children"?fr(v,le):R(v,oe,le,Q)}switch(U){case"input":dr(v,E);break;case"textarea":Ei(v,E);break;case"select":var se=v._wrapperState.wasMultiple;v._wrapperState.wasMultiple=!!E.multiple;var fe=E.value;fe!=null?Bn(v,!!E.multiple,fe,!1):se!==!!E.multiple&&(E.defaultValue!=null?Bn(v,!!E.multiple,E.defaultValue,!0):Bn(v,!!E.multiple,E.multiple?[]:"",!1))}v[Oc]=E}catch(ve){kt(a,a.return,ve)}}break;case 6:if(Gr(l,a),ms(a),g&4){if(a.stateNode===null)throw Error(t(162));v=a.stateNode,E=a.memoizedProps;try{v.nodeValue=E}catch(ve){kt(a,a.return,ve)}}break;case 3:if(Gr(l,a),ms(a),g&4&&d!==null&&d.memoizedState.isDehydrated)try{Br(l.containerInfo)}catch(ve){kt(a,a.return,ve)}break;case 4:Gr(l,a),ms(a);break;case 13:Gr(l,a),ms(a),v=a.child,v.flags&8192&&(E=v.memoizedState!==null,v.stateNode.isHidden=E,!E||v.alternate!==null&&v.alternate.memoizedState!==null||(Qm=ct())),g&4&&Hw(a);break;case 22:if(oe=d!==null&&d.memoizedState!==null,a.mode&1?(bn=(Q=bn)||oe,Gr(l,a),bn=Q):Gr(l,a),ms(a),g&8192){if(Q=a.memoizedState!==null,(a.stateNode.isHidden=Q)&&!oe&&(a.mode&1)!==0)for(me=a,oe=a.child;oe!==null;){for(le=me=oe;me!==null;){switch(se=me,fe=se.child,se.tag){case 0:case 11:case 14:case 15:qc(4,se,se.return);break;case 1:dl(se,se.return);var ye=se.stateNode;if(typeof ye.componentWillUnmount=="function"){g=se,d=se.return;try{l=g,ye.props=l.memoizedProps,ye.state=l.memoizedState,ye.componentWillUnmount()}catch(ve){kt(g,d,ve)}}break;case 5:dl(se,se.return);break;case 22:if(se.memoizedState!==null){Kw(le);continue}}fe!==null?(fe.return=se,me=fe):Kw(le)}oe=oe.sibling}e:for(oe=null,le=a;;){if(le.tag===5){if(oe===null){oe=le;try{v=le.stateNode,Q?(E=v.style,typeof E.setProperty=="function"?E.setProperty("display","none","important"):E.display="none"):(U=le.stateNode,H=le.memoizedProps.style,I=H!=null&&H.hasOwnProperty("display")?H.display:null,U.style.display=cc("display",I))}catch(ve){kt(a,a.return,ve)}}}else if(le.tag===6){if(oe===null)try{le.stateNode.nodeValue=Q?"":le.memoizedProps}catch(ve){kt(a,a.return,ve)}}else if((le.tag!==22&&le.tag!==23||le.memoizedState===null||le===a)&&le.child!==null){le.child.return=le,le=le.child;continue}if(le===a)break e;for(;le.sibling===null;){if(le.return===null||le.return===a)break e;oe===le&&(oe=null),le=le.return}oe===le&&(oe=null),le.sibling.return=le.return,le=le.sibling}}break;case 19:Gr(l,a),ms(a),g&4&&Hw(a);break;case 21:break;default:Gr(l,a),ms(a)}}function ms(a){var l=a.flags;if(l&2){try{e:{for(var d=a.return;d!==null;){if(Uw(d)){var g=d;break e}d=d.return}throw Error(t(160))}switch(g.tag){case 5:var v=g.stateNode;g.flags&32&&(fr(v,""),g.flags&=-33);var E=zw(a);Km(a,E,v);break;case 3:case 4:var I=g.stateNode.containerInfo,U=zw(a);qm(a,U,I);break;default:throw Error(t(161))}}catch(H){kt(a,a.return,H)}a.flags&=-3}l&4096&&(a.flags&=-4097)}function pP(a,l,d){me=a,Gw(a)}function Gw(a,l,d){for(var g=(a.mode&1)!==0;me!==null;){var v=me,E=v.child;if(v.tag===22&&g){var I=v.memoizedState!==null||_d;if(!I){var U=v.alternate,H=U!==null&&U.memoizedState!==null||bn;U=_d;var Q=bn;if(_d=I,(bn=H)&&!Q)for(me=v;me!==null;)I=me,H=I.child,I.tag===22&&I.memoizedState!==null?Xw(v):H!==null?(H.return=I,me=H):Xw(v);for(;E!==null;)me=E,Gw(E),E=E.sibling;me=v,_d=U,bn=Q}qw(a)}else(v.subtreeFlags&8772)!==0&&E!==null?(E.return=v,me=E):qw(a)}}function qw(a){for(;me!==null;){var l=me;if((l.flags&8772)!==0){var d=l.alternate;try{if((l.flags&8772)!==0)switch(l.tag){case 0:case 11:case 15:bn||wd(5,l);break;case 1:var g=l.stateNode;if(l.flags&4&&!bn)if(d===null)g.componentDidMount();else{var v=l.elementType===l.type?d.memoizedProps:Hr(l.type,d.memoizedProps);g.componentDidUpdate(v,d.memoizedState,g.__reactInternalSnapshotBeforeUpdate)}var E=l.updateQueue;E!==null&&K_(l,E,g);break;case 3:var I=l.updateQueue;if(I!==null){if(d=null,l.child!==null)switch(l.child.tag){case 5:d=l.child.stateNode;break;case 1:d=l.child.stateNode}K_(l,I,d)}break;case 5:var U=l.stateNode;if(d===null&&l.flags&4){d=U;var H=l.memoizedProps;switch(l.type){case"button":case"input":case"select":case"textarea":H.autoFocus&&d.focus();break;case"img":H.src&&(d.src=H.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(l.memoizedState===null){var Q=l.alternate;if(Q!==null){var oe=Q.memoizedState;if(oe!==null){var le=oe.dehydrated;le!==null&&Br(le)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}bn||l.flags&512&&Gm(l)}catch(se){kt(l,l.return,se)}}if(l===a){me=null;break}if(d=l.sibling,d!==null){d.return=l.return,me=d;break}me=l.return}}function Kw(a){for(;me!==null;){var l=me;if(l===a){me=null;break}var d=l.sibling;if(d!==null){d.return=l.return,me=d;break}me=l.return}}function Xw(a){for(;me!==null;){var l=me;try{switch(l.tag){case 0:case 11:case 15:var d=l.return;try{wd(4,l)}catch(H){kt(l,d,H)}break;case 1:var g=l.stateNode;if(typeof g.componentDidMount=="function"){var v=l.return;try{g.componentDidMount()}catch(H){kt(l,v,H)}}var E=l.return;try{Gm(l)}catch(H){kt(l,E,H)}break;case 5:var I=l.return;try{Gm(l)}catch(H){kt(l,I,H)}}}catch(H){kt(l,l.return,H)}if(l===a){me=null;break}var U=l.sibling;if(U!==null){U.return=l.return,me=U;break}me=l.return}}var mP=Math.ceil,Ed=B.ReactCurrentDispatcher,Xm=B.ReactCurrentOwner,Ar=B.ReactCurrentBatchConfig,Ze=0,rn=null,zt=null,dn=0,or=0,fl=Li(0),Yt=0,Kc=null,Wo=0,Ad=0,Ym=0,Xc=null,qn=null,Qm=0,pl=1/0,ti=null,bd=!1,Jm=null,ji=null,Td=!1,Bi=null,Sd=0,Yc=0,Zm=null,xd=-1,Cd=0;function On(){return(Ze&6)!==0?ct():xd!==-1?xd:xd=ct()}function Ui(a){return(a.mode&1)===0?1:(Ze&2)!==0&&dn!==0?dn&-dn:Jk.transition!==null?(Cd===0&&(Cd=Lo()),Cd):(a=Ye,a!==0||(a=window.event,a=a===void 0?16:Tc(a.type)),a)}function qr(a,l,d,g){if(50<Yc)throw Yc=0,Zm=null,Error(t(185));Si(a,d,g),((Ze&2)===0||a!==rn)&&(a===rn&&((Ze&2)===0&&(Ad|=d),Yt===4&&zi(a,dn)),Kn(a,g),d===1&&Ze===0&&(l.mode&1)===0&&(pl=ct()+500,td&&Ni()))}function Kn(a,l){var d=a.callbackNode;$s(a,l);var g=Do(a,a===rn?dn:0);if(g===0)d!==null&&_c(d),a.callbackNode=null,a.callbackPriority=0;else if(l=g&-g,a.callbackPriority!==l){if(d!=null&&_c(d),l===1)a.tag===0?Qk(Qw.bind(null,a)):O_(Qw.bind(null,a)),qk(function(){(Ze&6)===0&&Ni()}),d=null;else{switch(Ci(g)){case 1:d=Po;break;case 4:d=Ai;break;case 16:d=mr;break;case 536870912:d=Ch;break;default:d=mr}d=i1(d,Yw.bind(null,a))}a.callbackPriority=l,a.callbackNode=d}}function Yw(a,l){if(xd=-1,Cd=0,(Ze&6)!==0)throw Error(t(327));var d=a.callbackNode;if(ml()&&a.callbackNode!==d)return null;var g=Do(a,a===rn?dn:0);if(g===0)return null;if((g&30)!==0||(g&a.expiredLanes)!==0||l)l=Id(a,g);else{l=g;var v=Ze;Ze|=2;var E=Zw();(rn!==a||dn!==l)&&(ti=null,pl=ct()+500,qo(a,l));do try{vP();break}catch(U){Jw(a,U)}while(!0);ym(),Ed.current=E,Ze=v,zt!==null?l=0:(rn=null,dn=0,l=Yt)}if(l!==0){if(l===2&&(v=tr(a),v!==0&&(g=v,l=eg(a,v))),l===1)throw d=Kc,qo(a,0),zi(a,g),Kn(a,ct()),d;if(l===6)zi(a,g);else{if(v=a.current.alternate,(g&30)===0&&!gP(v)&&(l=Id(a,g),l===2&&(E=tr(a),E!==0&&(g=E,l=eg(a,E))),l===1))throw d=Kc,qo(a,0),zi(a,g),Kn(a,ct()),d;switch(a.finishedWork=v,a.finishedLanes=g,l){case 0:case 1:throw Error(t(345));case 2:Ko(a,qn,ti);break;case 3:if(zi(a,g),(g&130023424)===g&&(l=Qm+500-ct(),10<l)){if(Do(a,0)!==0)break;if(v=a.suspendedLanes,(v&g)!==g){On(),a.pingedLanes|=a.suspendedLanes&v;break}a.timeoutHandle=om(Ko.bind(null,a,qn,ti),l);break}Ko(a,qn,ti);break;case 4:if(zi(a,g),(g&4194240)===g)break;for(l=a.eventTimes,v=-1;0<g;){var I=31-Ln(g);E=1<<I,I=l[I],I>v&&(v=I),g&=~E}if(g=v,g=ct()-g,g=(120>g?120:480>g?480:1080>g?1080:1920>g?1920:3e3>g?3e3:4320>g?4320:1960*mP(g/1960))-g,10<g){a.timeoutHandle=om(Ko.bind(null,a,qn,ti),g);break}Ko(a,qn,ti);break;case 5:Ko(a,qn,ti);break;default:throw Error(t(329))}}}return Kn(a,ct()),a.callbackNode===d?Yw.bind(null,a):null}function eg(a,l){var d=Xc;return a.current.memoizedState.isDehydrated&&(qo(a,l).flags|=256),a=Id(a,l),a!==2&&(l=qn,qn=d,l!==null&&tg(l)),a}function tg(a){qn===null?qn=a:qn.push.apply(qn,a)}function gP(a){for(var l=a;;){if(l.flags&16384){var d=l.updateQueue;if(d!==null&&(d=d.stores,d!==null))for(var g=0;g<d.length;g++){var v=d[g],E=v.getSnapshot;v=v.value;try{if(!zr(E(),v))return!1}catch{return!1}}}if(d=l.child,l.subtreeFlags&16384&&d!==null)d.return=l,l=d;else{if(l===a)break;for(;l.sibling===null;){if(l.return===null||l.return===a)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function zi(a,l){for(l&=~Ym,l&=~Ad,a.suspendedLanes|=l,a.pingedLanes&=~l,a=a.expirationTimes;0<l;){var d=31-Ln(l),g=1<<d;a[d]=-1,l&=~g}}function Qw(a){if((Ze&6)!==0)throw Error(t(327));ml();var l=Do(a,0);if((l&1)===0)return Kn(a,ct()),null;var d=Id(a,l);if(a.tag!==0&&d===2){var g=tr(a);g!==0&&(l=g,d=eg(a,g))}if(d===1)throw d=Kc,qo(a,0),zi(a,l),Kn(a,ct()),d;if(d===6)throw Error(t(345));return a.finishedWork=a.current.alternate,a.finishedLanes=l,Ko(a,qn,ti),Kn(a,ct()),null}function ng(a,l){var d=Ze;Ze|=1;try{return a(l)}finally{Ze=d,Ze===0&&(pl=ct()+500,td&&Ni())}}function Go(a){Bi!==null&&Bi.tag===0&&(Ze&6)===0&&ml();var l=Ze;Ze|=1;var d=Ar.transition,g=Ye;try{if(Ar.transition=null,Ye=1,a)return a()}finally{Ye=g,Ar.transition=d,Ze=l,(Ze&6)===0&&Ni()}}function rg(){or=fl.current,ft(fl)}function qo(a,l){a.finishedWork=null,a.finishedLanes=0;var d=a.timeoutHandle;if(d!==-1&&(a.timeoutHandle=-1,Gk(d)),zt!==null)for(d=zt.return;d!==null;){var g=d;switch(dm(g),g.tag){case 1:g=g.type.childContextTypes,g!=null&&Zh();break;case 3:ul(),ft(Hn),ft(wn),Sm();break;case 5:bm(g);break;case 4:ul();break;case 13:ft(bt);break;case 19:ft(bt);break;case 10:vm(g.type._context);break;case 22:case 23:rg()}d=d.return}if(rn=a,zt=a=$i(a.current,null),dn=or=l,Yt=0,Kc=null,Ym=Ad=Wo=0,qn=Xc=null,zo!==null){for(l=0;l<zo.length;l++)if(d=zo[l],g=d.interleaved,g!==null){d.interleaved=null;var v=g.next,E=d.pending;if(E!==null){var I=E.next;E.next=v,g.next=I}d.pending=g}zo=null}return a}function Jw(a,l){do{var d=zt;try{if(ym(),hd.current=md,dd){for(var g=Tt.memoizedState;g!==null;){var v=g.queue;v!==null&&(v.pending=null),g=g.next}dd=!1}if(Ho=0,nn=Xt=Tt=null,zc=!1,$c=0,Xm.current=null,d===null||d.return===null){Yt=1,Kc=l,zt=null;break}e:{var E=a,I=d.return,U=d,H=l;if(l=dn,U.flags|=32768,H!==null&&typeof H=="object"&&typeof H.then=="function"){var Q=H,oe=U,le=oe.tag;if((oe.mode&1)===0&&(le===0||le===11||le===15)){var se=oe.alternate;se?(oe.updateQueue=se.updateQueue,oe.memoizedState=se.memoizedState,oe.lanes=se.lanes):(oe.updateQueue=null,oe.memoizedState=null)}var fe=bw(I);if(fe!==null){fe.flags&=-257,Tw(fe,I,U,E,l),fe.mode&1&&Aw(E,Q,l),l=fe,H=Q;var ye=l.updateQueue;if(ye===null){var ve=new Set;ve.add(H),l.updateQueue=ve}else ye.add(H);break e}else{if((l&1)===0){Aw(E,Q,l),sg();break e}H=Error(t(426))}}else if(_t&&U.mode&1){var Lt=bw(I);if(Lt!==null){(Lt.flags&65536)===0&&(Lt.flags|=256),Tw(Lt,I,U,E,l),mm(hl(H,U));break e}}E=H=hl(H,U),Yt!==4&&(Yt=2),Xc===null?Xc=[E]:Xc.push(E),E=I;do{switch(E.tag){case 3:E.flags|=65536,l&=-l,E.lanes|=l;var K=ww(E,H,l);q_(E,K);break e;case 1:U=H;var G=E.type,X=E.stateNode;if((E.flags&128)===0&&(typeof G.getDerivedStateFromError=="function"||X!==null&&typeof X.componentDidCatch=="function"&&(ji===null||!ji.has(X)))){E.flags|=65536,l&=-l,E.lanes|=l;var ce=Ew(E,U,l);q_(E,ce);break e}}E=E.return}while(E!==null)}t1(d)}catch(Ae){l=Ae,zt===d&&d!==null&&(zt=d=d.return);continue}break}while(!0)}function Zw(){var a=Ed.current;return Ed.current=md,a===null?md:a}function sg(){(Yt===0||Yt===3||Yt===2)&&(Yt=4),rn===null||(Wo&268435455)===0&&(Ad&268435455)===0||zi(rn,dn)}function Id(a,l){var d=Ze;Ze|=2;var g=Zw();(rn!==a||dn!==l)&&(ti=null,qo(a,l));do try{yP();break}catch(v){Jw(a,v)}while(!0);if(ym(),Ze=d,Ed.current=g,zt!==null)throw Error(t(261));return rn=null,dn=0,Yt}function yP(){for(;zt!==null;)e1(zt)}function vP(){for(;zt!==null&&!Sh();)e1(zt)}function e1(a){var l=s1(a.alternate,a,or);a.memoizedProps=a.pendingProps,l===null?t1(a):zt=l,Xm.current=null}function t1(a){var l=a;do{var d=l.alternate;if(a=l.return,(l.flags&32768)===0){if(d=uP(d,l,or),d!==null){zt=d;return}}else{if(d=hP(d,l),d!==null){d.flags&=32767,zt=d;return}if(a!==null)a.flags|=32768,a.subtreeFlags=0,a.deletions=null;else{Yt=6,zt=null;return}}if(l=l.sibling,l!==null){zt=l;return}zt=l=a}while(l!==null);Yt===0&&(Yt=5)}function Ko(a,l,d){var g=Ye,v=Ar.transition;try{Ar.transition=null,Ye=1,_P(a,l,d,g)}finally{Ar.transition=v,Ye=g}return null}function _P(a,l,d,g){do ml();while(Bi!==null);if((Ze&6)!==0)throw Error(t(327));d=a.finishedWork;var v=a.finishedLanes;if(d===null)return null;if(a.finishedWork=null,a.finishedLanes=0,d===a.current)throw Error(t(177));a.callbackNode=null,a.callbackPriority=0;var E=d.lanes|d.childLanes;if(ot(a,E),a===rn&&(zt=rn=null,dn=0),(d.subtreeFlags&2064)===0&&(d.flags&2064)===0||Td||(Td=!0,i1(mr,function(){return ml(),null})),E=(d.flags&15990)!==0,(d.subtreeFlags&15990)!==0||E){E=Ar.transition,Ar.transition=null;var I=Ye;Ye=1;var U=Ze;Ze|=4,Xm.current=null,fP(a,d),Ww(d,a),jk(sm),ki=!!rm,sm=rm=null,a.current=d,pP(d),Up(),Ze=U,Ye=I,Ar.transition=E}else a.current=d;if(Td&&(Td=!1,Bi=a,Sd=v),E=a.pendingLanes,E===0&&(ji=null),Ih(d.stateNode),Kn(a,ct()),l!==null)for(g=a.onRecoverableError,d=0;d<l.length;d++)v=l[d],g(v.value,{componentStack:v.stack,digest:v.digest});if(bd)throw bd=!1,a=Jm,Jm=null,a;return(Sd&1)!==0&&a.tag!==0&&ml(),E=a.pendingLanes,(E&1)!==0?a===Zm?Yc++:(Yc=0,Zm=a):Yc=0,Ni(),null}function ml(){if(Bi!==null){var a=Ci(Sd),l=Ar.transition,d=Ye;try{if(Ar.transition=null,Ye=16>a?16:a,Bi===null)var g=!1;else{if(a=Bi,Bi=null,Sd=0,(Ze&6)!==0)throw Error(t(331));var v=Ze;for(Ze|=4,me=a.current;me!==null;){var E=me,I=E.child;if((me.flags&16)!==0){var U=E.deletions;if(U!==null){for(var H=0;H<U.length;H++){var Q=U[H];for(me=Q;me!==null;){var oe=me;switch(oe.tag){case 0:case 11:case 15:qc(8,oe,E)}var le=oe.child;if(le!==null)le.return=oe,me=le;else for(;me!==null;){oe=me;var se=oe.sibling,fe=oe.return;if(Bw(oe),oe===Q){me=null;break}if(se!==null){se.return=fe,me=se;break}me=fe}}}var ye=E.alternate;if(ye!==null){var ve=ye.child;if(ve!==null){ye.child=null;do{var Lt=ve.sibling;ve.sibling=null,ve=Lt}while(ve!==null)}}me=E}}if((E.subtreeFlags&2064)!==0&&I!==null)I.return=E,me=I;else e:for(;me!==null;){if(E=me,(E.flags&2048)!==0)switch(E.tag){case 0:case 11:case 15:qc(9,E,E.return)}var K=E.sibling;if(K!==null){K.return=E.return,me=K;break e}me=E.return}}var G=a.current;for(me=G;me!==null;){I=me;var X=I.child;if((I.subtreeFlags&2064)!==0&&X!==null)X.return=I,me=X;else e:for(I=G;me!==null;){if(U=me,(U.flags&2048)!==0)try{switch(U.tag){case 0:case 11:case 15:wd(9,U)}}catch(Ae){kt(U,U.return,Ae)}if(U===I){me=null;break e}var ce=U.sibling;if(ce!==null){ce.return=U.return,me=ce;break e}me=U.return}}if(Ze=v,Ni(),er&&typeof er.onPostCommitFiberRoot=="function")try{er.onPostCommitFiberRoot(Ro,a)}catch{}g=!0}return g}finally{Ye=d,Ar.transition=l}}return!1}function n1(a,l,d){l=hl(d,l),l=ww(a,l,1),a=Fi(a,l,1),l=On(),a!==null&&(Si(a,1,l),Kn(a,l))}function kt(a,l,d){if(a.tag===3)n1(a,a,d);else for(;l!==null;){if(l.tag===3){n1(l,a,d);break}else if(l.tag===1){var g=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(ji===null||!ji.has(g))){a=hl(d,a),a=Ew(l,a,1),l=Fi(l,a,1),a=On(),l!==null&&(Si(l,1,a),Kn(l,a));break}}l=l.return}}function wP(a,l,d){var g=a.pingCache;g!==null&&g.delete(l),l=On(),a.pingedLanes|=a.suspendedLanes&d,rn===a&&(dn&d)===d&&(Yt===4||Yt===3&&(dn&130023424)===dn&&500>ct()-Qm?qo(a,0):Ym|=d),Kn(a,l)}function r1(a,l){l===0&&((a.mode&1)===0?l=1:(l=Va,Va<<=1,(Va&130023424)===0&&(Va=4194304)));var d=On();a=Js(a,l),a!==null&&(Si(a,l,d),Kn(a,d))}function EP(a){var l=a.memoizedState,d=0;l!==null&&(d=l.retryLane),r1(a,d)}function AP(a,l){var d=0;switch(a.tag){case 13:var g=a.stateNode,v=a.memoizedState;v!==null&&(d=v.retryLane);break;case 19:g=a.stateNode;break;default:throw Error(t(314))}g!==null&&g.delete(l),r1(a,d)}var s1;s1=function(a,l,d){if(a!==null)if(a.memoizedProps!==l.pendingProps||Hn.current)Gn=!0;else{if((a.lanes&d)===0&&(l.flags&128)===0)return Gn=!1,cP(a,l,d);Gn=(a.flags&131072)!==0}else Gn=!1,_t&&(l.flags&1048576)!==0&&F_(l,rd,l.index);switch(l.lanes=0,l.tag){case 2:var g=l.type;vd(a,l),a=l.pendingProps;var v=rl(l,wn.current);cl(l,d),v=Im(null,l,g,a,v,d);var E=km();return l.flags|=1,typeof v=="object"&&v!==null&&typeof v.render=="function"&&v.$$typeof===void 0?(l.tag=1,l.memoizedState=null,l.updateQueue=null,Wn(g)?(E=!0,ed(l)):E=!1,l.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,Em(l),v.updater=gd,l.stateNode=v,v._reactInternals=l,Nm(l,g,a,d),l=jm(null,l,g,!0,E,d)):(l.tag=0,_t&&E&&hm(l),Nn(null,l,v,d),l=l.child),l;case 16:g=l.elementType;e:{switch(vd(a,l),a=l.pendingProps,v=g._init,g=v(g._payload),l.type=g,v=l.tag=TP(g),a=Hr(g,a),v){case 0:l=Vm(null,l,g,a,d);break e;case 1:l=Pw(null,l,g,a,d);break e;case 11:l=Sw(null,l,g,a,d);break e;case 14:l=xw(null,l,g,Hr(g.type,a),d);break e}throw Error(t(306,g,""))}return l;case 0:return g=l.type,v=l.pendingProps,v=l.elementType===g?v:Hr(g,v),Vm(a,l,g,v,d);case 1:return g=l.type,v=l.pendingProps,v=l.elementType===g?v:Hr(g,v),Pw(a,l,g,v,d);case 3:e:{if(Rw(l),a===null)throw Error(t(387));g=l.pendingProps,E=l.memoizedState,v=E.element,G_(a,l),cd(l,g,null,d);var I=l.memoizedState;if(g=I.element,E.isDehydrated)if(E={element:g,isDehydrated:!1,cache:I.cache,pendingSuspenseBoundaries:I.pendingSuspenseBoundaries,transitions:I.transitions},l.updateQueue.baseState=E,l.memoizedState=E,l.flags&256){v=hl(Error(t(423)),l),l=Dw(a,l,g,d,v);break e}else if(g!==v){v=hl(Error(t(424)),l),l=Dw(a,l,g,d,v);break e}else for(ir=Di(l.stateNode.containerInfo.firstChild),sr=l,_t=!0,$r=null,d=H_(l,null,g,d),l.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling;else{if(ol(),g===v){l=ei(a,l,d);break e}Nn(a,l,g,d)}l=l.child}return l;case 5:return X_(l),a===null&&pm(l),g=l.type,v=l.pendingProps,E=a!==null?a.memoizedProps:null,I=v.children,im(g,v)?I=null:E!==null&&im(g,E)&&(l.flags|=32),kw(a,l),Nn(a,l,I,d),l.child;case 6:return a===null&&pm(l),null;case 13:return Lw(a,l,d);case 4:return Am(l,l.stateNode.containerInfo),g=l.pendingProps,a===null?l.child=al(l,null,g,d):Nn(a,l,g,d),l.child;case 11:return g=l.type,v=l.pendingProps,v=l.elementType===g?v:Hr(g,v),Sw(a,l,g,v,d);case 7:return Nn(a,l,l.pendingProps,d),l.child;case 8:return Nn(a,l,l.pendingProps.children,d),l.child;case 12:return Nn(a,l,l.pendingProps.children,d),l.child;case 10:e:{if(g=l.type._context,v=l.pendingProps,E=l.memoizedProps,I=v.value,ut(od,g._currentValue),g._currentValue=I,E!==null)if(zr(E.value,I)){if(E.children===v.children&&!Hn.current){l=ei(a,l,d);break e}}else for(E=l.child,E!==null&&(E.return=l);E!==null;){var U=E.dependencies;if(U!==null){I=E.child;for(var H=U.firstContext;H!==null;){if(H.context===g){if(E.tag===1){H=Zs(-1,d&-d),H.tag=2;var Q=E.updateQueue;if(Q!==null){Q=Q.shared;var oe=Q.pending;oe===null?H.next=H:(H.next=oe.next,oe.next=H),Q.pending=H}}E.lanes|=d,H=E.alternate,H!==null&&(H.lanes|=d),_m(E.return,d,l),U.lanes|=d;break}H=H.next}}else if(E.tag===10)I=E.type===l.type?null:E.child;else if(E.tag===18){if(I=E.return,I===null)throw Error(t(341));I.lanes|=d,U=I.alternate,U!==null&&(U.lanes|=d),_m(I,d,l),I=E.sibling}else I=E.child;if(I!==null)I.return=E;else for(I=E;I!==null;){if(I===l){I=null;break}if(E=I.sibling,E!==null){E.return=I.return,I=E;break}I=I.return}E=I}Nn(a,l,v.children,d),l=l.child}return l;case 9:return v=l.type,g=l.pendingProps.children,cl(l,d),v=wr(v),g=g(v),l.flags|=1,Nn(a,l,g,d),l.child;case 14:return g=l.type,v=Hr(g,l.pendingProps),v=Hr(g.type,v),xw(a,l,g,v,d);case 15:return Cw(a,l,l.type,l.pendingProps,d);case 17:return g=l.type,v=l.pendingProps,v=l.elementType===g?v:Hr(g,v),vd(a,l),l.tag=1,Wn(g)?(a=!0,ed(l)):a=!1,cl(l,d),vw(l,g,v),Nm(l,g,v,d),jm(null,l,g,!0,a,d);case 19:return Nw(a,l,d);case 22:return Iw(a,l,d)}throw Error(t(156,l.tag))};function i1(a,l){return Oa(a,l)}function bP(a,l,d,g){this.tag=a,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function br(a,l,d,g){return new bP(a,l,d,g)}function ig(a){return a=a.prototype,!(!a||!a.isReactComponent)}function TP(a){if(typeof a=="function")return ig(a)?1:0;if(a!=null){if(a=a.$$typeof,a===z)return 11;if(a===ke)return 14}return 2}function $i(a,l){var d=a.alternate;return d===null?(d=br(a.tag,l,a.key,a.mode),d.elementType=a.elementType,d.type=a.type,d.stateNode=a.stateNode,d.alternate=a,a.alternate=d):(d.pendingProps=l,d.type=a.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=a.flags&14680064,d.childLanes=a.childLanes,d.lanes=a.lanes,d.child=a.child,d.memoizedProps=a.memoizedProps,d.memoizedState=a.memoizedState,d.updateQueue=a.updateQueue,l=a.dependencies,d.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},d.sibling=a.sibling,d.index=a.index,d.ref=a.ref,d}function kd(a,l,d,g,v,E){var I=2;if(g=a,typeof a=="function")ig(a)&&(I=1);else if(typeof a=="string")I=5;else e:switch(a){case k:return Xo(d.children,v,E,l);case C:I=8,v|=8;break;case P:return a=br(12,d,l,v|2),a.elementType=P,a.lanes=E,a;case F:return a=br(13,d,l,v),a.elementType=F,a.lanes=E,a;case ue:return a=br(19,d,l,v),a.elementType=ue,a.lanes=E,a;case Z:return Pd(d,v,E,l);default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case N:I=10;break e;case j:I=9;break e;case z:I=11;break e;case ke:I=14;break e;case ie:I=16,g=null;break e}throw Error(t(130,a==null?a:typeof a,""))}return l=br(I,d,l,v),l.elementType=a,l.type=g,l.lanes=E,l}function Xo(a,l,d,g){return a=br(7,a,g,l),a.lanes=d,a}function Pd(a,l,d,g){return a=br(22,a,g,l),a.elementType=Z,a.lanes=d,a.stateNode={isHidden:!1},a}function og(a,l,d){return a=br(6,a,null,l),a.lanes=d,a}function ag(a,l,d){return l=br(4,a.children!==null?a.children:[],a.key,l),l.lanes=d,l.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},l}function SP(a,l,d,g,v){this.tag=l,this.containerInfo=a,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ti(0),this.expirationTimes=Ti(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ti(0),this.identifierPrefix=g,this.onRecoverableError=v,this.mutableSourceEagerHydrationData=null}function lg(a,l,d,g,v,E,I,U,H){return a=new SP(a,l,d,U,H),l===1?(l=1,E===!0&&(l|=8)):l=0,E=br(3,null,null,l),a.current=E,E.stateNode=a,E.memoizedState={element:g,isDehydrated:d,cache:null,transitions:null,pendingSuspenseBoundaries:null},Em(E),a}function xP(a,l,d){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:$,key:g==null?null:""+g,children:a,containerInfo:l,implementation:d}}function o1(a){if(!a)return Mi;a=a._reactInternals;e:{if(Nr(a)!==a||a.tag!==1)throw Error(t(170));var l=a;do{switch(l.tag){case 3:l=l.stateNode.context;break e;case 1:if(Wn(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break e}}l=l.return}while(l!==null);throw Error(t(171))}if(a.tag===1){var d=a.type;if(Wn(d))return M_(a,d,l)}return l}function a1(a,l,d,g,v,E,I,U,H){return a=lg(d,g,!0,a,v,E,I,U,H),a.context=o1(null),d=a.current,g=On(),v=Ui(d),E=Zs(g,v),E.callback=l??null,Fi(d,E,v),a.current.lanes=v,Si(a,v,g),Kn(a,g),a}function Rd(a,l,d,g){var v=l.current,E=On(),I=Ui(v);return d=o1(d),l.context===null?l.context=d:l.pendingContext=d,l=Zs(E,I),l.payload={element:a},g=g===void 0?null:g,g!==null&&(l.callback=g),a=Fi(v,l,I),a!==null&&(qr(a,v,I,E),ld(a,v,I)),I}function Dd(a){if(a=a.current,!a.child)return null;switch(a.child.tag){case 5:return a.child.stateNode;default:return a.child.stateNode}}function l1(a,l){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var d=a.retryLane;a.retryLane=d!==0&&d<l?d:l}}function cg(a,l){l1(a,l),(a=a.alternate)&&l1(a,l)}function CP(){return null}var c1=typeof reportError=="function"?reportError:function(a){console.error(a)};function ug(a){this._internalRoot=a}Ld.prototype.render=ug.prototype.render=function(a){var l=this._internalRoot;if(l===null)throw Error(t(409));Rd(a,l,null,null)},Ld.prototype.unmount=ug.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var l=a.containerInfo;Go(function(){Rd(null,a,null,null)}),l[Ks]=null}};function Ld(a){this._internalRoot=a}Ld.prototype.unstable_scheduleHydration=function(a){if(a){var l=Lh();a={blockedOn:null,target:a,priority:l};for(var d=0;d<ls.length&&l!==0&&l<ls[d].priority;d++);ls.splice(d,0,a),d===0&&Oh(a)}};function hg(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function Md(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11&&(a.nodeType!==8||a.nodeValue!==" react-mount-point-unstable "))}function u1(){}function IP(a,l,d,g,v){if(v){if(typeof g=="function"){var E=g;g=function(){var Q=Dd(I);E.call(Q)}}var I=a1(l,g,a,0,null,!1,!1,"",u1);return a._reactRootContainer=I,a[Ks]=I.current,Mc(a.nodeType===8?a.parentNode:a),Go(),I}for(;v=a.lastChild;)a.removeChild(v);if(typeof g=="function"){var U=g;g=function(){var Q=Dd(H);U.call(Q)}}var H=lg(a,0,!1,null,null,!1,!1,"",u1);return a._reactRootContainer=H,a[Ks]=H.current,Mc(a.nodeType===8?a.parentNode:a),Go(function(){Rd(l,H,d,g)}),H}function Nd(a,l,d,g,v){var E=d._reactRootContainer;if(E){var I=E;if(typeof v=="function"){var U=v;v=function(){var H=Dd(I);U.call(H)}}Rd(l,I,a,v)}else I=IP(d,l,a,v,g);return Dd(I)}Rh=function(a){switch(a.tag){case 3:var l=a.stateNode;if(l.current.memoizedState.isDehydrated){var d=bi(l.pendingLanes);d!==0&&(xi(l,d|1),Kn(l,ct()),(Ze&6)===0&&(pl=ct()+500,Ni()))}break;case 13:Go(function(){var g=Js(a,1);if(g!==null){var v=On();qr(g,a,1,v)}}),cg(a,1)}},ja=function(a){if(a.tag===13){var l=Js(a,134217728);if(l!==null){var d=On();qr(l,a,134217728,d)}cg(a,134217728)}},Dh=function(a){if(a.tag===13){var l=Ui(a),d=Js(a,l);if(d!==null){var g=On();qr(d,a,l,g)}cg(a,l)}},Lh=function(){return Ye},Mh=function(a,l){var d=Ye;try{return Ye=a,l()}finally{Ye=d}},Pa=function(a,l,d){switch(l){case"input":if(dr(a,d),l=d.name,d.type==="radio"&&l!=null){for(d=a;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll("input[name="+JSON.stringify(""+l)+'][type="radio"]'),l=0;l<d.length;l++){var g=d[l];if(g!==a&&g.form===a.form){var v=Jh(g);if(!v)throw Error(t(90));vn(g),dr(g,v)}}}break;case"textarea":Ei(a,d);break;case"select":l=d.value,l!=null&&Bn(a,!!d.multiple,l,!1)}},xo=ng,mc=Go;var kP={usingClientEntryPoint:!1,Events:[Fc,tl,Jh,os,pc,ng]},Qc={findFiberByHostInstance:Vo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},PP={bundleType:Qc.bundleType,version:Qc.version,rendererPackageName:Qc.rendererPackageName,rendererConfig:Qc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:B.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){return a=vc(a),a===null?null:a.stateNode},findFiberByHostInstance:Qc.findFiberByHostInstance||CP,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Od=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Od.isDisabled&&Od.supportsFiber)try{Ro=Od.inject(PP),er=Od}catch{}}return Yn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=kP,Yn.createPortal=function(a,l){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!hg(l))throw Error(t(200));return xP(a,l,null,d)},Yn.createRoot=function(a,l){if(!hg(a))throw Error(t(299));var d=!1,g="",v=c1;return l!=null&&(l.unstable_strictMode===!0&&(d=!0),l.identifierPrefix!==void 0&&(g=l.identifierPrefix),l.onRecoverableError!==void 0&&(v=l.onRecoverableError)),l=lg(a,1,!1,null,null,d,!1,g,v),a[Ks]=l.current,Mc(a.nodeType===8?a.parentNode:a),new ug(l)},Yn.findDOMNode=function(a){if(a==null)return null;if(a.nodeType===1)return a;var l=a._reactInternals;if(l===void 0)throw typeof a.render=="function"?Error(t(188)):(a=Object.keys(a).join(","),Error(t(268,a)));return a=vc(l),a=a===null?null:a.stateNode,a},Yn.flushSync=function(a){return Go(a)},Yn.hydrate=function(a,l,d){if(!Md(l))throw Error(t(200));return Nd(null,a,l,!0,d)},Yn.hydrateRoot=function(a,l,d){if(!hg(a))throw Error(t(405));var g=d!=null&&d.hydratedSources||null,v=!1,E="",I=c1;if(d!=null&&(d.unstable_strictMode===!0&&(v=!0),d.identifierPrefix!==void 0&&(E=d.identifierPrefix),d.onRecoverableError!==void 0&&(I=d.onRecoverableError)),l=a1(l,null,a,1,d??null,v,!1,E,I),a[Ks]=l.current,Mc(a),g)for(a=0;a<g.length;a++)d=g[a],v=d._getVersion,v=v(d._source),l.mutableSourceEagerHydrationData==null?l.mutableSourceEagerHydrationData=[d,v]:l.mutableSourceEagerHydrationData.push(d,v);return new Ld(l)},Yn.render=function(a,l,d){if(!Md(l))throw Error(t(200));return Nd(null,a,l,!1,d)},Yn.unmountComponentAtNode=function(a){if(!Md(a))throw Error(t(40));return a._reactRootContainer?(Go(function(){Nd(null,null,a,!1,function(){a._reactRootContainer=null,a[Ks]=null})}),!0):!1},Yn.unstable_batchedUpdates=ng,Yn.unstable_renderSubtreeIntoContainer=function(a,l,d,g){if(!Md(d))throw Error(t(200));if(a==null||a._reactInternals===void 0)throw Error(t(38));return Nd(a,l,d,!1,g)},Yn.version="18.3.1-next-f1338f8080-20240426",Yn}var w1;function VP(){if(w1)return mg.exports;w1=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),mg.exports=FP(),mg.exports}var E1;function jP(){if(E1)return Fd;E1=1;var r=VP();return Fd.createRoot=r.createRoot,Fd.hydrateRoot=r.hydrateRoot,Fd}var BP=jP();const UP=rv(BP),zP="modulepreload",$P=function(r){return"/Costas_Portfolio/"+r},A1={},HP=function(e,t,n){let s=Promise.resolve();if(t&&t.length>0){let u=function(h){return Promise.all(h.map(f=>Promise.resolve(f).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),c=o?.nonce||o?.getAttribute("nonce");s=u(t.map(h=>{if(h=$P(h),h in A1)return;A1[h]=!0;const f=h.endsWith(".css"),m=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${m}`))return;const y=document.createElement("link");if(y.rel=f?"stylesheet":zP,f||(y.as="script"),y.crossOrigin="",y.href=h,c&&y.setAttribute("nonce",c),document.head.appendChild(y),f)return new Promise((_,A)=>{y.addEventListener("load",_),y.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${h}`)))})}))}function i(o){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=o,window.dispatchEvent(c),!c.defaultPrevented)throw o}return s.then(o=>{for(const c of o||[])c.status==="rejected"&&i(c.reason);return e().catch(i)})};/**
 * react-router v7.8.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var b1="popstate";function WP(r={}){function e(n,s){let{pathname:i,search:o,hash:c}=n.location;return ny("",{pathname:i,search:o,hash:c},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function t(n,s){return typeof s=="string"?s:ku(s)}return qP(e,t,null,r)}function Ct(r,e){if(r===!1||r===null||typeof r>"u")throw new Error(e)}function Ns(r,e){if(!r){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function GP(){return Math.random().toString(36).substring(2,10)}function T1(r,e){return{usr:r.state,key:r.key,idx:e}}function ny(r,e,t=null,n){return{pathname:typeof r=="string"?r:r.pathname,search:"",hash:"",...typeof e=="string"?Ql(e):e,state:t,key:e&&e.key||n||GP()}}function ku({pathname:r="/",search:e="",hash:t=""}){return e&&e!=="?"&&(r+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(r+=t.charAt(0)==="#"?t:"#"+t),r}function Ql(r){let e={};if(r){let t=r.indexOf("#");t>=0&&(e.hash=r.substring(t),r=r.substring(0,t));let n=r.indexOf("?");n>=0&&(e.search=r.substring(n),r=r.substring(0,n)),r&&(e.pathname=r)}return e}function qP(r,e,t,n={}){let{window:s=document.defaultView,v5Compat:i=!1}=n,o=s.history,c="POP",u=null,h=f();h==null&&(h=0,o.replaceState({...o.state,idx:h},""));function f(){return(o.state||{idx:null}).idx}function m(){c="POP";let T=f(),x=T==null?null:T-h;h=T,u&&u({action:c,location:b.location,delta:x})}function y(T,x){c="PUSH";let M=ny(b.location,T,x);h=f()+1;let R=T1(M,h),B=b.createHref(M);try{o.pushState(R,"",B)}catch(O){if(O instanceof DOMException&&O.name==="DataCloneError")throw O;s.location.assign(B)}i&&u&&u({action:c,location:b.location,delta:1})}function _(T,x){c="REPLACE";let M=ny(b.location,T,x);h=f();let R=T1(M,h),B=b.createHref(M);o.replaceState(R,"",B),i&&u&&u({action:c,location:b.location,delta:0})}function A(T){return KP(T)}let b={get action(){return c},get location(){return r(s,o)},listen(T){if(u)throw new Error("A history only accepts one active listener");return s.addEventListener(b1,m),u=T,()=>{s.removeEventListener(b1,m),u=null}},createHref(T){return e(s,T)},createURL:A,encodeLocation(T){let x=A(T);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:y,replace:_,go(T){return o.go(T)}};return b}function KP(r,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),Ct(t,"No window.location.(origin|href) available to create URL");let n=typeof r=="string"?r:ku(r);return n=n.replace(/ $/,"%20"),!e&&n.startsWith("//")&&(n=t+n),new URL(n,t)}function sT(r,e,t="/"){return XP(r,e,t,!1)}function XP(r,e,t,n){let s=typeof e=="string"?Ql(e):e,i=ui(s.pathname||"/",t);if(i==null)return null;let o=iT(r);YP(o);let c=null;for(let u=0;c==null&&u<o.length;++u){let h=a2(i);c=i2(o[u],h,n)}return c}function iT(r,e=[],t=[],n=""){let s=(i,o,c)=>{let u={relativePath:c===void 0?i.path||"":c,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};u.relativePath.startsWith("/")&&(Ct(u.relativePath.startsWith(n),`Absolute route path "${u.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),u.relativePath=u.relativePath.slice(n.length));let h=oi([n,u.relativePath]),f=t.concat(u);i.children&&i.children.length>0&&(Ct(i.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${h}".`),iT(i.children,e,f,h)),!(i.path==null&&!i.index)&&e.push({path:h,score:r2(h,i.index),routesMeta:f})};return r.forEach((i,o)=>{if(i.path===""||!i.path?.includes("?"))s(i,o);else for(let c of oT(i.path))s(i,o,c)}),e}function oT(r){let e=r.split("/");if(e.length===0)return[];let[t,...n]=e,s=t.endsWith("?"),i=t.replace(/\?$/,"");if(n.length===0)return s?[i,""]:[i];let o=oT(n.join("/")),c=[];return c.push(...o.map(u=>u===""?i:[i,u].join("/"))),s&&c.push(...o),c.map(u=>r.startsWith("/")&&u===""?"/":u)}function YP(r){r.sort((e,t)=>e.score!==t.score?t.score-e.score:s2(e.routesMeta.map(n=>n.childrenIndex),t.routesMeta.map(n=>n.childrenIndex)))}var QP=/^:[\w-]+$/,JP=3,ZP=2,e2=1,t2=10,n2=-2,S1=r=>r==="*";function r2(r,e){let t=r.split("/"),n=t.length;return t.some(S1)&&(n+=n2),e&&(n+=ZP),t.filter(s=>!S1(s)).reduce((s,i)=>s+(QP.test(i)?JP:i===""?e2:t2),n)}function s2(r,e){return r.length===e.length&&r.slice(0,-1).every((n,s)=>n===e[s])?r[r.length-1]-e[e.length-1]:0}function i2(r,e,t=!1){let{routesMeta:n}=r,s={},i="/",o=[];for(let c=0;c<n.length;++c){let u=n[c],h=c===n.length-1,f=i==="/"?e:e.slice(i.length)||"/",m=Ef({path:u.relativePath,caseSensitive:u.caseSensitive,end:h},f),y=u.route;if(!m&&h&&t&&!n[n.length-1].route.index&&(m=Ef({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},f)),!m)return null;Object.assign(s,m.params),o.push({params:s,pathname:oi([i,m.pathname]),pathnameBase:h2(oi([i,m.pathnameBase])),route:y}),m.pathnameBase!=="/"&&(i=oi([i,m.pathnameBase]))}return o}function Ef(r,e){typeof r=="string"&&(r={path:r,caseSensitive:!1,end:!0});let[t,n]=o2(r.path,r.caseSensitive,r.end),s=e.match(t);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),c=s.slice(1);return{params:n.reduce((h,{paramName:f,isOptional:m},y)=>{if(f==="*"){let A=c[y]||"";o=i.slice(0,i.length-A.length).replace(/(.)\/+$/,"$1")}const _=c[y];return m&&!_?h[f]=void 0:h[f]=(_||"").replace(/%2F/g,"/"),h},{}),pathname:i,pathnameBase:o,pattern:r}}function o2(r,e=!1,t=!0){Ns(r==="*"||!r.endsWith("*")||r.endsWith("/*"),`Route path "${r}" will be treated as if it were "${r.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${r.replace(/\*$/,"/*")}".`);let n=[],s="^"+r.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,c,u)=>(n.push({paramName:c,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return r.endsWith("*")?(n.push({paramName:"*"}),s+=r==="*"||r==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?s+="\\/*$":r!==""&&r!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),n]}function a2(r){try{return r.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Ns(!1,`The URL path "${r}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),r}}function ui(r,e){if(e==="/")return r;if(!r.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,n=r.charAt(t);return n&&n!=="/"?null:r.slice(t)||"/"}function l2(r,e="/"){let{pathname:t,search:n="",hash:s=""}=typeof r=="string"?Ql(r):r;return{pathname:t?t.startsWith("/")?t:c2(t,e):e,search:d2(n),hash:f2(s)}}function c2(r,e){let t=e.replace(/\/+$/,"").split("/");return r.split("/").forEach(s=>{s===".."?t.length>1&&t.pop():s!=="."&&t.push(s)}),t.length>1?t.join("/"):"/"}function vg(r,e,t,n){return`Cannot include a '${r}' character in a manually specified \`to.${e}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function u2(r){return r.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function aT(r){let e=u2(r);return e.map((t,n)=>n===e.length-1?t.pathname:t.pathnameBase)}function lT(r,e,t,n=!1){let s;typeof r=="string"?s=Ql(r):(s={...r},Ct(!s.pathname||!s.pathname.includes("?"),vg("?","pathname","search",s)),Ct(!s.pathname||!s.pathname.includes("#"),vg("#","pathname","hash",s)),Ct(!s.search||!s.search.includes("#"),vg("#","search","hash",s)));let i=r===""||s.pathname==="",o=i?"/":s.pathname,c;if(o==null)c=t;else{let m=e.length-1;if(!n&&o.startsWith("..")){let y=o.split("/");for(;y[0]==="..";)y.shift(),m-=1;s.pathname=y.join("/")}c=m>=0?e[m]:"/"}let u=l2(s,c),h=o&&o!=="/"&&o.endsWith("/"),f=(i||o===".")&&t.endsWith("/");return!u.pathname.endsWith("/")&&(h||f)&&(u.pathname+="/"),u}var oi=r=>r.join("/").replace(/\/\/+/g,"/"),h2=r=>r.replace(/\/+$/,"").replace(/^\/*/,"/"),d2=r=>!r||r==="?"?"":r.startsWith("?")?r:"?"+r,f2=r=>!r||r==="#"?"":r.startsWith("#")?r:"#"+r;function p2(r){return r!=null&&typeof r.status=="number"&&typeof r.statusText=="string"&&typeof r.internal=="boolean"&&"data"in r}var cT=["POST","PUT","PATCH","DELETE"];new Set(cT);var m2=["GET",...cT];new Set(m2);var Jl=V.createContext(null);Jl.displayName="DataRouter";var ep=V.createContext(null);ep.displayName="DataRouterState";V.createContext(!1);var uT=V.createContext({isTransitioning:!1});uT.displayName="ViewTransition";var g2=V.createContext(new Map);g2.displayName="Fetchers";var y2=V.createContext(null);y2.displayName="Await";var js=V.createContext(null);js.displayName="Navigation";var Qu=V.createContext(null);Qu.displayName="Location";var _i=V.createContext({outlet:null,matches:[],isDataRoute:!1});_i.displayName="Route";var iv=V.createContext(null);iv.displayName="RouteError";function v2(r,{relative:e}={}){Ct(Ju(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:n}=V.useContext(js),{hash:s,pathname:i,search:o}=Zu(r,{relative:e}),c=i;return t!=="/"&&(c=i==="/"?t:oi([t,i])),n.createHref({pathname:c,search:o,hash:s})}function Ju(){return V.useContext(Qu)!=null}function va(){return Ct(Ju(),"useLocation() may be used only in the context of a <Router> component."),V.useContext(Qu).location}var hT="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function dT(r){V.useContext(js).static||V.useLayoutEffect(r)}function fT(){let{isDataRoute:r}=V.useContext(_i);return r?R2():_2()}function _2(){Ct(Ju(),"useNavigate() may be used only in the context of a <Router> component.");let r=V.useContext(Jl),{basename:e,navigator:t}=V.useContext(js),{matches:n}=V.useContext(_i),{pathname:s}=va(),i=JSON.stringify(aT(n)),o=V.useRef(!1);return dT(()=>{o.current=!0}),V.useCallback((u,h={})=>{if(Ns(o.current,hT),!o.current)return;if(typeof u=="number"){t.go(u);return}let f=lT(u,JSON.parse(i),s,h.relative==="path");r==null&&e!=="/"&&(f.pathname=f.pathname==="/"?e:oi([e,f.pathname])),(h.replace?t.replace:t.push)(f,h.state,h)},[e,t,i,s,r])}V.createContext(null);function Zu(r,{relative:e}={}){let{matches:t}=V.useContext(_i),{pathname:n}=va(),s=JSON.stringify(aT(t));return V.useMemo(()=>lT(r,JSON.parse(s),n,e==="path"),[r,s,n,e])}function w2(r,e){return pT(r,e)}function pT(r,e,t,n){Ct(Ju(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s}=V.useContext(js),{matches:i}=V.useContext(_i),o=i[i.length-1],c=o?o.params:{},u=o?o.pathname:"/",h=o?o.pathnameBase:"/",f=o&&o.route;{let x=f&&f.path||"";mT(u,!f||x.endsWith("*")||x.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${u}" (under <Route path="${x}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${x}"> to <Route path="${x==="/"?"*":`${x}/*`}">.`)}let m=va(),y;if(e){let x=typeof e=="string"?Ql(e):e;Ct(h==="/"||x.pathname?.startsWith(h),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${x.pathname}" was given in the \`location\` prop.`),y=x}else y=m;let _=y.pathname||"/",A=_;if(h!=="/"){let x=h.replace(/^\//,"").split("/");A="/"+_.replace(/^\//,"").split("/").slice(x.length).join("/")}let b=sT(r,{pathname:A});Ns(f||b!=null,`No routes matched location "${y.pathname}${y.search}${y.hash}" `),Ns(b==null||b[b.length-1].route.element!==void 0||b[b.length-1].route.Component!==void 0||b[b.length-1].route.lazy!==void 0,`Matched leaf route at location "${y.pathname}${y.search}${y.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let T=S2(b&&b.map(x=>Object.assign({},x,{params:Object.assign({},c,x.params),pathname:oi([h,s.encodeLocation?s.encodeLocation(x.pathname).pathname:x.pathname]),pathnameBase:x.pathnameBase==="/"?h:oi([h,s.encodeLocation?s.encodeLocation(x.pathnameBase).pathname:x.pathnameBase])})),i,t,n);return e&&T?V.createElement(Qu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...y},navigationType:"POP"}},T):T}function E2(){let r=P2(),e=p2(r)?`${r.status} ${r.statusText}`:r instanceof Error?r.message:JSON.stringify(r),t=r instanceof Error?r.stack:null,n="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:n},i={padding:"2px 4px",backgroundColor:n},o=null;return console.error("Error handled by React Router default ErrorBoundary:",r),o=V.createElement(V.Fragment,null,V.createElement("p",null,"💿 Hey developer 👋"),V.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",V.createElement("code",{style:i},"ErrorBoundary")," or"," ",V.createElement("code",{style:i},"errorElement")," prop on your route.")),V.createElement(V.Fragment,null,V.createElement("h2",null,"Unexpected Application Error!"),V.createElement("h3",{style:{fontStyle:"italic"}},e),t?V.createElement("pre",{style:s},t):null,o)}var A2=V.createElement(E2,null),b2=class extends V.Component{constructor(r){super(r),this.state={location:r.location,revalidation:r.revalidation,error:r.error}}static getDerivedStateFromError(r){return{error:r}}static getDerivedStateFromProps(r,e){return e.location!==r.location||e.revalidation!=="idle"&&r.revalidation==="idle"?{error:r.error,location:r.location,revalidation:r.revalidation}:{error:r.error!==void 0?r.error:e.error,location:e.location,revalidation:r.revalidation||e.revalidation}}componentDidCatch(r,e){console.error("React Router caught the following error during render",r,e)}render(){return this.state.error!==void 0?V.createElement(_i.Provider,{value:this.props.routeContext},V.createElement(iv.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function T2({routeContext:r,match:e,children:t}){let n=V.useContext(Jl);return n&&n.static&&n.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=e.route.id),V.createElement(_i.Provider,{value:r},t)}function S2(r,e=[],t=null,n=null){if(r==null){if(!t)return null;if(t.errors)r=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)r=t.matches;else return null}let s=r,i=t?.errors;if(i!=null){let u=s.findIndex(h=>h.route.id&&i?.[h.route.id]!==void 0);Ct(u>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(i).join(",")}`),s=s.slice(0,Math.min(s.length,u+1))}let o=!1,c=-1;if(t)for(let u=0;u<s.length;u++){let h=s[u];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(c=u),h.route.id){let{loaderData:f,errors:m}=t,y=h.route.loader&&!f.hasOwnProperty(h.route.id)&&(!m||m[h.route.id]===void 0);if(h.route.lazy||y){o=!0,c>=0?s=s.slice(0,c+1):s=[s[0]];break}}}return s.reduceRight((u,h,f)=>{let m,y=!1,_=null,A=null;t&&(m=i&&h.route.id?i[h.route.id]:void 0,_=h.route.errorElement||A2,o&&(c<0&&f===0?(mT("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),y=!0,A=null):c===f&&(y=!0,A=h.route.hydrateFallbackElement||null)));let b=e.concat(s.slice(0,f+1)),T=()=>{let x;return m?x=_:y?x=A:h.route.Component?x=V.createElement(h.route.Component,null):h.route.element?x=h.route.element:x=u,V.createElement(T2,{match:h,routeContext:{outlet:u,matches:b,isDataRoute:t!=null},children:x})};return t&&(h.route.ErrorBoundary||h.route.errorElement||f===0)?V.createElement(b2,{location:t.location,revalidation:t.revalidation,component:_,error:m,children:T(),routeContext:{outlet:null,matches:b,isDataRoute:!0}}):T()},null)}function ov(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function x2(r){let e=V.useContext(Jl);return Ct(e,ov(r)),e}function C2(r){let e=V.useContext(ep);return Ct(e,ov(r)),e}function I2(r){let e=V.useContext(_i);return Ct(e,ov(r)),e}function av(r){let e=I2(r),t=e.matches[e.matches.length-1];return Ct(t.route.id,`${r} can only be used on routes that contain a unique "id"`),t.route.id}function k2(){return av("useRouteId")}function P2(){let r=V.useContext(iv),e=C2("useRouteError"),t=av("useRouteError");return r!==void 0?r:e.errors?.[t]}function R2(){let{router:r}=x2("useNavigate"),e=av("useNavigate"),t=V.useRef(!1);return dT(()=>{t.current=!0}),V.useCallback(async(s,i={})=>{Ns(t.current,hT),t.current&&(typeof s=="number"?r.navigate(s):await r.navigate(s,{fromRouteId:e,...i}))},[r,e])}var x1={};function mT(r,e,t){!e&&!x1[r]&&(x1[r]=!0,Ns(!1,t))}V.memo(D2);function D2({routes:r,future:e,state:t}){return pT(r,void 0,t,e)}function ry(r){Ct(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function L2({basename:r="/",children:e=null,location:t,navigationType:n="POP",navigator:s,static:i=!1}){Ct(!Ju(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=r.replace(/^\/*/,"/"),c=V.useMemo(()=>({basename:o,navigator:s,static:i,future:{}}),[o,s,i]);typeof t=="string"&&(t=Ql(t));let{pathname:u="/",search:h="",hash:f="",state:m=null,key:y="default"}=t,_=V.useMemo(()=>{let A=ui(u,o);return A==null?null:{location:{pathname:A,search:h,hash:f,state:m,key:y},navigationType:n}},[o,u,h,f,m,y,n]);return Ns(_!=null,`<Router basename="${o}"> is not able to match the URL "${u}${h}${f}" because it does not start with the basename, so the <Router> won't render anything.`),_==null?null:V.createElement(js.Provider,{value:c},V.createElement(Qu.Provider,{children:e,value:_}))}function M2({children:r,location:e}){return w2(sy(r),e)}function sy(r,e=[]){let t=[];return V.Children.forEach(r,(n,s)=>{if(!V.isValidElement(n))return;let i=[...e,s];if(n.type===V.Fragment){t.push.apply(t,sy(n.props.children,i));return}Ct(n.type===ry,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Ct(!n.props.index||!n.props.children,"An index route cannot have child routes.");let o={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=sy(n.props.children,i)),t.push(o)}),t}var rf="get",sf="application/x-www-form-urlencoded";function tp(r){return r!=null&&typeof r.tagName=="string"}function N2(r){return tp(r)&&r.tagName.toLowerCase()==="button"}function O2(r){return tp(r)&&r.tagName.toLowerCase()==="form"}function F2(r){return tp(r)&&r.tagName.toLowerCase()==="input"}function V2(r){return!!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)}function j2(r,e){return r.button===0&&(!e||e==="_self")&&!V2(r)}var Vd=null;function B2(){if(Vd===null)try{new FormData(document.createElement("form"),0),Vd=!1}catch{Vd=!0}return Vd}var U2=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function _g(r){return r!=null&&!U2.has(r)?(Ns(!1,`"${r}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${sf}"`),null):r}function z2(r,e){let t,n,s,i,o;if(O2(r)){let c=r.getAttribute("action");n=c?ui(c,e):null,t=r.getAttribute("method")||rf,s=_g(r.getAttribute("enctype"))||sf,i=new FormData(r)}else if(N2(r)||F2(r)&&(r.type==="submit"||r.type==="image")){let c=r.form;if(c==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let u=r.getAttribute("formaction")||c.getAttribute("action");if(n=u?ui(u,e):null,t=r.getAttribute("formmethod")||c.getAttribute("method")||rf,s=_g(r.getAttribute("formenctype"))||_g(c.getAttribute("enctype"))||sf,i=new FormData(c,r),!B2()){let{name:h,type:f,value:m}=r;if(f==="image"){let y=h?`${h}.`:"";i.append(`${y}x`,"0"),i.append(`${y}y`,"0")}else h&&i.append(h,m)}}else{if(tp(r))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=rf,n=null,s=sf,o=r}return i&&s==="text/plain"&&(o=i,i=void 0),{action:n,method:t.toLowerCase(),encType:s,formData:i,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function lv(r,e){if(r===!1||r===null||typeof r>"u")throw new Error(e)}function $2(r,e,t){let n=typeof r=="string"?new URL(r,typeof window>"u"?"server://singlefetch/":window.location.origin):r;return n.pathname==="/"?n.pathname=`_root.${t}`:e&&ui(n.pathname,e)==="/"?n.pathname=`${e.replace(/\/$/,"")}/_root.${t}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${t}`,n}async function H2(r,e){if(r.id in e)return e[r.id];try{let t=await import(r.module);return e[r.id]=t,t}catch(t){return console.error(`Error loading route module \`${r.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function W2(r){return r==null?!1:r.href==null?r.rel==="preload"&&typeof r.imageSrcSet=="string"&&typeof r.imageSizes=="string":typeof r.rel=="string"&&typeof r.href=="string"}async function G2(r,e,t){let n=await Promise.all(r.map(async s=>{let i=e.routes[s.route.id];if(i){let o=await H2(i,t);return o.links?o.links():[]}return[]}));return Y2(n.flat(1).filter(W2).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function C1(r,e,t,n,s,i){let o=(u,h)=>t[h]?u.route.id!==t[h].route.id:!0,c=(u,h)=>t[h].pathname!==u.pathname||t[h].route.path?.endsWith("*")&&t[h].params["*"]!==u.params["*"];return i==="assets"?e.filter((u,h)=>o(u,h)||c(u,h)):i==="data"?e.filter((u,h)=>{let f=n.routes[u.route.id];if(!f||!f.hasLoader)return!1;if(o(u,h)||c(u,h))return!0;if(u.route.shouldRevalidate){let m=u.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(r,window.origin),nextParams:u.params,defaultShouldRevalidate:!0});if(typeof m=="boolean")return m}return!0}):[]}function q2(r,e,{includeHydrateFallback:t}={}){return K2(r.map(n=>{let s=e.routes[n.route.id];if(!s)return[];let i=[s.module];return s.clientActionModule&&(i=i.concat(s.clientActionModule)),s.clientLoaderModule&&(i=i.concat(s.clientLoaderModule)),t&&s.hydrateFallbackModule&&(i=i.concat(s.hydrateFallbackModule)),s.imports&&(i=i.concat(s.imports)),i}).flat(1))}function K2(r){return[...new Set(r)]}function X2(r){let e={},t=Object.keys(r).sort();for(let n of t)e[n]=r[n];return e}function Y2(r,e){let t=new Set;return new Set(e),r.reduce((n,s)=>{let i=JSON.stringify(X2(s));return t.has(i)||(t.add(i),n.push({key:i,link:s})),n},[])}function gT(){let r=V.useContext(Jl);return lv(r,"You must render this element inside a <DataRouterContext.Provider> element"),r}function Q2(){let r=V.useContext(ep);return lv(r,"You must render this element inside a <DataRouterStateContext.Provider> element"),r}var cv=V.createContext(void 0);cv.displayName="FrameworkContext";function yT(){let r=V.useContext(cv);return lv(r,"You must render this element inside a <HydratedRouter> element"),r}function J2(r,e){let t=V.useContext(cv),[n,s]=V.useState(!1),[i,o]=V.useState(!1),{onFocus:c,onBlur:u,onMouseEnter:h,onMouseLeave:f,onTouchStart:m}=e,y=V.useRef(null);V.useEffect(()=>{if(r==="render"&&o(!0),r==="viewport"){let b=x=>{x.forEach(M=>{o(M.isIntersecting)})},T=new IntersectionObserver(b,{threshold:.5});return y.current&&T.observe(y.current),()=>{T.disconnect()}}},[r]),V.useEffect(()=>{if(n){let b=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(b)}}},[n]);let _=()=>{s(!0)},A=()=>{s(!1),o(!1)};return t?r!=="intent"?[i,y,{}]:[i,y,{onFocus:Zc(c,_),onBlur:Zc(u,A),onMouseEnter:Zc(h,_),onMouseLeave:Zc(f,A),onTouchStart:Zc(m,_)}]:[!1,y,{}]}function Zc(r,e){return t=>{r&&r(t),t.defaultPrevented||e(t)}}function Z2({page:r,...e}){let{router:t}=gT(),n=V.useMemo(()=>sT(t.routes,r,t.basename),[t.routes,r,t.basename]);return n?V.createElement(tR,{page:r,matches:n,...e}):null}function eR(r){let{manifest:e,routeModules:t}=yT(),[n,s]=V.useState([]);return V.useEffect(()=>{let i=!1;return G2(r,e,t).then(o=>{i||s(o)}),()=>{i=!0}},[r,e,t]),n}function tR({page:r,matches:e,...t}){let n=va(),{manifest:s,routeModules:i}=yT(),{basename:o}=gT(),{loaderData:c,matches:u}=Q2(),h=V.useMemo(()=>C1(r,e,u,s,n,"data"),[r,e,u,s,n]),f=V.useMemo(()=>C1(r,e,u,s,n,"assets"),[r,e,u,s,n]),m=V.useMemo(()=>{if(r===n.pathname+n.search+n.hash)return[];let A=new Set,b=!1;if(e.forEach(x=>{let M=s.routes[x.route.id];!M||!M.hasLoader||(!h.some(R=>R.route.id===x.route.id)&&x.route.id in c&&i[x.route.id]?.shouldRevalidate||M.hasClientLoader?b=!0:A.add(x.route.id))}),A.size===0)return[];let T=$2(r,o,"data");return b&&A.size>0&&T.searchParams.set("_routes",e.filter(x=>A.has(x.route.id)).map(x=>x.route.id).join(",")),[T.pathname+T.search]},[o,c,n,s,h,e,r,i]),y=V.useMemo(()=>q2(f,s),[f,s]),_=eR(f);return V.createElement(V.Fragment,null,m.map(A=>V.createElement("link",{key:A,rel:"prefetch",as:"fetch",href:A,...t})),y.map(A=>V.createElement("link",{key:A,rel:"modulepreload",href:A,...t})),_.map(({key:A,link:b})=>V.createElement("link",{key:A,nonce:t.nonce,...b})))}function nR(...r){return e=>{r.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var vT=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{vT&&(window.__reactRouterVersion="7.8.0")}catch{}function rR({basename:r,children:e,window:t}){let n=V.useRef();n.current==null&&(n.current=WP({window:t,v5Compat:!0}));let s=n.current,[i,o]=V.useState({action:s.action,location:s.location}),c=V.useCallback(u=>{V.startTransition(()=>o(u))},[o]);return V.useLayoutEffect(()=>s.listen(c),[s,c]),V.createElement(L2,{basename:r,children:e,location:i.location,navigationType:i.action,navigator:s})}var _T=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,wT=V.forwardRef(function({onClick:e,discover:t="render",prefetch:n="none",relative:s,reloadDocument:i,replace:o,state:c,target:u,to:h,preventScrollReset:f,viewTransition:m,...y},_){let{basename:A}=V.useContext(js),b=typeof h=="string"&&_T.test(h),T,x=!1;if(typeof h=="string"&&b&&(T=h,vT))try{let P=new URL(window.location.href),N=h.startsWith("//")?new URL(P.protocol+h):new URL(h),j=ui(N.pathname,A);N.origin===P.origin&&j!=null?h=j+N.search+N.hash:x=!0}catch{Ns(!1,`<Link to="${h}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let M=v2(h,{relative:s}),[R,B,O]=J2(n,y),$=aR(h,{replace:o,state:c,target:u,preventScrollReset:f,relative:s,viewTransition:m});function k(P){e&&e(P),P.defaultPrevented||$(P)}let C=V.createElement("a",{...y,...O,href:T||M,onClick:x||i?e:k,ref:nR(_,B),target:u,"data-discover":!b&&t==="render"?"true":void 0});return R&&!b?V.createElement(V.Fragment,null,C,V.createElement(Z2,{page:M})):C});wT.displayName="Link";var sR=V.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:n="",end:s=!1,style:i,to:o,viewTransition:c,children:u,...h},f){let m=Zu(o,{relative:h.relative}),y=va(),_=V.useContext(ep),{navigator:A,basename:b}=V.useContext(js),T=_!=null&&dR(m)&&c===!0,x=A.encodeLocation?A.encodeLocation(m).pathname:m.pathname,M=y.pathname,R=_&&_.navigation&&_.navigation.location?_.navigation.location.pathname:null;t||(M=M.toLowerCase(),R=R?R.toLowerCase():null,x=x.toLowerCase()),R&&b&&(R=ui(R,b)||R);const B=x!=="/"&&x.endsWith("/")?x.length-1:x.length;let O=M===x||!s&&M.startsWith(x)&&M.charAt(B)==="/",$=R!=null&&(R===x||!s&&R.startsWith(x)&&R.charAt(x.length)==="/"),k={isActive:O,isPending:$,isTransitioning:T},C=O?e:void 0,P;typeof n=="function"?P=n(k):P=[n,O?"active":null,$?"pending":null,T?"transitioning":null].filter(Boolean).join(" ");let N=typeof i=="function"?i(k):i;return V.createElement(wT,{...h,"aria-current":C,className:P,ref:f,style:N,to:o,viewTransition:c},typeof u=="function"?u(k):u)});sR.displayName="NavLink";var iR=V.forwardRef(({discover:r="render",fetcherKey:e,navigate:t,reloadDocument:n,replace:s,state:i,method:o=rf,action:c,onSubmit:u,relative:h,preventScrollReset:f,viewTransition:m,...y},_)=>{let A=uR(),b=hR(c,{relative:h}),T=o.toLowerCase()==="get"?"get":"post",x=typeof c=="string"&&_T.test(c),M=R=>{if(u&&u(R),R.defaultPrevented)return;R.preventDefault();let B=R.nativeEvent.submitter,O=B?.getAttribute("formmethod")||o;A(B||R.currentTarget,{fetcherKey:e,method:O,navigate:t,replace:s,state:i,relative:h,preventScrollReset:f,viewTransition:m})};return V.createElement("form",{ref:_,method:T,action:b,onSubmit:n?u:M,...y,"data-discover":!x&&r==="render"?"true":void 0})});iR.displayName="Form";function oR(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function ET(r){let e=V.useContext(Jl);return Ct(e,oR(r)),e}function aR(r,{target:e,replace:t,state:n,preventScrollReset:s,relative:i,viewTransition:o}={}){let c=fT(),u=va(),h=Zu(r,{relative:i});return V.useCallback(f=>{if(j2(f,e)){f.preventDefault();let m=t!==void 0?t:ku(u)===ku(h);c(r,{replace:m,state:n,preventScrollReset:s,relative:i,viewTransition:o})}},[u,c,h,t,n,e,r,s,i,o])}var lR=0,cR=()=>`__${String(++lR)}__`;function uR(){let{router:r}=ET("useSubmit"),{basename:e}=V.useContext(js),t=k2();return V.useCallback(async(n,s={})=>{let{action:i,method:o,encType:c,formData:u,body:h}=z2(n,e);if(s.navigate===!1){let f=s.fetcherKey||cR();await r.fetch(f,t,s.action||i,{preventScrollReset:s.preventScrollReset,formData:u,body:h,formMethod:s.method||o,formEncType:s.encType||c,flushSync:s.flushSync})}else await r.navigate(s.action||i,{preventScrollReset:s.preventScrollReset,formData:u,body:h,formMethod:s.method||o,formEncType:s.encType||c,replace:s.replace,state:s.state,fromRouteId:t,flushSync:s.flushSync,viewTransition:s.viewTransition})},[r,e,t])}function hR(r,{relative:e}={}){let{basename:t}=V.useContext(js),n=V.useContext(_i);Ct(n,"useFormAction must be used inside a RouteContext");let[s]=n.matches.slice(-1),i={...Zu(r||".",{relative:e})},o=va();if(r==null){i.search=o.search;let c=new URLSearchParams(i.search),u=c.getAll("index");if(u.some(f=>f==="")){c.delete("index"),u.filter(m=>m).forEach(m=>c.append("index",m));let f=c.toString();i.search=f?`?${f}`:""}}return(!r||r===".")&&s.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(i.pathname=i.pathname==="/"?t:oi([t,i.pathname])),ku(i)}function dR(r,{relative:e}={}){let t=V.useContext(uT);Ct(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=ET("useViewTransitionState"),s=Zu(r,{relative:e});if(!t.isTransitioning)return!1;let i=ui(t.currentLocation.pathname,n)||t.currentLocation.pathname,o=ui(t.nextLocation.pathname,n)||t.nextLocation.pathname;return Ef(s.pathname,o)!=null||Ef(s.pathname,i)!=null}const fR=()=>{};var I1={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AT=function(r){const e=[];let t=0;for(let n=0;n<r.length;n++){let s=r.charCodeAt(n);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&n+1<r.length&&(r.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(r.charCodeAt(++n)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},pR=function(r){const e=[];let t=0,n=0;for(;t<r.length;){const s=r[t++];if(s<128)e[n++]=String.fromCharCode(s);else if(s>191&&s<224){const i=r[t++];e[n++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=r[t++],o=r[t++],c=r[t++],u=((s&7)<<18|(i&63)<<12|(o&63)<<6|c&63)-65536;e[n++]=String.fromCharCode(55296+(u>>10)),e[n++]=String.fromCharCode(56320+(u&1023))}else{const i=r[t++],o=r[t++];e[n++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},bT={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(r,e){if(!Array.isArray(r))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<r.length;s+=3){const i=r[s],o=s+1<r.length,c=o?r[s+1]:0,u=s+2<r.length,h=u?r[s+2]:0,f=i>>2,m=(i&3)<<4|c>>4;let y=(c&15)<<2|h>>6,_=h&63;u||(_=64,o||(y=64)),n.push(t[f],t[m],t[y],t[_])}return n.join("")},encodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(r):this.encodeByteArray(AT(r),e)},decodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(r):pR(this.decodeStringToByteArray(r,e))},decodeStringToByteArray(r,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<r.length;){const i=t[r.charAt(s++)],c=s<r.length?t[r.charAt(s)]:0;++s;const h=s<r.length?t[r.charAt(s)]:64;++s;const m=s<r.length?t[r.charAt(s)]:64;if(++s,i==null||c==null||h==null||m==null)throw new mR;const y=i<<2|c>>4;if(n.push(y),h!==64){const _=c<<4&240|h>>2;if(n.push(_),m!==64){const A=h<<6&192|m;n.push(A)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let r=0;r<this.ENCODED_VALS.length;r++)this.byteToCharMap_[r]=this.ENCODED_VALS.charAt(r),this.charToByteMap_[this.byteToCharMap_[r]]=r,this.byteToCharMapWebSafe_[r]=this.ENCODED_VALS_WEBSAFE.charAt(r),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[r]]=r,r>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(r)]=r,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(r)]=r)}}};class mR extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const gR=function(r){const e=AT(r);return bT.encodeByteArray(e,!0)},Af=function(r){return gR(r).replace(/\./g,"")},TT=function(r){try{return bT.decodeString(r,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yR(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vR=()=>yR().__FIREBASE_DEFAULTS__,_R=()=>{if(typeof process>"u"||typeof I1>"u")return;const r=I1.__FIREBASE_DEFAULTS__;if(r)return JSON.parse(r)},wR=()=>{if(typeof document>"u")return;let r;try{r=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=r&&TT(r[1]);return e&&JSON.parse(e)},np=()=>{try{return fR()||vR()||_R()||wR()}catch(r){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${r}`);return}},ST=r=>np()?.emulatorHosts?.[r],xT=r=>{const e=ST(r);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),n]:[e.substring(0,t),n]},CT=()=>np()?.config,IT=r=>np()?.[`_${r}`];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ER{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _a(r){try{return(r.startsWith("http://")||r.startsWith("https://")?new URL(r).hostname:r).endsWith(".cloudworkstations.dev")}catch{return!1}}async function uv(r){return(await fetch(r,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kT(r,e){if(r.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},n=e||"demo-project",s=r.iat||0,i=r.sub||r.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...r};return[Af(JSON.stringify(t)),Af(JSON.stringify(o)),""].join(".")}const yu={};function AR(){const r={prod:[],emulator:[]};for(const e of Object.keys(yu))yu[e]?r.emulator.push(e):r.prod.push(e);return r}function bR(r){let e=document.getElementById(r),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",r),t=!0),{created:t,element:e}}let k1=!1;function hv(r,e){if(typeof window>"u"||typeof document>"u"||!_a(window.location.host)||yu[r]===e||yu[r]||k1)return;yu[r]=e;function t(y){return`__firebase__banner__${y}`}const n="__firebase__banner",i=AR().prod.length>0;function o(){const y=document.getElementById(n);y&&y.remove()}function c(y){y.style.display="flex",y.style.background="#7faaf0",y.style.position="fixed",y.style.bottom="5px",y.style.left="5px",y.style.padding=".5em",y.style.borderRadius="5px",y.style.alignItems="center"}function u(y,_){y.setAttribute("width","24"),y.setAttribute("id",_),y.setAttribute("height","24"),y.setAttribute("viewBox","0 0 24 24"),y.setAttribute("fill","none"),y.style.marginLeft="-6px"}function h(){const y=document.createElement("span");return y.style.cursor="pointer",y.style.marginLeft="16px",y.style.fontSize="24px",y.innerHTML=" &times;",y.onclick=()=>{k1=!0,o()},y}function f(y,_){y.setAttribute("id",_),y.innerText="Learn more",y.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",y.setAttribute("target","__blank"),y.style.paddingLeft="5px",y.style.textDecoration="underline"}function m(){const y=bR(n),_=t("text"),A=document.getElementById(_)||document.createElement("span"),b=t("learnmore"),T=document.getElementById(b)||document.createElement("a"),x=t("preprendIcon"),M=document.getElementById(x)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(y.created){const R=y.element;c(R),f(T,b);const B=h();u(M,x),R.append(M,A,T,B),document.body.appendChild(R)}i?(A.innerText="Preview backend disconnected.",M.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(M.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,A.innerText="Preview backend running in this workspace."),A.setAttribute("id",_)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",m):m()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function TR(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Dn())}function SR(){const r=np()?.forceEnvironment;if(r==="node")return!0;if(r==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function xR(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function CR(){const r=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof r=="object"&&r.id!==void 0}function IR(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function kR(){const r=Dn();return r.indexOf("MSIE ")>=0||r.indexOf("Trident/")>=0}function PR(){return!SR()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function RR(){try{return typeof indexedDB=="object"}catch{return!1}}function DR(){return new Promise((r,e)=>{try{let t=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(n),r(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{e(s.error?.message||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LR="FirebaseError";class Bs extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name=LR,Object.setPrototypeOf(this,Bs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,eh.prototype.create)}}class eh{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?MR(i,n):"Error",c=`${this.serviceName}: ${o} (${s}).`;return new Bs(s,c,n)}}function MR(r,e){return r.replace(NR,(t,n)=>{const s=e[n];return s!=null?String(s):`<${n}?>`})}const NR=/\{\$([^}]+)}/g;function OR(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}function ua(r,e){if(r===e)return!0;const t=Object.keys(r),n=Object.keys(e);for(const s of t){if(!n.includes(s))return!1;const i=r[s],o=e[s];if(P1(i)&&P1(o)){if(!ua(i,o))return!1}else if(i!==o)return!1}for(const s of n)if(!t.includes(s))return!1;return!0}function P1(r){return r!==null&&typeof r=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function th(r){const e=[];for(const[t,n]of Object.entries(r))Array.isArray(n)?n.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function iu(r){const e={};return r.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[s,i]=n.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function ou(r){const e=r.indexOf("?");if(!e)return"";const t=r.indexOf("#",e);return r.substring(e,t>0?t:void 0)}function FR(r,e){const t=new VR(r,e);return t.subscribe.bind(t)}class VR{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let s;if(e===void 0&&t===void 0&&n===void 0)throw new Error("Missing Observer.");jR(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:n},s.next===void 0&&(s.next=wg),s.error===void 0&&(s.error=wg),s.complete===void 0&&(s.complete=wg);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function jR(r,e){if(typeof r!="object"||r===null)return!1;for(const t of e)if(t in r&&typeof r[t]=="function")return!0;return!1}function wg(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jn(r){return r&&r._delegate?r._delegate:r}class oo{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jo="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BR{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const n=new ER;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(s){if(n)return null;throw s}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(zR(e))try{this.getOrInitializeService({instanceIdentifier:Jo})}catch{}for(const[t,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:s});n.resolve(i)}catch{}}}}clearInstance(e=Jo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Jo){return this.instances.has(e)}getOptions(e=Jo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[i,o]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(i);n===c&&o.resolve(s)}return s}onInit(e,t){const n=this.normalizeInstanceIdentifier(t),s=this.onInitCallbacks.get(n)??new Set;s.add(e),this.onInitCallbacks.set(n,s);const i=this.instances.get(n);return i&&e(i,n),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const s of n)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:UR(e),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Jo){return this.component?this.component.multipleInstances?e:Jo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function UR(r){return r===Jo?void 0:r}function zR(r){return r.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $R{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new BR(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ge;(function(r){r[r.DEBUG=0]="DEBUG",r[r.VERBOSE=1]="VERBOSE",r[r.INFO=2]="INFO",r[r.WARN=3]="WARN",r[r.ERROR=4]="ERROR",r[r.SILENT=5]="SILENT"})(Ge||(Ge={}));const HR={debug:Ge.DEBUG,verbose:Ge.VERBOSE,info:Ge.INFO,warn:Ge.WARN,error:Ge.ERROR,silent:Ge.SILENT},WR=Ge.INFO,GR={[Ge.DEBUG]:"log",[Ge.VERBOSE]:"log",[Ge.INFO]:"info",[Ge.WARN]:"warn",[Ge.ERROR]:"error"},qR=(r,e,...t)=>{if(e<r.logLevel)return;const n=new Date().toISOString(),s=GR[e];if(s)console[s](`[${n}]  ${r.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class dv{constructor(e){this.name=e,this._logLevel=WR,this._logHandler=qR,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ge))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?HR[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ge.DEBUG,...e),this._logHandler(this,Ge.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ge.VERBOSE,...e),this._logHandler(this,Ge.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ge.INFO,...e),this._logHandler(this,Ge.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ge.WARN,...e),this._logHandler(this,Ge.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ge.ERROR,...e),this._logHandler(this,Ge.ERROR,...e)}}const KR=(r,e)=>e.some(t=>r instanceof t);let R1,D1;function XR(){return R1||(R1=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function YR(){return D1||(D1=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const PT=new WeakMap,iy=new WeakMap,RT=new WeakMap,Eg=new WeakMap,fv=new WeakMap;function QR(r){const e=new Promise((t,n)=>{const s=()=>{r.removeEventListener("success",i),r.removeEventListener("error",o)},i=()=>{t(Zi(r.result)),s()},o=()=>{n(r.error),s()};r.addEventListener("success",i),r.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&PT.set(t,r)}).catch(()=>{}),fv.set(e,r),e}function JR(r){if(iy.has(r))return;const e=new Promise((t,n)=>{const s=()=>{r.removeEventListener("complete",i),r.removeEventListener("error",o),r.removeEventListener("abort",o)},i=()=>{t(),s()},o=()=>{n(r.error||new DOMException("AbortError","AbortError")),s()};r.addEventListener("complete",i),r.addEventListener("error",o),r.addEventListener("abort",o)});iy.set(r,e)}let oy={get(r,e,t){if(r instanceof IDBTransaction){if(e==="done")return iy.get(r);if(e==="objectStoreNames")return r.objectStoreNames||RT.get(r);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Zi(r[e])},set(r,e,t){return r[e]=t,!0},has(r,e){return r instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in r}};function ZR(r){oy=r(oy)}function eD(r){return r===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const n=r.call(Ag(this),e,...t);return RT.set(n,e.sort?e.sort():[e]),Zi(n)}:YR().includes(r)?function(...e){return r.apply(Ag(this),e),Zi(PT.get(this))}:function(...e){return Zi(r.apply(Ag(this),e))}}function tD(r){return typeof r=="function"?eD(r):(r instanceof IDBTransaction&&JR(r),KR(r,XR())?new Proxy(r,oy):r)}function Zi(r){if(r instanceof IDBRequest)return QR(r);if(Eg.has(r))return Eg.get(r);const e=tD(r);return e!==r&&(Eg.set(r,e),fv.set(e,r)),e}const Ag=r=>fv.get(r);function nD(r,e,{blocked:t,upgrade:n,blocking:s,terminated:i}={}){const o=indexedDB.open(r,e),c=Zi(o);return n&&o.addEventListener("upgradeneeded",u=>{n(Zi(o.result),u.oldVersion,u.newVersion,Zi(o.transaction),u)}),t&&o.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),c.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",h=>s(h.oldVersion,h.newVersion,h))}).catch(()=>{}),c}const rD=["get","getKey","getAll","getAllKeys","count"],sD=["put","add","delete","clear"],bg=new Map;function L1(r,e){if(!(r instanceof IDBDatabase&&!(e in r)&&typeof e=="string"))return;if(bg.get(e))return bg.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,s=sD.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(s||rD.includes(t)))return;const i=async function(o,...c){const u=this.transaction(o,s?"readwrite":"readonly");let h=u.store;return n&&(h=h.index(c.shift())),(await Promise.all([h[t](...c),s&&u.done]))[0]};return bg.set(e,i),i}ZR(r=>({...r,get:(e,t,n)=>L1(e,t)||r.get(e,t,n),has:(e,t)=>!!L1(e,t)||r.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iD{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(oD(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(t=>t).join(" ")}}function oD(r){return r.getComponent()?.type==="VERSION"}const ay="@firebase/app",M1="0.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hi=new dv("@firebase/app"),aD="@firebase/app-compat",lD="@firebase/analytics-compat",cD="@firebase/analytics",uD="@firebase/app-check-compat",hD="@firebase/app-check",dD="@firebase/auth",fD="@firebase/auth-compat",pD="@firebase/database",mD="@firebase/data-connect",gD="@firebase/database-compat",yD="@firebase/functions",vD="@firebase/functions-compat",_D="@firebase/installations",wD="@firebase/installations-compat",ED="@firebase/messaging",AD="@firebase/messaging-compat",bD="@firebase/performance",TD="@firebase/performance-compat",SD="@firebase/remote-config",xD="@firebase/remote-config-compat",CD="@firebase/storage",ID="@firebase/storage-compat",kD="@firebase/firestore",PD="@firebase/ai",RD="@firebase/firestore-compat",DD="firebase",LD="12.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ly="[DEFAULT]",MD={[ay]:"fire-core",[aD]:"fire-core-compat",[cD]:"fire-analytics",[lD]:"fire-analytics-compat",[hD]:"fire-app-check",[uD]:"fire-app-check-compat",[dD]:"fire-auth",[fD]:"fire-auth-compat",[pD]:"fire-rtdb",[mD]:"fire-data-connect",[gD]:"fire-rtdb-compat",[yD]:"fire-fn",[vD]:"fire-fn-compat",[_D]:"fire-iid",[wD]:"fire-iid-compat",[ED]:"fire-fcm",[AD]:"fire-fcm-compat",[bD]:"fire-perf",[TD]:"fire-perf-compat",[SD]:"fire-rc",[xD]:"fire-rc-compat",[CD]:"fire-gcs",[ID]:"fire-gcs-compat",[kD]:"fire-fst",[RD]:"fire-fst-compat",[PD]:"fire-vertex","fire-js":"fire-js",[DD]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pu=new Map,ND=new Map,cy=new Map;function N1(r,e){try{r.container.addComponent(e)}catch(t){hi.debug(`Component ${e.name} failed to register with FirebaseApp ${r.name}`,t)}}function ha(r){const e=r.name;if(cy.has(e))return hi.debug(`There were multiple attempts to register component ${e}.`),!1;cy.set(e,r);for(const t of Pu.values())N1(t,r);for(const t of ND.values())N1(t,r);return!0}function rp(r,e){const t=r.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),r.container.getProvider(e)}function Ir(r){return r==null?!1:r.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OD={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},eo=new eh("app","Firebase",OD);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FD{constructor(e,t,n){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new oo("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw eo.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wa=LD;function DT(r,e={}){let t=r;typeof e!="object"&&(e={name:e});const n={name:ly,automaticDataCollectionEnabled:!0,...e},s=n.name;if(typeof s!="string"||!s)throw eo.create("bad-app-name",{appName:String(s)});if(t||(t=CT()),!t)throw eo.create("no-options");const i=Pu.get(s);if(i){if(ua(t,i.options)&&ua(n,i.config))return i;throw eo.create("duplicate-app",{appName:s})}const o=new $R(s);for(const u of cy.values())o.addComponent(u);const c=new FD(t,n,o);return Pu.set(s,c),c}function pv(r=ly){const e=Pu.get(r);if(!e&&r===ly&&CT())return DT();if(!e)throw eo.create("no-app",{appName:r});return e}function O1(){return Array.from(Pu.values())}function xs(r,e,t){let n=MD[r]??r;t&&(n+=`-${t}`);const s=n.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const o=[`Unable to register library "${n}" with version "${e}":`];s&&o.push(`library name "${n}" contains illegal characters (whitespace or "/")`),s&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),hi.warn(o.join(" "));return}ha(new oo(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VD="firebase-heartbeat-database",jD=1,Ru="firebase-heartbeat-store";let Tg=null;function LT(){return Tg||(Tg=nD(VD,jD,{upgrade:(r,e)=>{switch(e){case 0:try{r.createObjectStore(Ru)}catch(t){console.warn(t)}}}}).catch(r=>{throw eo.create("idb-open",{originalErrorMessage:r.message})})),Tg}async function BD(r){try{const t=(await LT()).transaction(Ru),n=await t.objectStore(Ru).get(MT(r));return await t.done,n}catch(e){if(e instanceof Bs)hi.warn(e.message);else{const t=eo.create("idb-get",{originalErrorMessage:e?.message});hi.warn(t.message)}}}async function F1(r,e){try{const n=(await LT()).transaction(Ru,"readwrite");await n.objectStore(Ru).put(e,MT(r)),await n.done}catch(t){if(t instanceof Bs)hi.warn(t.message);else{const n=eo.create("idb-set",{originalErrorMessage:t?.message});hi.warn(n.message)}}}function MT(r){return`${r.name}!${r.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UD=1024,zD=30;class $D{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new WD(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=V1();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(s=>s.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:t}),this._heartbeatsCache.heartbeats.length>zD){const s=GD(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(s,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){hi.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=V1(),{heartbeatsToSend:t,unsentEntries:n}=HD(this._heartbeatsCache.heartbeats),s=Af(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(e){return hi.warn(e),""}}}function V1(){return new Date().toISOString().substring(0,10)}function HD(r,e=UD){const t=[];let n=r.slice();for(const s of r){const i=t.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),j1(t)>e){i.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),j1(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}class WD{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return RR()?DR().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await BD(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return F1(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return F1(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function j1(r){return Af(JSON.stringify({version:2,heartbeats:r})).length}function GD(r){if(r.length===0)return-1;let e=0,t=r[0].date;for(let n=1;n<r.length;n++)r[n].date<t&&(t=r[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qD(r){ha(new oo("platform-logger",e=>new iD(e),"PRIVATE")),ha(new oo("heartbeat",e=>new $D(e),"PRIVATE")),xs(ay,M1,r),xs(ay,M1,"esm2020"),xs("fire-js","")}qD("");var KD="firebase",XD="12.1.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */xs(KD,XD,"app");var B1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var to,NT;(function(){var r;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(k,C){function P(){}P.prototype=C.prototype,k.D=C.prototype,k.prototype=new P,k.prototype.constructor=k,k.C=function(N,j,z){for(var F=Array(arguments.length-2),ue=2;ue<arguments.length;ue++)F[ue-2]=arguments[ue];return C.prototype[j].apply(N,F)}}function t(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,t),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(k,C,P){P||(P=0);var N=Array(16);if(typeof C=="string")for(var j=0;16>j;++j)N[j]=C.charCodeAt(P++)|C.charCodeAt(P++)<<8|C.charCodeAt(P++)<<16|C.charCodeAt(P++)<<24;else for(j=0;16>j;++j)N[j]=C[P++]|C[P++]<<8|C[P++]<<16|C[P++]<<24;C=k.g[0],P=k.g[1],j=k.g[2];var z=k.g[3],F=C+(z^P&(j^z))+N[0]+3614090360&4294967295;C=P+(F<<7&4294967295|F>>>25),F=z+(j^C&(P^j))+N[1]+3905402710&4294967295,z=C+(F<<12&4294967295|F>>>20),F=j+(P^z&(C^P))+N[2]+606105819&4294967295,j=z+(F<<17&4294967295|F>>>15),F=P+(C^j&(z^C))+N[3]+3250441966&4294967295,P=j+(F<<22&4294967295|F>>>10),F=C+(z^P&(j^z))+N[4]+4118548399&4294967295,C=P+(F<<7&4294967295|F>>>25),F=z+(j^C&(P^j))+N[5]+1200080426&4294967295,z=C+(F<<12&4294967295|F>>>20),F=j+(P^z&(C^P))+N[6]+2821735955&4294967295,j=z+(F<<17&4294967295|F>>>15),F=P+(C^j&(z^C))+N[7]+4249261313&4294967295,P=j+(F<<22&4294967295|F>>>10),F=C+(z^P&(j^z))+N[8]+1770035416&4294967295,C=P+(F<<7&4294967295|F>>>25),F=z+(j^C&(P^j))+N[9]+2336552879&4294967295,z=C+(F<<12&4294967295|F>>>20),F=j+(P^z&(C^P))+N[10]+4294925233&4294967295,j=z+(F<<17&4294967295|F>>>15),F=P+(C^j&(z^C))+N[11]+2304563134&4294967295,P=j+(F<<22&4294967295|F>>>10),F=C+(z^P&(j^z))+N[12]+1804603682&4294967295,C=P+(F<<7&4294967295|F>>>25),F=z+(j^C&(P^j))+N[13]+4254626195&4294967295,z=C+(F<<12&4294967295|F>>>20),F=j+(P^z&(C^P))+N[14]+2792965006&4294967295,j=z+(F<<17&4294967295|F>>>15),F=P+(C^j&(z^C))+N[15]+1236535329&4294967295,P=j+(F<<22&4294967295|F>>>10),F=C+(j^z&(P^j))+N[1]+4129170786&4294967295,C=P+(F<<5&4294967295|F>>>27),F=z+(P^j&(C^P))+N[6]+3225465664&4294967295,z=C+(F<<9&4294967295|F>>>23),F=j+(C^P&(z^C))+N[11]+643717713&4294967295,j=z+(F<<14&4294967295|F>>>18),F=P+(z^C&(j^z))+N[0]+3921069994&4294967295,P=j+(F<<20&4294967295|F>>>12),F=C+(j^z&(P^j))+N[5]+3593408605&4294967295,C=P+(F<<5&4294967295|F>>>27),F=z+(P^j&(C^P))+N[10]+38016083&4294967295,z=C+(F<<9&4294967295|F>>>23),F=j+(C^P&(z^C))+N[15]+3634488961&4294967295,j=z+(F<<14&4294967295|F>>>18),F=P+(z^C&(j^z))+N[4]+3889429448&4294967295,P=j+(F<<20&4294967295|F>>>12),F=C+(j^z&(P^j))+N[9]+568446438&4294967295,C=P+(F<<5&4294967295|F>>>27),F=z+(P^j&(C^P))+N[14]+3275163606&4294967295,z=C+(F<<9&4294967295|F>>>23),F=j+(C^P&(z^C))+N[3]+4107603335&4294967295,j=z+(F<<14&4294967295|F>>>18),F=P+(z^C&(j^z))+N[8]+1163531501&4294967295,P=j+(F<<20&4294967295|F>>>12),F=C+(j^z&(P^j))+N[13]+2850285829&4294967295,C=P+(F<<5&4294967295|F>>>27),F=z+(P^j&(C^P))+N[2]+4243563512&4294967295,z=C+(F<<9&4294967295|F>>>23),F=j+(C^P&(z^C))+N[7]+1735328473&4294967295,j=z+(F<<14&4294967295|F>>>18),F=P+(z^C&(j^z))+N[12]+2368359562&4294967295,P=j+(F<<20&4294967295|F>>>12),F=C+(P^j^z)+N[5]+4294588738&4294967295,C=P+(F<<4&4294967295|F>>>28),F=z+(C^P^j)+N[8]+2272392833&4294967295,z=C+(F<<11&4294967295|F>>>21),F=j+(z^C^P)+N[11]+1839030562&4294967295,j=z+(F<<16&4294967295|F>>>16),F=P+(j^z^C)+N[14]+4259657740&4294967295,P=j+(F<<23&4294967295|F>>>9),F=C+(P^j^z)+N[1]+2763975236&4294967295,C=P+(F<<4&4294967295|F>>>28),F=z+(C^P^j)+N[4]+1272893353&4294967295,z=C+(F<<11&4294967295|F>>>21),F=j+(z^C^P)+N[7]+4139469664&4294967295,j=z+(F<<16&4294967295|F>>>16),F=P+(j^z^C)+N[10]+3200236656&4294967295,P=j+(F<<23&4294967295|F>>>9),F=C+(P^j^z)+N[13]+681279174&4294967295,C=P+(F<<4&4294967295|F>>>28),F=z+(C^P^j)+N[0]+3936430074&4294967295,z=C+(F<<11&4294967295|F>>>21),F=j+(z^C^P)+N[3]+3572445317&4294967295,j=z+(F<<16&4294967295|F>>>16),F=P+(j^z^C)+N[6]+76029189&4294967295,P=j+(F<<23&4294967295|F>>>9),F=C+(P^j^z)+N[9]+3654602809&4294967295,C=P+(F<<4&4294967295|F>>>28),F=z+(C^P^j)+N[12]+3873151461&4294967295,z=C+(F<<11&4294967295|F>>>21),F=j+(z^C^P)+N[15]+530742520&4294967295,j=z+(F<<16&4294967295|F>>>16),F=P+(j^z^C)+N[2]+3299628645&4294967295,P=j+(F<<23&4294967295|F>>>9),F=C+(j^(P|~z))+N[0]+4096336452&4294967295,C=P+(F<<6&4294967295|F>>>26),F=z+(P^(C|~j))+N[7]+1126891415&4294967295,z=C+(F<<10&4294967295|F>>>22),F=j+(C^(z|~P))+N[14]+2878612391&4294967295,j=z+(F<<15&4294967295|F>>>17),F=P+(z^(j|~C))+N[5]+4237533241&4294967295,P=j+(F<<21&4294967295|F>>>11),F=C+(j^(P|~z))+N[12]+1700485571&4294967295,C=P+(F<<6&4294967295|F>>>26),F=z+(P^(C|~j))+N[3]+2399980690&4294967295,z=C+(F<<10&4294967295|F>>>22),F=j+(C^(z|~P))+N[10]+4293915773&4294967295,j=z+(F<<15&4294967295|F>>>17),F=P+(z^(j|~C))+N[1]+2240044497&4294967295,P=j+(F<<21&4294967295|F>>>11),F=C+(j^(P|~z))+N[8]+1873313359&4294967295,C=P+(F<<6&4294967295|F>>>26),F=z+(P^(C|~j))+N[15]+4264355552&4294967295,z=C+(F<<10&4294967295|F>>>22),F=j+(C^(z|~P))+N[6]+2734768916&4294967295,j=z+(F<<15&4294967295|F>>>17),F=P+(z^(j|~C))+N[13]+1309151649&4294967295,P=j+(F<<21&4294967295|F>>>11),F=C+(j^(P|~z))+N[4]+4149444226&4294967295,C=P+(F<<6&4294967295|F>>>26),F=z+(P^(C|~j))+N[11]+3174756917&4294967295,z=C+(F<<10&4294967295|F>>>22),F=j+(C^(z|~P))+N[2]+718787259&4294967295,j=z+(F<<15&4294967295|F>>>17),F=P+(z^(j|~C))+N[9]+3951481745&4294967295,k.g[0]=k.g[0]+C&4294967295,k.g[1]=k.g[1]+(j+(F<<21&4294967295|F>>>11))&4294967295,k.g[2]=k.g[2]+j&4294967295,k.g[3]=k.g[3]+z&4294967295}n.prototype.u=function(k,C){C===void 0&&(C=k.length);for(var P=C-this.blockSize,N=this.B,j=this.h,z=0;z<C;){if(j==0)for(;z<=P;)s(this,k,z),z+=this.blockSize;if(typeof k=="string"){for(;z<C;)if(N[j++]=k.charCodeAt(z++),j==this.blockSize){s(this,N),j=0;break}}else for(;z<C;)if(N[j++]=k[z++],j==this.blockSize){s(this,N),j=0;break}}this.h=j,this.o+=C},n.prototype.v=function(){var k=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);k[0]=128;for(var C=1;C<k.length-8;++C)k[C]=0;var P=8*this.o;for(C=k.length-8;C<k.length;++C)k[C]=P&255,P/=256;for(this.u(k),k=Array(16),C=P=0;4>C;++C)for(var N=0;32>N;N+=8)k[P++]=this.g[C]>>>N&255;return k};function i(k,C){var P=c;return Object.prototype.hasOwnProperty.call(P,k)?P[k]:P[k]=C(k)}function o(k,C){this.h=C;for(var P=[],N=!0,j=k.length-1;0<=j;j--){var z=k[j]|0;N&&z==C||(P[j]=z,N=!1)}this.g=P}var c={};function u(k){return-128<=k&&128>k?i(k,function(C){return new o([C|0],0>C?-1:0)}):new o([k|0],0>k?-1:0)}function h(k){if(isNaN(k)||!isFinite(k))return m;if(0>k)return T(h(-k));for(var C=[],P=1,N=0;k>=P;N++)C[N]=k/P|0,P*=4294967296;return new o(C,0)}function f(k,C){if(k.length==0)throw Error("number format error: empty string");if(C=C||10,2>C||36<C)throw Error("radix out of range: "+C);if(k.charAt(0)=="-")return T(f(k.substring(1),C));if(0<=k.indexOf("-"))throw Error('number format error: interior "-" character');for(var P=h(Math.pow(C,8)),N=m,j=0;j<k.length;j+=8){var z=Math.min(8,k.length-j),F=parseInt(k.substring(j,j+z),C);8>z?(z=h(Math.pow(C,z)),N=N.j(z).add(h(F))):(N=N.j(P),N=N.add(h(F)))}return N}var m=u(0),y=u(1),_=u(16777216);r=o.prototype,r.m=function(){if(b(this))return-T(this).m();for(var k=0,C=1,P=0;P<this.g.length;P++){var N=this.i(P);k+=(0<=N?N:4294967296+N)*C,C*=4294967296}return k},r.toString=function(k){if(k=k||10,2>k||36<k)throw Error("radix out of range: "+k);if(A(this))return"0";if(b(this))return"-"+T(this).toString(k);for(var C=h(Math.pow(k,6)),P=this,N="";;){var j=B(P,C).g;P=x(P,j.j(C));var z=((0<P.g.length?P.g[0]:P.h)>>>0).toString(k);if(P=j,A(P))return z+N;for(;6>z.length;)z="0"+z;N=z+N}},r.i=function(k){return 0>k?0:k<this.g.length?this.g[k]:this.h};function A(k){if(k.h!=0)return!1;for(var C=0;C<k.g.length;C++)if(k.g[C]!=0)return!1;return!0}function b(k){return k.h==-1}r.l=function(k){return k=x(this,k),b(k)?-1:A(k)?0:1};function T(k){for(var C=k.g.length,P=[],N=0;N<C;N++)P[N]=~k.g[N];return new o(P,~k.h).add(y)}r.abs=function(){return b(this)?T(this):this},r.add=function(k){for(var C=Math.max(this.g.length,k.g.length),P=[],N=0,j=0;j<=C;j++){var z=N+(this.i(j)&65535)+(k.i(j)&65535),F=(z>>>16)+(this.i(j)>>>16)+(k.i(j)>>>16);N=F>>>16,z&=65535,F&=65535,P[j]=F<<16|z}return new o(P,P[P.length-1]&-2147483648?-1:0)};function x(k,C){return k.add(T(C))}r.j=function(k){if(A(this)||A(k))return m;if(b(this))return b(k)?T(this).j(T(k)):T(T(this).j(k));if(b(k))return T(this.j(T(k)));if(0>this.l(_)&&0>k.l(_))return h(this.m()*k.m());for(var C=this.g.length+k.g.length,P=[],N=0;N<2*C;N++)P[N]=0;for(N=0;N<this.g.length;N++)for(var j=0;j<k.g.length;j++){var z=this.i(N)>>>16,F=this.i(N)&65535,ue=k.i(j)>>>16,ke=k.i(j)&65535;P[2*N+2*j]+=F*ke,M(P,2*N+2*j),P[2*N+2*j+1]+=z*ke,M(P,2*N+2*j+1),P[2*N+2*j+1]+=F*ue,M(P,2*N+2*j+1),P[2*N+2*j+2]+=z*ue,M(P,2*N+2*j+2)}for(N=0;N<C;N++)P[N]=P[2*N+1]<<16|P[2*N];for(N=C;N<2*C;N++)P[N]=0;return new o(P,0)};function M(k,C){for(;(k[C]&65535)!=k[C];)k[C+1]+=k[C]>>>16,k[C]&=65535,C++}function R(k,C){this.g=k,this.h=C}function B(k,C){if(A(C))throw Error("division by zero");if(A(k))return new R(m,m);if(b(k))return C=B(T(k),C),new R(T(C.g),T(C.h));if(b(C))return C=B(k,T(C)),new R(T(C.g),C.h);if(30<k.g.length){if(b(k)||b(C))throw Error("slowDivide_ only works with positive integers.");for(var P=y,N=C;0>=N.l(k);)P=O(P),N=O(N);var j=$(P,1),z=$(N,1);for(N=$(N,2),P=$(P,2);!A(N);){var F=z.add(N);0>=F.l(k)&&(j=j.add(P),z=F),N=$(N,1),P=$(P,1)}return C=x(k,j.j(C)),new R(j,C)}for(j=m;0<=k.l(C);){for(P=Math.max(1,Math.floor(k.m()/C.m())),N=Math.ceil(Math.log(P)/Math.LN2),N=48>=N?1:Math.pow(2,N-48),z=h(P),F=z.j(C);b(F)||0<F.l(k);)P-=N,z=h(P),F=z.j(C);A(z)&&(z=y),j=j.add(z),k=x(k,F)}return new R(j,k)}r.A=function(k){return B(this,k).h},r.and=function(k){for(var C=Math.max(this.g.length,k.g.length),P=[],N=0;N<C;N++)P[N]=this.i(N)&k.i(N);return new o(P,this.h&k.h)},r.or=function(k){for(var C=Math.max(this.g.length,k.g.length),P=[],N=0;N<C;N++)P[N]=this.i(N)|k.i(N);return new o(P,this.h|k.h)},r.xor=function(k){for(var C=Math.max(this.g.length,k.g.length),P=[],N=0;N<C;N++)P[N]=this.i(N)^k.i(N);return new o(P,this.h^k.h)};function O(k){for(var C=k.g.length+1,P=[],N=0;N<C;N++)P[N]=k.i(N)<<1|k.i(N-1)>>>31;return new o(P,k.h)}function $(k,C){var P=C>>5;C%=32;for(var N=k.g.length-P,j=[],z=0;z<N;z++)j[z]=0<C?k.i(z+P)>>>C|k.i(z+P+1)<<32-C:k.i(z+P);return new o(j,k.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,NT=n,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=f,to=o}).apply(typeof B1<"u"?B1:typeof self<"u"?self:typeof window<"u"?window:{});var jd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var OT,au,FT,of,uy,VT,jT,BT;(function(){var r,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(p,w,S){return p==Array.prototype||p==Object.prototype||(p[w]=S.value),p};function t(p){p=[typeof globalThis=="object"&&globalThis,p,typeof window=="object"&&window,typeof self=="object"&&self,typeof jd=="object"&&jd];for(var w=0;w<p.length;++w){var S=p[w];if(S&&S.Math==Math)return S}throw Error("Cannot find global object")}var n=t(this);function s(p,w){if(w)e:{var S=n;p=p.split(".");for(var D=0;D<p.length-1;D++){var q=p[D];if(!(q in S))break e;S=S[q]}p=p[p.length-1],D=S[p],w=w(D),w!=D&&w!=null&&e(S,p,{configurable:!0,writable:!0,value:w})}}function i(p,w){p instanceof String&&(p+="");var S=0,D=!1,q={next:function(){if(!D&&S<p.length){var J=S++;return{value:w(J,p[J]),done:!1}}return D=!0,{done:!0,value:void 0}}};return q[Symbol.iterator]=function(){return q},q}s("Array.prototype.values",function(p){return p||function(){return i(this,function(w,S){return S})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},c=this||self;function u(p){var w=typeof p;return w=w!="object"?w:p?Array.isArray(p)?"array":w:"null",w=="array"||w=="object"&&typeof p.length=="number"}function h(p){var w=typeof p;return w=="object"&&p!=null||w=="function"}function f(p,w,S){return p.call.apply(p.bind,arguments)}function m(p,w,S){if(!p)throw Error();if(2<arguments.length){var D=Array.prototype.slice.call(arguments,2);return function(){var q=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(q,D),p.apply(w,q)}}return function(){return p.apply(w,arguments)}}function y(p,w,S){return y=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:m,y.apply(null,arguments)}function _(p,w){var S=Array.prototype.slice.call(arguments,1);return function(){var D=S.slice();return D.push.apply(D,arguments),p.apply(this,D)}}function A(p,w){function S(){}S.prototype=w.prototype,p.aa=w.prototype,p.prototype=new S,p.prototype.constructor=p,p.Qb=function(D,q,J){for(var he=Array(arguments.length-2),rt=2;rt<arguments.length;rt++)he[rt-2]=arguments[rt];return w.prototype[q].apply(D,he)}}function b(p){const w=p.length;if(0<w){const S=Array(w);for(let D=0;D<w;D++)S[D]=p[D];return S}return[]}function T(p,w){for(let S=1;S<arguments.length;S++){const D=arguments[S];if(u(D)){const q=p.length||0,J=D.length||0;p.length=q+J;for(let he=0;he<J;he++)p[q+he]=D[he]}else p.push(D)}}class x{constructor(w,S){this.i=w,this.j=S,this.h=0,this.g=null}get(){let w;return 0<this.h?(this.h--,w=this.g,this.g=w.next,w.next=null):w=this.i(),w}}function M(p){return/^[\s\xa0]*$/.test(p)}function R(){var p=c.navigator;return p&&(p=p.userAgent)?p:""}function B(p){return B[" "](p),p}B[" "]=function(){};var O=R().indexOf("Gecko")!=-1&&!(R().toLowerCase().indexOf("webkit")!=-1&&R().indexOf("Edge")==-1)&&!(R().indexOf("Trident")!=-1||R().indexOf("MSIE")!=-1)&&R().indexOf("Edge")==-1;function $(p,w,S){for(const D in p)w.call(S,p[D],D,p)}function k(p,w){for(const S in p)w.call(void 0,p[S],S,p)}function C(p){const w={};for(const S in p)w[S]=p[S];return w}const P="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function N(p,w){let S,D;for(let q=1;q<arguments.length;q++){D=arguments[q];for(S in D)p[S]=D[S];for(let J=0;J<P.length;J++)S=P[J],Object.prototype.hasOwnProperty.call(D,S)&&(p[S]=D[S])}}function j(p){var w=1;p=p.split(":");const S=[];for(;0<w&&p.length;)S.push(p.shift()),w--;return p.length&&S.push(p.join(":")),S}function z(p){c.setTimeout(()=>{throw p},0)}function F(){var p=de;let w=null;return p.g&&(w=p.g,p.g=p.g.next,p.g||(p.h=null),w.next=null),w}class ue{constructor(){this.h=this.g=null}add(w,S){const D=ke.get();D.set(w,S),this.h?this.h.next=D:this.g=D,this.h=D}}var ke=new x(()=>new ie,p=>p.reset());class ie{constructor(){this.next=this.g=this.h=null}set(w,S){this.h=w,this.g=S,this.next=null}reset(){this.next=this.g=this.h=null}}let Z,te=!1,de=new ue,ee=()=>{const p=c.Promise.resolve(void 0);Z=()=>{p.then(W)}};var W=()=>{for(var p;p=F();){try{p.h.call(p.g)}catch(S){z(S)}var w=ke;w.j(p),100>w.h&&(w.h++,p.next=w.g,w.g=p)}te=!1};function Y(){this.s=this.s,this.C=this.C}Y.prototype.s=!1,Y.prototype.ma=function(){this.s||(this.s=!0,this.N())},Y.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ae(p,w){this.type=p,this.g=this.target=w,this.defaultPrevented=!1}ae.prototype.h=function(){this.defaultPrevented=!0};var _e=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var p=!1,w=Object.defineProperty({},"passive",{get:function(){p=!0}});try{const S=()=>{};c.addEventListener("test",S,w),c.removeEventListener("test",S,w)}catch{}return p}();function Te(p,w){if(ae.call(this,p?p.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,p){var S=this.type=p.type,D=p.changedTouches&&p.changedTouches.length?p.changedTouches[0]:null;if(this.target=p.target||p.srcElement,this.g=w,w=p.relatedTarget){if(O){e:{try{B(w.nodeName);var q=!0;break e}catch{}q=!1}q||(w=null)}}else S=="mouseover"?w=p.fromElement:S=="mouseout"&&(w=p.toElement);this.relatedTarget=w,D?(this.clientX=D.clientX!==void 0?D.clientX:D.pageX,this.clientY=D.clientY!==void 0?D.clientY:D.pageY,this.screenX=D.screenX||0,this.screenY=D.screenY||0):(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0),this.button=p.button,this.key=p.key||"",this.ctrlKey=p.ctrlKey,this.altKey=p.altKey,this.shiftKey=p.shiftKey,this.metaKey=p.metaKey,this.pointerId=p.pointerId||0,this.pointerType=typeof p.pointerType=="string"?p.pointerType:Pe[p.pointerType]||"",this.state=p.state,this.i=p,p.defaultPrevented&&Te.aa.h.call(this)}}A(Te,ae);var Pe={2:"touch",3:"pen",4:"mouse"};Te.prototype.h=function(){Te.aa.h.call(this);var p=this.i;p.preventDefault?p.preventDefault():p.returnValue=!1};var Ee="closure_listenable_"+(1e6*Math.random()|0),Be=0;function $e(p,w,S,D,q){this.listener=p,this.proxy=null,this.src=w,this.type=S,this.capture=!!D,this.ha=q,this.key=++Be,this.da=this.fa=!1}function Ue(p){p.da=!0,p.listener=null,p.proxy=null,p.src=null,p.ha=null}function qt(p){this.src=p,this.g={},this.h=0}qt.prototype.add=function(p,w,S,D,q){var J=p.toString();p=this.g[J],p||(p=this.g[J]=[],this.h++);var he=ze(p,w,D,q);return-1<he?(w=p[he],S||(w.fa=!1)):(w=new $e(w,this.src,J,!!D,q),w.fa=S,p.push(w)),w};function vn(p,w){var S=w.type;if(S in p.g){var D=p.g[S],q=Array.prototype.indexOf.call(D,w,void 0),J;(J=0<=q)&&Array.prototype.splice.call(D,q,1),J&&(Ue(w),p.g[S].length==0&&(delete p.g[S],p.h--))}}function ze(p,w,S,D){for(var q=0;q<p.length;++q){var J=p[q];if(!J.da&&J.listener==w&&J.capture==!!S&&J.ha==D)return q}return-1}var et="closure_lm_"+(1e6*Math.random()|0),lt={};function yt(p,w,S,D,q){if(Array.isArray(w)){for(var J=0;J<w.length;J++)yt(p,w[J],S,D,q);return null}return S=Ao(S),p&&p[Ee]?p.K(w,S,h(D)?!!D.capture:!1,q):dr(p,w,S,!1,D,q)}function dr(p,w,S,D,q,J){if(!w)throw Error("Invalid event type");var he=h(q)?!!q.capture:!!q,rt=wi(p);if(rt||(p[et]=rt=new qt(p)),S=rt.add(w,S,D,he,J),S.proxy)return S;if(D=rs(),S.proxy=D,D.src=p,D.listener=S,p.addEventListener)_e||(q=he),q===void 0&&(q=!1),p.addEventListener(w.toString(),D,q);else if(p.attachEvent)p.attachEvent(Bn(w.toString()),D);else if(p.addListener&&p.removeListener)p.addListener(D);else throw Error("addEventListener and attachEvent are unavailable.");return S}function rs(){function p(S){return w.call(p.src,p.listener,S)}const w=Eo;return p}function ss(p,w,S,D,q){if(Array.isArray(w))for(var J=0;J<w.length;J++)ss(p,w[J],S,D,q);else D=h(D)?!!D.capture:!!D,S=Ao(S),p&&p[Ee]?(p=p.i,w=String(w).toString(),w in p.g&&(J=p.g[w],S=ze(J,S,D,q),-1<S&&(Ue(J[S]),Array.prototype.splice.call(J,S,1),J.length==0&&(delete p.g[w],p.h--)))):p&&(p=wi(p))&&(w=p.g[w.toString()],p=-1,w&&(p=ze(w,S,D,q)),(S=-1<p?w[p]:null)&&Dr(S))}function Dr(p){if(typeof p!="number"&&p&&!p.da){var w=p.src;if(w&&w[Ee])vn(w.i,p);else{var S=p.type,D=p.proxy;w.removeEventListener?w.removeEventListener(S,D,p.capture):w.detachEvent?w.detachEvent(Bn(S),D):w.addListener&&w.removeListener&&w.removeListener(D),(S=wi(w))?(vn(S,p),S.h==0&&(S.src=null,w[et]=null)):Ue(p)}}}function Bn(p){return p in lt?lt[p]:lt[p]="on"+p}function Eo(p,w){if(p.da)p=!0;else{w=new Te(w,this);var S=p.listener,D=p.ha||p.src;p.fa&&Dr(p),p=S.call(D,w)}return p}function wi(p){return p=p[et],p instanceof qt?p:null}var Ei="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ao(p){return typeof p=="function"?p:(p[Ei]||(p[Ei]=function(w){return p.handleEvent(w)}),p[Ei])}function Rt(){Y.call(this),this.i=new qt(this),this.M=this,this.F=null}A(Rt,Y),Rt.prototype[Ee]=!0,Rt.prototype.removeEventListener=function(p,w,S,D){ss(this,p,w,S,D)};function st(p,w){var S,D=p.F;if(D)for(S=[];D;D=D.F)S.push(D);if(p=p.M,D=w.type||w,typeof w=="string")w=new ae(w,p);else if(w instanceof ae)w.target=w.target||p;else{var q=w;w=new ae(D,p),N(w,q)}if(q=!0,S)for(var J=S.length-1;0<=J;J--){var he=w.g=S[J];q=_n(he,D,!0,w)&&q}if(he=w.g=p,q=_n(he,D,!0,w)&&q,q=_n(he,D,!1,w)&&q,S)for(J=0;J<S.length;J++)he=w.g=S[J],q=_n(he,D,!1,w)&&q}Rt.prototype.N=function(){if(Rt.aa.N.call(this),this.i){var p=this.i,w;for(w in p.g){for(var S=p.g[w],D=0;D<S.length;D++)Ue(S[D]);delete p.g[w],p.h--}}this.F=null},Rt.prototype.K=function(p,w,S,D){return this.i.add(String(p),w,!1,S,D)},Rt.prototype.L=function(p,w,S,D){return this.i.add(String(p),w,!0,S,D)};function _n(p,w,S,D){if(w=p.i.g[String(w)],!w)return!0;w=w.concat();for(var q=!0,J=0;J<w.length;++J){var he=w[J];if(he&&!he.da&&he.capture==S){var rt=he.listener,Kt=he.ha||he.src;he.fa&&vn(p.i,he),q=rt.call(Kt,D)!==!1&&q}}return q&&!D.defaultPrevented}function Un(p,w,S){if(typeof p=="function")S&&(p=y(p,S));else if(p&&typeof p.handleEvent=="function")p=y(p.handleEvent,p);else throw Error("Invalid listener argument");return 2147483647<Number(w)?-1:c.setTimeout(p,w||0)}function fr(p){p.g=Un(()=>{p.g=null,p.i&&(p.i=!1,fr(p))},p.l);const w=p.h;p.h=null,p.m.apply(null,w)}class bo extends Y{constructor(w,S){super(),this.m=w,this.l=S,this.h=null,this.i=!1,this.g=null}j(w){this.h=arguments,this.g?this.i=!0:fr(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function To(p){Y.call(this),this.h=p,this.g={}}A(To,Y);var cc=[];function uc(p){$(p.g,function(w,S){this.g.hasOwnProperty(S)&&Dr(w)},p),p.g={}}To.prototype.N=function(){To.aa.N.call(this),uc(this)},To.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var hc=c.JSON.stringify,dc=c.JSON.parse,fc=class{stringify(p){return c.JSON.stringify(p,void 0)}parse(p){return c.JSON.parse(p,void 0)}};function So(){}So.prototype.h=null;function ka(p){return p.h||(p.h=p.i())}function Pa(){}var pr={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function is(){ae.call(this,"d")}A(is,ae);function Ra(){ae.call(this,"c")}A(Ra,ae);var os={},pc=null;function xo(){return pc=pc||new Rt}os.La="serverreachability";function mc(p){ae.call(this,os.La,p)}A(mc,ae);function zs(p){const w=xo();st(w,new mc(w))}os.STAT_EVENT="statevent";function gc(p,w){ae.call(this,os.STAT_EVENT,p),this.stat=w}A(gc,ae);function Dt(p){const w=xo();st(w,new gc(w,p))}os.Ma="timingevent";function Da(p,w){ae.call(this,os.Ma,p),this.size=w}A(Da,ae);function Lr(p,w){if(typeof p!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){p()},w)}function Co(){this.g=!0}Co.prototype.xa=function(){this.g=!1};function Io(p,w,S,D,q,J){p.info(function(){if(p.g)if(J)for(var he="",rt=J.split("&"),Kt=0;Kt<rt.length;Kt++){var Qe=rt[Kt].split("=");if(1<Qe.length){var tn=Qe[0];Qe=Qe[1];var Ut=tn.split("_");he=2<=Ut.length&&Ut[1]=="type"?he+(tn+"="+Qe+"&"):he+(tn+"=redacted&")}}else he=null;else he=J;return"XMLHTTP REQ ("+D+") [attempt "+q+"]: "+w+`
`+S+`
`+he})}function La(p,w,S,D,q,J,he){p.info(function(){return"XMLHTTP RESP ("+D+") [ attempt "+q+"]: "+w+`
`+S+`
`+J+" "+he})}function Mr(p,w,S,D){p.info(function(){return"XMLHTTP TEXT ("+w+"): "+Bp(p,S)+(D?" "+D:"")})}function yc(p,w){p.info(function(){return"TIMEOUT: "+w})}Co.prototype.info=function(){};function Bp(p,w){if(!p.g)return w;if(!w)return null;try{var S=JSON.parse(w);if(S){for(p=0;p<S.length;p++)if(Array.isArray(S[p])){var D=S[p];if(!(2>D.length)){var q=D[1];if(Array.isArray(q)&&!(1>q.length)){var J=q[0];if(J!="noop"&&J!="stop"&&J!="close")for(var he=1;he<q.length;he++)q[he]=""}}}}return hc(S)}catch{return w}}var Ma={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},bh={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Nr;function ko(){}A(ko,So),ko.prototype.g=function(){return new XMLHttpRequest},ko.prototype.i=function(){return{}},Nr=new ko;function Or(p,w,S,D){this.j=p,this.i=w,this.l=S,this.R=D||1,this.U=new To(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Th}function Th(){this.i=null,this.g="",this.h=!1}var vc={},Na={};function Oa(p,w,S){p.L=1,p.v=xi(tr(w)),p.m=S,p.P=!0,_c(p,null)}function _c(p,w){p.F=Date.now(),ct(p),p.A=tr(p.v);var S=p.A,D=p.R;Array.isArray(D)||(D=[String(D)]),Ii(S.i,"t",D),p.C=0,S=p.j.J,p.h=new Th,p.g=zh(p.j,S?w:null,!p.m),0<p.O&&(p.M=new bo(y(p.Y,p,p.g),p.O)),w=p.U,S=p.g,D=p.ca;var q="readystatechange";Array.isArray(q)||(q&&(cc[0]=q.toString()),q=cc);for(var J=0;J<q.length;J++){var he=yt(S,q[J],D||w.handleEvent,!1,w.h||w);if(!he)break;w.g[he.key]=he}w=p.H?C(p.H):{},p.m?(p.u||(p.u="POST"),w["Content-Type"]="application/x-www-form-urlencoded",p.g.ea(p.A,p.u,p.m,w)):(p.u="GET",p.g.ea(p.A,p.u,null,w)),zs(),Io(p.i,p.u,p.A,p.l,p.R,p.m)}Or.prototype.ca=function(p){p=p.target;const w=this.M;w&&$n(p)==3?w.j():this.Y(p)},Or.prototype.Y=function(p){try{if(p==this.g)e:{const Ut=$n(this.g);var w=this.g.Ba();const yr=this.g.Z();if(!(3>Ut)&&(Ut!=3||this.g&&(this.h.h||this.g.oa()||Sc(this.g)))){this.J||Ut!=4||w==7||(w==8||0>=yr?zs(3):zs(2)),Po(this);var S=this.g.Z();this.X=S;t:if(Sh(this)){var D=Sc(this.g);p="";var q=D.length,J=$n(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){mr(this),Ai(this);var he="";break t}this.h.i=new c.TextDecoder}for(w=0;w<q;w++)this.h.h=!0,p+=this.h.i.decode(D[w],{stream:!(J&&w==q-1)});D.length=0,this.h.g+=p,this.C=0,he=this.h.g}else he=this.g.oa();if(this.o=S==200,La(this.i,this.u,this.A,this.l,this.R,Ut,S),this.o){if(this.T&&!this.K){t:{if(this.g){var rt,Kt=this.g;if((rt=Kt.g?Kt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!M(rt)){var Qe=rt;break t}}Qe=null}if(S=Qe)Mr(this.i,this.l,S,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,wc(this,S);else{this.o=!1,this.s=3,Dt(12),mr(this),Ai(this);break e}}if(this.P){S=!0;let rr;for(;!this.J&&this.C<he.length;)if(rr=Up(this,he),rr==Na){Ut==4&&(this.s=4,Dt(14),S=!1),Mr(this.i,this.l,null,"[Incomplete Response]");break}else if(rr==vc){this.s=4,Dt(15),Mr(this.i,this.l,he,"[Invalid Chunk]"),S=!1;break}else Mr(this.i,this.l,rr,null),wc(this,rr);if(Sh(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ut!=4||he.length!=0||this.h.h||(this.s=1,Dt(16),S=!1),this.o=this.o&&S,!S)Mr(this.i,this.l,he,"[Invalid Chunked Response]"),mr(this),Ai(this);else if(0<he.length&&!this.W){this.W=!0;var tn=this.j;tn.g==this&&tn.ba&&!tn.M&&(tn.j.info("Great, no buffering proxy detected. Bytes received: "+he.length),Cc(tn),tn.M=!0,Dt(11))}}else Mr(this.i,this.l,he,null),wc(this,he);Ut==4&&mr(this),this.o&&!this.J&&(Ut==4?qa(this.j,this):(this.o=!1,ct(this)))}else za(this.g),S==400&&0<he.indexOf("Unknown SID")?(this.s=3,Dt(12)):(this.s=0,Dt(13)),mr(this),Ai(this)}}}catch{}finally{}};function Sh(p){return p.g?p.u=="GET"&&p.L!=2&&p.j.Ca:!1}function Up(p,w){var S=p.C,D=w.indexOf(`
`,S);return D==-1?Na:(S=Number(w.substring(S,D)),isNaN(S)?vc:(D+=1,D+S>w.length?Na:(w=w.slice(D,D+S),p.C=D+S,w)))}Or.prototype.cancel=function(){this.J=!0,mr(this)};function ct(p){p.S=Date.now()+p.I,xh(p,p.I)}function xh(p,w){if(p.B!=null)throw Error("WatchDog timer not null");p.B=Lr(y(p.ba,p),w)}function Po(p){p.B&&(c.clearTimeout(p.B),p.B=null)}Or.prototype.ba=function(){this.B=null;const p=Date.now();0<=p-this.S?(yc(this.i,this.A),this.L!=2&&(zs(),Dt(17)),mr(this),this.s=2,Ai(this)):xh(this,this.S-p)};function Ai(p){p.j.G==0||p.J||qa(p.j,p)}function mr(p){Po(p);var w=p.M;w&&typeof w.ma=="function"&&w.ma(),p.M=null,uc(p.U),p.g&&(w=p.g,p.g=null,w.abort(),w.ma())}function wc(p,w){try{var S=p.j;if(S.G!=0&&(S.g==p||Ln(S.h,p))){if(!p.K&&Ln(S.h,p)&&S.G==3){try{var D=S.Da.g.parse(w)}catch{D=null}if(Array.isArray(D)&&D.length==3){var q=D;if(q[0]==0){e:if(!S.u){if(S.g)if(S.g.F+3e3<p.F)Ga(S),Ur(S);else break e;Wa(S),Dt(18)}}else S.za=q[1],0<S.za-S.T&&37500>q[2]&&S.F&&S.v==0&&!S.C&&(S.C=Lr(y(S.Za,S),6e3));if(1>=Ih(S.h)&&S.ca){try{S.ca()}catch{}S.ca=void 0}}else qs(S,11)}else if((p.K||S.g==p)&&Ga(S),!M(w))for(q=S.Da.g.parse(w),w=0;w<q.length;w++){let Qe=q[w];if(S.T=Qe[0],Qe=Qe[1],S.G==2)if(Qe[0]=="c"){S.K=Qe[1],S.ia=Qe[2];const tn=Qe[3];tn!=null&&(S.la=tn,S.j.info("VER="+S.la));const Ut=Qe[4];Ut!=null&&(S.Aa=Ut,S.j.info("SVER="+S.Aa));const yr=Qe[5];yr!=null&&typeof yr=="number"&&0<yr&&(D=1.5*yr,S.L=D,S.j.info("backChannelRequestTimeoutMs_="+D)),D=S;const rr=p.g;if(rr){const Fo=rr.g?rr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Fo){var J=D.h;J.g||Fo.indexOf("spdy")==-1&&Fo.indexOf("quic")==-1&&Fo.indexOf("h2")==-1||(J.j=J.l,J.g=new Set,J.h&&(Ec(J,J.h),J.h=null))}if(D.D){const Xa=rr.g?rr.g.getResponseHeader("X-HTTP-Session-Id"):null;Xa&&(D.ya=Xa,ot(D.I,D.D,Xa))}}S.G=3,S.l&&S.l.ua(),S.ba&&(S.R=Date.now()-p.F,S.j.info("Handshake RTT: "+S.R+"ms")),D=S;var he=p;if(D.qa=Uh(D,D.J?D.ia:null,D.W),he.K){kh(D.h,he);var rt=he,Kt=D.L;Kt&&(rt.I=Kt),rt.B&&(Po(rt),ct(rt)),D.g=he}else Oo(D);0<S.i.length&&us(S)}else Qe[0]!="stop"&&Qe[0]!="close"||qs(S,7);else S.G==3&&(Qe[0]=="stop"||Qe[0]=="close"?Qe[0]=="stop"?qs(S,7):un(S):Qe[0]!="noop"&&S.l&&S.l.ta(Qe),S.v=0)}}zs(4)}catch{}}var Ch=class{constructor(p,w){this.g=p,this.map=w}};function Ro(p){this.l=p||10,c.PerformanceNavigationTiming?(p=c.performance.getEntriesByType("navigation"),p=0<p.length&&(p[0].nextHopProtocol=="hq"||p[0].nextHopProtocol=="h2")):p=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=p?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function er(p){return p.h?!0:p.g?p.g.size>=p.j:!1}function Ih(p){return p.h?1:p.g?p.g.size:0}function Ln(p,w){return p.h?p.h==w:p.g?p.g.has(w):!1}function Ec(p,w){p.g?p.g.add(w):p.h=w}function kh(p,w){p.h&&p.h==w?p.h=null:p.g&&p.g.has(w)&&p.g.delete(w)}Ro.prototype.cancel=function(){if(this.i=Ph(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const p of this.g.values())p.cancel();this.g.clear()}};function Ph(p){if(p.h!=null)return p.i.concat(p.h.D);if(p.g!=null&&p.g.size!==0){let w=p.i;for(const S of p.g.values())w=w.concat(S.D);return w}return b(p.i)}function Fa(p){if(p.V&&typeof p.V=="function")return p.V();if(typeof Map<"u"&&p instanceof Map||typeof Set<"u"&&p instanceof Set)return Array.from(p.values());if(typeof p=="string")return p.split("");if(u(p)){for(var w=[],S=p.length,D=0;D<S;D++)w.push(p[D]);return w}w=[],S=0;for(D in p)w[S++]=p[D];return w}function Va(p){if(p.na&&typeof p.na=="function")return p.na();if(!p.V||typeof p.V!="function"){if(typeof Map<"u"&&p instanceof Map)return Array.from(p.keys());if(!(typeof Set<"u"&&p instanceof Set)){if(u(p)||typeof p=="string"){var w=[];p=p.length;for(var S=0;S<p;S++)w.push(S);return w}w=[],S=0;for(const D in p)w[S++]=D;return w}}}function bi(p,w){if(p.forEach&&typeof p.forEach=="function")p.forEach(w,void 0);else if(u(p)||typeof p=="string")Array.prototype.forEach.call(p,w,void 0);else for(var S=Va(p),D=Fa(p),q=D.length,J=0;J<q;J++)w.call(void 0,D[J],S&&S[J],p)}var Do=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function zp(p,w){if(p){p=p.split("&");for(var S=0;S<p.length;S++){var D=p[S].indexOf("="),q=null;if(0<=D){var J=p[S].substring(0,D);q=p[S].substring(D+1)}else J=p[S];w(J,q?decodeURIComponent(q.replace(/\+/g," ")):"")}}}function $s(p){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,p instanceof $s){this.h=p.h,Lo(this,p.j),this.o=p.o,this.g=p.g,Ti(this,p.s),this.l=p.l;var w=p.i,S=new as;S.i=w.i,w.g&&(S.g=new Map(w.g),S.h=w.h),Si(this,S),this.m=p.m}else p&&(w=String(p).match(Do))?(this.h=!1,Lo(this,w[1]||"",!0),this.o=Ye(w[2]||""),this.g=Ye(w[3]||"",!0),Ti(this,w[4]),this.l=Ye(w[5]||"",!0),Si(this,w[6]||"",!0),this.m=Ye(w[7]||"")):(this.h=!1,this.i=new as(null,this.h))}$s.prototype.toString=function(){var p=[],w=this.j;w&&p.push(Ci(w,ja,!0),":");var S=this.g;return(S||w=="file")&&(p.push("//"),(w=this.o)&&p.push(Ci(w,ja,!0),"@"),p.push(encodeURIComponent(String(S)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),S=this.s,S!=null&&p.push(":",String(S))),(S=this.l)&&(this.g&&S.charAt(0)!="/"&&p.push("/"),p.push(Ci(S,S.charAt(0)=="/"?Lh:Dh,!0))),(S=this.i.toString())&&p.push("?",S),(S=this.m)&&p.push("#",Ci(S,Ac)),p.join("")};function tr(p){return new $s(p)}function Lo(p,w,S){p.j=S?Ye(w,!0):w,p.j&&(p.j=p.j.replace(/:$/,""))}function Ti(p,w){if(w){if(w=Number(w),isNaN(w)||0>w)throw Error("Bad port number "+w);p.s=w}else p.s=null}function Si(p,w,S){w instanceof as?(p.i=w,ls(p.i,p.h)):(S||(w=Ci(w,Mh)),p.i=new as(w,p.h))}function ot(p,w,S){p.i.set(w,S)}function xi(p){return ot(p,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),p}function Ye(p,w){return p?w?decodeURI(p.replace(/%25/g,"%2525")):decodeURIComponent(p):""}function Ci(p,w,S){return typeof p=="string"?(p=encodeURI(p).replace(w,Rh),S&&(p=p.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p):null}function Rh(p){return p=p.charCodeAt(0),"%"+(p>>4&15).toString(16)+(p&15).toString(16)}var ja=/[#\/\?@]/g,Dh=/[#\?:]/g,Lh=/[#\?]/g,Mh=/[#\?@]/g,Ac=/#/g;function as(p,w){this.h=this.g=null,this.i=p||null,this.j=!!w}function cn(p){p.g||(p.g=new Map,p.h=0,p.i&&zp(p.i,function(w,S){p.add(decodeURIComponent(w.replace(/\+/g," ")),S)}))}r=as.prototype,r.add=function(p,w){cn(this),this.i=null,p=gr(this,p);var S=this.g.get(p);return S||this.g.set(p,S=[]),S.push(w),this.h+=1,this};function Fr(p,w){cn(p),w=gr(p,w),p.g.has(w)&&(p.i=null,p.h-=p.g.get(w).length,p.g.delete(w))}function Vr(p,w){return cn(p),w=gr(p,w),p.g.has(w)}r.forEach=function(p,w){cn(this),this.g.forEach(function(S,D){S.forEach(function(q){p.call(w,q,D,this)},this)},this)},r.na=function(){cn(this);const p=Array.from(this.g.values()),w=Array.from(this.g.keys()),S=[];for(let D=0;D<w.length;D++){const q=p[D];for(let J=0;J<q.length;J++)S.push(w[D])}return S},r.V=function(p){cn(this);let w=[];if(typeof p=="string")Vr(this,p)&&(w=w.concat(this.g.get(gr(this,p))));else{p=Array.from(this.g.values());for(let S=0;S<p.length;S++)w=w.concat(p[S])}return w},r.set=function(p,w){return cn(this),this.i=null,p=gr(this,p),Vr(this,p)&&(this.h-=this.g.get(p).length),this.g.set(p,[w]),this.h+=1,this},r.get=function(p,w){return p?(p=this.V(p),0<p.length?String(p[0]):w):w};function Ii(p,w,S){Fr(p,w),0<S.length&&(p.i=null,p.g.set(gr(p,w),b(S)),p.h+=S.length)}r.toString=function(){if(this.i)return this.i;if(!this.g)return"";const p=[],w=Array.from(this.g.keys());for(var S=0;S<w.length;S++){var D=w[S];const J=encodeURIComponent(String(D)),he=this.V(D);for(D=0;D<he.length;D++){var q=J;he[D]!==""&&(q+="="+encodeURIComponent(String(he[D]))),p.push(q)}}return this.i=p.join("&")};function gr(p,w){return w=String(w),p.j&&(w=w.toLowerCase()),w}function ls(p,w){w&&!p.j&&(cn(p),p.i=null,p.g.forEach(function(S,D){var q=D.toLowerCase();D!=q&&(Fr(this,D),Ii(this,q,S))},p)),p.j=w}function $p(p,w){const S=new Co;if(c.Image){const D=new Image;D.onload=_(zn,S,"TestLoadImage: loaded",!0,w,D),D.onerror=_(zn,S,"TestLoadImage: error",!1,w,D),D.onabort=_(zn,S,"TestLoadImage: abort",!1,w,D),D.ontimeout=_(zn,S,"TestLoadImage: timeout",!1,w,D),c.setTimeout(function(){D.ontimeout&&D.ontimeout()},1e4),D.src=p}else w(!1)}function Nh(p,w){const S=new Co,D=new AbortController,q=setTimeout(()=>{D.abort(),zn(S,"TestPingServer: timeout",!1,w)},1e4);fetch(p,{signal:D.signal}).then(J=>{clearTimeout(q),J.ok?zn(S,"TestPingServer: ok",!0,w):zn(S,"TestPingServer: server error",!1,w)}).catch(()=>{clearTimeout(q),zn(S,"TestPingServer: error",!1,w)})}function zn(p,w,S,D,q){try{q&&(q.onload=null,q.onerror=null,q.onabort=null,q.ontimeout=null),D(S)}catch{}}function Hp(){this.g=new fc}function Oh(p,w,S){const D=S||"";try{bi(p,function(q,J){let he=q;h(q)&&(he=hc(q)),w.push(D+J+"="+encodeURIComponent(he))})}catch(q){throw w.push(D+"type="+encodeURIComponent("_badmap")),q}}function Hs(p){this.l=p.Ub||null,this.j=p.eb||!1}A(Hs,So),Hs.prototype.g=function(){return new Mo(this.l,this.j)},Hs.prototype.i=function(p){return function(){return p}}({});function Mo(p,w){Rt.call(this),this.D=p,this.o=w,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}A(Mo,Rt),r=Mo.prototype,r.open=function(p,w){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=p,this.A=w,this.readyState=1,Br(this)},r.send=function(p){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const w={headers:this.u,method:this.B,credentials:this.m,cache:void 0};p&&(w.body=p),(this.D||c).fetch(new Request(this.A,w)).then(this.Sa.bind(this),this.ga.bind(this))},r.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,jr(this)),this.readyState=0},r.Sa=function(p){if(this.g&&(this.l=p,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=p.headers,this.readyState=2,Br(this)),this.g&&(this.readyState=3,Br(this),this.g)))if(this.responseType==="arraybuffer")p.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in p){if(this.j=p.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Fh(this)}else p.text().then(this.Ra.bind(this),this.ga.bind(this))};function Fh(p){p.j.read().then(p.Pa.bind(p)).catch(p.ga.bind(p))}r.Pa=function(p){if(this.g){if(this.o&&p.value)this.response.push(p.value);else if(!this.o){var w=p.value?p.value:new Uint8Array(0);(w=this.v.decode(w,{stream:!p.done}))&&(this.response=this.responseText+=w)}p.done?jr(this):Br(this),this.readyState==3&&Fh(this)}},r.Ra=function(p){this.g&&(this.response=this.responseText=p,jr(this))},r.Qa=function(p){this.g&&(this.response=p,jr(this))},r.ga=function(){this.g&&jr(this)};function jr(p){p.readyState=4,p.l=null,p.j=null,p.v=null,Br(p)}r.setRequestHeader=function(p,w){this.u.append(p,w)},r.getResponseHeader=function(p){return this.h&&this.h.get(p.toLowerCase())||""},r.getAllResponseHeaders=function(){if(!this.h)return"";const p=[],w=this.h.entries();for(var S=w.next();!S.done;)S=S.value,p.push(S[0]+": "+S[1]),S=w.next();return p.join(`\r
`)};function Br(p){p.onreadystatechange&&p.onreadystatechange.call(p)}Object.defineProperty(Mo.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(p){this.m=p?"include":"same-origin"}});function Ws(p){let w="";return $(p,function(S,D){w+=D,w+=":",w+=S,w+=`\r
`}),w}function ki(p,w,S){e:{for(D in S){var D=!1;break e}D=!0}D||(S=Ws(S),typeof p=="string"?S!=null&&encodeURIComponent(String(S)):ot(p,w,S))}function vt(p){Rt.call(this),this.headers=new Map,this.o=p||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}A(vt,Rt);var Wp=/^https?$/i,bc=["POST","PUT"];r=vt.prototype,r.Ha=function(p){this.J=p},r.ea=function(p,w,S,D){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+p);w=w?w.toUpperCase():"GET",this.D=p,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Nr.g(),this.v=this.o?ka(this.o):ka(Nr),this.g.onreadystatechange=y(this.Ea,this);try{this.B=!0,this.g.open(w,String(p),!0),this.B=!1}catch(J){No(this,J);return}if(p=S||"",S=new Map(this.headers),D)if(Object.getPrototypeOf(D)===Object.prototype)for(var q in D)S.set(q,D[q]);else if(typeof D.keys=="function"&&typeof D.get=="function")for(const J of D.keys())S.set(J,D.get(J));else throw Error("Unknown input type for opt_headers: "+String(D));D=Array.from(S.keys()).find(J=>J.toLowerCase()=="content-type"),q=c.FormData&&p instanceof c.FormData,!(0<=Array.prototype.indexOf.call(bc,w,void 0))||D||q||S.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[J,he]of S)this.g.setRequestHeader(J,he);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Ua(this),this.u=!0,this.g.send(p),this.u=!1}catch(J){No(this,J)}};function No(p,w){p.h=!1,p.g&&(p.j=!0,p.g.abort(),p.j=!1),p.l=w,p.m=5,Ba(p),nr(p)}function Ba(p){p.A||(p.A=!0,st(p,"complete"),st(p,"error"))}r.abort=function(p){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=p||7,st(this,"complete"),st(this,"abort"),nr(this))},r.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),nr(this,!0)),vt.aa.N.call(this)},r.Ea=function(){this.s||(this.B||this.u||this.j?Tc(this):this.bb())},r.bb=function(){Tc(this)};function Tc(p){if(p.h&&typeof o<"u"&&(!p.v[1]||$n(p)!=4||p.Z()!=2)){if(p.u&&$n(p)==4)Un(p.Ea,0,p);else if(st(p,"readystatechange"),$n(p)==4){p.h=!1;try{const he=p.Z();e:switch(he){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var w=!0;break e;default:w=!1}var S;if(!(S=w)){var D;if(D=he===0){var q=String(p.D).match(Do)[1]||null;!q&&c.self&&c.self.location&&(q=c.self.location.protocol.slice(0,-1)),D=!Wp.test(q?q.toLowerCase():"")}S=D}if(S)st(p,"complete"),st(p,"success");else{p.m=6;try{var J=2<$n(p)?p.g.statusText:""}catch{J=""}p.l=J+" ["+p.Z()+"]",Ba(p)}}finally{nr(p)}}}}function nr(p,w){if(p.g){Ua(p);const S=p.g,D=p.v[0]?()=>{}:null;p.g=null,p.v=null,w||st(p,"ready");try{S.onreadystatechange=D}catch{}}}function Ua(p){p.I&&(c.clearTimeout(p.I),p.I=null)}r.isActive=function(){return!!this.g};function $n(p){return p.g?p.g.readyState:0}r.Z=function(){try{return 2<$n(this)?this.g.status:-1}catch{return-1}},r.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},r.Oa=function(p){if(this.g){var w=this.g.responseText;return p&&w.indexOf(p)==0&&(w=w.substring(p.length)),dc(w)}};function Sc(p){try{if(!p.g)return null;if("response"in p.g)return p.g.response;switch(p.H){case"":case"text":return p.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in p.g)return p.g.mozResponseArrayBuffer}return null}catch{return null}}function za(p){const w={};p=(p.g&&2<=$n(p)&&p.g.getAllResponseHeaders()||"").split(`\r
`);for(let D=0;D<p.length;D++){if(M(p[D]))continue;var S=j(p[D]);const q=S[0];if(S=S[1],typeof S!="string")continue;S=S.trim();const J=w[q]||[];w[q]=J,J.push(S)}k(w,function(D){return D.join(", ")})}r.Ba=function(){return this.m},r.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function cs(p,w,S){return S&&S.internalChannelParams&&S.internalChannelParams[p]||w}function xc(p){this.Aa=0,this.i=[],this.j=new Co,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=cs("failFast",!1,p),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=cs("baseRetryDelayMs",5e3,p),this.cb=cs("retryDelaySeedMs",1e4,p),this.Wa=cs("forwardChannelMaxRetries",2,p),this.wa=cs("forwardChannelRequestTimeoutMs",2e4,p),this.pa=p&&p.xmlHttpFactory||void 0,this.Xa=p&&p.Tb||void 0,this.Ca=p&&p.useFetchStreams||!1,this.L=void 0,this.J=p&&p.supportsCrossDomainXhr||!1,this.K="",this.h=new Ro(p&&p.concurrentRequestLimit),this.Da=new Hp,this.P=p&&p.fastHandshake||!1,this.O=p&&p.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=p&&p.Rb||!1,p&&p.xa&&this.j.xa(),p&&p.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&p&&p.detectBufferingProxy||!1,this.ja=void 0,p&&p.longPollingTimeout&&0<p.longPollingTimeout&&(this.ja=p.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}r=xc.prototype,r.la=8,r.G=1,r.connect=function(p,w,S,D){Dt(0),this.W=p,this.H=w||{},S&&D!==void 0&&(this.H.OSID=S,this.H.OAID=D),this.F=this.X,this.I=Uh(this,null,this.W),us(this)};function un(p){if($a(p),p.G==3){var w=p.U++,S=tr(p.I);if(ot(S,"SID",p.K),ot(S,"RID",w),ot(S,"TYPE","terminate"),Gs(p,S),w=new Or(p,p.j,w),w.L=2,w.v=xi(tr(S)),S=!1,c.navigator&&c.navigator.sendBeacon)try{S=c.navigator.sendBeacon(w.v.toString(),"")}catch{}!S&&c.Image&&(new Image().src=w.v,S=!0),S||(w.g=zh(w.j,null),w.g.ea(w.v)),w.F=Date.now(),ct(w)}Bh(p)}function Ur(p){p.g&&(Cc(p),p.g.cancel(),p.g=null)}function $a(p){Ur(p),p.u&&(c.clearTimeout(p.u),p.u=null),Ga(p),p.h.cancel(),p.s&&(typeof p.s=="number"&&c.clearTimeout(p.s),p.s=null)}function us(p){if(!er(p.h)&&!p.s){p.s=!0;var w=p.Ga;Z||ee(),te||(Z(),te=!0),de.add(w,p),p.B=0}}function Gp(p,w){return Ih(p.h)>=p.h.j-(p.s?1:0)?!1:p.s?(p.i=w.D.concat(p.i),!0):p.G==1||p.G==2||p.B>=(p.Va?0:p.Wa)?!1:(p.s=Lr(y(p.Ga,p,w),jh(p,p.B)),p.B++,!0)}r.Ga=function(p){if(this.s)if(this.s=null,this.G==1){if(!p){this.U=Math.floor(1e5*Math.random()),p=this.U++;const q=new Or(this,this.j,p);let J=this.o;if(this.S&&(J?(J=C(J),N(J,this.S)):J=this.S),this.m!==null||this.O||(q.H=J,J=null),this.P)e:{for(var w=0,S=0;S<this.i.length;S++){t:{var D=this.i[S];if("__data__"in D.map&&(D=D.map.__data__,typeof D=="string")){D=D.length;break t}D=void 0}if(D===void 0)break;if(w+=D,4096<w){w=S;break e}if(w===4096||S===this.i.length-1){w=S+1;break e}}w=1e3}else w=1e3;w=Pi(this,q,w),S=tr(this.I),ot(S,"RID",p),ot(S,"CVER",22),this.D&&ot(S,"X-HTTP-Session-Id",this.D),Gs(this,S),J&&(this.O?w="headers="+encodeURIComponent(String(Ws(J)))+"&"+w:this.m&&ki(S,this.m,J)),Ec(this.h,q),this.Ua&&ot(S,"TYPE","init"),this.P?(ot(S,"$req",w),ot(S,"SID","null"),q.T=!0,Oa(q,S,null)):Oa(q,S,w),this.G=2}}else this.G==3&&(p?Ha(this,p):this.i.length==0||er(this.h)||Ha(this))};function Ha(p,w){var S;w?S=w.l:S=p.U++;const D=tr(p.I);ot(D,"SID",p.K),ot(D,"RID",S),ot(D,"AID",p.T),Gs(p,D),p.m&&p.o&&ki(D,p.m,p.o),S=new Or(p,p.j,S,p.B+1),p.m===null&&(S.H=p.o),w&&(p.i=w.D.concat(p.i)),w=Pi(p,S,1e3),S.I=Math.round(.5*p.wa)+Math.round(.5*p.wa*Math.random()),Ec(p.h,S),Oa(S,D,w)}function Gs(p,w){p.H&&$(p.H,function(S,D){ot(w,D,S)}),p.l&&bi({},function(S,D){ot(w,D,S)})}function Pi(p,w,S){S=Math.min(p.i.length,S);var D=p.l?y(p.l.Na,p.l,p):null;e:{var q=p.i;let J=-1;for(;;){const he=["count="+S];J==-1?0<S?(J=q[0].g,he.push("ofs="+J)):J=0:he.push("ofs="+J);let rt=!0;for(let Kt=0;Kt<S;Kt++){let Qe=q[Kt].g;const tn=q[Kt].map;if(Qe-=J,0>Qe)J=Math.max(0,q[Kt].g-100),rt=!1;else try{Oh(tn,he,"req"+Qe+"_")}catch{D&&D(tn)}}if(rt){D=he.join("&");break e}}}return p=p.i.splice(0,S),w.D=p,D}function Oo(p){if(!p.g&&!p.u){p.Y=1;var w=p.Fa;Z||ee(),te||(Z(),te=!0),de.add(w,p),p.v=0}}function Wa(p){return p.g||p.u||3<=p.v?!1:(p.Y++,p.u=Lr(y(p.Fa,p),jh(p,p.v)),p.v++,!0)}r.Fa=function(){if(this.u=null,Vh(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var p=2*this.R;this.j.info("BP detection timer enabled: "+p),this.A=Lr(y(this.ab,this),p)}},r.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Dt(10),Ur(this),Vh(this))};function Cc(p){p.A!=null&&(c.clearTimeout(p.A),p.A=null)}function Vh(p){p.g=new Or(p,p.j,"rpc",p.Y),p.m===null&&(p.g.H=p.o),p.g.O=0;var w=tr(p.qa);ot(w,"RID","rpc"),ot(w,"SID",p.K),ot(w,"AID",p.T),ot(w,"CI",p.F?"0":"1"),!p.F&&p.ja&&ot(w,"TO",p.ja),ot(w,"TYPE","xmlhttp"),Gs(p,w),p.m&&p.o&&ki(w,p.m,p.o),p.L&&(p.g.I=p.L);var S=p.g;p=p.ia,S.L=1,S.v=xi(tr(w)),S.m=null,S.P=!0,_c(S,p)}r.Za=function(){this.C!=null&&(this.C=null,Ur(this),Wa(this),Dt(19))};function Ga(p){p.C!=null&&(c.clearTimeout(p.C),p.C=null)}function qa(p,w){var S=null;if(p.g==w){Ga(p),Cc(p),p.g=null;var D=2}else if(Ln(p.h,w))S=w.D,kh(p.h,w),D=1;else return;if(p.G!=0){if(w.o)if(D==1){S=w.m?w.m.length:0,w=Date.now()-w.F;var q=p.B;D=xo(),st(D,new Da(D,S)),us(p)}else Oo(p);else if(q=w.s,q==3||q==0&&0<w.X||!(D==1&&Gp(p,w)||D==2&&Wa(p)))switch(S&&0<S.length&&(w=p.h,w.i=w.i.concat(S)),q){case 1:qs(p,5);break;case 4:qs(p,10);break;case 3:qs(p,6);break;default:qs(p,2)}}}function jh(p,w){let S=p.Ta+Math.floor(Math.random()*p.cb);return p.isActive()||(S*=2),S*w}function qs(p,w){if(p.j.info("Error code "+w),w==2){var S=y(p.fb,p),D=p.Xa;const q=!D;D=new $s(D||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||Lo(D,"https"),xi(D),q?$p(D.toString(),S):Nh(D.toString(),S)}else Dt(2);p.G=0,p.l&&p.l.sa(w),Bh(p),$a(p)}r.fb=function(p){p?(this.j.info("Successfully pinged google.com"),Dt(2)):(this.j.info("Failed to ping google.com"),Dt(1))};function Bh(p){if(p.G=0,p.ka=[],p.l){const w=Ph(p.h);(w.length!=0||p.i.length!=0)&&(T(p.ka,w),T(p.ka,p.i),p.h.i.length=0,b(p.i),p.i.length=0),p.l.ra()}}function Uh(p,w,S){var D=S instanceof $s?tr(S):new $s(S);if(D.g!="")w&&(D.g=w+"."+D.g),Ti(D,D.s);else{var q=c.location;D=q.protocol,w=w?w+"."+q.hostname:q.hostname,q=+q.port;var J=new $s(null);D&&Lo(J,D),w&&(J.g=w),q&&Ti(J,q),S&&(J.l=S),D=J}return S=p.D,w=p.ya,S&&w&&ot(D,S,w),ot(D,"VER",p.la),Gs(p,D),D}function zh(p,w,S){if(w&&!p.J)throw Error("Can't create secondary domain capable XhrIo object.");return w=p.Ca&&!p.pa?new vt(new Hs({eb:S})):new vt(p.pa),w.Ha(p.J),w}r.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ic(){}r=Ic.prototype,r.ua=function(){},r.ta=function(){},r.sa=function(){},r.ra=function(){},r.isActive=function(){return!0},r.Na=function(){};function Ka(){}Ka.prototype.g=function(p,w){return new Mn(p,w)};function Mn(p,w){Rt.call(this),this.g=new xc(w),this.l=p,this.h=w&&w.messageUrlParams||null,p=w&&w.messageHeaders||null,w&&w.clientProtocolHeaderRequired&&(p?p["X-Client-Protocol"]="webchannel":p={"X-Client-Protocol":"webchannel"}),this.g.o=p,p=w&&w.initMessageHeaders||null,w&&w.messageContentType&&(p?p["X-WebChannel-Content-Type"]=w.messageContentType:p={"X-WebChannel-Content-Type":w.messageContentType}),w&&w.va&&(p?p["X-WebChannel-Client-Profile"]=w.va:p={"X-WebChannel-Client-Profile":w.va}),this.g.S=p,(p=w&&w.Sb)&&!M(p)&&(this.g.m=p),this.v=w&&w.supportsCrossDomainXhr||!1,this.u=w&&w.sendRawJson||!1,(w=w&&w.httpSessionIdParam)&&!M(w)&&(this.g.D=w,p=this.h,p!==null&&w in p&&(p=this.h,w in p&&delete p[w])),this.j=new hs(this)}A(Mn,Rt),Mn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Mn.prototype.close=function(){un(this.g)},Mn.prototype.o=function(p){var w=this.g;if(typeof p=="string"){var S={};S.__data__=p,p=S}else this.u&&(S={},S.__data__=hc(p),p=S);w.i.push(new Ch(w.Ya++,p)),w.G==3&&us(w)},Mn.prototype.N=function(){this.g.l=null,delete this.j,un(this.g),delete this.g,Mn.aa.N.call(this)};function $h(p){is.call(this),p.__headers__&&(this.headers=p.__headers__,this.statusCode=p.__status__,delete p.__headers__,delete p.__status__);var w=p.__sm__;if(w){e:{for(const S in w){p=S;break e}p=void 0}(this.i=p)&&(p=this.i,w=w!==null&&p in w?w[p]:void 0),this.data=w}else this.data=p}A($h,is);function Hh(){Ra.call(this),this.status=1}A(Hh,Ra);function hs(p){this.g=p}A(hs,Ic),hs.prototype.ua=function(){st(this.g,"a")},hs.prototype.ta=function(p){st(this.g,new $h(p))},hs.prototype.sa=function(p){st(this.g,new Hh)},hs.prototype.ra=function(){st(this.g,"b")},Ka.prototype.createWebChannel=Ka.prototype.g,Mn.prototype.send=Mn.prototype.o,Mn.prototype.open=Mn.prototype.m,Mn.prototype.close=Mn.prototype.close,BT=function(){return new Ka},jT=function(){return xo()},VT=os,uy={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ma.NO_ERROR=0,Ma.TIMEOUT=8,Ma.HTTP_ERROR=6,of=Ma,bh.COMPLETE="complete",FT=bh,Pa.EventType=pr,pr.OPEN="a",pr.CLOSE="b",pr.ERROR="c",pr.MESSAGE="d",Rt.prototype.listen=Rt.prototype.K,au=Pa,vt.prototype.listenOnce=vt.prototype.L,vt.prototype.getLastError=vt.prototype.Ka,vt.prototype.getLastErrorCode=vt.prototype.Ba,vt.prototype.getStatus=vt.prototype.Z,vt.prototype.getResponseJson=vt.prototype.Oa,vt.prototype.getResponseText=vt.prototype.oa,vt.prototype.send=vt.prototype.ea,vt.prototype.setWithCredentials=vt.prototype.Ha,OT=vt}).apply(typeof jd<"u"?jd:typeof self<"u"?self:typeof window<"u"?window:{});const U1="@firebase/firestore",z1="4.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class In{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}In.UNAUTHENTICATED=new In(null),In.GOOGLE_CREDENTIALS=new In("google-credentials-uid"),In.FIRST_PARTY=new In("first-party-uid"),In.MOCK_USER=new In("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zl="12.0.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const da=new dv("@firebase/firestore");function gl(){return da.logLevel}function pe(r,...e){if(da.logLevel<=Ge.DEBUG){const t=e.map(mv);da.debug(`Firestore (${Zl}): ${r}`,...t)}}function di(r,...e){if(da.logLevel<=Ge.ERROR){const t=e.map(mv);da.error(`Firestore (${Zl}): ${r}`,...t)}}function jl(r,...e){if(da.logLevel<=Ge.WARN){const t=e.map(mv);da.warn(`Firestore (${Zl}): ${r}`,...t)}}function mv(r){if(typeof r=="string")return r;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(r)}catch{return r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Me(r,e,t){let n="Unexpected state";typeof e=="string"?n=e:t=e,UT(r,n,t)}function UT(r,e,t){let n=`FIRESTORE (${Zl}) INTERNAL ASSERTION FAILED: ${e} (ID: ${r.toString(16)})`;if(t!==void 0)try{n+=" CONTEXT: "+JSON.stringify(t)}catch{n+=" CONTEXT: "+t}throw di(n),new Error(n)}function nt(r,e,t,n){let s="Unexpected state";typeof t=="string"?s=t:n=t,r||UT(e,s,n)}function je(r,e){return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const re={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class we extends Bs{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ai{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zT{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class YD{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(In.UNAUTHENTICATED))}shutdown(){}}class QD{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class JD{constructor(e){this.t=e,this.currentUser=In.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){nt(this.o===void 0,42304);let n=this.i;const s=u=>this.i!==n?(n=this.i,t(u)):Promise.resolve();let i=new ai;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new ai,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await s(this.currentUser)})},c=u=>{pe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>c(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?c(u):(pe("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new ai)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(n=>this.i!==e?(pe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(nt(typeof n.accessToken=="string",31837,{l:n}),new zT(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return nt(e===null||typeof e=="string",2055,{h:e}),new In(e)}}class ZD{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=In.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class eL{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new ZD(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(In.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class $1{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class tL{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Ir(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){nt(this.o===void 0,3512);const n=i=>{i.error!=null&&pe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,pe("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>n(i))};const s=i=>{pe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):pe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new $1(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(nt(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new $1(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nL(r){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(r);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let n=0;n<r;n++)t[n]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gv{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const s=nL(40);for(let i=0;i<s.length;++i)n.length<20&&s[i]<t&&(n+=e.charAt(s[i]%62))}return n}}function Ke(r,e){return r<e?-1:r>e?1:0}function hy(r,e){const t=Math.min(r.length,e.length);for(let n=0;n<t;n++){const s=r.charAt(n),i=e.charAt(n);if(s!==i)return Sg(s)===Sg(i)?Ke(s,i):Sg(s)?1:-1}return Ke(r.length,e.length)}const rL=55296,sL=57343;function Sg(r){const e=r.charCodeAt(0);return e>=rL&&e<=sL}function Bl(r,e,t){return r.length===e.length&&r.every((n,s)=>t(n,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H1="__name__";class Es{constructor(e,t,n){t===void 0?t=0:t>e.length&&Me(637,{offset:t,range:e.length}),n===void 0?n=e.length-t:n>e.length-t&&Me(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return Es.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Es?e.forEach(n=>{t.push(n)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let s=0;s<n;s++){const i=Es.compareSegments(e.get(s),t.get(s));if(i!==0)return i}return Ke(e.length,t.length)}static compareSegments(e,t){const n=Es.isNumericId(e),s=Es.isNumericId(t);return n&&!s?-1:!n&&s?1:n&&s?Es.extractNumericId(e).compare(Es.extractNumericId(t)):hy(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return to.fromString(e.substring(4,e.length-2))}}class pt extends Es{construct(e,t,n){return new pt(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new we(re.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(s=>s.length>0))}return new pt(t)}static emptyPath(){return new pt([])}}const iL=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class gn extends Es{construct(e,t,n){return new gn(e,t,n)}static isValidIdentifier(e){return iL.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),gn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===H1}static keyField(){return new gn([H1])}static fromServerFormat(e){const t=[];let n="",s=0;const i=()=>{if(n.length===0)throw new we(re.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let o=!1;for(;s<e.length;){const c=e[s];if(c==="\\"){if(s+1===e.length)throw new we(re.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new we(re.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=u,s+=2}else c==="`"?(o=!o,s++):c!=="."||o?(n+=c,s++):(i(),s++)}if(i(),o)throw new we(re.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new gn(t)}static emptyPath(){return new gn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Se{constructor(e){this.path=e}static fromPath(e){return new Se(pt.fromString(e))}static fromName(e){return new Se(pt.fromString(e).popFirst(5))}static empty(){return new Se(pt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&pt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return pt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Se(new pt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $T(r,e,t){if(!t)throw new we(re.INVALID_ARGUMENT,`Function ${r}() cannot be called with an empty ${e}.`)}function oL(r,e,t,n){if(e===!0&&n===!0)throw new we(re.INVALID_ARGUMENT,`${r} and ${t} cannot be used together.`)}function W1(r){if(!Se.isDocumentKey(r))throw new we(re.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${r} has ${r.length}.`)}function G1(r){if(Se.isDocumentKey(r))throw new we(re.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${r} has ${r.length}.`)}function HT(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}function yv(r){if(r===void 0)return"undefined";if(r===null)return"null";if(typeof r=="string")return r.length>20&&(r=`${r.substring(0,20)}...`),JSON.stringify(r);if(typeof r=="number"||typeof r=="boolean")return""+r;if(typeof r=="object"){if(r instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(r);return e?`a custom ${e} object`:"an object"}}return typeof r=="function"?"a function":Me(12329,{type:typeof r})}function fi(r,e){if("_delegate"in r&&(r=r._delegate),!(r instanceof e)){if(e.name===r.constructor.name)throw new we(re.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=yv(r);throw new we(re.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return r}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gt(r,e){const t={typeString:r};return e&&(t.value=e),t}function nh(r,e){if(!HT(r))throw new we(re.INVALID_ARGUMENT,"JSON must be an object");let t;for(const n in e)if(e[n]){const s=e[n].typeString,i="value"in e[n]?{value:e[n].value}:void 0;if(!(n in r)){t=`JSON missing required field: '${n}'`;break}const o=r[n];if(s&&typeof o!==s){t=`JSON field '${n}' must be a ${s}.`;break}if(i!==void 0&&o!==i.value){t=`Expected '${n}' field to equal '${i.value}'`;break}}if(t)throw new we(re.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q1=-62135596800,K1=1e6;class mt{static now(){return mt.fromMillis(Date.now())}static fromDate(e){return mt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*K1);return new mt(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new we(re.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new we(re.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<q1)throw new we(re.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new we(re.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/K1}_compareTo(e){return this.seconds===e.seconds?Ke(this.nanoseconds,e.nanoseconds):Ke(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:mt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(nh(e,mt._jsonSchema))return new mt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-q1;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}mt._jsonSchemaVersion="firestore/timestamp/1.0",mt._jsonSchema={type:Gt("string",mt._jsonSchemaVersion),seconds:Gt("number"),nanoseconds:Gt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fe{static fromTimestamp(e){return new Fe(e)}static min(){return new Fe(new mt(0,0))}static max(){return new Fe(new mt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Du=-1;function aL(r,e){const t=r.toTimestamp().seconds,n=r.toTimestamp().nanoseconds+1,s=Fe.fromTimestamp(n===1e9?new mt(t+1,0):new mt(t,n));return new ao(s,Se.empty(),e)}function lL(r){return new ao(r.readTime,r.key,Du)}class ao{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new ao(Fe.min(),Se.empty(),Du)}static max(){return new ao(Fe.max(),Se.empty(),Du)}}function cL(r,e){let t=r.readTime.compareTo(e.readTime);return t!==0?t:(t=Se.comparator(r.documentKey,e.documentKey),t!==0?t:Ke(r.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uL="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class hL{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ec(r){if(r.code!==re.FAILED_PRECONDITION||r.message!==uL)throw r;pe("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ne{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Me(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ne((n,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(n,s)},this.catchCallback=i=>{this.wrapFailure(t,i).next(n,s)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof ne?t:ne.resolve(t)}catch(t){return ne.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):ne.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):ne.reject(t)}static resolve(e){return new ne((t,n)=>{t(e)})}static reject(e){return new ne((t,n)=>{n(e)})}static waitFor(e){return new ne((t,n)=>{let s=0,i=0,o=!1;e.forEach(c=>{++s,c.next(()=>{++i,o&&i===s&&t()},u=>n(u))}),o=!0,i===s&&t()})}static or(e){let t=ne.resolve(!1);for(const n of e)t=t.next(s=>s?ne.resolve(s):n());return t}static forEach(e,t){const n=[];return e.forEach((s,i)=>{n.push(t.call(this,s,i))}),this.waitFor(n)}static mapArray(e,t){return new ne((n,s)=>{const i=e.length,o=new Array(i);let c=0;for(let u=0;u<i;u++){const h=u;t(e[h]).next(f=>{o[h]=f,++c,c===i&&n(o)},f=>s(f))}})}static doWhile(e,t){return new ne((n,s)=>{const i=()=>{e()===!0?t().next(()=>{i()},s):n()};i()})}}function dL(r){const e=r.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function tc(r){return r.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sp{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>t.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}sp.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vv=-1;function ip(r){return r==null}function bf(r){return r===0&&1/r==-1/0}function fL(r){return typeof r=="number"&&Number.isInteger(r)&&!bf(r)&&r<=Number.MAX_SAFE_INTEGER&&r>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WT="";function pL(r){let e="";for(let t=0;t<r.length;t++)e.length>0&&(e=X1(e)),e=mL(r.get(t),e);return X1(e)}function mL(r,e){let t=e;const n=r.length;for(let s=0;s<n;s++){const i=r.charAt(s);switch(i){case"\0":t+="";break;case WT:t+="";break;default:t+=i}}return t}function X1(r){return r+WT+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y1(r){let e=0;for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e++;return e}function Ea(r,e){for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e(t,r[t])}function GT(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class It{constructor(e,t){this.comparator=e,this.root=t||pn.EMPTY}insert(e,t){return new It(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,pn.BLACK,null,null))}remove(e){return new It(this.comparator,this.root.remove(e,this.comparator).copy(null,null,pn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return t+n.left.size;s<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Bd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Bd(this.root,e,this.comparator,!1)}getReverseIterator(){return new Bd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Bd(this.root,e,this.comparator,!0)}}class Bd{constructor(e,t,n,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class pn{constructor(e,t,n,s,i){this.key=e,this.value=t,this.color=n??pn.RED,this.left=s??pn.EMPTY,this.right=i??pn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,s,i){return new pn(e??this.key,t??this.value,n??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let s=this;const i=n(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,t,n),null):i===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return pn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return pn.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,pn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,pn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Me(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Me(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Me(27949);return e+(this.isRed()?0:1)}}pn.EMPTY=null,pn.RED=!0,pn.BLACK=!1;pn.EMPTY=new class{constructor(){this.size=0}get key(){throw Me(57766)}get value(){throw Me(16141)}get color(){throw Me(16727)}get left(){throw Me(29726)}get right(){throw Me(36894)}copy(e,t,n,s,i){return this}insert(e,t,n){return new pn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class en{constructor(e){this.comparator=e,this.data=new It(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let n;for(n=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Q1(this.data.getIterator())}getIteratorFrom(e){return new Q1(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(n=>{t=t.add(n)}),t}isEqual(e){if(!(e instanceof en)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=n.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new en(this.comparator);return t.data=e,t}}class Q1{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qr{constructor(e){this.fields=e,e.sort(gn.comparator)}static empty(){return new Qr([])}unionWith(e){let t=new en(gn.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new Qr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Bl(this.fields,e.fields,(t,n)=>t.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qT extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new qT("Invalid base64 string: "+i):i}}(e);return new yn(t)}static fromUint8Array(e){const t=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new yn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const n=new Uint8Array(t.length);for(let s=0;s<t.length;s++)n[s]=t.charCodeAt(s);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ke(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}yn.EMPTY_BYTE_STRING=new yn("");const gL=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function lo(r){if(nt(!!r,39018),typeof r=="string"){let e=0;const t=gL.exec(r);if(nt(!!t,46558,{timestamp:r}),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const n=new Date(r);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Ft(r.seconds),nanos:Ft(r.nanos)}}function Ft(r){return typeof r=="number"?r:typeof r=="string"?Number(r):0}function co(r){return typeof r=="string"?yn.fromBase64String(r):yn.fromUint8Array(r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KT="server_timestamp",XT="__type__",YT="__previous_value__",QT="__local_write_time__";function _v(r){return(r?.mapValue?.fields||{})[XT]?.stringValue===KT}function op(r){const e=r.mapValue.fields[YT];return _v(e)?op(e):e}function Lu(r){const e=lo(r.mapValue.fields[QT].timestampValue);return new mt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yL{constructor(e,t,n,s,i,o,c,u,h,f){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=h,this.isUsingEmulator=f}}const Tf="(default)";class Mu{constructor(e,t){this.projectId=e,this.database=t||Tf}static empty(){return new Mu("","")}get isDefaultDatabase(){return this.database===Tf}isEqual(e){return e instanceof Mu&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JT="__type__",vL="__max__",Ud={mapValue:{}},ZT="__vector__",Sf="value";function uo(r){return"nullValue"in r?0:"booleanValue"in r?1:"integerValue"in r||"doubleValue"in r?2:"timestampValue"in r?3:"stringValue"in r?5:"bytesValue"in r?6:"referenceValue"in r?7:"geoPointValue"in r?8:"arrayValue"in r?9:"mapValue"in r?_v(r)?4:wL(r)?9007199254740991:_L(r)?10:11:Me(28295,{value:r})}function Os(r,e){if(r===e)return!0;const t=uo(r);if(t!==uo(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return r.booleanValue===e.booleanValue;case 4:return Lu(r).isEqual(Lu(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=lo(s.timestampValue),c=lo(i.timestampValue);return o.seconds===c.seconds&&o.nanos===c.nanos}(r,e);case 5:return r.stringValue===e.stringValue;case 6:return function(s,i){return co(s.bytesValue).isEqual(co(i.bytesValue))}(r,e);case 7:return r.referenceValue===e.referenceValue;case 8:return function(s,i){return Ft(s.geoPointValue.latitude)===Ft(i.geoPointValue.latitude)&&Ft(s.geoPointValue.longitude)===Ft(i.geoPointValue.longitude)}(r,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Ft(s.integerValue)===Ft(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=Ft(s.doubleValue),c=Ft(i.doubleValue);return o===c?bf(o)===bf(c):isNaN(o)&&isNaN(c)}return!1}(r,e);case 9:return Bl(r.arrayValue.values||[],e.arrayValue.values||[],Os);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},c=i.mapValue.fields||{};if(Y1(o)!==Y1(c))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(c[u]===void 0||!Os(o[u],c[u])))return!1;return!0}(r,e);default:return Me(52216,{left:r})}}function Nu(r,e){return(r.values||[]).find(t=>Os(t,e))!==void 0}function Ul(r,e){if(r===e)return 0;const t=uo(r),n=uo(e);if(t!==n)return Ke(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return Ke(r.booleanValue,e.booleanValue);case 2:return function(i,o){const c=Ft(i.integerValue||i.doubleValue),u=Ft(o.integerValue||o.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1}(r,e);case 3:return J1(r.timestampValue,e.timestampValue);case 4:return J1(Lu(r),Lu(e));case 5:return hy(r.stringValue,e.stringValue);case 6:return function(i,o){const c=co(i),u=co(o);return c.compareTo(u)}(r.bytesValue,e.bytesValue);case 7:return function(i,o){const c=i.split("/"),u=o.split("/");for(let h=0;h<c.length&&h<u.length;h++){const f=Ke(c[h],u[h]);if(f!==0)return f}return Ke(c.length,u.length)}(r.referenceValue,e.referenceValue);case 8:return function(i,o){const c=Ke(Ft(i.latitude),Ft(o.latitude));return c!==0?c:Ke(Ft(i.longitude),Ft(o.longitude))}(r.geoPointValue,e.geoPointValue);case 9:return Z1(r.arrayValue,e.arrayValue);case 10:return function(i,o){const c=i.fields||{},u=o.fields||{},h=c[Sf]?.arrayValue,f=u[Sf]?.arrayValue,m=Ke(h?.values?.length||0,f?.values?.length||0);return m!==0?m:Z1(h,f)}(r.mapValue,e.mapValue);case 11:return function(i,o){if(i===Ud.mapValue&&o===Ud.mapValue)return 0;if(i===Ud.mapValue)return 1;if(o===Ud.mapValue)return-1;const c=i.fields||{},u=Object.keys(c),h=o.fields||{},f=Object.keys(h);u.sort(),f.sort();for(let m=0;m<u.length&&m<f.length;++m){const y=hy(u[m],f[m]);if(y!==0)return y;const _=Ul(c[u[m]],h[f[m]]);if(_!==0)return _}return Ke(u.length,f.length)}(r.mapValue,e.mapValue);default:throw Me(23264,{he:t})}}function J1(r,e){if(typeof r=="string"&&typeof e=="string"&&r.length===e.length)return Ke(r,e);const t=lo(r),n=lo(e),s=Ke(t.seconds,n.seconds);return s!==0?s:Ke(t.nanos,n.nanos)}function Z1(r,e){const t=r.values||[],n=e.values||[];for(let s=0;s<t.length&&s<n.length;++s){const i=Ul(t[s],n[s]);if(i)return i}return Ke(t.length,n.length)}function zl(r){return dy(r)}function dy(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?function(t){const n=lo(t);return`time(${n.seconds},${n.nanos})`}(r.timestampValue):"stringValue"in r?r.stringValue:"bytesValue"in r?function(t){return co(t).toBase64()}(r.bytesValue):"referenceValue"in r?function(t){return Se.fromName(t).toString()}(r.referenceValue):"geoPointValue"in r?function(t){return`geo(${t.latitude},${t.longitude})`}(r.geoPointValue):"arrayValue"in r?function(t){let n="[",s=!0;for(const i of t.values||[])s?s=!1:n+=",",n+=dy(i);return n+"]"}(r.arrayValue):"mapValue"in r?function(t){const n=Object.keys(t.fields||{}).sort();let s="{",i=!0;for(const o of n)i?i=!1:s+=",",s+=`${o}:${dy(t.fields[o])}`;return s+"}"}(r.mapValue):Me(61005,{value:r})}function af(r){switch(uo(r)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=op(r);return e?16+af(e):16;case 5:return 2*r.stringValue.length;case 6:return co(r.bytesValue).approximateByteSize();case 7:return r.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((s,i)=>s+af(i),0)}(r.arrayValue);case 10:case 11:return function(n){let s=0;return Ea(n.fields,(i,o)=>{s+=i.length+af(o)}),s}(r.mapValue);default:throw Me(13486,{value:r})}}function fy(r){return!!r&&"integerValue"in r}function wv(r){return!!r&&"arrayValue"in r}function eE(r){return!!r&&"nullValue"in r}function tE(r){return!!r&&"doubleValue"in r&&isNaN(Number(r.doubleValue))}function lf(r){return!!r&&"mapValue"in r}function _L(r){return(r?.mapValue?.fields||{})[JT]?.stringValue===ZT}function vu(r){if(r.geoPointValue)return{geoPointValue:{...r.geoPointValue}};if(r.timestampValue&&typeof r.timestampValue=="object")return{timestampValue:{...r.timestampValue}};if(r.mapValue){const e={mapValue:{fields:{}}};return Ea(r.mapValue.fields,(t,n)=>e.mapValue.fields[t]=vu(n)),e}if(r.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(r.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=vu(r.arrayValue.values[t]);return e}return{...r}}function wL(r){return(((r.mapValue||{}).fields||{}).__type__||{}).stringValue===vL}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kr{constructor(e){this.value=e}static empty(){return new kr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!lf(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=vu(t)}setAll(e){let t=gn.emptyPath(),n={},s=[];e.forEach((o,c)=>{if(!t.isImmediateParentOf(c)){const u=this.getFieldsMap(t);this.applyChanges(u,n,s),n={},s=[],t=c.popLast()}o?n[c.lastSegment()]=vu(o):s.push(c.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,n,s)}delete(e){const t=this.field(e.popLast());lf(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Os(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let s=t.mapValue.fields[e.get(n)];lf(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,n){Ea(t,(s,i)=>e[s]=i);for(const s of n)delete e[s]}clone(){return new kr(vu(this.value))}}function eS(r){const e=[];return Ea(r.fields,(t,n)=>{const s=new gn([t]);if(lf(n)){const i=eS(n.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new Qr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kn{constructor(e,t,n,s,i,o,c){this.key=e,this.documentType=t,this.version=n,this.readTime=s,this.createTime=i,this.data=o,this.documentState=c}static newInvalidDocument(e){return new kn(e,0,Fe.min(),Fe.min(),Fe.min(),kr.empty(),0)}static newFoundDocument(e,t,n,s){return new kn(e,1,t,Fe.min(),n,s,0)}static newNoDocument(e,t){return new kn(e,2,t,Fe.min(),Fe.min(),kr.empty(),0)}static newUnknownDocument(e,t){return new kn(e,3,t,Fe.min(),Fe.min(),kr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Fe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=kr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=kr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Fe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof kn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new kn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xf{constructor(e,t){this.position=e,this.inclusive=t}}function nE(r,e,t){let n=0;for(let s=0;s<r.position.length;s++){const i=e[s],o=r.position[s];if(i.field.isKeyField()?n=Se.comparator(Se.fromName(o.referenceValue),t.key):n=Ul(o,t.data.field(i.field)),i.dir==="desc"&&(n*=-1),n!==0)break}return n}function rE(r,e){if(r===null)return e===null;if(e===null||r.inclusive!==e.inclusive||r.position.length!==e.position.length)return!1;for(let t=0;t<r.position.length;t++)if(!Os(r.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cf{constructor(e,t="asc"){this.field=e,this.dir=t}}function EL(r,e){return r.dir===e.dir&&r.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tS{}class Jt extends tS{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,n):new bL(e,t,n):t==="array-contains"?new xL(e,n):t==="in"?new CL(e,n):t==="not-in"?new IL(e,n):t==="array-contains-any"?new kL(e,n):new Jt(e,t,n)}static createKeyFieldInFilter(e,t,n){return t==="in"?new TL(e,n):new SL(e,n)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Ul(t,this.value)):t!==null&&uo(this.value)===uo(t)&&this.matchesComparison(Ul(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Me(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Fs extends tS{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Fs(e,t)}matches(e){return nS(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function nS(r){return r.op==="and"}function rS(r){return AL(r)&&nS(r)}function AL(r){for(const e of r.filters)if(e instanceof Fs)return!1;return!0}function py(r){if(r instanceof Jt)return r.field.canonicalString()+r.op.toString()+zl(r.value);if(rS(r))return r.filters.map(e=>py(e)).join(",");{const e=r.filters.map(t=>py(t)).join(",");return`${r.op}(${e})`}}function sS(r,e){return r instanceof Jt?function(n,s){return s instanceof Jt&&n.op===s.op&&n.field.isEqual(s.field)&&Os(n.value,s.value)}(r,e):r instanceof Fs?function(n,s){return s instanceof Fs&&n.op===s.op&&n.filters.length===s.filters.length?n.filters.reduce((i,o,c)=>i&&sS(o,s.filters[c]),!0):!1}(r,e):void Me(19439)}function iS(r){return r instanceof Jt?function(t){return`${t.field.canonicalString()} ${t.op} ${zl(t.value)}`}(r):r instanceof Fs?function(t){return t.op.toString()+" {"+t.getFilters().map(iS).join(" ,")+"}"}(r):"Filter"}class bL extends Jt{constructor(e,t,n){super(e,t,n),this.key=Se.fromName(n.referenceValue)}matches(e){const t=Se.comparator(e.key,this.key);return this.matchesComparison(t)}}class TL extends Jt{constructor(e,t){super(e,"in",t),this.keys=oS("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class SL extends Jt{constructor(e,t){super(e,"not-in",t),this.keys=oS("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function oS(r,e){return(e.arrayValue?.values||[]).map(t=>Se.fromName(t.referenceValue))}class xL extends Jt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return wv(t)&&Nu(t.arrayValue,this.value)}}class CL extends Jt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Nu(this.value.arrayValue,t)}}class IL extends Jt{constructor(e,t){super(e,"not-in",t)}matches(e){if(Nu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Nu(this.value.arrayValue,t)}}class kL extends Jt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!wv(t)||!t.arrayValue.values)&&t.arrayValue.values.some(n=>Nu(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PL{constructor(e,t=null,n=[],s=[],i=null,o=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=s,this.limit=i,this.startAt=o,this.endAt=c,this.Te=null}}function sE(r,e=null,t=[],n=[],s=null,i=null,o=null){return new PL(r,e,t,n,s,i,o)}function Ev(r){const e=je(r);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(n=>py(n)).join(","),t+="|ob:",t+=e.orderBy.map(n=>function(i){return i.field.canonicalString()+i.dir}(n)).join(","),ip(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>zl(n)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>zl(n)).join(",")),e.Te=t}return e.Te}function Av(r,e){if(r.limit!==e.limit||r.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<r.orderBy.length;t++)if(!EL(r.orderBy[t],e.orderBy[t]))return!1;if(r.filters.length!==e.filters.length)return!1;for(let t=0;t<r.filters.length;t++)if(!sS(r.filters[t],e.filters[t]))return!1;return r.collectionGroup===e.collectionGroup&&!!r.path.isEqual(e.path)&&!!rE(r.startAt,e.startAt)&&rE(r.endAt,e.endAt)}function my(r){return Se.isDocumentKey(r.path)&&r.collectionGroup===null&&r.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ap{constructor(e,t=null,n=[],s=[],i=null,o="F",c=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=s,this.limit=i,this.limitType=o,this.startAt=c,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function RL(r,e,t,n,s,i,o,c){return new ap(r,e,t,n,s,i,o,c)}function bv(r){return new ap(r)}function iE(r){return r.filters.length===0&&r.limit===null&&r.startAt==null&&r.endAt==null&&(r.explicitOrderBy.length===0||r.explicitOrderBy.length===1&&r.explicitOrderBy[0].field.isKeyField())}function DL(r){return r.collectionGroup!==null}function _u(r){const e=je(r);if(e.Ie===null){e.Ie=[];const t=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),t.add(i.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let c=new en(gn.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(h=>{h.isInequality()&&(c=c.add(h.field))})}),c})(e).forEach(i=>{t.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new Cf(i,n))}),t.has(gn.keyField().canonicalString())||e.Ie.push(new Cf(gn.keyField(),n))}return e.Ie}function Cs(r){const e=je(r);return e.Ee||(e.Ee=LL(e,_u(r))),e.Ee}function LL(r,e){if(r.limitType==="F")return sE(r.path,r.collectionGroup,e,r.filters,r.limit,r.startAt,r.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Cf(s.field,i)});const t=r.endAt?new xf(r.endAt.position,r.endAt.inclusive):null,n=r.startAt?new xf(r.startAt.position,r.startAt.inclusive):null;return sE(r.path,r.collectionGroup,e,r.filters,r.limit,t,n)}}function gy(r,e,t){return new ap(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),e,t,r.startAt,r.endAt)}function lp(r,e){return Av(Cs(r),Cs(e))&&r.limitType===e.limitType}function aS(r){return`${Ev(Cs(r))}|lt:${r.limitType}`}function yl(r){return`Query(target=${function(t){let n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map(s=>iS(s)).join(", ")}]`),ip(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(s=>zl(s)).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(s=>zl(s)).join(",")),`Target(${n})`}(Cs(r))}; limitType=${r.limitType})`}function cp(r,e){return e.isFoundDocument()&&function(n,s){const i=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(i):Se.isDocumentKey(n.path)?n.path.isEqual(i):n.path.isImmediateParentOf(i)}(r,e)&&function(n,s){for(const i of _u(n))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(r,e)&&function(n,s){for(const i of n.filters)if(!i.matches(s))return!1;return!0}(r,e)&&function(n,s){return!(n.startAt&&!function(o,c,u){const h=nE(o,c,u);return o.inclusive?h<=0:h<0}(n.startAt,_u(n),s)||n.endAt&&!function(o,c,u){const h=nE(o,c,u);return o.inclusive?h>=0:h>0}(n.endAt,_u(n),s))}(r,e)}function ML(r){return r.collectionGroup||(r.path.length%2==1?r.path.lastSegment():r.path.get(r.path.length-2))}function lS(r){return(e,t)=>{let n=!1;for(const s of _u(r)){const i=NL(s,e,t);if(i!==0)return i;n=n||s.field.isKeyField()}return 0}}function NL(r,e,t){const n=r.field.isKeyField()?Se.comparator(e.key,t.key):function(i,o,c){const u=o.data.field(i),h=c.data.field(i);return u!==null&&h!==null?Ul(u,h):Me(42886)}(r.field,e,t);switch(r.dir){case"asc":return n;case"desc":return-1*n;default:return Me(19790,{direction:r.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aa{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(const[s,i]of n)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],e))return n.length===1?delete this.inner[t]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Ea(this.inner,(t,n)=>{for(const[s,i]of n)e(s,i)})}isEmpty(){return GT(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OL=new It(Se.comparator);function pi(){return OL}const cS=new It(Se.comparator);function lu(...r){let e=cS;for(const t of r)e=e.insert(t.key,t);return e}function uS(r){let e=cS;return r.forEach((t,n)=>e=e.insert(t,n.overlayedDocument)),e}function na(){return wu()}function hS(){return wu()}function wu(){return new Aa(r=>r.toString(),(r,e)=>r.isEqual(e))}const FL=new It(Se.comparator),VL=new en(Se.comparator);function Xe(...r){let e=VL;for(const t of r)e=e.add(t);return e}const jL=new en(Ke);function BL(){return jL}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tv(r,e){if(r.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:bf(e)?"-0":e}}function dS(r){return{integerValue:""+r}}function UL(r,e){return fL(e)?dS(e):Tv(r,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class up{constructor(){this._=void 0}}function zL(r,e,t){return r instanceof Ou?function(s,i){const o={fields:{[XT]:{stringValue:KT},[QT]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&_v(i)&&(i=op(i)),i&&(o.fields[YT]=i),{mapValue:o}}(t,e):r instanceof Fu?pS(r,e):r instanceof Vu?mS(r,e):function(s,i){const o=fS(s,i),c=oE(o)+oE(s.Ae);return fy(o)&&fy(s.Ae)?dS(c):Tv(s.serializer,c)}(r,e)}function $L(r,e,t){return r instanceof Fu?pS(r,e):r instanceof Vu?mS(r,e):t}function fS(r,e){return r instanceof If?function(n){return fy(n)||function(i){return!!i&&"doubleValue"in i}(n)}(e)?e:{integerValue:0}:null}class Ou extends up{}class Fu extends up{constructor(e){super(),this.elements=e}}function pS(r,e){const t=gS(e);for(const n of r.elements)t.some(s=>Os(s,n))||t.push(n);return{arrayValue:{values:t}}}class Vu extends up{constructor(e){super(),this.elements=e}}function mS(r,e){let t=gS(e);for(const n of r.elements)t=t.filter(s=>!Os(s,n));return{arrayValue:{values:t}}}class If extends up{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function oE(r){return Ft(r.integerValue||r.doubleValue)}function gS(r){return wv(r)&&r.arrayValue.values?r.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HL{constructor(e,t){this.field=e,this.transform=t}}function WL(r,e){return r.field.isEqual(e.field)&&function(n,s){return n instanceof Fu&&s instanceof Fu||n instanceof Vu&&s instanceof Vu?Bl(n.elements,s.elements,Os):n instanceof If&&s instanceof If?Os(n.Ae,s.Ae):n instanceof Ou&&s instanceof Ou}(r.transform,e.transform)}class GL{constructor(e,t){this.version=e,this.transformResults=t}}class es{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new es}static exists(e){return new es(void 0,e)}static updateTime(e){return new es(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function cf(r,e){return r.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(r.updateTime):r.exists===void 0||r.exists===e.isFoundDocument()}class hp{}function yS(r,e){if(!r.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return r.isNoDocument()?new Sv(r.key,es.none()):new rh(r.key,r.data,es.none());{const t=r.data,n=kr.empty();let s=new en(gn.comparator);for(let i of e.fields)if(!s.has(i)){let o=t.field(i);o===null&&i.length>1&&(i=i.popLast(),o=t.field(i)),o===null?n.delete(i):n.set(i,o),s=s.add(i)}return new ba(r.key,n,new Qr(s.toArray()),es.none())}}function qL(r,e,t){r instanceof rh?function(s,i,o){const c=s.value.clone(),u=lE(s.fieldTransforms,i,o.transformResults);c.setAll(u),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(r,e,t):r instanceof ba?function(s,i,o){if(!cf(s.precondition,i))return void i.convertToUnknownDocument(o.version);const c=lE(s.fieldTransforms,i,o.transformResults),u=i.data;u.setAll(vS(s)),u.setAll(c),i.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(r,e,t):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function Eu(r,e,t,n){return r instanceof rh?function(i,o,c,u){if(!cf(i.precondition,o))return c;const h=i.value.clone(),f=cE(i.fieldTransforms,u,o);return h.setAll(f),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null}(r,e,t,n):r instanceof ba?function(i,o,c,u){if(!cf(i.precondition,o))return c;const h=cE(i.fieldTransforms,u,o),f=o.data;return f.setAll(vS(i)),f.setAll(h),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),c===null?null:c.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(m=>m.field))}(r,e,t,n):function(i,o,c){return cf(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):c}(r,e,t)}function KL(r,e){let t=null;for(const n of r.fieldTransforms){const s=e.data.field(n.field),i=fS(n.transform,s||null);i!=null&&(t===null&&(t=kr.empty()),t.set(n.field,i))}return t||null}function aE(r,e){return r.type===e.type&&!!r.key.isEqual(e.key)&&!!r.precondition.isEqual(e.precondition)&&!!function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&Bl(n,s,(i,o)=>WL(i,o))}(r.fieldTransforms,e.fieldTransforms)&&(r.type===0?r.value.isEqual(e.value):r.type!==1||r.data.isEqual(e.data)&&r.fieldMask.isEqual(e.fieldMask))}class rh extends hp{constructor(e,t,n,s=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class ba extends hp{constructor(e,t,n,s,i=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function vS(r){const e=new Map;return r.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const n=r.data.field(t);e.set(t,n)}}),e}function lE(r,e,t){const n=new Map;nt(r.length===t.length,32656,{Re:t.length,Ve:r.length});for(let s=0;s<t.length;s++){const i=r[s],o=i.transform,c=e.data.field(i.field);n.set(i.field,$L(o,c,t[s]))}return n}function cE(r,e,t){const n=new Map;for(const s of r){const i=s.transform,o=t.data.field(s.field);n.set(s.field,zL(i,o,e))}return n}class Sv extends hp{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class XL extends hp{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YL{constructor(e,t,n,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&qL(i,e,n[s])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Eu(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Eu(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=hS();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let c=this.applyToLocalView(o,i.mutatedFields);c=t.has(s.key)?null:c;const u=yS(o,c);u!==null&&n.set(s.key,u),o.isValidDocument()||o.convertToNoDocument(Fe.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Xe())}isEqual(e){return this.batchId===e.batchId&&Bl(this.mutations,e.mutations,(t,n)=>aE(t,n))&&Bl(this.baseMutations,e.baseMutations,(t,n)=>aE(t,n))}}class xv{constructor(e,t,n,s){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=s}static from(e,t,n){nt(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let s=function(){return FL}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,n[o].version);return new xv(e,t,n,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QL{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JL{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ht,Je;function ZL(r){switch(r){case re.OK:return Me(64938);case re.CANCELLED:case re.UNKNOWN:case re.DEADLINE_EXCEEDED:case re.RESOURCE_EXHAUSTED:case re.INTERNAL:case re.UNAVAILABLE:case re.UNAUTHENTICATED:return!1;case re.INVALID_ARGUMENT:case re.NOT_FOUND:case re.ALREADY_EXISTS:case re.PERMISSION_DENIED:case re.FAILED_PRECONDITION:case re.ABORTED:case re.OUT_OF_RANGE:case re.UNIMPLEMENTED:case re.DATA_LOSS:return!0;default:return Me(15467,{code:r})}}function _S(r){if(r===void 0)return di("GRPC error has no .code"),re.UNKNOWN;switch(r){case Ht.OK:return re.OK;case Ht.CANCELLED:return re.CANCELLED;case Ht.UNKNOWN:return re.UNKNOWN;case Ht.DEADLINE_EXCEEDED:return re.DEADLINE_EXCEEDED;case Ht.RESOURCE_EXHAUSTED:return re.RESOURCE_EXHAUSTED;case Ht.INTERNAL:return re.INTERNAL;case Ht.UNAVAILABLE:return re.UNAVAILABLE;case Ht.UNAUTHENTICATED:return re.UNAUTHENTICATED;case Ht.INVALID_ARGUMENT:return re.INVALID_ARGUMENT;case Ht.NOT_FOUND:return re.NOT_FOUND;case Ht.ALREADY_EXISTS:return re.ALREADY_EXISTS;case Ht.PERMISSION_DENIED:return re.PERMISSION_DENIED;case Ht.FAILED_PRECONDITION:return re.FAILED_PRECONDITION;case Ht.ABORTED:return re.ABORTED;case Ht.OUT_OF_RANGE:return re.OUT_OF_RANGE;case Ht.UNIMPLEMENTED:return re.UNIMPLEMENTED;case Ht.DATA_LOSS:return re.DATA_LOSS;default:return Me(39323,{code:r})}}(Je=Ht||(Ht={}))[Je.OK=0]="OK",Je[Je.CANCELLED=1]="CANCELLED",Je[Je.UNKNOWN=2]="UNKNOWN",Je[Je.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Je[Je.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Je[Je.NOT_FOUND=5]="NOT_FOUND",Je[Je.ALREADY_EXISTS=6]="ALREADY_EXISTS",Je[Je.PERMISSION_DENIED=7]="PERMISSION_DENIED",Je[Je.UNAUTHENTICATED=16]="UNAUTHENTICATED",Je[Je.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Je[Je.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Je[Je.ABORTED=10]="ABORTED",Je[Je.OUT_OF_RANGE=11]="OUT_OF_RANGE",Je[Je.UNIMPLEMENTED=12]="UNIMPLEMENTED",Je[Je.INTERNAL=13]="INTERNAL",Je[Je.UNAVAILABLE=14]="UNAVAILABLE",Je[Je.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eM(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tM=new to([4294967295,4294967295],0);function uE(r){const e=eM().encode(r),t=new NT;return t.update(e),new Uint8Array(t.digest())}function hE(r){const e=new DataView(r.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new to([t,n],0),new to([s,i],0)]}class Cv{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new cu(`Invalid padding: ${t}`);if(n<0)throw new cu(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new cu(`Invalid hash count: ${n}`);if(e.length===0&&t!==0)throw new cu(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=to.fromNumber(this.ge)}ye(e,t,n){let s=e.add(t.multiply(to.fromNumber(n)));return s.compare(tM)===1&&(s=new to([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=uE(e),[n,s]=hE(t);for(let i=0;i<this.hashCount;i++){const o=this.ye(n,s,i);if(!this.we(o))return!1}return!0}static create(e,t,n){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new Cv(i,s,t);return n.forEach(c=>o.insert(c)),o}insert(e){if(this.ge===0)return;const t=uE(e),[n,s]=hE(t);for(let i=0;i<this.hashCount;i++){const o=this.ye(n,s,i);this.Se(o)}}Se(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class cu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dp{constructor(e,t,n,s,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const s=new Map;return s.set(e,sh.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new dp(Fe.min(),s,new It(Ke),pi(),Xe())}}class sh{constructor(e,t,n,s,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new sh(n,t,Xe(),Xe(),Xe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uf{constructor(e,t,n,s){this.be=e,this.removedTargetIds=t,this.key=n,this.De=s}}class wS{constructor(e,t){this.targetId=e,this.Ce=t}}class ES{constructor(e,t,n=yn.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=s}}class dE{constructor(){this.ve=0,this.Fe=fE(),this.Me=yn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Xe(),t=Xe(),n=Xe();return this.Fe.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:n=n.add(s);break;default:Me(38017,{changeType:i})}}),new sh(this.Me,this.xe,e,t,n)}qe(){this.Oe=!1,this.Fe=fE()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,nt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class nM{constructor(e){this.Ge=e,this.ze=new Map,this.je=pi(),this.Je=zd(),this.He=zd(),this.Ye=new It(Ke)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{const n=this.nt(t);switch(e.state){case 0:this.rt(t)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),n.Le(e.resumeToken));break;default:Me(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((n,s)=>{this.rt(s)&&t(s)})}st(e){const t=e.targetId,n=e.Ce.count,s=this.ot(t);if(s){const i=s.target;if(my(i))if(n===0){const o=new Se(i.path);this.et(t,o,kn.newNoDocument(o,Fe.min()))}else nt(n===1,20013,{expectedCount:n});else{const o=this._t(t);if(o!==n){const c=this.ut(e),u=c?this.ct(c,e,o):1;if(u!==0){this.it(t);const h=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,h)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:s=0},hashCount:i=0}=t;let o,c;try{o=co(n).toUint8Array()}catch(u){if(u instanceof qT)return jl("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{c=new Cv(o,s,i)}catch(u){return jl(u instanceof cu?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return c.ge===0?null:c}ct(e,t,n){return t.Ce.count===n-this.Pt(e,t.targetId)?0:2}Pt(e,t){const n=this.Ge.getRemoteKeysForTarget(t);let s=0;return n.forEach(i=>{const o=this.Ge.ht(),c=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(c)||(this.et(t,i,null),s++)}),s}Tt(e){const t=new Map;this.ze.forEach((i,o)=>{const c=this.ot(o);if(c){if(i.current&&my(c.target)){const u=new Se(c.target.path);this.It(u).has(o)||this.Et(o,u)||this.et(o,u,kn.newNoDocument(u,e))}i.Be&&(t.set(o,i.ke()),i.qe())}});let n=Xe();this.He.forEach((i,o)=>{let c=!0;o.forEachWhile(u=>{const h=this.ot(u);return!h||h.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(n=n.add(i))}),this.je.forEach((i,o)=>o.setReadTime(e));const s=new dp(e,t,this.Ye,this.je,n);return this.je=pi(),this.Je=zd(),this.He=zd(),this.Ye=new It(Ke),s}Xe(e,t){if(!this.rt(e))return;const n=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,n),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,n){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,t)?s.Qe(t,1):s.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),n&&(this.je=this.je.insert(t,n))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new dE,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new en(Ke),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new en(Ke),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||pe("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new dE),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function zd(){return new It(Se.comparator)}function fE(){return new It(Se.comparator)}const rM={asc:"ASCENDING",desc:"DESCENDING"},sM={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},iM={and:"AND",or:"OR"};class oM{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function yy(r,e){return r.useProto3Json||ip(e)?e:{value:e}}function kf(r,e){return r.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function AS(r,e){return r.useProto3Json?e.toBase64():e.toUint8Array()}function aM(r,e){return kf(r,e.toTimestamp())}function Is(r){return nt(!!r,49232),Fe.fromTimestamp(function(t){const n=lo(t);return new mt(n.seconds,n.nanos)}(r))}function Iv(r,e){return vy(r,e).canonicalString()}function vy(r,e){const t=function(s){return new pt(["projects",s.projectId,"databases",s.database])}(r).child("documents");return e===void 0?t:t.child(e)}function bS(r){const e=pt.fromString(r);return nt(IS(e),10190,{key:e.toString()}),e}function _y(r,e){return Iv(r.databaseId,e.path)}function xg(r,e){const t=bS(e);if(t.get(1)!==r.databaseId.projectId)throw new we(re.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+r.databaseId.projectId);if(t.get(3)!==r.databaseId.database)throw new we(re.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+r.databaseId.database);return new Se(SS(t))}function TS(r,e){return Iv(r.databaseId,e)}function lM(r){const e=bS(r);return e.length===4?pt.emptyPath():SS(e)}function wy(r){return new pt(["projects",r.databaseId.projectId,"databases",r.databaseId.database]).canonicalString()}function SS(r){return nt(r.length>4&&r.get(4)==="documents",29091,{key:r.toString()}),r.popFirst(5)}function pE(r,e,t){return{name:_y(r,e),fields:t.value.mapValue.fields}}function cM(r,e){let t;if("targetChange"in e){e.targetChange;const n=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:Me(39313,{state:h})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(h,f){return h.useProto3Json?(nt(f===void 0||typeof f=="string",58123),yn.fromBase64String(f||"")):(nt(f===void 0||f instanceof Buffer||f instanceof Uint8Array,16193),yn.fromUint8Array(f||new Uint8Array))}(r,e.targetChange.resumeToken),o=e.targetChange.cause,c=o&&function(h){const f=h.code===void 0?re.UNKNOWN:_S(h.code);return new we(f,h.message||"")}(o);t=new ES(n,s,i,c||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const s=xg(r,n.document.name),i=Is(n.document.updateTime),o=n.document.createTime?Is(n.document.createTime):Fe.min(),c=new kr({mapValue:{fields:n.document.fields}}),u=kn.newFoundDocument(s,i,o,c),h=n.targetIds||[],f=n.removedTargetIds||[];t=new uf(h,f,u.key,u)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const s=xg(r,n.document),i=n.readTime?Is(n.readTime):Fe.min(),o=kn.newNoDocument(s,i),c=n.removedTargetIds||[];t=new uf([],c,o.key,o)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const s=xg(r,n.document),i=n.removedTargetIds||[];t=new uf([],i,s,null)}else{if(!("filter"in e))return Me(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:s=0,unchangedNames:i}=n,o=new JL(s,i),c=n.targetId;t=new wS(c,o)}}return t}function uM(r,e){let t;if(e instanceof rh)t={update:pE(r,e.key,e.value)};else if(e instanceof Sv)t={delete:_y(r,e.key)};else if(e instanceof ba)t={update:pE(r,e.key,e.data),updateMask:_M(e.fieldMask)};else{if(!(e instanceof XL))return Me(16599,{Vt:e.type});t={verify:_y(r,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(n=>function(i,o){const c=o.transform;if(c instanceof Ou)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Fu)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof Vu)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof If)return{fieldPath:o.field.canonicalString(),increment:c.Ae};throw Me(20930,{transform:o.transform})}(0,n))),e.precondition.isNone||(t.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:aM(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:Me(27497)}(r,e.precondition)),t}function hM(r,e){return r&&r.length>0?(nt(e!==void 0,14353),r.map(t=>function(s,i){let o=s.updateTime?Is(s.updateTime):Is(i);return o.isEqual(Fe.min())&&(o=Is(i)),new GL(o,s.transformResults||[])}(t,e))):[]}function dM(r,e){return{documents:[TS(r,e.path)]}}function fM(r,e){const t={structuredQuery:{}},n=e.path;let s;e.collectionGroup!==null?(s=n,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=n.popLast(),t.structuredQuery.from=[{collectionId:n.lastSegment()}]),t.parent=TS(r,s);const i=function(h){if(h.length!==0)return CS(Fs.create(h,"and"))}(e.filters);i&&(t.structuredQuery.where=i);const o=function(h){if(h.length!==0)return h.map(f=>function(y){return{field:vl(y.field),direction:gM(y.dir)}}(f))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const c=yy(r,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),{ft:t,parent:s}}function pM(r){let e=lM(r.parent);const t=r.structuredQuery,n=t.from?t.from.length:0;let s=null;if(n>0){nt(n===1,65062);const f=t.from[0];f.allDescendants?s=f.collectionId:e=e.child(f.collectionId)}let i=[];t.where&&(i=function(m){const y=xS(m);return y instanceof Fs&&rS(y)?y.getFilters():[y]}(t.where));let o=[];t.orderBy&&(o=function(m){return m.map(y=>function(A){return new Cf(_l(A.field),function(T){switch(T){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(A.direction))}(y))}(t.orderBy));let c=null;t.limit&&(c=function(m){let y;return y=typeof m=="object"?m.value:m,ip(y)?null:y}(t.limit));let u=null;t.startAt&&(u=function(m){const y=!!m.before,_=m.values||[];return new xf(_,y)}(t.startAt));let h=null;return t.endAt&&(h=function(m){const y=!m.before,_=m.values||[];return new xf(_,y)}(t.endAt)),RL(e,s,o,i,c,"F",u,h)}function mM(r,e){const t=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Me(28987,{purpose:s})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function xS(r){return r.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const n=_l(t.unaryFilter.field);return Jt.create(n,"==",{doubleValue:NaN});case"IS_NULL":const s=_l(t.unaryFilter.field);return Jt.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=_l(t.unaryFilter.field);return Jt.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=_l(t.unaryFilter.field);return Jt.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Me(61313);default:return Me(60726)}}(r):r.fieldFilter!==void 0?function(t){return Jt.create(_l(t.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Me(58110);default:return Me(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(r):r.compositeFilter!==void 0?function(t){return Fs.create(t.compositeFilter.filters.map(n=>xS(n)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Me(1026)}}(t.compositeFilter.op))}(r):Me(30097,{filter:r})}function gM(r){return rM[r]}function yM(r){return sM[r]}function vM(r){return iM[r]}function vl(r){return{fieldPath:r.canonicalString()}}function _l(r){return gn.fromServerFormat(r.fieldPath)}function CS(r){return r instanceof Jt?function(t){if(t.op==="=="){if(tE(t.value))return{unaryFilter:{field:vl(t.field),op:"IS_NAN"}};if(eE(t.value))return{unaryFilter:{field:vl(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(tE(t.value))return{unaryFilter:{field:vl(t.field),op:"IS_NOT_NAN"}};if(eE(t.value))return{unaryFilter:{field:vl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:vl(t.field),op:yM(t.op),value:t.value}}}(r):r instanceof Fs?function(t){const n=t.getFilters().map(s=>CS(s));return n.length===1?n[0]:{compositeFilter:{op:vM(t.op),filters:n}}}(r):Me(54877,{filter:r})}function _M(r){const e=[];return r.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function IS(r){return r.length>=4&&r.get(0)==="projects"&&r.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ji{constructor(e,t,n,s,i=Fe.min(),o=Fe.min(),c=yn.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c,this.expectedCount=u}withSequenceNumber(e){return new Ji(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Ji(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ji(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ji(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wM{constructor(e){this.yt=e}}function EM(r){const e=pM({parent:r.parent,structuredQuery:r.structuredQuery});return r.limitType==="LAST"?gy(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AM{constructor(){this.Cn=new bM}addToCollectionParentIndex(e,t){return this.Cn.add(t),ne.resolve()}getCollectionParents(e,t){return ne.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return ne.resolve()}deleteFieldIndex(e,t){return ne.resolve()}deleteAllFieldIndexes(e){return ne.resolve()}createTargetIndexes(e,t){return ne.resolve()}getDocumentsMatchingTarget(e,t){return ne.resolve(null)}getIndexType(e,t){return ne.resolve(0)}getFieldIndexes(e,t){return ne.resolve([])}getNextCollectionGroupToUpdate(e){return ne.resolve(null)}getMinOffset(e,t){return ne.resolve(ao.min())}getMinOffsetFromCollectionGroup(e,t){return ne.resolve(ao.min())}updateCollectionGroup(e,t,n){return ne.resolve()}updateIndexEntries(e,t){return ne.resolve()}}class bM{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),s=this.index[t]||new en(pt.comparator),i=!s.has(n);return this.index[t]=s.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),s=this.index[t];return s&&s.has(n)}getEntries(e){return(this.index[e]||new en(pt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mE={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},kS=41943040;class Zn{static withCacheSize(e){return new Zn(e,Zn.DEFAULT_COLLECTION_PERCENTILE,Zn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Zn.DEFAULT_COLLECTION_PERCENTILE=10,Zn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Zn.DEFAULT=new Zn(kS,Zn.DEFAULT_COLLECTION_PERCENTILE,Zn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Zn.DISABLED=new Zn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $l{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new $l(0)}static cr(){return new $l(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gE="LruGarbageCollector",TM=1048576;function yE([r,e],[t,n]){const s=Ke(r,t);return s===0?Ke(e,n):s}class SM{constructor(e){this.Ir=e,this.buffer=new en(yE),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const n=this.buffer.last();yE(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}}class xM{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){pe(gE,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){tc(t)?pe(gE,"Ignoring IndexedDB error during garbage collection: ",t):await ec(t)}await this.Vr(3e5)})}}class CM{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next(n=>Math.floor(t/100*n))}nthSequenceNumber(e,t){if(t===0)return ne.resolve(sp.ce);const n=new SM(t);return this.mr.forEachTarget(e,s=>n.Ar(s.sequenceNumber)).next(()=>this.mr.pr(e,s=>n.Ar(s))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.mr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(pe("LruGarbageCollector","Garbage collection skipped; disabled"),ne.resolve(mE)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(pe("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),mE):this.yr(e,t))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let n,s,i,o,c,u,h;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(m=>(m>this.params.maximumSequenceNumbersToCollect?(pe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),s=this.params.maximumSequenceNumbersToCollect):s=m,o=Date.now(),this.nthSequenceNumber(e,s))).next(m=>(n=m,c=Date.now(),this.removeTargets(e,n,t))).next(m=>(i=m,u=Date.now(),this.removeOrphanedDocuments(e,n))).next(m=>(h=Date.now(),gl()<=Ge.DEBUG&&pe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-f}ms
	Determined least recently used ${s} in `+(c-o)+`ms
	Removed ${i} targets in `+(u-c)+`ms
	Removed ${m} documents in `+(h-u)+`ms
Total Duration: ${h-f}ms`),ne.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:m})))}}function IM(r,e){return new CM(r,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kM{constructor(){this.changes=new Aa(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,kn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return n!==void 0?ne.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PM{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RM{constructor(e,t,n,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=s}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(s=>(n=s,this.remoteDocumentCache.getEntry(e,t))).next(s=>(n!==null&&Eu(n.mutation,s,Qr.empty(),mt.now()),s))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.getLocalViewOfDocuments(e,n,Xe()).next(()=>n))}getLocalViewOfDocuments(e,t,n=Xe()){const s=na();return this.populateOverlays(e,s,t).next(()=>this.computeViews(e,t,s,n).next(i=>{let o=lu();return i.forEach((c,u)=>{o=o.insert(c,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const n=na();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,Xe()))}populateOverlays(e,t,n){const s=[];return n.forEach(i=>{t.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,c)=>{t.set(o,c)})})}computeViews(e,t,n,s){let i=pi();const o=wu(),c=function(){return wu()}();return t.forEach((u,h)=>{const f=n.get(h.key);s.has(h.key)&&(f===void 0||f.mutation instanceof ba)?i=i.insert(h.key,h):f!==void 0?(o.set(h.key,f.mutation.getFieldMask()),Eu(f.mutation,h,f.mutation.getFieldMask(),mt.now())):o.set(h.key,Qr.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((h,f)=>o.set(h,f)),t.forEach((h,f)=>c.set(h,new PM(f,o.get(h)??null))),c))}recalculateAndSaveOverlays(e,t){const n=wu();let s=new It((o,c)=>o-c),i=Xe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const c of o)c.keys().forEach(u=>{const h=t.get(u);if(h===null)return;let f=n.get(u)||Qr.empty();f=c.applyToLocalView(h,f),n.set(u,f);const m=(s.get(c.batchId)||Xe()).add(u);s=s.insert(c.batchId,m)})}).next(()=>{const o=[],c=s.getReverseIterator();for(;c.hasNext();){const u=c.getNext(),h=u.key,f=u.value,m=hS();f.forEach(y=>{if(!i.has(y)){const _=yS(t.get(y),n.get(y));_!==null&&m.set(y,_),i=i.add(y)}}),o.push(this.documentOverlayCache.saveOverlays(e,h,m))}return ne.waitFor(o)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,t,n,s){return function(o){return Se.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):DL(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,s):this.getDocumentsMatchingCollectionQuery(e,t,n,s)}getNextDocuments(e,t,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,s-i.size):ne.resolve(na());let c=Du,u=i;return o.next(h=>ne.forEach(h,(f,m)=>(c<m.largestBatchId&&(c=m.largestBatchId),i.get(f)?ne.resolve():this.remoteDocumentCache.getEntry(e,f).next(y=>{u=u.insert(f,y)}))).next(()=>this.populateOverlays(e,h,i)).next(()=>this.computeViews(e,u,h,Xe())).next(f=>({batchId:c,changes:uS(f)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Se(t)).next(n=>{let s=lu();return n.isFoundDocument()&&(s=s.insert(n.key,n)),s})}getDocumentsMatchingCollectionGroupQuery(e,t,n,s){const i=t.collectionGroup;let o=lu();return this.indexManager.getCollectionParents(e,i).next(c=>ne.forEach(c,u=>{const h=function(m,y){return new ap(y,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(t,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,h,n,s).next(f=>{f.forEach((m,y)=>{o=o.insert(m,y)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,n,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i,s))).next(o=>{i.forEach((u,h)=>{const f=h.getKey();o.get(f)===null&&(o=o.insert(f,kn.newInvalidDocument(f)))});let c=lu();return o.forEach((u,h)=>{const f=i.get(u);f!==void 0&&Eu(f.mutation,h,Qr.empty(),mt.now()),cp(t,h)&&(c=c.insert(u,h))}),c})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DM{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return ne.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,function(s){return{id:s.id,version:s.version,createTime:Is(s.createTime)}}(t)),ne.resolve()}getNamedQuery(e,t){return ne.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,function(s){return{name:s.name,query:EM(s.bundledQuery),readTime:Is(s.readTime)}}(t)),ne.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LM{constructor(){this.overlays=new It(Se.comparator),this.qr=new Map}getOverlay(e,t){return ne.resolve(this.overlays.get(t))}getOverlays(e,t){const n=na();return ne.forEach(t,s=>this.getOverlay(e,s).next(i=>{i!==null&&n.set(s,i)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((s,i)=>{this.St(e,t,i)}),ne.resolve()}removeOverlaysForBatchId(e,t,n){const s=this.qr.get(n);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(n)),ne.resolve()}getOverlaysForCollection(e,t,n){const s=na(),i=t.length+1,o=new Se(t.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){const u=c.getNext().value,h=u.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===i&&u.largestBatchId>n&&s.set(u.getKey(),u)}return ne.resolve(s)}getOverlaysForCollectionGroup(e,t,n,s){let i=new It((h,f)=>h-f);const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>n){let f=i.get(h.largestBatchId);f===null&&(f=na(),i=i.insert(h.largestBatchId,f)),f.set(h.getKey(),h)}}const c=na(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((h,f)=>c.set(h,f)),!(c.size()>=s)););return ne.resolve(c)}St(e,t,n){const s=this.overlays.get(n.key);if(s!==null){const o=this.qr.get(s.largestBatchId).delete(n.key);this.qr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new QL(t,n));let i=this.qr.get(t);i===void 0&&(i=Xe(),this.qr.set(t,i)),this.qr.set(t,i.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MM{constructor(){this.sessionToken=yn.EMPTY_BYTE_STRING}getSessionToken(e){return ne.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ne.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kv{constructor(){this.Qr=new en(an.$r),this.Ur=new en(an.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const n=new an(e,t);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,t){e.forEach(n=>this.addReference(n,t))}removeReference(e,t){this.Gr(new an(e,t))}zr(e,t){e.forEach(n=>this.removeReference(n,t))}jr(e){const t=new Se(new pt([])),n=new an(t,e),s=new an(t,e+1),i=[];return this.Ur.forEachInRange([n,s],o=>{this.Gr(o),i.push(o.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new Se(new pt([])),n=new an(t,e),s=new an(t,e+1);let i=Xe();return this.Ur.forEachInRange([n,s],o=>{i=i.add(o.key)}),i}containsKey(e){const t=new an(e,0),n=this.Qr.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}}class an{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return Se.comparator(e.key,t.key)||Ke(e.Yr,t.Yr)}static Kr(e,t){return Ke(e.Yr,t.Yr)||Se.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NM{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new en(an.$r)}checkEmpty(e){return ne.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,s){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new YL(i,t,n,s);this.mutationQueue.push(o);for(const c of s)this.Zr=this.Zr.add(new an(c.key,i)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return ne.resolve(o)}lookupMutationBatch(e,t){return ne.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,s=this.ei(n),i=s<0?0:s;return ne.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return ne.resolve(this.mutationQueue.length===0?vv:this.tr-1)}getAllMutationBatches(e){return ne.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new an(t,0),s=new an(t,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([n,s],o=>{const c=this.Xr(o.Yr);i.push(c)}),ne.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new en(Ke);return t.forEach(s=>{const i=new an(s,0),o=new an(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,o],c=>{n=n.add(c.Yr)})}),ne.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,s=n.length+1;let i=n;Se.isDocumentKey(i)||(i=i.child(""));const o=new an(new Se(i),0);let c=new en(Ke);return this.Zr.forEachWhile(u=>{const h=u.key.path;return!!n.isPrefixOf(h)&&(h.length===s&&(c=c.add(u.Yr)),!0)},o),ne.resolve(this.ti(c))}ti(e){const t=[];return e.forEach(n=>{const s=this.Xr(n);s!==null&&t.push(s)}),t}removeMutationBatch(e,t){nt(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return ne.forEach(t.mutations,s=>{const i=new an(s.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,t){const n=new an(t,0),s=this.Zr.firstAfterOrEqual(n);return ne.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,ne.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OM{constructor(e){this.ri=e,this.docs=function(){return new It(Se.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,s=this.docs.get(n),i=s?s.size:0,o=this.ri(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return ne.resolve(n?n.document.mutableCopy():kn.newInvalidDocument(t))}getEntries(e,t){let n=pi();return t.forEach(s=>{const i=this.docs.get(s);n=n.insert(s,i?i.document.mutableCopy():kn.newInvalidDocument(s))}),ne.resolve(n)}getDocumentsMatchingQuery(e,t,n,s){let i=pi();const o=t.path,c=new Se(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){const{key:h,value:{document:f}}=u.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||cL(lL(f),n)<=0||(s.has(f.key)||cp(t,f))&&(i=i.insert(f.key,f.mutableCopy()))}return ne.resolve(i)}getAllFromCollectionGroup(e,t,n,s){Me(9500)}ii(e,t){return ne.forEach(this.docs,n=>t(n))}newChangeBuffer(e){return new FM(this)}getSize(e){return ne.resolve(this.size)}}class FM extends kM{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach((n,s)=>{s.isValidDocument()?t.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(n)}),ne.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VM{constructor(e){this.persistence=e,this.si=new Aa(t=>Ev(t),Av),this.lastRemoteSnapshotVersion=Fe.min(),this.highestTargetId=0,this.oi=0,this._i=new kv,this.targetCount=0,this.ai=$l.ur()}forEachTarget(e,t){return this.si.forEach((n,s)=>t(s)),ne.resolve()}getLastRemoteSnapshotVersion(e){return ne.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ne.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),ne.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.oi&&(this.oi=t),ne.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new $l(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,ne.resolve()}updateTargetData(e,t){return this.Pr(t),ne.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,ne.resolve()}removeTargets(e,t,n){let s=0;const i=[];return this.si.forEach((o,c)=>{c.sequenceNumber<=t&&n.get(c.targetId)===null&&(this.si.delete(o),i.push(this.removeMatchingKeysForTargetId(e,c.targetId)),s++)}),ne.waitFor(i).next(()=>s)}getTargetCount(e){return ne.resolve(this.targetCount)}getTargetData(e,t){const n=this.si.get(t)||null;return ne.resolve(n)}addMatchingKeys(e,t,n){return this._i.Wr(t,n),ne.resolve()}removeMatchingKeys(e,t,n){this._i.zr(t,n);const s=this.persistence.referenceDelegate,i=[];return s&&t.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),ne.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),ne.resolve()}getMatchingKeysForTargetId(e,t){const n=this._i.Hr(t);return ne.resolve(n)}containsKey(e,t){return ne.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PS{constructor(e,t){this.ui={},this.overlays={},this.ci=new sp(0),this.li=!1,this.li=!0,this.hi=new MM,this.referenceDelegate=e(this),this.Pi=new VM(this),this.indexManager=new AM,this.remoteDocumentCache=function(s){return new OM(s)}(n=>this.referenceDelegate.Ti(n)),this.serializer=new wM(t),this.Ii=new DM(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new LM,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ui[e.toKey()];return n||(n=new NM(t,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,n){pe("MemoryPersistence","Starting transaction:",e);const s=new jM(this.ci.next());return this.referenceDelegate.Ei(),n(s).next(i=>this.referenceDelegate.di(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ai(e,t){return ne.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,t)))}}class jM extends hL{constructor(e){super(),this.currentSequenceNumber=e}}class Pv{constructor(e){this.persistence=e,this.Ri=new kv,this.Vi=null}static mi(e){return new Pv(e)}get fi(){if(this.Vi)return this.Vi;throw Me(60996)}addReference(e,t,n){return this.Ri.addReference(n,t),this.fi.delete(n.toString()),ne.resolve()}removeReference(e,t,n){return this.Ri.removeReference(n,t),this.fi.add(n.toString()),ne.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),ne.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach(s=>this.fi.add(s.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(s=>{s.forEach(i=>this.fi.add(i.toString()))}).next(()=>n.removeTargetData(e,t))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ne.forEach(this.fi,n=>{const s=Se.fromPath(n);return this.gi(e,s).next(i=>{i||t.removeEntry(s,Fe.min())})}).next(()=>(this.Vi=null,t.apply(e)))}updateLimboDocument(e,t){return this.gi(e,t).next(n=>{n?this.fi.delete(t.toString()):this.fi.add(t.toString())})}Ti(e){return 0}gi(e,t){return ne.or([()=>ne.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Pf{constructor(e,t){this.persistence=e,this.pi=new Aa(n=>pL(n.path),(n,s)=>n.isEqual(s)),this.garbageCollector=IM(this,t)}static mi(e,t){return new Pf(e,t)}Ei(){}di(e){return ne.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>t.next(s=>n+s))}wr(e){let t=0;return this.pr(e,n=>{t++}).next(()=>t)}pr(e,t){return ne.forEach(this.pi,(n,s)=>this.br(e,n,s).next(i=>i?ne.resolve():t(s)))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ii(e,o=>this.br(e,o,t).next(c=>{c||(n++,i.removeEntry(o,Fe.min()))})).next(()=>i.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),ne.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),ne.resolve()}removeReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),ne.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),ne.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=af(e.data.value)),t}br(e,t,n){return ne.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const s=this.pi.get(t);return ne.resolve(s!==void 0&&s>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rv{constructor(e,t,n,s){this.targetId=e,this.fromCache=t,this.Es=n,this.ds=s}static As(e,t){let n=Xe(),s=Xe();for(const i of t.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Rv(e,t.fromCache,n,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BM{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UM{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return PR()?8:dL(Dn())>0?6:4}()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,n,s){const i={result:null};return this.ys(e,t).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ws(e,t,s,n).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new BM;return this.Ss(e,t,o).next(c=>{if(i.result=c,this.Vs)return this.bs(e,t,o,c.size)})}).next(()=>i.result)}bs(e,t,n,s){return n.documentReadCount<this.fs?(gl()<=Ge.DEBUG&&pe("QueryEngine","SDK will not create cache indexes for query:",yl(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),ne.resolve()):(gl()<=Ge.DEBUG&&pe("QueryEngine","Query:",yl(t),"scans",n.documentReadCount,"local documents and returns",s,"documents as results."),n.documentReadCount>this.gs*s?(gl()<=Ge.DEBUG&&pe("QueryEngine","The SDK decides to create cache indexes for query:",yl(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Cs(t))):ne.resolve())}ys(e,t){if(iE(t))return ne.resolve(null);let n=Cs(t);return this.indexManager.getIndexType(e,n).next(s=>s===0?null:(t.limit!==null&&s===1&&(t=gy(t,null,"F"),n=Cs(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(i=>{const o=Xe(...i);return this.ps.getDocuments(e,o).next(c=>this.indexManager.getMinOffset(e,n).next(u=>{const h=this.Ds(t,c);return this.Cs(t,h,o,u.readTime)?this.ys(e,gy(t,null,"F")):this.vs(e,h,t,u)}))})))}ws(e,t,n,s){return iE(t)||s.isEqual(Fe.min())?ne.resolve(null):this.ps.getDocuments(e,n).next(i=>{const o=this.Ds(t,i);return this.Cs(t,o,n,s)?ne.resolve(null):(gl()<=Ge.DEBUG&&pe("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),yl(t)),this.vs(e,o,t,aL(s,Du)).next(c=>c))})}Ds(e,t){let n=new en(lS(e));return t.forEach((s,i)=>{cp(e,i)&&(n=n.add(i))}),n}Cs(e,t,n,s){if(e.limit===null)return!1;if(n.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(e,t,n){return gl()<=Ge.DEBUG&&pe("QueryEngine","Using full collection scan to execute query:",yl(t)),this.ps.getDocumentsMatchingQuery(e,t,ao.min(),n)}vs(e,t,n,s){return this.ps.getDocumentsMatchingQuery(e,n,s).next(i=>(t.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dv="LocalStore",zM=3e8;class $M{constructor(e,t,n,s){this.persistence=e,this.Fs=t,this.serializer=s,this.Ms=new It(Ke),this.xs=new Aa(i=>Ev(i),Av),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new RM(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ms))}}function HM(r,e,t,n){return new $M(r,e,t,n)}async function RS(r,e){const t=je(r);return await t.persistence.runTransaction("Handle user change","readonly",n=>{let s;return t.mutationQueue.getAllMutationBatches(n).next(i=>(s=i,t.Bs(e),t.mutationQueue.getAllMutationBatches(n))).next(i=>{const o=[],c=[];let u=Xe();for(const h of s){o.push(h.batchId);for(const f of h.mutations)u=u.add(f.key)}for(const h of i){c.push(h.batchId);for(const f of h.mutations)u=u.add(f.key)}return t.localDocuments.getDocuments(n,u).next(h=>({Ls:h,removedBatchIds:o,addedBatchIds:c}))})})}function WM(r,e){const t=je(r);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const s=e.batch.keys(),i=t.Ns.newChangeBuffer({trackRemovals:!0});return function(c,u,h,f){const m=h.batch,y=m.keys();let _=ne.resolve();return y.forEach(A=>{_=_.next(()=>f.getEntry(u,A)).next(b=>{const T=h.docVersions.get(A);nt(T!==null,48541),b.version.compareTo(T)<0&&(m.applyToRemoteDocument(b,h),b.isValidDocument()&&(b.setReadTime(h.commitVersion),f.addEntry(b)))})}),_.next(()=>c.mutationQueue.removeMutationBatch(u,m))}(t,n,e,i).next(()=>i.apply(n)).next(()=>t.mutationQueue.performConsistencyCheck(n)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(n,s,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(c){let u=Xe();for(let h=0;h<c.mutationResults.length;++h)c.mutationResults[h].transformResults.length>0&&(u=u.add(c.batch.mutations[h].key));return u}(e))).next(()=>t.localDocuments.getDocuments(n,s))})}function DS(r){const e=je(r);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Pi.getLastRemoteSnapshotVersion(t))}function GM(r,e){const t=je(r),n=e.snapshotVersion;let s=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=t.Ns.newChangeBuffer({trackRemovals:!0});s=t.Ms;const c=[];e.targetChanges.forEach((f,m)=>{const y=s.get(m);if(!y)return;c.push(t.Pi.removeMatchingKeys(i,f.removedDocuments,m).next(()=>t.Pi.addMatchingKeys(i,f.addedDocuments,m)));let _=y.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(m)!==null?_=_.withResumeToken(yn.EMPTY_BYTE_STRING,Fe.min()).withLastLimboFreeSnapshotVersion(Fe.min()):f.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(f.resumeToken,n)),s=s.insert(m,_),function(b,T,x){return b.resumeToken.approximateByteSize()===0||T.snapshotVersion.toMicroseconds()-b.snapshotVersion.toMicroseconds()>=zM?!0:x.addedDocuments.size+x.modifiedDocuments.size+x.removedDocuments.size>0}(y,_,f)&&c.push(t.Pi.updateTargetData(i,_))});let u=pi(),h=Xe();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(i,f))}),c.push(qM(i,o,e.documentUpdates).next(f=>{u=f.ks,h=f.qs})),!n.isEqual(Fe.min())){const f=t.Pi.getLastRemoteSnapshotVersion(i).next(m=>t.Pi.setTargetsMetadata(i,i.currentSequenceNumber,n));c.push(f)}return ne.waitFor(c).next(()=>o.apply(i)).next(()=>t.localDocuments.getLocalViewOfDocuments(i,u,h)).next(()=>u)}).then(i=>(t.Ms=s,i))}function qM(r,e,t){let n=Xe(),s=Xe();return t.forEach(i=>n=n.add(i)),e.getEntries(r,n).next(i=>{let o=pi();return t.forEach((c,u)=>{const h=i.get(c);u.isFoundDocument()!==h.isFoundDocument()&&(s=s.add(c)),u.isNoDocument()&&u.version.isEqual(Fe.min())?(e.removeEntry(c,u.readTime),o=o.insert(c,u)):!h.isValidDocument()||u.version.compareTo(h.version)>0||u.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(u),o=o.insert(c,u)):pe(Dv,"Ignoring outdated watch update for ",c,". Current version:",h.version," Watch version:",u.version)}),{ks:o,qs:s}})}function KM(r,e){const t=je(r);return t.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=vv),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function XM(r,e){const t=je(r);return t.persistence.runTransaction("Allocate target","readwrite",n=>{let s;return t.Pi.getTargetData(n,e).next(i=>i?(s=i,ne.resolve(s)):t.Pi.allocateTargetId(n).next(o=>(s=new Ji(e,o,"TargetPurposeListen",n.currentSequenceNumber),t.Pi.addTargetData(n,s).next(()=>s))))}).then(n=>{const s=t.Ms.get(n.targetId);return(s===null||n.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(n.targetId,n),t.xs.set(e,n.targetId)),n})}async function Ey(r,e,t){const n=je(r),s=n.Ms.get(e),i=t?"readwrite":"readwrite-primary";try{t||await n.persistence.runTransaction("Release target",i,o=>n.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!tc(o))throw o;pe(Dv,`Failed to update sequence numbers for target ${e}: ${o}`)}n.Ms=n.Ms.remove(e),n.xs.delete(s.target)}function vE(r,e,t){const n=je(r);let s=Fe.min(),i=Xe();return n.persistence.runTransaction("Execute query","readwrite",o=>function(u,h,f){const m=je(u),y=m.xs.get(f);return y!==void 0?ne.resolve(m.Ms.get(y)):m.Pi.getTargetData(h,f)}(n,o,Cs(e)).next(c=>{if(c)return s=c.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(o,c.targetId).next(u=>{i=u})}).next(()=>n.Fs.getDocumentsMatchingQuery(o,e,t?s:Fe.min(),t?i:Xe())).next(c=>(YM(n,ML(e),c),{documents:c,Qs:i})))}function YM(r,e,t){let n=r.Os.get(e)||Fe.min();t.forEach((s,i)=>{i.readTime.compareTo(n)>0&&(n=i.readTime)}),r.Os.set(e,n)}class _E{constructor(){this.activeTargetIds=BL()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class QM{constructor(){this.Mo=new _E,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,n){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new _E,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JM{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wE="ConnectivityMonitor";class EE{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){pe(wE,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){pe(wE,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $d=null;function Ay(){return $d===null?$d=function(){return 268435456+Math.round(2147483648*Math.random())}():$d++,"0x"+$d.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cg="RestConnection",ZM={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class eN{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${n}/databases/${s}`,this.Wo=this.databaseId.database===Tf?`project_id=${n}`:`project_id=${n}&database_id=${s}`}Go(e,t,n,s,i){const o=Ay(),c=this.zo(e,t.toUriEncodedString());pe(Cg,`Sending RPC '${e}' ${o}:`,c,n);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,s,i);const{host:h}=new URL(c),f=_a(h);return this.Jo(e,c,u,n,f).then(m=>(pe(Cg,`Received RPC '${e}' ${o}: `,m),m),m=>{throw jl(Cg,`RPC '${e}' ${o} failed with error: `,m,"url: ",c,"request:",n),m})}Ho(e,t,n,s,i,o){return this.Go(e,t,n,s,i)}jo(e,t,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Zl}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((s,i)=>e[i]=s),n&&n.headers.forEach((s,i)=>e[i]=s)}zo(e,t){const n=ZM[e];return`${this.Uo}/v1/${t}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tN{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tn="WebChannelConnection";class nN extends eN{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,n,s,i){const o=Ay();return new Promise((c,u)=>{const h=new OT;h.setWithCredentials(!0),h.listenOnce(FT.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case of.NO_ERROR:const m=h.getResponseJson();pe(Tn,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(m)),c(m);break;case of.TIMEOUT:pe(Tn,`RPC '${e}' ${o} timed out`),u(new we(re.DEADLINE_EXCEEDED,"Request time out"));break;case of.HTTP_ERROR:const y=h.getStatus();if(pe(Tn,`RPC '${e}' ${o} failed with status:`,y,"response text:",h.getResponseText()),y>0){let _=h.getResponseJson();Array.isArray(_)&&(_=_[0]);const A=_?.error;if(A&&A.status&&A.message){const b=function(x){const M=x.toLowerCase().replace(/_/g,"-");return Object.values(re).indexOf(M)>=0?M:re.UNKNOWN}(A.status);u(new we(b,A.message))}else u(new we(re.UNKNOWN,"Server responded with status "+h.getStatus()))}else u(new we(re.UNAVAILABLE,"Connection failed."));break;default:Me(9055,{l_:e,streamId:o,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{pe(Tn,`RPC '${e}' ${o} completed.`)}});const f=JSON.stringify(s);pe(Tn,`RPC '${e}' ${o} sending request:`,s),h.send(t,"POST",f,n,15)})}T_(e,t,n){const s=Ay(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=BT(),c=jT(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(u.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,t,n),u.encodeInitMessageHeaders=!0;const f=i.join("");pe(Tn,`Creating RPC '${e}' stream ${s}: ${f}`,u);const m=o.createWebChannel(f,u);this.I_(m);let y=!1,_=!1;const A=new tN({Yo:T=>{_?pe(Tn,`Not sending because RPC '${e}' stream ${s} is closed:`,T):(y||(pe(Tn,`Opening RPC '${e}' stream ${s} transport.`),m.open(),y=!0),pe(Tn,`RPC '${e}' stream ${s} sending:`,T),m.send(T))},Zo:()=>m.close()}),b=(T,x,M)=>{T.listen(x,R=>{try{M(R)}catch(B){setTimeout(()=>{throw B},0)}})};return b(m,au.EventType.OPEN,()=>{_||(pe(Tn,`RPC '${e}' stream ${s} transport opened.`),A.o_())}),b(m,au.EventType.CLOSE,()=>{_||(_=!0,pe(Tn,`RPC '${e}' stream ${s} transport closed`),A.a_(),this.E_(m))}),b(m,au.EventType.ERROR,T=>{_||(_=!0,jl(Tn,`RPC '${e}' stream ${s} transport errored. Name:`,T.name,"Message:",T.message),A.a_(new we(re.UNAVAILABLE,"The operation could not be completed")))}),b(m,au.EventType.MESSAGE,T=>{if(!_){const x=T.data[0];nt(!!x,16349);const M=x,R=M?.error||M[0]?.error;if(R){pe(Tn,`RPC '${e}' stream ${s} received error:`,R);const B=R.status;let O=function(C){const P=Ht[C];if(P!==void 0)return _S(P)}(B),$=R.message;O===void 0&&(O=re.INTERNAL,$="Unknown error status: "+B+" with message "+R.message),_=!0,A.a_(new we(O,$)),m.close()}else pe(Tn,`RPC '${e}' stream ${s} received:`,x),A.u_(x)}}),b(c,VT.STAT_EVENT,T=>{T.stat===uy.PROXY?pe(Tn,`RPC '${e}' stream ${s} detected buffering proxy`):T.stat===uy.NOPROXY&&pe(Tn,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{A.__()},0),A}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(t=>t===e)}}function Ig(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fp(r){return new oM(r,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LS{constructor(e,t,n=1e3,s=1.5,i=6e4){this.Mi=e,this.timerId=t,this.d_=n,this.A_=s,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),s=Math.max(0,t-n);s>0&&pe("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AE="PersistentStream";class MS{constructor(e,t,n,s,i,o,c,u){this.Mi=e,this.S_=n,this.b_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new LS(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===re.RESOURCE_EXHAUSTED?(di(t.toString()),di("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===re.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,s])=>{this.D_===t&&this.G_(n,s)},n=>{e(()=>{const s=new we(re.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(s)})})}G_(e,t){const n=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(s=>{n(()=>this.z_(s))}),this.stream.onMessage(s=>{n(()=>++this.F_==1?this.J_(s):this.onNext(s))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return pe(AE,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget(()=>this.D_===e?t():(pe(AE,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class rN extends MS{constructor(e,t,n,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,s,o),this.serializer=i}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=cM(this.serializer,e),n=function(i){if(!("targetChange"in i))return Fe.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?Fe.min():o.readTime?Is(o.readTime):Fe.min()}(e);return this.listener.H_(t,n)}Y_(e){const t={};t.database=wy(this.serializer),t.addTarget=function(i,o){let c;const u=o.target;if(c=my(u)?{documents:dM(i,u)}:{query:fM(i,u).ft},c.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){c.resumeToken=AS(i,o.resumeToken);const h=yy(i,o.expectedCount);h!==null&&(c.expectedCount=h)}else if(o.snapshotVersion.compareTo(Fe.min())>0){c.readTime=kf(i,o.snapshotVersion.toTimestamp());const h=yy(i,o.expectedCount);h!==null&&(c.expectedCount=h)}return c}(this.serializer,e);const n=mM(this.serializer,e);n&&(t.labels=n),this.q_(t)}Z_(e){const t={};t.database=wy(this.serializer),t.removeTarget=e,this.q_(t)}}class sN extends MS{constructor(e,t,n,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,s,o),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return nt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,nt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){nt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=hM(e.writeResults,e.commitTime),n=Is(e.commitTime);return this.listener.na(n,t)}ra(){const e={};e.database=wy(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map(n=>uM(this.serializer,n))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iN{}class oN extends iN{constructor(e,t,n,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new we(re.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,n,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Go(e,vy(t,n),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===re.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new we(re.UNKNOWN,i.toString())})}Ho(e,t,n,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,c])=>this.connection.Ho(e,vy(t,n),s,o,c,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===re.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new we(re.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class aN{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(di(t),this.aa=!1):pe("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fa="RemoteStore";class lN{constructor(e,t,n,s,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(o=>{n.enqueueAndForget(async()=>{Ta(this)&&(pe(fa,"Restarting streams for network reachability change."),await async function(u){const h=je(u);h.Ea.add(4),await ih(h),h.Ra.set("Unknown"),h.Ea.delete(4),await pp(h)}(this))})}),this.Ra=new aN(n,s)}}async function pp(r){if(Ta(r))for(const e of r.da)await e(!0)}async function ih(r){for(const e of r.da)await e(!1)}function NS(r,e){const t=je(r);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Ov(t)?Nv(t):nc(t).O_()&&Mv(t,e))}function Lv(r,e){const t=je(r),n=nc(t);t.Ia.delete(e),n.O_()&&OS(t,e),t.Ia.size===0&&(n.O_()?n.L_():Ta(t)&&t.Ra.set("Unknown"))}function Mv(r,e){if(r.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Fe.min())>0){const t=r.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}nc(r).Y_(e)}function OS(r,e){r.Va.Ue(e),nc(r).Z_(e)}function Nv(r){r.Va=new nM({getRemoteKeysForTarget:e=>r.remoteSyncer.getRemoteKeysForTarget(e),At:e=>r.Ia.get(e)||null,ht:()=>r.datastore.serializer.databaseId}),nc(r).start(),r.Ra.ua()}function Ov(r){return Ta(r)&&!nc(r).x_()&&r.Ia.size>0}function Ta(r){return je(r).Ea.size===0}function FS(r){r.Va=void 0}async function cN(r){r.Ra.set("Online")}async function uN(r){r.Ia.forEach((e,t)=>{Mv(r,e)})}async function hN(r,e){FS(r),Ov(r)?(r.Ra.ha(e),Nv(r)):r.Ra.set("Unknown")}async function dN(r,e,t){if(r.Ra.set("Online"),e instanceof ES&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const c of i.targetIds)s.Ia.has(c)&&(await s.remoteSyncer.rejectListen(c,o),s.Ia.delete(c),s.Va.removeTarget(c))}(r,e)}catch(n){pe(fa,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Rf(r,n)}else if(e instanceof uf?r.Va.Ze(e):e instanceof wS?r.Va.st(e):r.Va.tt(e),!t.isEqual(Fe.min()))try{const n=await DS(r.localStore);t.compareTo(n)>=0&&await function(i,o){const c=i.Va.Tt(o);return c.targetChanges.forEach((u,h)=>{if(u.resumeToken.approximateByteSize()>0){const f=i.Ia.get(h);f&&i.Ia.set(h,f.withResumeToken(u.resumeToken,o))}}),c.targetMismatches.forEach((u,h)=>{const f=i.Ia.get(u);if(!f)return;i.Ia.set(u,f.withResumeToken(yn.EMPTY_BYTE_STRING,f.snapshotVersion)),OS(i,u);const m=new Ji(f.target,u,h,f.sequenceNumber);Mv(i,m)}),i.remoteSyncer.applyRemoteEvent(c)}(r,t)}catch(n){pe(fa,"Failed to raise snapshot:",n),await Rf(r,n)}}async function Rf(r,e,t){if(!tc(e))throw e;r.Ea.add(1),await ih(r),r.Ra.set("Offline"),t||(t=()=>DS(r.localStore)),r.asyncQueue.enqueueRetryable(async()=>{pe(fa,"Retrying IndexedDB access"),await t(),r.Ea.delete(1),await pp(r)})}function VS(r,e){return e().catch(t=>Rf(r,t,e))}async function mp(r){const e=je(r),t=ho(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:vv;for(;fN(e);)try{const s=await KM(e.localStore,n);if(s===null){e.Ta.length===0&&t.L_();break}n=s.batchId,pN(e,s)}catch(s){await Rf(e,s)}jS(e)&&BS(e)}function fN(r){return Ta(r)&&r.Ta.length<10}function pN(r,e){r.Ta.push(e);const t=ho(r);t.O_()&&t.X_&&t.ea(e.mutations)}function jS(r){return Ta(r)&&!ho(r).x_()&&r.Ta.length>0}function BS(r){ho(r).start()}async function mN(r){ho(r).ra()}async function gN(r){const e=ho(r);for(const t of r.Ta)e.ea(t.mutations)}async function yN(r,e,t){const n=r.Ta.shift(),s=xv.from(n,e,t);await VS(r,()=>r.remoteSyncer.applySuccessfulWrite(s)),await mp(r)}async function vN(r,e){e&&ho(r).X_&&await async function(n,s){if(function(o){return ZL(o)&&o!==re.ABORTED}(s.code)){const i=n.Ta.shift();ho(n).B_(),await VS(n,()=>n.remoteSyncer.rejectFailedWrite(i.batchId,s)),await mp(n)}}(r,e),jS(r)&&BS(r)}async function bE(r,e){const t=je(r);t.asyncQueue.verifyOperationInProgress(),pe(fa,"RemoteStore received new credentials");const n=Ta(t);t.Ea.add(3),await ih(t),n&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await pp(t)}async function _N(r,e){const t=je(r);e?(t.Ea.delete(2),await pp(t)):e||(t.Ea.add(2),await ih(t),t.Ra.set("Unknown"))}function nc(r){return r.ma||(r.ma=function(t,n,s){const i=je(t);return i.sa(),new rN(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(r.datastore,r.asyncQueue,{Xo:cN.bind(null,r),t_:uN.bind(null,r),r_:hN.bind(null,r),H_:dN.bind(null,r)}),r.da.push(async e=>{e?(r.ma.B_(),Ov(r)?Nv(r):r.Ra.set("Unknown")):(await r.ma.stop(),FS(r))})),r.ma}function ho(r){return r.fa||(r.fa=function(t,n,s){const i=je(t);return i.sa(),new sN(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(r.datastore,r.asyncQueue,{Xo:()=>Promise.resolve(),t_:mN.bind(null,r),r_:vN.bind(null,r),ta:gN.bind(null,r),na:yN.bind(null,r)}),r.da.push(async e=>{e?(r.fa.B_(),await mp(r)):(await r.fa.stop(),r.Ta.length>0&&(pe(fa,`Stopping write stream with ${r.Ta.length} pending writes`),r.Ta=[]))})),r.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fv{constructor(e,t,n,s,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=s,this.removalCallback=i,this.deferred=new ai,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,s,i){const o=Date.now()+n,c=new Fv(e,t,o,s,i);return c.start(n),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new we(re.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Vv(r,e){if(di("AsyncQueue",`${e}: ${r}`),tc(r))return new we(re.UNAVAILABLE,`${e}: ${r}`);throw r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pl{static emptySet(e){return new Pl(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||Se.comparator(t.key,n.key):(t,n)=>Se.comparator(t.key,n.key),this.keyedMap=lu(),this.sortedSet=new It(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Pl)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=n.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const n=new Pl;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TE{constructor(){this.ga=new It(Se.comparator)}track(e){const t=e.doc.key,n=this.ga.get(t);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(t,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(t,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(t):e.type===1&&n.type===2?this.ga=this.ga.insert(t,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Me(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal((t,n)=>{e.push(n)}),e}}class Hl{constructor(e,t,n,s,i,o,c,u,h){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=h}static fromInitialDocuments(e,t,n,s,i){const o=[];return t.forEach(c=>{o.push({type:0,doc:c})}),new Hl(e,t,Pl.emptySet(t),o,n,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&lp(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==n[s].type||!t[s].doc.isEqual(n[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wN{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class EN{constructor(){this.queries=SE(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,n){const s=je(t),i=s.queries;s.queries=SE(),i.forEach((o,c)=>{for(const u of c.Sa)u.onError(n)})})(this,new we(re.ABORTED,"Firestore shutting down"))}}function SE(){return new Aa(r=>aS(r),lp)}async function US(r,e){const t=je(r);let n=3;const s=e.query;let i=t.queries.get(s);i?!i.ba()&&e.Da()&&(n=2):(i=new wN,n=e.Da()?0:1);try{switch(n){case 0:i.wa=await t.onListen(s,!0);break;case 1:i.wa=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(o){const c=Vv(o,`Initialization of query '${yl(e.query)}' failed`);return void e.onError(c)}t.queries.set(s,i),i.Sa.push(e),e.va(t.onlineState),i.wa&&e.Fa(i.wa)&&jv(t)}async function zS(r,e){const t=je(r),n=e.query;let s=3;const i=t.queries.get(n);if(i){const o=i.Sa.indexOf(e);o>=0&&(i.Sa.splice(o,1),i.Sa.length===0?s=e.Da()?0:1:!i.ba()&&e.Da()&&(s=2))}switch(s){case 0:return t.queries.delete(n),t.onUnlisten(n,!0);case 1:return t.queries.delete(n),t.onUnlisten(n,!1);case 2:return t.onLastRemoteStoreUnlisten(n);default:return}}function AN(r,e){const t=je(r);let n=!1;for(const s of e){const i=s.query,o=t.queries.get(i);if(o){for(const c of o.Sa)c.Fa(s)&&(n=!0);o.wa=s}}n&&jv(t)}function bN(r,e,t){const n=je(r),s=n.queries.get(e);if(s)for(const i of s.Sa)i.onError(t);n.queries.delete(e)}function jv(r){r.Ca.forEach(e=>{e.next()})}var by,xE;(xE=by||(by={})).Ma="default",xE.Cache="cache";class $S{constructor(e,t,n){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const s of e.docChanges)s.type!==3&&n.push(s);e=new Hl(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const n=t!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Hl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==by.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HS{constructor(e){this.key=e}}class WS{constructor(e){this.key=e}}class TN{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Xe(),this.mutatedKeys=Xe(),this.eu=lS(e),this.tu=new Pl(this.eu)}get nu(){return this.Ya}ru(e,t){const n=t?t.iu:new TE,s=t?t.tu:this.tu;let i=t?t.mutatedKeys:this.mutatedKeys,o=s,c=!1;const u=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,h=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((f,m)=>{const y=s.get(f),_=cp(this.query,m)?m:null,A=!!y&&this.mutatedKeys.has(y.key),b=!!_&&(_.hasLocalMutations||this.mutatedKeys.has(_.key)&&_.hasCommittedMutations);let T=!1;y&&_?y.data.isEqual(_.data)?A!==b&&(n.track({type:3,doc:_}),T=!0):this.su(y,_)||(n.track({type:2,doc:_}),T=!0,(u&&this.eu(_,u)>0||h&&this.eu(_,h)<0)&&(c=!0)):!y&&_?(n.track({type:0,doc:_}),T=!0):y&&!_&&(n.track({type:1,doc:y}),T=!0,(u||h)&&(c=!0)),T&&(_?(o=o.add(_),i=b?i.add(f):i.delete(f)):(o=o.delete(f),i=i.delete(f)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const f=this.query.limitType==="F"?o.last():o.first();o=o.delete(f.key),i=i.delete(f.key),n.track({type:1,doc:f})}return{tu:o,iu:n,Cs:c,mutatedKeys:i}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((f,m)=>function(_,A){const b=T=>{switch(T){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Me(20277,{Rt:T})}};return b(_)-b(A)}(f.type,m.type)||this.eu(f.doc,m.doc)),this.ou(n),s=s??!1;const c=t&&!s?this._u():[],u=this.Xa.size===0&&this.current&&!s?1:0,h=u!==this.Za;return this.Za=u,o.length!==0||h?{snapshot:new Hl(this.query,e.tu,i,o,e.mutatedKeys,u===0,h,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new TE,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(t=>this.Ya=this.Ya.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ya=this.Ya.delete(t)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Xe(),this.tu.forEach(n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))});const t=[];return e.forEach(n=>{this.Xa.has(n)||t.push(new WS(n))}),this.Xa.forEach(n=>{e.has(n)||t.push(new HS(n))}),t}cu(e){this.Ya=e.Qs,this.Xa=Xe();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Hl.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Bv="SyncEngine";class SN{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class xN{constructor(e){this.key=e,this.hu=!1}}class CN{constructor(e,t,n,s,i,o){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Aa(c=>aS(c),lp),this.Iu=new Map,this.Eu=new Set,this.du=new It(Se.comparator),this.Au=new Map,this.Ru=new kv,this.Vu={},this.mu=new Map,this.fu=$l.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function IN(r,e,t=!0){const n=QS(r);let s;const i=n.Tu.get(e);return i?(n.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await GS(n,e,t,!0),s}async function kN(r,e){const t=QS(r);await GS(t,e,!0,!1)}async function GS(r,e,t,n){const s=await XM(r.localStore,Cs(e)),i=s.targetId,o=r.sharedClientState.addLocalQueryTarget(i,t);let c;return n&&(c=await PN(r,e,i,o==="current",s.resumeToken)),r.isPrimaryClient&&t&&NS(r.remoteStore,s),c}async function PN(r,e,t,n,s){r.pu=(m,y,_)=>async function(b,T,x,M){let R=T.view.ru(x);R.Cs&&(R=await vE(b.localStore,T.query,!1).then(({documents:k})=>T.view.ru(k,R)));const B=M&&M.targetChanges.get(T.targetId),O=M&&M.targetMismatches.get(T.targetId)!=null,$=T.view.applyChanges(R,b.isPrimaryClient,B,O);return IE(b,T.targetId,$.au),$.snapshot}(r,m,y,_);const i=await vE(r.localStore,e,!0),o=new TN(e,i.Qs),c=o.ru(i.documents),u=sh.createSynthesizedTargetChangeForCurrentChange(t,n&&r.onlineState!=="Offline",s),h=o.applyChanges(c,r.isPrimaryClient,u);IE(r,t,h.au);const f=new SN(e,t,o);return r.Tu.set(e,f),r.Iu.has(t)?r.Iu.get(t).push(e):r.Iu.set(t,[e]),h.snapshot}async function RN(r,e,t){const n=je(r),s=n.Tu.get(e),i=n.Iu.get(s.targetId);if(i.length>1)return n.Iu.set(s.targetId,i.filter(o=>!lp(o,e))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await Ey(n.localStore,s.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(s.targetId),t&&Lv(n.remoteStore,s.targetId),Ty(n,s.targetId)}).catch(ec)):(Ty(n,s.targetId),await Ey(n.localStore,s.targetId,!0))}async function DN(r,e){const t=je(r),n=t.Tu.get(e),s=t.Iu.get(n.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(n.targetId),Lv(t.remoteStore,n.targetId))}async function LN(r,e,t){const n=BN(r);try{const s=await function(o,c){const u=je(o),h=mt.now(),f=c.reduce((_,A)=>_.add(A.key),Xe());let m,y;return u.persistence.runTransaction("Locally write mutations","readwrite",_=>{let A=pi(),b=Xe();return u.Ns.getEntries(_,f).next(T=>{A=T,A.forEach((x,M)=>{M.isValidDocument()||(b=b.add(x))})}).next(()=>u.localDocuments.getOverlayedDocuments(_,A)).next(T=>{m=T;const x=[];for(const M of c){const R=KL(M,m.get(M.key).overlayedDocument);R!=null&&x.push(new ba(M.key,R,eS(R.value.mapValue),es.exists(!0)))}return u.mutationQueue.addMutationBatch(_,h,x,c)}).next(T=>{y=T;const x=T.applyToLocalDocumentSet(m,b);return u.documentOverlayCache.saveOverlays(_,T.batchId,x)})}).then(()=>({batchId:y.batchId,changes:uS(m)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(s.batchId),function(o,c,u){let h=o.Vu[o.currentUser.toKey()];h||(h=new It(Ke)),h=h.insert(c,u),o.Vu[o.currentUser.toKey()]=h}(n,s.batchId,t),await oh(n,s.changes),await mp(n.remoteStore)}catch(s){const i=Vv(s,"Failed to persist write");t.reject(i)}}async function qS(r,e){const t=je(r);try{const n=await GM(t.localStore,e);e.targetChanges.forEach((s,i)=>{const o=t.Au.get(i);o&&(nt(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.hu=!0:s.modifiedDocuments.size>0?nt(o.hu,14607):s.removedDocuments.size>0&&(nt(o.hu,42227),o.hu=!1))}),await oh(t,n,e)}catch(n){await ec(n)}}function CE(r,e,t){const n=je(r);if(n.isPrimaryClient&&t===0||!n.isPrimaryClient&&t===1){const s=[];n.Tu.forEach((i,o)=>{const c=o.view.va(e);c.snapshot&&s.push(c.snapshot)}),function(o,c){const u=je(o);u.onlineState=c;let h=!1;u.queries.forEach((f,m)=>{for(const y of m.Sa)y.va(c)&&(h=!0)}),h&&jv(u)}(n.eventManager,e),s.length&&n.Pu.H_(s),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function MN(r,e,t){const n=je(r);n.sharedClientState.updateQueryState(e,"rejected",t);const s=n.Au.get(e),i=s&&s.key;if(i){let o=new It(Se.comparator);o=o.insert(i,kn.newNoDocument(i,Fe.min()));const c=Xe().add(i),u=new dp(Fe.min(),new Map,new It(Ke),o,c);await qS(n,u),n.du=n.du.remove(i),n.Au.delete(e),Uv(n)}else await Ey(n.localStore,e,!1).then(()=>Ty(n,e,t)).catch(ec)}async function NN(r,e){const t=je(r),n=e.batch.batchId;try{const s=await WM(t.localStore,e);XS(t,n,null),KS(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),await oh(t,s)}catch(s){await ec(s)}}async function ON(r,e,t){const n=je(r);try{const s=await function(o,c){const u=je(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let f;return u.mutationQueue.lookupMutationBatch(h,c).next(m=>(nt(m!==null,37113),f=m.keys(),u.mutationQueue.removeMutationBatch(h,m))).next(()=>u.mutationQueue.performConsistencyCheck(h)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(h,f,c)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,f)).next(()=>u.localDocuments.getDocuments(h,f))})}(n.localStore,e);XS(n,e,t),KS(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),await oh(n,s)}catch(s){await ec(s)}}function KS(r,e){(r.mu.get(e)||[]).forEach(t=>{t.resolve()}),r.mu.delete(e)}function XS(r,e,t){const n=je(r);let s=n.Vu[n.currentUser.toKey()];if(s){const i=s.get(e);i&&(t?i.reject(t):i.resolve(),s=s.remove(e)),n.Vu[n.currentUser.toKey()]=s}}function Ty(r,e,t=null){r.sharedClientState.removeLocalQueryTarget(e);for(const n of r.Iu.get(e))r.Tu.delete(n),t&&r.Pu.yu(n,t);r.Iu.delete(e),r.isPrimaryClient&&r.Ru.jr(e).forEach(n=>{r.Ru.containsKey(n)||YS(r,n)})}function YS(r,e){r.Eu.delete(e.path.canonicalString());const t=r.du.get(e);t!==null&&(Lv(r.remoteStore,t),r.du=r.du.remove(e),r.Au.delete(t),Uv(r))}function IE(r,e,t){for(const n of t)n instanceof HS?(r.Ru.addReference(n.key,e),FN(r,n)):n instanceof WS?(pe(Bv,"Document no longer in limbo: "+n.key),r.Ru.removeReference(n.key,e),r.Ru.containsKey(n.key)||YS(r,n.key)):Me(19791,{wu:n})}function FN(r,e){const t=e.key,n=t.path.canonicalString();r.du.get(t)||r.Eu.has(n)||(pe(Bv,"New document in limbo: "+t),r.Eu.add(n),Uv(r))}function Uv(r){for(;r.Eu.size>0&&r.du.size<r.maxConcurrentLimboResolutions;){const e=r.Eu.values().next().value;r.Eu.delete(e);const t=new Se(pt.fromString(e)),n=r.fu.next();r.Au.set(n,new xN(t)),r.du=r.du.insert(t,n),NS(r.remoteStore,new Ji(Cs(bv(t.path)),n,"TargetPurposeLimboResolution",sp.ce))}}async function oh(r,e,t){const n=je(r),s=[],i=[],o=[];n.Tu.isEmpty()||(n.Tu.forEach((c,u)=>{o.push(n.pu(u,e,t).then(h=>{if((h||t)&&n.isPrimaryClient){const f=h?!h.fromCache:t?.targetChanges.get(u.targetId)?.current;n.sharedClientState.updateQueryState(u.targetId,f?"current":"not-current")}if(h){s.push(h);const f=Rv.As(u.targetId,h);i.push(f)}}))}),await Promise.all(o),n.Pu.H_(s),await async function(u,h){const f=je(u);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>ne.forEach(h,y=>ne.forEach(y.Es,_=>f.persistence.referenceDelegate.addReference(m,y.targetId,_)).next(()=>ne.forEach(y.ds,_=>f.persistence.referenceDelegate.removeReference(m,y.targetId,_)))))}catch(m){if(!tc(m))throw m;pe(Dv,"Failed to update sequence numbers: "+m)}for(const m of h){const y=m.targetId;if(!m.fromCache){const _=f.Ms.get(y),A=_.snapshotVersion,b=_.withLastLimboFreeSnapshotVersion(A);f.Ms=f.Ms.insert(y,b)}}}(n.localStore,i))}async function VN(r,e){const t=je(r);if(!t.currentUser.isEqual(e)){pe(Bv,"User change. New user:",e.toKey());const n=await RS(t.localStore,e);t.currentUser=e,function(i,o){i.mu.forEach(c=>{c.forEach(u=>{u.reject(new we(re.CANCELLED,o))})}),i.mu.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await oh(t,n.Ls)}}function jN(r,e){const t=je(r),n=t.Au.get(e);if(n&&n.hu)return Xe().add(n.key);{let s=Xe();const i=t.Iu.get(e);if(!i)return s;for(const o of i){const c=t.Tu.get(o);s=s.unionWith(c.view.nu)}return s}}function QS(r){const e=je(r);return e.remoteStore.remoteSyncer.applyRemoteEvent=qS.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=jN.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=MN.bind(null,e),e.Pu.H_=AN.bind(null,e.eventManager),e.Pu.yu=bN.bind(null,e.eventManager),e}function BN(r){const e=je(r);return e.remoteStore.remoteSyncer.applySuccessfulWrite=NN.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=ON.bind(null,e),e}class Df{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=fp(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return HM(this.persistence,new UM,e.initialUser,this.serializer)}Cu(e){return new PS(Pv.mi,this.serializer)}Du(e){return new QM}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Df.provider={build:()=>new Df};class UN extends Df{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){nt(this.persistence.referenceDelegate instanceof Pf,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new xM(n,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Zn.withCacheSize(this.cacheSizeBytes):Zn.DEFAULT;return new PS(n=>Pf.mi(n,t),this.serializer)}}class Sy{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>CE(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=VN.bind(null,this.syncEngine),await _N(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new EN}()}createDatastore(e){const t=fp(e.databaseInfo.databaseId),n=function(i){return new nN(i)}(e.databaseInfo);return function(i,o,c,u){return new oN(i,o,c,u)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(n,s,i,o,c){return new lN(n,s,i,o,c)}(this.localStore,this.datastore,e.asyncQueue,t=>CE(this.syncEngine,t,0),function(){return EE.v()?new EE:new JM}())}createSyncEngine(e,t){return function(s,i,o,c,u,h,f){const m=new CN(s,i,o,c,u,h);return f&&(m.gu=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await async function(t){const n=je(t);pe(fa,"RemoteStore shutting down."),n.Ea.add(5),await ih(n),n.Aa.shutdown(),n.Ra.set("Unknown")}(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Sy.provider={build:()=>new Sy};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JS{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):di("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fo="FirestoreClient";class zN{constructor(e,t,n,s,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=s,this.user=In.UNAUTHENTICATED,this.clientId=gv.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,async o=>{pe(fo,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(n,o=>(pe(fo,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ai;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=Vv(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function kg(r,e){r.asyncQueue.verifyOperationInProgress(),pe(fo,"Initializing OfflineComponentProvider");const t=r.configuration;await e.initialize(t);let n=t.initialUser;r.setCredentialChangeListener(async s=>{n.isEqual(s)||(await RS(e.localStore,s),n=s)}),e.persistence.setDatabaseDeletedListener(()=>r.terminate()),r._offlineComponents=e}async function kE(r,e){r.asyncQueue.verifyOperationInProgress();const t=await $N(r);pe(fo,"Initializing OnlineComponentProvider"),await e.initialize(t,r.configuration),r.setCredentialChangeListener(n=>bE(e.remoteStore,n)),r.setAppCheckTokenChangeListener((n,s)=>bE(e.remoteStore,s)),r._onlineComponents=e}async function $N(r){if(!r._offlineComponents)if(r._uninitializedComponentsProvider){pe(fo,"Using user provided OfflineComponentProvider");try{await kg(r,r._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(s){return s.name==="FirebaseError"?s.code===re.FAILED_PRECONDITION||s.code===re.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(t))throw t;jl("Error using user provided cache. Falling back to memory cache: "+t),await kg(r,new Df)}}else pe(fo,"Using default OfflineComponentProvider"),await kg(r,new UN(void 0));return r._offlineComponents}async function ZS(r){return r._onlineComponents||(r._uninitializedComponentsProvider?(pe(fo,"Using user provided OnlineComponentProvider"),await kE(r,r._uninitializedComponentsProvider._online)):(pe(fo,"Using default OnlineComponentProvider"),await kE(r,new Sy))),r._onlineComponents}function HN(r){return ZS(r).then(e=>e.syncEngine)}async function ex(r){const e=await ZS(r),t=e.eventManager;return t.onListen=IN.bind(null,e.syncEngine),t.onUnlisten=RN.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=kN.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=DN.bind(null,e.syncEngine),t}function WN(r,e,t={}){const n=new ai;return r.asyncQueue.enqueueAndForget(async()=>function(i,o,c,u,h){const f=new JS({next:y=>{f.Nu(),o.enqueueAndForget(()=>zS(i,m));const _=y.docs.has(c);!_&&y.fromCache?h.reject(new we(re.UNAVAILABLE,"Failed to get document because the client is offline.")):_&&y.fromCache&&u&&u.source==="server"?h.reject(new we(re.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(y)},error:y=>h.reject(y)}),m=new $S(bv(c.path),f,{includeMetadataChanges:!0,qa:!0});return US(i,m)}(await ex(r),r.asyncQueue,e,t,n)),n.promise}function GN(r,e,t={}){const n=new ai;return r.asyncQueue.enqueueAndForget(async()=>function(i,o,c,u,h){const f=new JS({next:y=>{f.Nu(),o.enqueueAndForget(()=>zS(i,m)),y.fromCache&&u.source==="server"?h.reject(new we(re.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(y)},error:y=>h.reject(y)}),m=new $S(c,f,{includeMetadataChanges:!0,qa:!0});return US(i,m)}(await ex(r),r.asyncQueue,e,t,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tx(r){const e={};return r.timeoutSeconds!==void 0&&(e.timeoutSeconds=r.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PE=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nx="firestore.googleapis.com",RE=!0;class DE{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new we(re.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=nx,this.ssl=RE}else this.host=e.host,this.ssl=e.ssl??RE;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=kS;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<TM)throw new we(re.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}oL("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=tx(e.experimentalLongPollingOptions??{}),function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new we(re.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new we(re.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new we(re.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,s){return n.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class gp{constructor(e,t,n,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new DE({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new we(re.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new we(re.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new DE(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new YD;switch(n.type){case"firstParty":return new eL(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new we(re.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const n=PE.get(t);n&&(pe("ComponentProvider","Removing Datastore"),PE.delete(t),n.terminate())}(this),Promise.resolve()}}function qN(r,e,t,n={}){r=fi(r,gp);const s=_a(e),i=r._getSettings(),o={...i,emulatorOptions:r._getEmulatorOptions()},c=`${e}:${t}`;s&&(uv(`https://${c}`),hv("Firestore",!0)),i.host!==nx&&i.host!==c&&jl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...i,host:c,ssl:s,emulatorOptions:n};if(!ua(u,o)&&(r._setSettings(u),n.mockUserToken)){let h,f;if(typeof n.mockUserToken=="string")h=n.mockUserToken,f=In.MOCK_USER;else{h=kT(n.mockUserToken,r._app?.options.projectId);const m=n.mockUserToken.sub||n.mockUserToken.user_id;if(!m)throw new we(re.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new In(m)}r._authCredentials=new QD(new zT(h,f))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yp{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new yp(this.firestore,e,this._query)}}class Zt{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new no(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Zt(this.firestore,e,this._key)}toJSON(){return{type:Zt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,n){if(nh(t,Zt._jsonSchema))return new Zt(e,n||null,new Se(pt.fromString(t.referencePath)))}}Zt._jsonSchemaVersion="firestore/documentReference/1.0",Zt._jsonSchema={type:Gt("string",Zt._jsonSchemaVersion),referencePath:Gt("string")};class no extends yp{constructor(e,t,n){super(e,t,bv(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Zt(this.firestore,null,new Se(e))}withConverter(e){return new no(this.firestore,e,this._path)}}function KN(r,e,...t){if(r=jn(r),$T("collection","path",e),r instanceof gp){const n=pt.fromString(e,...t);return G1(n),new no(r,null,n)}{if(!(r instanceof Zt||r instanceof no))throw new we(re.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(pt.fromString(e,...t));return G1(n),new no(r.firestore,null,n)}}function rx(r,e,...t){if(r=jn(r),arguments.length===1&&(e=gv.newId()),$T("doc","path",e),r instanceof gp){const n=pt.fromString(e,...t);return W1(n),new Zt(r,null,new Se(n))}{if(!(r instanceof Zt||r instanceof no))throw new we(re.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(pt.fromString(e,...t));return W1(n),new Zt(r.firestore,r instanceof no?r.converter:null,new Se(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LE="AsyncQueue";class ME{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new LS(this,"async_queue_retry"),this._c=()=>{const n=Ig();n&&pe(LE,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const t=Ig();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Ig();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const t=new ai;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!tc(e))throw e;pe(LE,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const t=this.ac.then(()=>(this.rc=!0,e().catch(n=>{throw this.nc=n,this.rc=!1,di("INTERNAL UNHANDLED ERROR: ",NE(n)),n}).then(n=>(this.rc=!1,n))));return this.ac=t,t}enqueueAfterDelay(e,t,n){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const s=Fv.createAndSchedule(this,e,t,n,i=>this.hc(i));return this.tc.push(s),s}uc(){this.nc&&Me(47125,{Pc:NE(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((t,n)=>t.targetTimeMs-n.targetTimeMs);for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function NE(r){let e=r.message||"";return r.stack&&(e=r.stack.includes(r.message)?r.stack:r.message+`
`+r.stack),e}class rc extends gp{constructor(e,t,n,s){super(e,t,n,s),this.type="firestore",this._queue=new ME,this._persistenceKey=s?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new ME(e),this._firestoreClient=void 0,await e}}}function XN(r,e){const t=typeof r=="object"?r:pv(),n=typeof r=="string"?r:Tf,s=rp(t,"firestore").getImmediate({identifier:n});if(!s._initialized){const i=xT("firestore");i&&qN(s,...i)}return s}function zv(r){if(r._terminated)throw new we(re.FAILED_PRECONDITION,"The client has already been terminated.");return r._firestoreClient||YN(r),r._firestoreClient}function YN(r){const e=r._freezeSettings(),t=function(s,i,o,c){return new yL(s,i,o,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,tx(c.experimentalLongPollingOptions),c.useFetchStreams,c.isUsingEmulator)}(r._databaseId,r._app?.options.appId||"",r._persistenceKey,e);r._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(r._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),r._firestoreClient=new zN(r._authCredentials,r._appCheckCredentials,r._queue,t,r._componentsProvider&&function(s){const i=s?._online.build();return{_offline:s?._offline.build(i),_online:i}}(r._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Pr(yn.fromBase64String(e))}catch(t){throw new we(re.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Pr(yn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Pr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(nh(e,Pr._jsonSchema))return Pr.fromBase64String(e.bytes)}}Pr._jsonSchemaVersion="firestore/bytes/1.0",Pr._jsonSchema={type:Gt("string",Pr._jsonSchemaVersion),bytes:Gt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $v{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new we(re.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new gn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hv{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ks{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new we(re.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new we(re.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ke(this._lat,e._lat)||Ke(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:ks._jsonSchemaVersion}}static fromJSON(e){if(nh(e,ks._jsonSchema))return new ks(e.latitude,e.longitude)}}ks._jsonSchemaVersion="firestore/geoPoint/1.0",ks._jsonSchema={type:Gt("string",ks._jsonSchemaVersion),latitude:Gt("number"),longitude:Gt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ps{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,s){if(n.length!==s.length)return!1;for(let i=0;i<n.length;++i)if(n[i]!==s[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Ps._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(nh(e,Ps._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new Ps(e.vectorValues);throw new we(re.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Ps._jsonSchemaVersion="firestore/vectorValue/1.0",Ps._jsonSchema={type:Gt("string",Ps._jsonSchemaVersion),vectorValues:Gt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QN=/^__.*__$/;class JN{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return this.fieldMask!==null?new ba(e,this.data,this.fieldMask,t,this.fieldTransforms):new rh(e,this.data,t,this.fieldTransforms)}}function sx(r){switch(r){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Me(40011,{Ac:r})}}class Wv{constructor(e,t,n,s,i,o){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=s,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Wv({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),n=this.Vc({path:t,fc:!1});return n.gc(e),n}yc(e){const t=this.path?.child(e),n=this.Vc({path:t,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Lf(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(sx(this.Ac)&&QN.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class ZN{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||fp(e)}Cc(e,t,n,s=!1){return new Wv({Ac:e,methodName:t,Dc:n,path:gn.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function ix(r){const e=r._freezeSettings(),t=fp(r._databaseId);return new ZN(r._databaseId,!!e.ignoreUndefinedProperties,t)}function ox(r,e,t,n,s,i={}){const o=r.Cc(i.merge||i.mergeFields?2:0,e,t,s);ux("Data must be an object, but it was:",o,n);const c=lx(n,o);let u,h;if(i.merge)u=new Qr(o.fieldMask),h=o.fieldTransforms;else if(i.mergeFields){const f=[];for(const m of i.mergeFields){const y=e4(e,m,t);if(!o.contains(y))throw new we(re.INVALID_ARGUMENT,`Field '${y}' is specified in your field mask but missing from your input data.`);n4(f,y)||f.push(y)}u=new Qr(f),h=o.fieldTransforms.filter(m=>u.covers(m.field))}else u=null,h=o.fieldTransforms;return new JN(new kr(c),u,h)}class Gv extends Hv{_toFieldTransform(e){return new HL(e.path,new Ou)}isEqual(e){return e instanceof Gv}}function ax(r,e){if(cx(r=jn(r)))return ux("Unsupported field value:",e,r),lx(r,e);if(r instanceof Hv)return function(n,s){if(!sx(s.Ac))throw s.Sc(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${n._methodName}() is not currently supported inside arrays`);const i=n._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(r,e),null;if(r===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),r instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(n,s){const i=[];let o=0;for(const c of n){let u=ax(c,s.wc(o));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),o++}return{arrayValue:{values:i}}}(r,e)}return function(n,s){if((n=jn(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return UL(s.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const i=mt.fromDate(n);return{timestampValue:kf(s.serializer,i)}}if(n instanceof mt){const i=new mt(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:kf(s.serializer,i)}}if(n instanceof ks)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Pr)return{bytesValue:AS(s.serializer,n._byteString)};if(n instanceof Zt){const i=s.databaseId,o=n.firestore._databaseId;if(!o.isEqual(i))throw s.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Iv(n.firestore._databaseId||s.databaseId,n._key.path)}}if(n instanceof Ps)return function(o,c){return{mapValue:{fields:{[JT]:{stringValue:ZT},[Sf]:{arrayValue:{values:o.toArray().map(h=>{if(typeof h!="number")throw c.Sc("VectorValues must only contain numeric values.");return Tv(c.serializer,h)})}}}}}}(n,s);throw s.Sc(`Unsupported field value: ${yv(n)}`)}(r,e)}function lx(r,e){const t={};return GT(r)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ea(r,(n,s)=>{const i=ax(s,e.mc(n));i!=null&&(t[n]=i)}),{mapValue:{fields:t}}}function cx(r){return!(typeof r!="object"||r===null||r instanceof Array||r instanceof Date||r instanceof mt||r instanceof ks||r instanceof Pr||r instanceof Zt||r instanceof Hv||r instanceof Ps)}function ux(r,e,t){if(!cx(t)||!HT(t)){const n=yv(t);throw n==="an object"?e.Sc(r+" a custom object"):e.Sc(r+" "+n)}}function e4(r,e,t){if((e=jn(e))instanceof $v)return e._internalPath;if(typeof e=="string")return hx(r,e);throw Lf("Field path arguments must be of type string or ",r,!1,void 0,t)}const t4=new RegExp("[~\\*/\\[\\]]");function hx(r,e,t){if(e.search(t4)>=0)throw Lf(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,r,!1,void 0,t);try{return new $v(...e.split("."))._internalPath}catch{throw Lf(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,r,!1,void 0,t)}}function Lf(r,e,t,n,s){const i=n&&!n.isEmpty(),o=s!==void 0;let c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(i||o)&&(u+=" (found",i&&(u+=` in field ${n}`),o&&(u+=` in document ${s}`),u+=")"),new we(re.INVALID_ARGUMENT,c+r+u)}function n4(r,e){return r.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dx{constructor(e,t,n,s,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Zt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new r4(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(fx("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class r4 extends dx{data(){return super.data()}}function fx(r,e){return typeof e=="string"?hx(r,e):e instanceof $v?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s4(r){if(r.limitType==="L"&&r.explicitOrderBy.length===0)throw new we(re.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class i4{convertValue(e,t="none"){switch(uo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ft(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(co(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Me(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return Ea(e,(s,i)=>{n[s]=this.convertValue(i,t)}),n}convertVectorValue(e){const t=e.fields?.[Sf].arrayValue?.values?.map(n=>Ft(n.doubleValue));return new Ps(t)}convertGeoPoint(e){return new ks(Ft(e.latitude),Ft(e.longitude))}convertArray(e,t){return(e.values||[]).map(n=>this.convertValue(n,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=op(e);return n==null?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Lu(e));default:return null}}convertTimestamp(e){const t=lo(e);return new mt(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=pt.fromString(e);nt(IS(n),9688,{name:e});const s=new Mu(n.get(1),n.get(3)),i=new Se(n.popFirst(5));return s.isEqual(t)||di(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function px(r,e,t){let n;return n=r?t&&(t.merge||t.mergeFields)?r.toFirestore(e,t):r.toFirestore(e):e,n}class uu{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class la extends dx{constructor(e,t,n,s,i,o){super(e,t,n,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new hf(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(fx("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new we(re.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=la._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}la._jsonSchemaVersion="firestore/documentSnapshot/1.0",la._jsonSchema={type:Gt("string",la._jsonSchemaVersion),bundleSource:Gt("string","DocumentSnapshot"),bundleName:Gt("string"),bundle:Gt("string")};class hf extends la{data(e={}){return super.data(e)}}class Rl{constructor(e,t,n,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new uu(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new hf(this._firestore,this._userDataWriter,n.key,n,new uu(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new we(re.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(c=>{const u=new hf(s._firestore,s._userDataWriter,c.doc.key,c.doc,new uu(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);return c.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(c=>i||c.type!==3).map(c=>{const u=new hf(s._firestore,s._userDataWriter,c.doc.key,c.doc,new uu(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);let h=-1,f=-1;return c.type!==0&&(h=o.indexOf(c.doc.key),o=o.delete(c.doc.key)),c.type!==1&&(o=o.add(c.doc),f=o.indexOf(c.doc.key)),{type:o4(c.type),doc:u,oldIndex:h,newIndex:f}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new we(re.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Rl._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=gv.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],n=[],s=[];return this.docs.forEach(i=>{i._document!==null&&(t.push(i._document),n.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function o4(r){switch(r){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Me(61501,{type:r})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a4(r){r=fi(r,Zt);const e=fi(r.firestore,rc);return WN(zv(e),r._key).then(t=>c4(e,r,t))}Rl._jsonSchemaVersion="firestore/querySnapshot/1.0",Rl._jsonSchema={type:Gt("string",Rl._jsonSchemaVersion),bundleSource:Gt("string","QuerySnapshot"),bundleName:Gt("string"),bundle:Gt("string")};class mx extends i4{constructor(e){super(),this.firestore=e}convertBytes(e){return new Pr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Zt(this.firestore,null,t)}}function l4(r){r=fi(r,yp);const e=fi(r.firestore,rc),t=zv(e),n=new mx(e);return s4(r._query),GN(t,r._query).then(s=>new Rl(e,n,r,s))}function oU(r,e,t){r=fi(r,Zt);const n=fi(r.firestore,rc),s=px(r.converter,e,t);return qv(n,[ox(ix(n),"setDoc",r._key,s,r.converter!==null,t).toMutation(r._key,es.none())])}function aU(r){return qv(fi(r.firestore,rc),[new Sv(r._key,es.none())])}function lU(r,e){const t=fi(r.firestore,rc),n=rx(r),s=px(r.converter,e);return qv(t,[ox(ix(r.firestore),"addDoc",n._key,s,r.converter!==null,{}).toMutation(n._key,es.exists(!1))]).then(()=>n)}function qv(r,e){return function(n,s){const i=new ai;return n.asyncQueue.enqueueAndForget(async()=>LN(await HN(n),s,i)),i.promise}(zv(r),e)}function c4(r,e,t){const n=t.docs.get(e._key),s=new mx(r);return new la(r,s,e._key,n,new uu(t.hasPendingWrites,t.fromCache),e.converter)}function cU(){return new Gv("serverTimestamp")}(function(e,t=!0){(function(s){Zl=s})(wa),ha(new oo("firestore",(n,{instanceIdentifier:s,options:i})=>{const o=n.getProvider("app").getImmediate(),c=new rc(new JD(n.getProvider("auth-internal")),new tL(o,n.getProvider("app-check-internal")),function(h,f){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new we(re.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Mu(h.options.projectId,f)}(o,s),o);return i={useFetchStreams:t,...i},c._setSettings(i),c},"PUBLIC").setMultipleInstances(!0)),xs(U1,z1,e),xs(U1,z1,"esm2020")})();function gx(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const u4=gx,yx=new eh("auth","Firebase",gx());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mf=new dv("@firebase/auth");function h4(r,...e){Mf.logLevel<=Ge.WARN&&Mf.warn(`Auth (${wa}): ${r}`,...e)}function df(r,...e){Mf.logLevel<=Ge.ERROR&&Mf.error(`Auth (${wa}): ${r}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ts(r,...e){throw Kv(r,...e)}function Rs(r,...e){return Kv(r,...e)}function vx(r,e,t){const n={...u4(),[e]:t};return new eh("auth","Firebase",n).create(e,{appName:r.name})}function ro(r){return vx(r,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Kv(r,...e){if(typeof r!="string"){const t=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=r.name),r._errorFactory.create(t,...n)}return yx.create(r,...e)}function Le(r,e,...t){if(!r)throw Kv(e,...t)}function si(r){const e="INTERNAL ASSERTION FAILED: "+r;throw df(e),new Error(e)}function mi(r,e){r||si(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xy(){return typeof self<"u"&&self.location?.href||""}function d4(){return OE()==="http:"||OE()==="https:"}function OE(){return typeof self<"u"&&self.location?.protocol||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f4(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(d4()||CR()||"connection"in navigator)?navigator.onLine:!0}function p4(){if(typeof navigator>"u")return null;const r=navigator;return r.languages&&r.languages[0]||r.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ah{constructor(e,t){this.shortDelay=e,this.longDelay=t,mi(t>e,"Short delay should be less than long delay!"),this.isMobile=TR()||IR()}get(){return f4()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xv(r,e){mi(r.emulator,"Emulator should always be set here");const{url:t}=r.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _x{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;si("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;si("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;si("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m4={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g4=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],y4=new ah(3e4,6e4);function Sa(r,e){return r.tenantId&&!e.tenantId?{...e,tenantId:r.tenantId}:e}async function yo(r,e,t,n,s={}){return wx(r,s,async()=>{let i={},o={};n&&(e==="GET"?o=n:i={body:JSON.stringify(n)});const c=th({key:r.config.apiKey,...o}).slice(1),u=await r._getAdditionalHeaders();u["Content-Type"]="application/json",r.languageCode&&(u["X-Firebase-Locale"]=r.languageCode);const h={method:e,headers:u,...i};return xR()||(h.referrerPolicy="no-referrer"),r.emulatorConfig&&_a(r.emulatorConfig.host)&&(h.credentials="include"),_x.fetch()(await Ex(r,r.config.apiHost,t,c),h)})}async function wx(r,e,t){r._canInitEmulator=!1;const n={...m4,...e};try{const s=new _4(r),i=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Hd(r,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const c=i.ok?o.errorMessage:o.error.message,[u,h]=c.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Hd(r,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw Hd(r,"email-already-in-use",o);if(u==="USER_DISABLED")throw Hd(r,"user-disabled",o);const f=n[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw vx(r,f,h);ts(r,f)}}catch(s){if(s instanceof Bs)throw s;ts(r,"network-request-failed",{message:String(s)})}}async function vp(r,e,t,n,s={}){const i=await yo(r,e,t,n,s);return"mfaPendingCredential"in i&&ts(r,"multi-factor-auth-required",{_serverResponse:i}),i}async function Ex(r,e,t,n){const s=`${e}${t}?${n}`,i=r,o=i.config.emulator?Xv(r.config,s):`${r.config.apiScheme}://${s}`;return g4.includes(t)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}function v4(r){switch(r){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class _4{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,n)=>{this.timer=setTimeout(()=>n(Rs(this.auth,"network-request-failed")),y4.get())})}}function Hd(r,e,t){const n={appName:r.name};t.email&&(n.email=t.email),t.phoneNumber&&(n.phoneNumber=t.phoneNumber);const s=Rs(r,e,n);return s.customData._tokenResponse=t,s}function FE(r){return r!==void 0&&r.enterprise!==void 0}class w4{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return v4(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function E4(r,e){return yo(r,"GET","/v2/recaptchaConfig",Sa(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function A4(r,e){return yo(r,"POST","/v1/accounts:delete",e)}async function Nf(r,e){return yo(r,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Au(r){if(r)try{const e=new Date(Number(r));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function b4(r,e=!1){const t=jn(r),n=await t.getIdToken(e),s=Yv(n);Le(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i?.sign_in_provider;return{claims:s,token:n,authTime:Au(Pg(s.auth_time)),issuedAtTime:Au(Pg(s.iat)),expirationTime:Au(Pg(s.exp)),signInProvider:o||null,signInSecondFactor:i?.sign_in_second_factor||null}}function Pg(r){return Number(r)*1e3}function Yv(r){const[e,t,n]=r.split(".");if(e===void 0||t===void 0||n===void 0)return df("JWT malformed, contained fewer than 3 sections"),null;try{const s=TT(t);return s?JSON.parse(s):(df("Failed to decode base64 JWT payload"),null)}catch(s){return df("Caught error parsing JWT payload as JSON",s?.toString()),null}}function VE(r){const e=Yv(r);return Le(e,"internal-error"),Le(typeof e.exp<"u","internal-error"),Le(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ju(r,e,t=!1){if(t)return e;try{return await e}catch(n){throw n instanceof Bs&&T4(n)&&r.auth.currentUser===r&&await r.auth.signOut(),n}}function T4({code:r}){return r==="auth/user-disabled"||r==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S4{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cy{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Au(this.lastLoginAt),this.creationTime=Au(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Of(r){const e=r.auth,t=await r.getIdToken(),n=await ju(r,Nf(e,{idToken:t}));Le(n?.users.length,e,"internal-error");const s=n.users[0];r._notifyReloadListener(s);const i=s.providerUserInfo?.length?Ax(s.providerUserInfo):[],o=C4(r.providerData,i),c=r.isAnonymous,u=!(r.email&&s.passwordHash)&&!o?.length,h=c?u:!1,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Cy(s.createdAt,s.lastLoginAt),isAnonymous:h};Object.assign(r,f)}async function x4(r){const e=jn(r);await Of(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function C4(r,e){return[...r.filter(n=>!e.some(s=>s.providerId===n.providerId)),...e]}function Ax(r){return r.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function I4(r,e){const t=await wx(r,{},async()=>{const n=th({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=r.config,o=await Ex(r,s,"/v1/token",`key=${i}`),c=await r._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:c,body:n};return r.emulatorConfig&&_a(r.emulatorConfig.host)&&(u.credentials="include"),_x.fetch()(o,u)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function k4(r,e){return yo(r,"POST","/v2/accounts:revokeToken",Sa(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Le(e.idToken,"internal-error"),Le(typeof e.idToken<"u","internal-error"),Le(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):VE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Le(e.length!==0,"internal-error");const t=VE(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Le(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:s,expiresIn:i}=await I4(e,t);this.updateTokensAndExpiration(n,s,Number(i))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,t){const{refreshToken:n,accessToken:s,expirationTime:i}=t,o=new Dl;return n&&(Le(typeof n=="string","internal-error",{appName:e}),o.refreshToken=n),s&&(Le(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(Le(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Dl,this.toJSON())}_performRefresh(){return si("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wi(r,e){Le(typeof r=="string"||typeof r>"u","internal-error",{appName:e})}class Jr{constructor({uid:e,auth:t,stsTokenManager:n,...s}){this.providerId="firebase",this.proactiveRefresh=new S4(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Cy(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await ju(this,this.stsTokenManager.getToken(this.auth,e));return Le(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return b4(this,e)}reload(){return x4(this)}_assign(e){this!==e&&(Le(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Jr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Le(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await Of(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ir(this.auth.app))return Promise.reject(ro(this.auth));const e=await this.getIdToken();return await ju(this,A4(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const n=t.displayName??void 0,s=t.email??void 0,i=t.phoneNumber??void 0,o=t.photoURL??void 0,c=t.tenantId??void 0,u=t._redirectEventId??void 0,h=t.createdAt??void 0,f=t.lastLoginAt??void 0,{uid:m,emailVerified:y,isAnonymous:_,providerData:A,stsTokenManager:b}=t;Le(m&&b,e,"internal-error");const T=Dl.fromJSON(this.name,b);Le(typeof m=="string",e,"internal-error"),Wi(n,e.name),Wi(s,e.name),Le(typeof y=="boolean",e,"internal-error"),Le(typeof _=="boolean",e,"internal-error"),Wi(i,e.name),Wi(o,e.name),Wi(c,e.name),Wi(u,e.name),Wi(h,e.name),Wi(f,e.name);const x=new Jr({uid:m,auth:e,email:s,emailVerified:y,displayName:n,isAnonymous:_,photoURL:o,phoneNumber:i,tenantId:c,stsTokenManager:T,createdAt:h,lastLoginAt:f});return A&&Array.isArray(A)&&(x.providerData=A.map(M=>({...M}))),u&&(x._redirectEventId=u),x}static async _fromIdTokenResponse(e,t,n=!1){const s=new Dl;s.updateFromServerResponse(t);const i=new Jr({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:n});return await Of(i),i}static async _fromGetAccountInfoResponse(e,t,n){const s=t.users[0];Le(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?Ax(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!i?.length,c=new Dl;c.updateFromIdToken(n);const u=new Jr({uid:s.localId,auth:e,stsTokenManager:c,isAnonymous:o}),h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Cy(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!i?.length};return Object.assign(u,h),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jE=new Map;function ii(r){mi(r instanceof Function,"Expected a class definition");let e=jE.get(r);return e?(mi(e instanceof r,"Instance stored in cache mismatched with class"),e):(e=new r,jE.set(r,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bx{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}bx.type="NONE";const BE=bx;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ff(r,e,t){return`firebase:${r}:${e}:${t}`}class Ll{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:s,name:i}=this.auth;this.fullUserKey=ff(this.userKey,s.apiKey,i),this.fullPersistenceKey=ff("persistence",s.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Nf(this.auth,{idToken:e}).catch(()=>{});return t?Jr._fromGetAccountInfoResponse(this.auth,t,e):null}return Jr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new Ll(ii(BE),e,n);const s=(await Promise.all(t.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let i=s[0]||ii(BE);const o=ff(n,e.config.apiKey,e.name);let c=null;for(const h of t)try{const f=await h._get(o);if(f){let m;if(typeof f=="string"){const y=await Nf(e,{idToken:f}).catch(()=>{});if(!y)break;m=await Jr._fromGetAccountInfoResponse(e,y,f)}else m=Jr._fromJSON(e,f);h!==i&&(c=m),i=h;break}}catch{}const u=s.filter(h=>h._shouldAllowMigration);return!i._shouldAllowMigration||!u.length?new Ll(i,e,n):(i=u[0],c&&await i._set(o,c.toJSON()),await Promise.all(t.map(async h=>{if(h!==i)try{await h._remove(o)}catch{}})),new Ll(i,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UE(r){const e=r.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Cx(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Tx(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(kx(e))return"Blackberry";if(Px(e))return"Webos";if(Sx(e))return"Safari";if((e.includes("chrome/")||xx(e))&&!e.includes("edge/"))return"Chrome";if(Ix(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=r.match(t);if(n?.length===2)return n[1]}return"Other"}function Tx(r=Dn()){return/firefox\//i.test(r)}function Sx(r=Dn()){const e=r.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function xx(r=Dn()){return/crios\//i.test(r)}function Cx(r=Dn()){return/iemobile/i.test(r)}function Ix(r=Dn()){return/android/i.test(r)}function kx(r=Dn()){return/blackberry/i.test(r)}function Px(r=Dn()){return/webos/i.test(r)}function Qv(r=Dn()){return/iphone|ipad|ipod/i.test(r)||/macintosh/i.test(r)&&/mobile/i.test(r)}function P4(r=Dn()){return Qv(r)&&!!window.navigator?.standalone}function R4(){return kR()&&document.documentMode===10}function Rx(r=Dn()){return Qv(r)||Ix(r)||Px(r)||kx(r)||/windows phone/i.test(r)||Cx(r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dx(r,e=[]){let t;switch(r){case"Browser":t=UE(Dn());break;case"Worker":t=`${UE(Dn())}-${r}`;break;default:t=r}const n=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${wa}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D4{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=i=>new Promise((o,c)=>{try{const u=e(i);o(u)}catch(u){c(u)}});n.onAbort=t,this.queue.push(n);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function L4(r,e={}){return yo(r,"GET","/v2/passwordPolicy",Sa(r,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M4=6;class N4{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??M4,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let n;for(let s=0;s<e.length;s++)n=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O4{constructor(e,t,n,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new zE(this),this.idTokenSubscription=new zE(this),this.beforeStateQueue=new D4(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=yx,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=ii(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Ll.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Nf(this,{idToken:e}),n=await Jr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Ir(this.app)){const i=this.app.settings.authIdToken;return i?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(i).then(o,o))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let n=t,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const i=this.redirectUser?._redirectEventId,o=n?._redirectEventId,c=await this.tryRedirectSignIn(e);(!i||i===o)&&c?.user&&(n=c.user,s=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(n)}catch(i){n=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(i))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return Le(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Of(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=p4()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ir(this.app))return Promise.reject(ro(this));const t=e?jn(e):null;return t&&Le(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Le(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ir(this.app)?Promise.reject(ro(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ir(this.app)?Promise.reject(ro(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ii(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await L4(this),t=new N4(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new eh("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(n.tenantId=this.tenantId),await k4(this,n)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&ii(e)||this._popupRedirectResolver;Le(t,this,"argument-error"),this.redirectPersistenceManager=await Ll.create(this,[ii(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,s){if(this._deleted)return()=>{};const i=typeof t=="function"?t:t.next.bind(t);let o=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(Le(c,this,"internal-error"),c.then(()=>{o||i(this.currentUser)}),typeof t=="function"){const u=e.addObserver(t,n,s);return()=>{o=!0,u()}}else{const u=e.addObserver(t);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Le(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Dx(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){if(Ir(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&h4(`Error while retrieving App Check token: ${e.error}`),e?.token}}function sc(r){return jn(r)}class zE{constructor(e){this.auth=e,this.observer=null,this.addObserver=FR(t=>this.observer=t)}get next(){return Le(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _p={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function F4(r){_p=r}function Lx(r){return _p.loadJS(r)}function V4(){return _p.recaptchaEnterpriseScript}function j4(){return _p.gapiScript}function B4(r){return`__${r}${Math.floor(Math.random()*1e6)}`}class U4{constructor(){this.enterprise=new z4}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class z4{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const $4="recaptcha-enterprise",Mx="NO_RECAPTCHA";class H4{constructor(e){this.type=$4,this.auth=sc(e)}async verify(e="verify",t=!1){async function n(i){if(!t){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,c)=>{E4(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{const h=new w4(u);return i.tenantId==null?i._agentRecaptchaConfig=h:i._tenantRecaptchaConfigs[i.tenantId]=h,o(h.siteKey)}}).catch(u=>{c(u)})})}function s(i,o,c){const u=window.grecaptcha;FE(u)?u.enterprise.ready(()=>{u.enterprise.execute(i,{action:e}).then(h=>{o(h)}).catch(()=>{o(Mx)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new U4().execute("siteKey",{action:"verify"}):new Promise((i,o)=>{n(this.auth).then(c=>{if(!t&&FE(window.grecaptcha))s(c,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let u=V4();u.length!==0&&(u+=c),Lx(u).then(()=>{s(c,i,o)}).catch(h=>{o(h)})}}).catch(c=>{o(c)})})}}async function $E(r,e,t,n=!1,s=!1){const i=new H4(r);let o;if(s)o=Mx;else try{o=await i.verify(t)}catch{o=await i.verify(t,!0)}const c={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in c){const u=c.phoneEnrollmentInfo.phoneNumber,h=c.phoneEnrollmentInfo.recaptchaToken;Object.assign(c,{phoneEnrollmentInfo:{phoneNumber:u,recaptchaToken:h,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in c){const u=c.phoneSignInInfo.recaptchaToken;Object.assign(c,{phoneSignInInfo:{recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return c}return n?Object.assign(c,{captchaResp:o}):Object.assign(c,{captchaResponse:o}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c}async function HE(r,e,t,n,s){if(r._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await $E(r,e,t,t==="getOobCode");return n(r,i)}else return n(r,e).catch(async i=>{if(i.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await $E(r,e,t,t==="getOobCode");return n(r,o)}else return Promise.reject(i)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W4(r,e){const t=rp(r,"auth");if(t.isInitialized()){const s=t.getImmediate(),i=t.getOptions();if(ua(i,e??{}))return s;ts(s,"already-initialized")}return t.initialize({options:e})}function G4(r,e){const t=e?.persistence||[],n=(Array.isArray(t)?t:[t]).map(ii);e?.errorMap&&r._updateErrorMap(e.errorMap),r._initializeWithPersistence(n,e?.popupRedirectResolver)}function q4(r,e,t){const n=sc(r);Le(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const s=!1,i=Nx(e),{host:o,port:c}=K4(e),u=c===null?"":`:${c}`,h={url:`${i}//${o}${u}/`},f=Object.freeze({host:o,port:c,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!n._canInitEmulator){Le(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),Le(ua(h,n.config.emulator)&&ua(f,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=h,n.emulatorConfig=f,n.settings.appVerificationDisabledForTesting=!0,_a(o)?(uv(`${i}//${o}${u}`),hv("Auth",!0)):X4()}function Nx(r){const e=r.indexOf(":");return e<0?"":r.substr(0,e+1)}function K4(r){const e=Nx(r),t=/(\/\/)?([^?#/]+)/.exec(r.substr(e.length));if(!t)return{host:"",port:null};const n=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(n);if(s){const i=s[1];return{host:i,port:WE(n.substr(i.length+1))}}else{const[i,o]=n.split(":");return{host:i,port:WE(o)}}}function WE(r){if(!r)return null;const e=Number(r);return isNaN(e)?null:e}function X4(){function r(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",r):r())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jv{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return si("not implemented")}_getIdTokenResponse(e){return si("not implemented")}_linkToIdToken(e,t){return si("not implemented")}_getReauthenticationResolver(e){return si("not implemented")}}async function Y4(r,e){return yo(r,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Q4(r,e){return vp(r,"POST","/v1/accounts:signInWithPassword",Sa(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function J4(r,e){return vp(r,"POST","/v1/accounts:signInWithEmailLink",Sa(r,e))}async function Z4(r,e){return vp(r,"POST","/v1/accounts:signInWithEmailLink",Sa(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bu extends Jv{constructor(e,t,n,s=null){super("password",n),this._email=e,this._password=t,this._tenantId=s}static _fromEmailAndPassword(e,t){return new Bu(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new Bu(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return HE(e,t,"signInWithPassword",Q4);case"emailLink":return J4(e,{email:this._email,oobCode:this._password});default:ts(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const n={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return HE(e,n,"signUpPassword",Y4);case"emailLink":return Z4(e,{idToken:t,email:this._email,oobCode:this._password});default:ts(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ml(r,e){return vp(r,"POST","/v1/accounts:signInWithIdp",Sa(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e3="http://localhost";class pa extends Jv{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new pa(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ts("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:s,...i}=t;if(!n||!s)return null;const o=new pa(n,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return Ml(e,t)}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Ml(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Ml(e,t)}buildRequest(){const e={requestUri:e3,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=th(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t3(r){switch(r){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function n3(r){const e=iu(ou(r)).link,t=e?iu(ou(e)).deep_link_id:null,n=iu(ou(r)).deep_link_id;return(n?iu(ou(n)).link:null)||n||t||e||r}class Zv{constructor(e){const t=iu(ou(e)),n=t.apiKey??null,s=t.oobCode??null,i=t3(t.mode??null);Le(n&&s&&i,"argument-error"),this.apiKey=n,this.operation=i,this.code=s,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=n3(e);try{return new Zv(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ic{constructor(){this.providerId=ic.PROVIDER_ID}static credential(e,t){return Bu._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=Zv.parseLink(t);return Le(n,"argument-error"),Bu._fromEmailAndCode(e,n.code,n.tenantId)}}ic.PROVIDER_ID="password";ic.EMAIL_PASSWORD_SIGN_IN_METHOD="password";ic.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ox{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lh extends Ox{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qi extends lh{constructor(){super("facebook.com")}static credential(e){return pa._fromParams({providerId:qi.PROVIDER_ID,signInMethod:qi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return qi.credentialFromTaggedObject(e)}static credentialFromError(e){return qi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return qi.credential(e.oauthAccessToken)}catch{return null}}}qi.FACEBOOK_SIGN_IN_METHOD="facebook.com";qi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ki extends lh{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return pa._fromParams({providerId:Ki.PROVIDER_ID,signInMethod:Ki.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ki.credentialFromTaggedObject(e)}static credentialFromError(e){return Ki.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return Ki.credential(t,n)}catch{return null}}}Ki.GOOGLE_SIGN_IN_METHOD="google.com";Ki.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xi extends lh{constructor(){super("github.com")}static credential(e){return pa._fromParams({providerId:Xi.PROVIDER_ID,signInMethod:Xi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Xi.credentialFromTaggedObject(e)}static credentialFromError(e){return Xi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Xi.credential(e.oauthAccessToken)}catch{return null}}}Xi.GITHUB_SIGN_IN_METHOD="github.com";Xi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yi extends lh{constructor(){super("twitter.com")}static credential(e,t){return pa._fromParams({providerId:Yi.PROVIDER_ID,signInMethod:Yi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Yi.credentialFromTaggedObject(e)}static credentialFromError(e){return Yi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return Yi.credential(t,n)}catch{return null}}}Yi.TWITTER_SIGN_IN_METHOD="twitter.com";Yi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,s=!1){const i=await Jr._fromIdTokenResponse(e,n,s),o=GE(n);return new Wl({user:i,providerId:o,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const s=GE(n);return new Wl({user:e,providerId:s,_tokenResponse:n,operationType:t})}}function GE(r){return r.providerId?r.providerId:"phoneNumber"in r?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ff extends Bs{constructor(e,t,n,s){super(t.code,t.message),this.operationType=n,this.user=s,Object.setPrototypeOf(this,Ff.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,s){return new Ff(e,t,n,s)}}function Fx(r,e,t,n){return(e==="reauthenticate"?t._getReauthenticationResolver(r):t._getIdTokenResponse(r)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Ff._fromErrorAndOperation(r,i,e,n):i})}async function r3(r,e,t=!1){const n=await ju(r,e._linkToIdToken(r.auth,await r.getIdToken()),t);return Wl._forOperation(r,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function s3(r,e,t=!1){const{auth:n}=r;if(Ir(n.app))return Promise.reject(ro(n));const s="reauthenticate";try{const i=await ju(r,Fx(n,s,e,r),t);Le(i.idToken,n,"internal-error");const o=Yv(i.idToken);Le(o,n,"internal-error");const{sub:c}=o;return Le(r.uid===c,n,"user-mismatch"),Wl._forOperation(r,s,i)}catch(i){throw i?.code==="auth/user-not-found"&&ts(n,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vx(r,e,t=!1){if(Ir(r.app))return Promise.reject(ro(r));const n="signIn",s=await Fx(r,n,e),i=await Wl._fromIdTokenResponse(r,n,s);return t||await r._updateCurrentUser(i.user),i}async function i3(r,e){return Vx(sc(r),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function o3(r){const e=sc(r);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}function uU(r,e,t){return Ir(r.app)?Promise.reject(ro(r)):i3(jn(r),ic.credential(e,t)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&o3(r),n})}function a3(r,e,t,n){return jn(r).onIdTokenChanged(e,t,n)}function l3(r,e,t){return jn(r).beforeAuthStateChanged(e,t)}function hU(r,e,t,n){return jn(r).onAuthStateChanged(e,t,n)}function dU(r){return jn(r).signOut()}const Vf="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jx{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Vf,"1"),this.storage.removeItem(Vf),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c3=1e3,u3=10;class Bx extends jx{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Rx(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),s=this.localCache[t];n!==s&&e(t,s,n)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,c,u)=>{this.notifyListeners(o,u)});return}const n=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(n);!t&&this.localCache[n]===o||this.notifyListeners(n,o)},i=this.storage.getItem(n);R4()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,u3):s()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},c3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Bx.type="LOCAL";const h3=Bx;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ux extends jx{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Ux.type="SESSION";const zx=Ux;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d3(r){return Promise.all(r.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wp{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const n=new wp(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:s,data:i}=t.data,o=this.handlersMap[s];if(!o?.size)return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:s});const c=Array.from(o).map(async h=>h(t.origin,i)),u=await d3(c);t.ports[0].postMessage({status:"done",eventId:n,eventType:s,response:u})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}wp.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e0(r="",e=10){let t="";for(let n=0;n<e;n++)t+=Math.floor(Math.random()*10);return r+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f3{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((c,u)=>{const h=e0("",20);s.port1.start();const f=setTimeout(()=>{u(new Error("unsupported_event"))},n);o={messageChannel:s,onMessage(m){const y=m;if(y.data.eventId===h)switch(y.data.status){case"ack":clearTimeout(f),i=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),c(y.data.response);break;default:clearTimeout(f),clearTimeout(i),u(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:h,data:t},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ds(){return window}function p3(r){Ds().location.href=r}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $x(){return typeof Ds().WorkerGlobalScope<"u"&&typeof Ds().importScripts=="function"}async function m3(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function g3(){return navigator?.serviceWorker?.controller||null}function y3(){return $x()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hx="firebaseLocalStorageDb",v3=1,jf="firebaseLocalStorage",Wx="fbase_key";class ch{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Ep(r,e){return r.transaction([jf],e?"readwrite":"readonly").objectStore(jf)}function _3(){const r=indexedDB.deleteDatabase(Hx);return new ch(r).toPromise()}function Iy(){const r=indexedDB.open(Hx,v3);return new Promise((e,t)=>{r.addEventListener("error",()=>{t(r.error)}),r.addEventListener("upgradeneeded",()=>{const n=r.result;try{n.createObjectStore(jf,{keyPath:Wx})}catch(s){t(s)}}),r.addEventListener("success",async()=>{const n=r.result;n.objectStoreNames.contains(jf)?e(n):(n.close(),await _3(),e(await Iy()))})})}async function qE(r,e,t){const n=Ep(r,!0).put({[Wx]:e,value:t});return new ch(n).toPromise()}async function w3(r,e){const t=Ep(r,!1).get(e),n=await new ch(t).toPromise();return n===void 0?null:n.value}function KE(r,e){const t=Ep(r,!0).delete(e);return new ch(t).toPromise()}const E3=800,A3=3;class Gx{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Iy(),this.db)}async _withRetries(e){let t=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(t++>A3)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return $x()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=wp._getInstance(y3()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await m3(),!this.activeServiceWorker)return;this.sender=new f3(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||g3()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Iy();return await qE(e,Vf,"1"),await KE(e,Vf),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>qE(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(n=>w3(n,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>KE(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Ep(s,!1).getAll();return new ch(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],n=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)n.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!n.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),E3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Gx.type="LOCAL";const b3=Gx;new ah(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T3(r,e){return e?ii(e):(Le(r._popupRedirectResolver,r,"argument-error"),r._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t0 extends Jv{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ml(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Ml(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Ml(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function S3(r){return Vx(r.auth,new t0(r),r.bypassAuthState)}function x3(r){const{auth:e,user:t}=r;return Le(t,e,"internal-error"),s3(t,new t0(r),r.bypassAuthState)}async function C3(r){const{auth:e,user:t}=r;return Le(t,e,"internal-error"),r3(t,new t0(r),r.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qx{constructor(e,t,n,s,i=!1){this.auth=e,this.resolver=n,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:s,tenantId:i,error:o,type:c}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(u))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return S3;case"linkViaPopup":case"linkViaRedirect":return C3;case"reauthViaPopup":case"reauthViaRedirect":return x3;default:ts(this.auth,"internal-error")}}resolve(e){mi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){mi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I3=new ah(2e3,1e4);class Al extends qx{constructor(e,t,n,s,i){super(e,t,s,i),this.provider=n,this.authWindow=null,this.pollId=null,Al.currentPopupAction&&Al.currentPopupAction.cancel(),Al.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Le(e,this.auth,"internal-error"),e}async onExecution(){mi(this.filter.length===1,"Popup operations only handle one event");const e=e0();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Rs(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Rs(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Al.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Rs(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,I3.get())};e()}}Al.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k3="pendingRedirect",pf=new Map;class P3 extends qx{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=pf.get(this.auth._key());if(!e){try{const n=await R3(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}pf.set(this.auth._key(),e)}return this.bypassAuthState||pf.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function R3(r,e){const t=M3(e),n=L3(r);if(!await n._isAvailable())return!1;const s=await n._get(t)==="true";return await n._remove(t),s}function D3(r,e){pf.set(r._key(),e)}function L3(r){return ii(r._redirectPersistence)}function M3(r){return ff(k3,r.config.apiKey,r.name)}async function N3(r,e,t=!1){if(Ir(r.app))return Promise.reject(ro(r));const n=sc(r),s=T3(n,e),o=await new P3(n,s,t).execute();return o&&!t&&(delete o.user._redirectEventId,await n._persistUserIfCurrent(o.user),await n._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O3=600*1e3;class F3{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!V3(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!Kx(e)){const n=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Rs(this.auth,n))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=O3&&this.cachedEventUids.clear(),this.cachedEventUids.has(XE(e))}saveEventToCache(e){this.cachedEventUids.add(XE(e)),this.lastProcessedEventTime=Date.now()}}function XE(r){return[r.type,r.eventId,r.sessionId,r.tenantId].filter(e=>e).join("-")}function Kx({type:r,error:e}){return r==="unknown"&&e?.code==="auth/no-auth-event"}function V3(r){switch(r.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Kx(r);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function j3(r,e={}){return yo(r,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B3=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,U3=/^https?/;async function z3(r){if(r.config.emulator)return;const{authorizedDomains:e}=await j3(r);for(const t of e)try{if($3(t))return}catch{}ts(r,"unauthorized-domain")}function $3(r){const e=xy(),{protocol:t,hostname:n}=new URL(e);if(r.startsWith("chrome-extension://")){const o=new URL(r);return o.hostname===""&&n===""?t==="chrome-extension:"&&r.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===n}if(!U3.test(t))return!1;if(B3.test(r))return n===r;const s=r.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H3=new ah(3e4,6e4);function YE(){const r=Ds().___jsl;if(r?.H){for(const e of Object.keys(r.H))if(r.H[e].r=r.H[e].r||[],r.H[e].L=r.H[e].L||[],r.H[e].r=[...r.H[e].L],r.CP)for(let t=0;t<r.CP.length;t++)r.CP[t]=null}}function W3(r){return new Promise((e,t)=>{function n(){YE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{YE(),t(Rs(r,"network-request-failed"))},timeout:H3.get()})}if(Ds().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Ds().gapi?.load)n();else{const s=B4("iframefcb");return Ds()[s]=()=>{gapi.load?n():t(Rs(r,"network-request-failed"))},Lx(`${j4()}?onload=${s}`).catch(i=>t(i))}}).catch(e=>{throw mf=null,e})}let mf=null;function G3(r){return mf=mf||W3(r),mf}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q3=new ah(5e3,15e3),K3="__/auth/iframe",X3="emulator/auth/iframe",Y3={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Q3=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function J3(r){const e=r.config;Le(e.authDomain,r,"auth-domain-config-required");const t=e.emulator?Xv(e,X3):`https://${r.config.authDomain}/${K3}`,n={apiKey:e.apiKey,appName:r.name,v:wa},s=Q3.get(r.config.apiHost);s&&(n.eid=s);const i=r._getFrameworks();return i.length&&(n.fw=i.join(",")),`${t}?${th(n).slice(1)}`}async function Z3(r){const e=await G3(r),t=Ds().gapi;return Le(t,r,"internal-error"),e.open({where:document.body,url:J3(r),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Y3,dontclear:!0},n=>new Promise(async(s,i)=>{await n.restyle({setHideOnLeave:!1});const o=Rs(r,"network-request-failed"),c=Ds().setTimeout(()=>{i(o)},q3.get());function u(){Ds().clearTimeout(c),s(n)}n.ping(u).then(u,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eO={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},tO=500,nO=600,rO="_blank",sO="http://localhost";class QE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function iO(r,e,t,n=tO,s=nO){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-n)/2,0).toString();let c="";const u={...eO,width:n.toString(),height:s.toString(),top:i,left:o},h=Dn().toLowerCase();t&&(c=xx(h)?rO:t),Tx(h)&&(e=e||sO,u.scrollbars="yes");const f=Object.entries(u).reduce((y,[_,A])=>`${y}${_}=${A},`,"");if(P4(h)&&c!=="_self")return oO(e||"",c),new QE(null);const m=window.open(e||"",c,f);Le(m,r,"popup-blocked");try{m.focus()}catch{}return new QE(m)}function oO(r,e){const t=document.createElement("a");t.href=r,t.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aO="__/auth/handler",lO="emulator/auth/handler",cO=encodeURIComponent("fac");async function JE(r,e,t,n,s,i){Le(r.config.authDomain,r,"auth-domain-config-required"),Le(r.config.apiKey,r,"invalid-api-key");const o={apiKey:r.config.apiKey,appName:r.name,authType:t,redirectUrl:n,v:wa,eventId:s};if(e instanceof Ox){e.setDefaultLanguage(r.languageCode),o.providerId=e.providerId||"",OR(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,m]of Object.entries({}))o[f]=m}if(e instanceof lh){const f=e.getScopes().filter(m=>m!=="");f.length>0&&(o.scopes=f.join(","))}r.tenantId&&(o.tid=r.tenantId);const c=o;for(const f of Object.keys(c))c[f]===void 0&&delete c[f];const u=await r._getAppCheckToken(),h=u?`#${cO}=${encodeURIComponent(u)}`:"";return`${uO(r)}?${th(c).slice(1)}${h}`}function uO({config:r}){return r.emulator?Xv(r,lO):`https://${r.authDomain}/${aO}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rg="webStorageSupport";class hO{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=zx,this._completeRedirectFn=N3,this._overrideRedirectResult=D3}async _openPopup(e,t,n,s){mi(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const i=await JE(e,t,n,xy(),s);return iO(e,i,e0())}async _openRedirect(e,t,n,s){await this._originValidation(e);const i=await JE(e,t,n,xy(),s);return p3(i),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:i}=this.eventManagers[t];return s?Promise.resolve(s):(mi(i,"If manager is not set, promise should be"),i)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await Z3(e),n=new F3(e);return t.register("authEvent",s=>(Le(s?.authEvent,e,"invalid-auth-event"),{status:n.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Rg,{type:Rg},s=>{const i=s?.[0]?.[Rg];i!==void 0&&t(!!i),ts(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=z3(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Rx()||Sx()||Qv()}}const dO=hO;var ZE="@firebase/auth",eA="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fO{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Le(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pO(r){switch(r){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function mO(r){ha(new oo("auth",(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:c}=n.options;Le(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const u={apiKey:o,authDomain:c,clientPlatform:r,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Dx(r)},h=new O4(n,s,i,u);return G4(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),ha(new oo("auth-internal",e=>{const t=sc(e.getProvider("auth").getImmediate());return(n=>new fO(n))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),xs(ZE,eA,pO(r)),xs(ZE,eA,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gO=300,yO=IT("authIdTokenMaxAge")||gO;let tA=null;const vO=r=>async e=>{const t=e&&await e.getIdTokenResult(),n=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>yO)return;const s=t?.token;tA!==s&&(tA=s,await fetch(r,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function _O(r=pv()){const e=rp(r,"auth");if(e.isInitialized())return e.getImmediate();const t=W4(r,{popupRedirectResolver:dO,persistence:[b3,h3,zx]}),n=IT("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(n,location.origin);if(location.origin===i.origin){const o=vO(i.toString());l3(t,o,()=>o(t.currentUser)),a3(t,c=>o(c))}}const s=ST("auth");return s&&q4(t,`http://${s}`),t}function wO(){return document.getElementsByTagName("head")?.[0]??document}F4({loadJS(r){return new Promise((e,t)=>{const n=document.createElement("script");n.setAttribute("src",r),n.onload=e,n.onerror=s=>{const i=Rs("internal-error");i.customData=s,t(i)},n.type="text/javascript",n.charset="UTF-8",wO().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});mO("Browser");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xx="firebasestorage.googleapis.com",EO="storageBucket",AO=120*1e3,bO=600*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Us extends Bs{constructor(e,t,n=0){super(Dg(e),`Firebase Storage: ${t} (${Dg(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Us.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Dg(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Vs;(function(r){r.UNKNOWN="unknown",r.OBJECT_NOT_FOUND="object-not-found",r.BUCKET_NOT_FOUND="bucket-not-found",r.PROJECT_NOT_FOUND="project-not-found",r.QUOTA_EXCEEDED="quota-exceeded",r.UNAUTHENTICATED="unauthenticated",r.UNAUTHORIZED="unauthorized",r.UNAUTHORIZED_APP="unauthorized-app",r.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",r.INVALID_CHECKSUM="invalid-checksum",r.CANCELED="canceled",r.INVALID_EVENT_NAME="invalid-event-name",r.INVALID_URL="invalid-url",r.INVALID_DEFAULT_BUCKET="invalid-default-bucket",r.NO_DEFAULT_BUCKET="no-default-bucket",r.CANNOT_SLICE_BLOB="cannot-slice-blob",r.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",r.NO_DOWNLOAD_URL="no-download-url",r.INVALID_ARGUMENT="invalid-argument",r.INVALID_ARGUMENT_COUNT="invalid-argument-count",r.APP_DELETED="app-deleted",r.INVALID_ROOT_OPERATION="invalid-root-operation",r.INVALID_FORMAT="invalid-format",r.INTERNAL_ERROR="internal-error",r.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Vs||(Vs={}));function Dg(r){return"storage/"+r}function TO(){const r="An unknown error occurred, please check the error payload for server response.";return new Us(Vs.UNKNOWN,r)}function SO(){return new Us(Vs.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function xO(){return new Us(Vs.CANCELED,"User canceled the upload/download.")}function CO(r){return new Us(Vs.INVALID_URL,"Invalid URL '"+r+"'.")}function IO(r){return new Us(Vs.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+r+"'.")}function nA(r){return new Us(Vs.INVALID_ARGUMENT,r)}function Yx(){return new Us(Vs.APP_DELETED,"The Firebase app was deleted.")}function kO(r){return new Us(Vs.INVALID_ROOT_OPERATION,"The operation '"+r+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zr{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=Zr.makeFromUrl(e,t)}catch{return new Zr(e,"")}if(n.path==="")return n;throw IO(e)}static makeFromUrl(e,t){let n=null;const s="([A-Za-z0-9.\\-_]+)";function i(B){B.path.charAt(B.path.length-1)==="/"&&(B.path_=B.path_.slice(0,-1))}const o="(/(.*))?$",c=new RegExp("^gs://"+s+o,"i"),u={bucket:1,path:3};function h(B){B.path_=decodeURIComponent(B.path)}const f="v[A-Za-z0-9_]+",m=t.replace(/[.]/g,"\\."),y="(/([^?#]*).*)?$",_=new RegExp(`^https?://${m}/${f}/b/${s}/o${y}`,"i"),A={bucket:1,path:3},b=t===Xx?"(?:storage.googleapis.com|storage.cloud.google.com)":t,T="([^?#]*)",x=new RegExp(`^https?://${b}/${s}/${T}`,"i"),R=[{regex:c,indices:u,postModify:i},{regex:_,indices:A,postModify:h},{regex:x,indices:{bucket:1,path:2},postModify:h}];for(let B=0;B<R.length;B++){const O=R[B],$=O.regex.exec(e);if($){const k=$[O.indices.bucket];let C=$[O.indices.path];C||(C=""),n=new Zr(k,C),O.postModify(n);break}}if(n==null)throw CO(e);return n}}class PO{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RO(r,e,t){let n=1,s=null,i=null,o=!1,c=0;function u(){return c===2}let h=!1;function f(...T){h||(h=!0,e.apply(null,T))}function m(T){s=setTimeout(()=>{s=null,r(_,u())},T)}function y(){i&&clearTimeout(i)}function _(T,...x){if(h){y();return}if(T){y(),f.call(null,T,...x);return}if(u()||o){y(),f.call(null,T,...x);return}n<64&&(n*=2);let R;c===1?(c=2,R=0):R=(n+Math.random())*1e3,m(R)}let A=!1;function b(T){A||(A=!0,y(),!h&&(s!==null?(T||(c=2),clearTimeout(s),m(0)):T||(c=1)))}return m(0),i=setTimeout(()=>{o=!0,b(!0)},t),b}function DO(r){r(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LO(r){return r!==void 0}function rA(r,e,t,n){if(n<e)throw nA(`Invalid value for '${r}'. Expected ${e} or greater.`);if(n>t)throw nA(`Invalid value for '${r}'. Expected ${t} or less.`)}function MO(r){const e=encodeURIComponent;let t="?";for(const n in r)if(r.hasOwnProperty(n)){const s=e(n)+"="+e(r[n]);t=t+s+"&"}return t=t.slice(0,-1),t}var Bf;(function(r){r[r.NO_ERROR=0]="NO_ERROR",r[r.NETWORK_ERROR=1]="NETWORK_ERROR",r[r.ABORT=2]="ABORT"})(Bf||(Bf={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NO(r,e){const t=r>=500&&r<600,s=[408,429].indexOf(r)!==-1,i=e.indexOf(r)!==-1;return t||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OO{constructor(e,t,n,s,i,o,c,u,h,f,m,y=!0,_=!1){this.url_=e,this.method_=t,this.headers_=n,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=c,this.errorCallback_=u,this.timeout_=h,this.progressCallback_=f,this.connectionFactory_=m,this.retry=y,this.isUsingEmulator=_,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((A,b)=>{this.resolve_=A,this.reject_=b,this.start_()})}start_(){const e=(n,s)=>{if(s){n(!1,new Wd(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=c=>{const u=c.loaded,h=c.lengthComputable?c.total:-1;this.progressCallback_!==null&&this.progressCallback_(u,h)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const c=i.getErrorCode()===Bf.NO_ERROR,u=i.getStatus();if(!c||NO(u,this.additionalRetryCodes_)&&this.retry){const f=i.getErrorCode()===Bf.ABORT;n(!1,new Wd(!1,null,f));return}const h=this.successCodes_.indexOf(u)!==-1;n(!0,new Wd(h,i))})},t=(n,s)=>{const i=this.resolve_,o=this.reject_,c=s.connection;if(s.wasSuccessCode)try{const u=this.callback_(c,c.getResponse());LO(u)?i(u):i()}catch(u){o(u)}else if(c!==null){const u=TO();u.serverResponse=c.getErrorText(),this.errorCallback_?o(this.errorCallback_(c,u)):o(u)}else if(s.canceled){const u=this.appDelete_?Yx():xO();o(u)}else{const u=SO();o(u)}};this.canceled_?t(!1,new Wd(!1,null,!0)):this.backoffId_=RO(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&DO(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Wd{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}function FO(r,e){e!==null&&e.length>0&&(r.Authorization="Firebase "+e)}function VO(r,e){r["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function jO(r,e){e&&(r["X-Firebase-GMPID"]=e)}function BO(r,e){e!==null&&(r["X-Firebase-AppCheck"]=e)}function UO(r,e,t,n,s,i,o=!0,c=!1){const u=MO(r.urlParams),h=r.url+u,f=Object.assign({},r.headers);return jO(f,e),FO(f,t),VO(f,i),BO(f,n),new OO(h,r.method,f,r.body,r.successCodes,r.additionalRetryCodes,r.handler,r.errorHandler,r.timeout,r.progressCallback,s,o,c)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zO(r){if(r.length===0)return null;const e=r.lastIndexOf("/");return e===-1?"":r.slice(0,e)}function $O(r){const e=r.lastIndexOf("/",r.length-2);return e===-1?r:r.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uf{constructor(e,t){this._service=e,t instanceof Zr?this._location=t:this._location=Zr.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Uf(e,t)}get root(){const e=new Zr(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return $O(this._location.path)}get storage(){return this._service}get parent(){const e=zO(this._location.path);if(e===null)return null;const t=new Zr(this._location.bucket,e);return new Uf(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw kO(e)}}function sA(r,e){const t=e?.[EO];return t==null?null:Zr.makeFromBucketSpec(t,r)}function HO(r,e,t,n={}){r.host=`${e}:${t}`;const s=_a(e);s&&(uv(`https://${r.host}/b`),hv("Storage",!0)),r._isUsingEmulator=!0,r._protocol=s?"https":"http";const{mockUserToken:i}=n;i&&(r._overrideAuthToken=typeof i=="string"?i:kT(i,r.app.options.projectId))}class WO{constructor(e,t,n,s,i,o=!1){this.app=e,this._authProvider=t,this._appCheckProvider=n,this._url=s,this._firebaseVersion=i,this._isUsingEmulator=o,this._bucket=null,this._host=Xx,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=AO,this._maxUploadRetryTime=bO,this._requests=new Set,s!=null?this._bucket=Zr.makeFromBucketSpec(s,this._host):this._bucket=sA(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Zr.makeFromBucketSpec(this._url,e):this._bucket=sA(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){rA("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){rA("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Ir(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Uf(this,e)}_makeRequest(e,t,n,s,i=!0){if(this._deleted)return new PO(Yx());{const o=UO(e,this._appId,n,s,t,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,t){const[n,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n,s).getPromise()}}const iA="@firebase/storage",oA="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qx="storage";function GO(r=pv(),e){r=jn(r);const n=rp(r,Qx).getImmediate({identifier:e}),s=xT("storage");return s&&qO(n,...s),n}function qO(r,e,t,n={}){HO(r,e,t,n)}function KO(r,{instanceIdentifier:e}){const t=r.getProvider("app").getImmediate(),n=r.getProvider("auth-internal"),s=r.getProvider("app-check-internal");return new WO(t,n,s,e,wa)}function XO(){ha(new oo(Qx,KO,"PUBLIC").setMultipleInstances(!0)),xs(iA,oA,""),xs(iA,oA,"esm2020")}XO();const n0=V.createContext({});function r0(r){const e=V.useRef(null);return e.current===null&&(e.current=r()),e.current}const Ap=V.createContext(null),s0=V.createContext({transformPagePoint:r=>r,isStatic:!1,reducedMotion:"never"});class YO extends V.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const n=this.props.sizeRef.current;n.height=t.offsetHeight||0,n.width=t.offsetWidth||0,n.top=t.offsetTop,n.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function QO({children:r,isPresent:e}){const t=V.useId(),n=V.useRef(null),s=V.useRef({width:0,height:0,top:0,left:0}),{nonce:i}=V.useContext(s0);return V.useInsertionEffect(()=>{const{width:o,height:c,top:u,left:h}=s.current;if(e||!n.current||!o||!c)return;n.current.dataset.motionPopId=t;const f=document.createElement("style");return i&&(f.nonce=i),document.head.appendChild(f),f.sheet&&f.sheet.insertRule(`
          [data-motion-pop-id="${t}"] {
            position: absolute !important;
            width: ${o}px !important;
            height: ${c}px !important;
            top: ${u}px !important;
            left: ${h}px !important;
          }
        `),()=>{document.head.removeChild(f)}},[e]),L.jsx(YO,{isPresent:e,childRef:n,sizeRef:s,children:V.cloneElement(r,{ref:n})})}const JO=({children:r,initial:e,isPresent:t,onExitComplete:n,custom:s,presenceAffectsLayout:i,mode:o})=>{const c=r0(ZO),u=V.useId(),h=V.useCallback(m=>{c.set(m,!0);for(const y of c.values())if(!y)return;n&&n()},[c,n]),f=V.useMemo(()=>({id:u,initial:e,isPresent:t,custom:s,onExitComplete:h,register:m=>(c.set(m,!1),()=>c.delete(m))}),i?[Math.random(),h]:[t,h]);return V.useMemo(()=>{c.forEach((m,y)=>c.set(y,!1))},[t]),V.useEffect(()=>{!t&&!c.size&&n&&n()},[t]),o==="popLayout"&&(r=L.jsx(QO,{isPresent:t,children:r})),L.jsx(Ap.Provider,{value:f,children:r})};function ZO(){return new Map}function Jx(r=!0){const e=V.useContext(Ap);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:n,register:s}=e,i=V.useId();V.useEffect(()=>{r&&s(i)},[r]);const o=V.useCallback(()=>r&&n&&n(i),[i,n,r]);return!t&&n?[!1,o]:[!0]}const Gd=r=>r.key||"";function aA(r){const e=[];return V.Children.forEach(r,t=>{V.isValidElement(t)&&e.push(t)}),e}const i0=typeof window<"u",Zx=i0?V.useLayoutEffect:V.useEffect,bp=({children:r,custom:e,initial:t=!0,onExitComplete:n,presenceAffectsLayout:s=!0,mode:i="sync",propagate:o=!1})=>{const[c,u]=Jx(o),h=V.useMemo(()=>aA(r),[r]),f=o&&!c?[]:h.map(Gd),m=V.useRef(!0),y=V.useRef(h),_=r0(()=>new Map),[A,b]=V.useState(h),[T,x]=V.useState(h);Zx(()=>{m.current=!1,y.current=h;for(let B=0;B<T.length;B++){const O=Gd(T[B]);f.includes(O)?_.delete(O):_.get(O)!==!0&&_.set(O,!1)}},[T,f.length,f.join("-")]);const M=[];if(h!==A){let B=[...h];for(let O=0;O<T.length;O++){const $=T[O],k=Gd($);f.includes(k)||(B.splice(O,0,$),M.push($))}i==="wait"&&M.length&&(B=M),x(aA(B)),b(h);return}const{forceRender:R}=V.useContext(n0);return L.jsx(L.Fragment,{children:T.map(B=>{const O=Gd(B),$=o&&!c?!1:h===T||f.includes(O),k=()=>{if(_.has(O))_.set(O,!0);else return;let C=!0;_.forEach(P=>{P||(C=!1)}),C&&(R?.(),x(y.current),o&&u?.(),n&&n())};return L.jsx(JO,{isPresent:$,initial:!m.current||t?void 0:!1,custom:$?void 0:e,presenceAffectsLayout:s,mode:i,onExitComplete:$?void 0:k,children:B},O)})})},ur=r=>r;let eC=ur;function o0(r){let e;return()=>(e===void 0&&(e=r()),e)}const Gl=(r,e,t)=>{const n=e-r;return n===0?1:(t-r)/n},li=r=>r*1e3,ci=r=>r/1e3,e6={useManualTiming:!1};function t6(r){let e=new Set,t=new Set,n=!1,s=!1;const i=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function c(h){i.has(h)&&(u.schedule(h),r()),h(o)}const u={schedule:(h,f=!1,m=!1)=>{const _=m&&n?e:t;return f&&i.add(h),_.has(h)||_.add(h),h},cancel:h=>{t.delete(h),i.delete(h)},process:h=>{if(o=h,n){s=!0;return}n=!0,[e,t]=[t,e],e.forEach(c),e.clear(),n=!1,s&&(s=!1,u.process(h))}};return u}const qd=["read","resolveKeyframes","update","preRender","render","postRender"],n6=40;function tC(r,e){let t=!1,n=!0;const s={delta:0,timestamp:0,isProcessing:!1},i=()=>t=!0,o=qd.reduce((x,M)=>(x[M]=t6(i),x),{}),{read:c,resolveKeyframes:u,update:h,preRender:f,render:m,postRender:y}=o,_=()=>{const x=performance.now();t=!1,s.delta=n?1e3/60:Math.max(Math.min(x-s.timestamp,n6),1),s.timestamp=x,s.isProcessing=!0,c.process(s),u.process(s),h.process(s),f.process(s),m.process(s),y.process(s),s.isProcessing=!1,t&&e&&(n=!1,r(_))},A=()=>{t=!0,n=!0,s.isProcessing||r(_)};return{schedule:qd.reduce((x,M)=>{const R=o[M];return x[M]=(B,O=!1,$=!1)=>(t||A(),R.schedule(B,O,$)),x},{}),cancel:x=>{for(let M=0;M<qd.length;M++)o[qd[M]].cancel(x)},state:s,steps:o}}const{schedule:gt,cancel:po,state:fn,steps:Lg}=tC(typeof requestAnimationFrame<"u"?requestAnimationFrame:ur,!0),a0=V.createContext({strict:!1}),lA={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},ql={};for(const r in lA)ql[r]={isEnabled:e=>lA[r].some(t=>!!e[t])};function ky(r){for(const e in r)ql[e]={...ql[e],...r[e]}}function r6({children:r,features:e,strict:t=!1}){const[,n]=V.useState(!Mg(e)),s=V.useRef(void 0);if(!Mg(e)){const{renderer:i,...o}=e;s.current=i,ky(o)}return V.useEffect(()=>{Mg(e)&&e().then(({renderer:i,...o})=>{ky(o),s.current=i,n(!0)})},[]),L.jsx(a0.Provider,{value:{renderer:s.current,strict:t},children:r})}function Mg(r){return typeof r=="function"}const s6=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function zf(r){return r.startsWith("while")||r.startsWith("drag")&&r!=="draggable"||r.startsWith("layout")||r.startsWith("onTap")||r.startsWith("onPan")||r.startsWith("onLayout")||s6.has(r)}let nC=r=>!zf(r);function i6(r){r&&(nC=e=>e.startsWith("on")?!zf(e):r(e))}try{i6(require("@emotion/is-prop-valid").default)}catch{}function o6(r,e,t){const n={};for(const s in r)s==="values"&&typeof r.values=="object"||(nC(s)||t===!0&&zf(s)||!e&&!zf(s)||r.draggable&&s.startsWith("onDrag"))&&(n[s]=r[s]);return n}function a6(r){if(typeof Proxy>"u")return r;const e=new Map,t=(...n)=>r(...n);return new Proxy(t,{get:(n,s)=>s==="create"?r:(e.has(s)||e.set(s,r(s)),e.get(s))})}const Tp=V.createContext({});function Uu(r){return typeof r=="string"||Array.isArray(r)}function Sp(r){return r!==null&&typeof r=="object"&&typeof r.start=="function"}const l0=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],c0=["initial",...l0];function xp(r){return Sp(r.animate)||c0.some(e=>Uu(r[e]))}function rC(r){return!!(xp(r)||r.variants)}function l6(r,e){if(xp(r)){const{initial:t,animate:n}=r;return{initial:t===!1||Uu(t)?t:void 0,animate:Uu(n)?n:void 0}}return r.inherit!==!1?e:{}}function c6(r){const{initial:e,animate:t}=l6(r,V.useContext(Tp));return V.useMemo(()=>({initial:e,animate:t}),[cA(e),cA(t)])}function cA(r){return Array.isArray(r)?r.join(" "):r}const u6=Symbol.for("motionComponentSymbol");function bl(r){return r&&typeof r=="object"&&Object.prototype.hasOwnProperty.call(r,"current")}function h6(r,e,t){return V.useCallback(n=>{n&&r.onMount&&r.onMount(n),e&&(n?e.mount(n):e.unmount()),t&&(typeof t=="function"?t(n):bl(t)&&(t.current=n))},[e])}const u0=r=>r.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),d6="framerAppearId",sC="data-"+u0(d6),{schedule:h0}=tC(queueMicrotask,!1),iC=V.createContext({});function f6(r,e,t,n,s){var i,o;const{visualElement:c}=V.useContext(Tp),u=V.useContext(a0),h=V.useContext(Ap),f=V.useContext(s0).reducedMotion,m=V.useRef(null);n=n||u.renderer,!m.current&&n&&(m.current=n(r,{visualState:e,parent:c,props:t,presenceContext:h,blockInitialAnimation:h?h.initial===!1:!1,reducedMotionConfig:f}));const y=m.current,_=V.useContext(iC);y&&!y.projection&&s&&(y.type==="html"||y.type==="svg")&&p6(m.current,t,s,_);const A=V.useRef(!1);V.useInsertionEffect(()=>{y&&A.current&&y.update(t,h)});const b=t[sC],T=V.useRef(!!b&&!(!((i=window.MotionHandoffIsComplete)===null||i===void 0)&&i.call(window,b))&&((o=window.MotionHasOptimisedAnimation)===null||o===void 0?void 0:o.call(window,b)));return Zx(()=>{y&&(A.current=!0,window.MotionIsMounted=!0,y.updateFeatures(),h0.render(y.render),T.current&&y.animationState&&y.animationState.animateChanges())}),V.useEffect(()=>{y&&(!T.current&&y.animationState&&y.animationState.animateChanges(),T.current&&(queueMicrotask(()=>{var x;(x=window.MotionHandoffMarkAsComplete)===null||x===void 0||x.call(window,b)}),T.current=!1))}),y}function p6(r,e,t,n){const{layoutId:s,layout:i,drag:o,dragConstraints:c,layoutScroll:u,layoutRoot:h}=e;r.projection=new t(r.latestValues,e["data-framer-portal-id"]?void 0:oC(r.parent)),r.projection.setOptions({layoutId:s,layout:i,alwaysMeasureLayout:!!o||c&&bl(c),visualElement:r,animationType:typeof i=="string"?i:"both",initialPromotionConfig:n,layoutScroll:u,layoutRoot:h})}function oC(r){if(r)return r.options.allowProjection!==!1?r.projection:oC(r.parent)}function m6({preloadedFeatures:r,createVisualElement:e,useRender:t,useVisualState:n,Component:s}){var i,o;r&&ky(r);function c(h,f){let m;const y={...V.useContext(s0),...h,layoutId:g6(h)},{isStatic:_}=y,A=c6(h),b=n(h,_);if(!_&&i0){y6();const T=v6(y);m=T.MeasureLayout,A.visualElement=f6(s,b,y,e,T.ProjectionNode)}return L.jsxs(Tp.Provider,{value:A,children:[m&&A.visualElement?L.jsx(m,{visualElement:A.visualElement,...y}):null,t(s,h,h6(b,A.visualElement,f),b,_,A.visualElement)]})}c.displayName=`motion.${typeof s=="string"?s:`create(${(o=(i=s.displayName)!==null&&i!==void 0?i:s.name)!==null&&o!==void 0?o:""})`}`;const u=V.forwardRef(c);return u[u6]=s,u}function g6({layoutId:r}){const e=V.useContext(n0).id;return e&&r!==void 0?e+"-"+r:r}function y6(r,e){V.useContext(a0).strict}function v6(r){const{drag:e,layout:t}=ql;if(!e&&!t)return{};const n={...e,...t};return{MeasureLayout:e?.isEnabled(r)||t?.isEnabled(r)?n.MeasureLayout:void 0,ProjectionNode:n.ProjectionNode}}const _6=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function d0(r){return typeof r!="string"||r.includes("-")?!1:!!(_6.indexOf(r)>-1||/[A-Z]/u.test(r))}function uA(r){const e=[{},{}];return r?.values.forEach((t,n)=>{e[0][n]=t.get(),e[1][n]=t.getVelocity()}),e}function f0(r,e,t,n){if(typeof e=="function"){const[s,i]=uA(n);e=e(t!==void 0?t:r.custom,s,i)}if(typeof e=="string"&&(e=r.variants&&r.variants[e]),typeof e=="function"){const[s,i]=uA(n);e=e(t!==void 0?t:r.custom,s,i)}return e}const Py=r=>Array.isArray(r),w6=r=>!!(r&&typeof r=="object"&&r.mix&&r.toValue),E6=r=>Py(r)?r[r.length-1]||0:r,Rn=r=>!!(r&&r.getVelocity);function gf(r){const e=Rn(r)?r.get():r;return w6(e)?e.toValue():e}function A6({scrapeMotionValuesFromProps:r,createRenderState:e,onUpdate:t},n,s,i){const o={latestValues:b6(n,s,i,r),renderState:e()};return t&&(o.onMount=c=>t({props:n,current:c,...o}),o.onUpdate=c=>t(c)),o}const aC=r=>(e,t)=>{const n=V.useContext(Tp),s=V.useContext(Ap),i=()=>A6(r,e,n,s);return t?i():r0(i)};function b6(r,e,t,n){const s={},i=n(r,{});for(const y in i)s[y]=gf(i[y]);let{initial:o,animate:c}=r;const u=xp(r),h=rC(r);e&&h&&!u&&r.inherit!==!1&&(o===void 0&&(o=e.initial),c===void 0&&(c=e.animate));let f=t?t.initial===!1:!1;f=f||o===!1;const m=f?c:o;if(m&&typeof m!="boolean"&&!Sp(m)){const y=Array.isArray(m)?m:[m];for(let _=0;_<y.length;_++){const A=f0(r,y[_]);if(A){const{transitionEnd:b,transition:T,...x}=A;for(const M in x){let R=x[M];if(Array.isArray(R)){const B=f?R.length-1:0;R=R[B]}R!==null&&(s[M]=R)}for(const M in b)s[M]=b[M]}}}return s}const oc=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],xa=new Set(oc),lC=r=>e=>typeof e=="string"&&e.startsWith(r),cC=lC("--"),T6=lC("var(--"),p0=r=>T6(r)?S6.test(r.split("/*")[0].trim()):!1,S6=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,uC=(r,e)=>e&&typeof r=="number"?e.transform(r):r,gi=(r,e,t)=>t>e?e:t<r?r:t,ac={test:r=>typeof r=="number",parse:parseFloat,transform:r=>r},zu={...ac,transform:r=>gi(0,1,r)},Kd={...ac,default:1},uh=r=>({test:e=>typeof e=="string"&&e.endsWith(r)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${r}`}),Gi=uh("deg"),Ls=uh("%"),De=uh("px"),x6=uh("vh"),C6=uh("vw"),hA={...Ls,parse:r=>Ls.parse(r)/100,transform:r=>Ls.transform(r*100)},I6={borderWidth:De,borderTopWidth:De,borderRightWidth:De,borderBottomWidth:De,borderLeftWidth:De,borderRadius:De,radius:De,borderTopLeftRadius:De,borderTopRightRadius:De,borderBottomRightRadius:De,borderBottomLeftRadius:De,width:De,maxWidth:De,height:De,maxHeight:De,top:De,right:De,bottom:De,left:De,padding:De,paddingTop:De,paddingRight:De,paddingBottom:De,paddingLeft:De,margin:De,marginTop:De,marginRight:De,marginBottom:De,marginLeft:De,backgroundPositionX:De,backgroundPositionY:De},k6={rotate:Gi,rotateX:Gi,rotateY:Gi,rotateZ:Gi,scale:Kd,scaleX:Kd,scaleY:Kd,scaleZ:Kd,skew:Gi,skewX:Gi,skewY:Gi,distance:De,translateX:De,translateY:De,translateZ:De,x:De,y:De,z:De,perspective:De,transformPerspective:De,opacity:zu,originX:hA,originY:hA,originZ:De},dA={...ac,transform:Math.round},m0={...I6,...k6,zIndex:dA,size:De,fillOpacity:zu,strokeOpacity:zu,numOctaves:dA},P6={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},R6=oc.length;function D6(r,e,t){let n="",s=!0;for(let i=0;i<R6;i++){const o=oc[i],c=r[o];if(c===void 0)continue;let u=!0;if(typeof c=="number"?u=c===(o.startsWith("scale")?1:0):u=parseFloat(c)===0,!u||t){const h=uC(c,m0[o]);if(!u){s=!1;const f=P6[o]||o;n+=`${f}(${h}) `}t&&(e[o]=h)}}return n=n.trim(),t?n=t(e,s?"":n):s&&(n="none"),n}function g0(r,e,t){const{style:n,vars:s,transformOrigin:i}=r;let o=!1,c=!1;for(const u in e){const h=e[u];if(xa.has(u)){o=!0;continue}else if(cC(u)){s[u]=h;continue}else{const f=uC(h,m0[u]);u.startsWith("origin")?(c=!0,i[u]=f):n[u]=f}}if(e.transform||(o||t?n.transform=D6(e,r.transform,t):n.transform&&(n.transform="none")),c){const{originX:u="50%",originY:h="50%",originZ:f=0}=i;n.transformOrigin=`${u} ${h} ${f}`}}const L6={offset:"stroke-dashoffset",array:"stroke-dasharray"},M6={offset:"strokeDashoffset",array:"strokeDasharray"};function N6(r,e,t=1,n=0,s=!0){r.pathLength=1;const i=s?L6:M6;r[i.offset]=De.transform(-n);const o=De.transform(e),c=De.transform(t);r[i.array]=`${o} ${c}`}function fA(r,e,t){return typeof r=="string"?r:De.transform(e+t*r)}function O6(r,e,t){const n=fA(e,r.x,r.width),s=fA(t,r.y,r.height);return`${n} ${s}`}function y0(r,{attrX:e,attrY:t,attrScale:n,originX:s,originY:i,pathLength:o,pathSpacing:c=1,pathOffset:u=0,...h},f,m){if(g0(r,h,m),f){r.style.viewBox&&(r.attrs.viewBox=r.style.viewBox);return}r.attrs=r.style,r.style={};const{attrs:y,style:_,dimensions:A}=r;y.transform&&(A&&(_.transform=y.transform),delete y.transform),A&&(s!==void 0||i!==void 0||_.transform)&&(_.transformOrigin=O6(A,s!==void 0?s:.5,i!==void 0?i:.5)),e!==void 0&&(y.x=e),t!==void 0&&(y.y=t),n!==void 0&&(y.scale=n),o!==void 0&&N6(y,o,c,u,!1)}const v0=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),hC=()=>({...v0(),attrs:{}}),_0=r=>typeof r=="string"&&r.toLowerCase()==="svg";function dC(r,{style:e,vars:t},n,s){Object.assign(r.style,e,s&&s.getProjectionStyles(n));for(const i in t)r.style.setProperty(i,t[i])}const fC=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function pC(r,e,t,n){dC(r,e,void 0,n);for(const s in e.attrs)r.setAttribute(fC.has(s)?s:u0(s),e.attrs[s])}const $f={};function F6(r){Object.assign($f,r)}function mC(r,{layout:e,layoutId:t}){return xa.has(r)||r.startsWith("origin")||(e||t!==void 0)&&(!!$f[r]||r==="opacity")}function w0(r,e,t){var n;const{style:s}=r,i={};for(const o in s)(Rn(s[o])||e.style&&Rn(e.style[o])||mC(o,r)||((n=t?.getValue(o))===null||n===void 0?void 0:n.liveStyle)!==void 0)&&(i[o]=s[o]);return i}function gC(r,e,t){const n=w0(r,e,t);for(const s in r)if(Rn(r[s])||Rn(e[s])){const i=oc.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;n[i]=r[s]}return n}function V6(r,e){try{e.dimensions=typeof r.getBBox=="function"?r.getBBox():r.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const pA=["x","y","width","height","cx","cy","r"],j6={useVisualState:aC({scrapeMotionValuesFromProps:gC,createRenderState:hC,onUpdate:({props:r,prevProps:e,current:t,renderState:n,latestValues:s})=>{if(!t)return;let i=!!r.drag;if(!i){for(const c in s)if(xa.has(c)){i=!0;break}}if(!i)return;let o=!e;if(e)for(let c=0;c<pA.length;c++){const u=pA[c];r[u]!==e[u]&&(o=!0)}o&&gt.read(()=>{V6(t,n),gt.render(()=>{y0(n,s,_0(t.tagName),r.transformTemplate),pC(t,n)})})}})},B6={useVisualState:aC({scrapeMotionValuesFromProps:w0,createRenderState:v0})};function yC(r,e,t){for(const n in e)!Rn(e[n])&&!mC(n,t)&&(r[n]=e[n])}function U6({transformTemplate:r},e){return V.useMemo(()=>{const t=v0();return g0(t,e,r),Object.assign({},t.vars,t.style)},[e])}function z6(r,e){const t=r.style||{},n={};return yC(n,t,r),Object.assign(n,U6(r,e)),n}function $6(r,e){const t={},n=z6(r,e);return r.drag&&r.dragListener!==!1&&(t.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=r.drag===!0?"none":`pan-${r.drag==="x"?"y":"x"}`),r.tabIndex===void 0&&(r.onTap||r.onTapStart||r.whileTap)&&(t.tabIndex=0),t.style=n,t}function H6(r,e,t,n){const s=V.useMemo(()=>{const i=hC();return y0(i,e,_0(n),r.transformTemplate),{...i.attrs,style:{...i.style}}},[e]);if(r.style){const i={};yC(i,r.style,r),s.style={...i,...s.style}}return s}function W6(r=!1){return(t,n,s,{latestValues:i},o)=>{const u=(d0(t)?H6:$6)(n,i,o,t),h=o6(n,typeof t=="string",r),f=t!==V.Fragment?{...h,...u,ref:s}:{},{children:m}=n,y=V.useMemo(()=>Rn(m)?m.get():m,[m]);return V.createElement(t,{...f,children:y})}}function G6(r,e){return function(n,{forwardMotionProps:s}={forwardMotionProps:!1}){const o={...d0(n)?j6:B6,preloadedFeatures:r,useRender:W6(s),createVisualElement:e,Component:n};return m6(o)}}function vC(r,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==r.length)return!1;for(let n=0;n<t;n++)if(e[n]!==r[n])return!1;return!0}function Cp(r,e,t){const n=r.getProps();return f0(n,e,t!==void 0?t:n.custom,r)}const q6=o0(()=>window.ScrollTimeline!==void 0);class K6{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,t){for(let n=0;n<this.animations.length;n++)this.animations[n][e]=t}attachTimeline(e,t){const n=this.animations.map(s=>{if(q6()&&s.attachTimeline)return s.attachTimeline(e);if(typeof t=="function")return t(s)});return()=>{n.forEach((s,i)=>{s&&s(),this.animations[i].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let t=0;t<this.animations.length;t++)e=Math.max(e,this.animations[t].duration);return e}runAll(e){this.animations.forEach(t=>t[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class X6 extends K6{then(e,t){return Promise.all(this.animations).then(e).catch(t)}}function E0(r,e){return r?r[e]||r.default||r:void 0}const Ry=2e4;function _C(r){let e=0;const t=50;let n=r.next(e);for(;!n.done&&e<Ry;)e+=t,n=r.next(e);return e>=Ry?1/0:e}function A0(r){return typeof r=="function"}function mA(r,e){r.timeline=e,r.onfinish=null}const b0=r=>Array.isArray(r)&&typeof r[0]=="number",Y6={linearEasing:void 0};function Q6(r,e){const t=o0(r);return()=>{var n;return(n=Y6[e])!==null&&n!==void 0?n:t()}}const Hf=Q6(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),wC=(r,e,t=10)=>{let n="";const s=Math.max(Math.round(e/t),2);for(let i=0;i<s;i++)n+=r(Gl(0,s-1,i))+", ";return`linear(${n.substring(0,n.length-2)})`};function EC(r){return!!(typeof r=="function"&&Hf()||!r||typeof r=="string"&&(r in Dy||Hf())||b0(r)||Array.isArray(r)&&r.every(EC))}const hu=([r,e,t,n])=>`cubic-bezier(${r}, ${e}, ${t}, ${n})`,Dy={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:hu([0,.65,.55,1]),circOut:hu([.55,0,1,.45]),backIn:hu([.31,.01,.66,-.59]),backOut:hu([.33,1.53,.69,.99])};function AC(r,e){if(r)return typeof r=="function"&&Hf()?wC(r,e):b0(r)?hu(r):Array.isArray(r)?r.map(t=>AC(t,e)||Dy.easeOut):Dy[r]}const Kr={x:!1,y:!1};function bC(){return Kr.x||Kr.y}function TC(r,e,t){var n;if(r instanceof Element)return[r];if(typeof r=="string"){let s=document;const i=(n=void 0)!==null&&n!==void 0?n:s.querySelectorAll(r);return i?Array.from(i):[]}return Array.from(r)}function SC(r,e){const t=TC(r),n=new AbortController,s={passive:!0,...e,signal:n.signal};return[t,s,()=>n.abort()]}function gA(r){return e=>{e.pointerType==="touch"||bC()||r(e)}}function J6(r,e,t={}){const[n,s,i]=SC(r,t),o=gA(c=>{const{target:u}=c,h=e(c);if(typeof h!="function"||!u)return;const f=gA(m=>{h(m),u.removeEventListener("pointerleave",f)});u.addEventListener("pointerleave",f,s)});return n.forEach(c=>{c.addEventListener("pointerenter",o,s)}),i}const xC=(r,e)=>e?r===e?!0:xC(r,e.parentElement):!1,T0=r=>r.pointerType==="mouse"?typeof r.button!="number"||r.button<=0:r.isPrimary!==!1,Z6=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function eF(r){return Z6.has(r.tagName)||r.tabIndex!==-1}const du=new WeakSet;function yA(r){return e=>{e.key==="Enter"&&r(e)}}function Ng(r,e){r.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const tF=(r,e)=>{const t=r.currentTarget;if(!t)return;const n=yA(()=>{if(du.has(t))return;Ng(t,"down");const s=yA(()=>{Ng(t,"up")}),i=()=>Ng(t,"cancel");t.addEventListener("keyup",s,e),t.addEventListener("blur",i,e)});t.addEventListener("keydown",n,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",n),e)};function vA(r){return T0(r)&&!bC()}function nF(r,e,t={}){const[n,s,i]=SC(r,t),o=c=>{const u=c.currentTarget;if(!vA(c)||du.has(u))return;du.add(u);const h=e(c),f=(_,A)=>{window.removeEventListener("pointerup",m),window.removeEventListener("pointercancel",y),!(!vA(_)||!du.has(u))&&(du.delete(u),typeof h=="function"&&h(_,{success:A}))},m=_=>{f(_,t.useGlobalTarget||xC(u,_.target))},y=_=>{f(_,!1)};window.addEventListener("pointerup",m,s),window.addEventListener("pointercancel",y,s)};return n.forEach(c=>{!eF(c)&&c.getAttribute("tabindex")===null&&(c.tabIndex=0),(t.useGlobalTarget?window:c).addEventListener("pointerdown",o,s),c.addEventListener("focus",h=>tF(h,s),s)}),i}function rF(r){return r==="x"||r==="y"?Kr[r]?null:(Kr[r]=!0,()=>{Kr[r]=!1}):Kr.x||Kr.y?null:(Kr.x=Kr.y=!0,()=>{Kr.x=Kr.y=!1})}const CC=new Set(["width","height","top","left","right","bottom",...oc]);let yf;function sF(){yf=void 0}const Ms={now:()=>(yf===void 0&&Ms.set(fn.isProcessing||e6.useManualTiming?fn.timestamp:performance.now()),yf),set:r=>{yf=r,queueMicrotask(sF)}};function S0(r,e){r.indexOf(e)===-1&&r.push(e)}function x0(r,e){const t=r.indexOf(e);t>-1&&r.splice(t,1)}class C0{constructor(){this.subscriptions=[]}add(e){return S0(this.subscriptions,e),()=>x0(this.subscriptions,e)}notify(e,t,n){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](e,t,n);else for(let i=0;i<s;i++){const o=this.subscriptions[i];o&&o(e,t,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function IC(r,e){return e?r*(1e3/e):0}const _A=30,iF=r=>!isNaN(parseFloat(r));class oF{constructor(e,t={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(n,s=!0)=>{const i=Ms.now();this.updatedAt!==i&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(n),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),s&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=Ms.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=iF(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new C0);const n=this.events[e].add(t);return e==="change"?()=>{n(),gt.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e,t=!0){!t||!this.passiveEffect?this.updateAndNotify(e,t):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,t,n){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-n}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=Ms.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>_A)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,_A);return IC(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function $u(r,e){return new oF(r,e)}function aF(r,e,t){r.hasValue(e)?r.getValue(e).set(t):r.addValue(e,$u(t))}function lF(r,e){const t=Cp(r,e);let{transitionEnd:n={},transition:s={},...i}=t||{};i={...i,...n};for(const o in i){const c=E6(i[o]);aF(r,o,c)}}function cF(r){return!!(Rn(r)&&r.add)}function Ly(r,e){const t=r.getValue("willChange");if(cF(t))return t.add(e)}function kC(r){return r.props[sC]}const PC=(r,e,t)=>(((1-3*t+3*e)*r+(3*t-6*e))*r+3*e)*r,uF=1e-7,hF=12;function dF(r,e,t,n,s){let i,o,c=0;do o=e+(t-e)/2,i=PC(o,n,s)-r,i>0?t=o:e=o;while(Math.abs(i)>uF&&++c<hF);return o}function hh(r,e,t,n){if(r===e&&t===n)return ur;const s=i=>dF(i,0,1,r,t);return i=>i===0||i===1?i:PC(s(i),e,n)}const RC=r=>e=>e<=.5?r(2*e)/2:(2-r(2*(1-e)))/2,DC=r=>e=>1-r(1-e),LC=hh(.33,1.53,.69,.99),I0=DC(LC),MC=RC(I0),NC=r=>(r*=2)<1?.5*I0(r):.5*(2-Math.pow(2,-10*(r-1))),k0=r=>1-Math.sin(Math.acos(r)),OC=DC(k0),FC=RC(k0),VC=r=>/^0[^.\s]+$/u.test(r);function fF(r){return typeof r=="number"?r===0:r!==null?r==="none"||r==="0"||VC(r):!0}const bu=r=>Math.round(r*1e5)/1e5,P0=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function pF(r){return r==null}const mF=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,R0=(r,e)=>t=>!!(typeof t=="string"&&mF.test(t)&&t.startsWith(r)||e&&!pF(t)&&Object.prototype.hasOwnProperty.call(t,e)),jC=(r,e,t)=>n=>{if(typeof n!="string")return n;const[s,i,o,c]=n.match(P0);return{[r]:parseFloat(s),[e]:parseFloat(i),[t]:parseFloat(o),alpha:c!==void 0?parseFloat(c):1}},gF=r=>gi(0,255,r),Og={...ac,transform:r=>Math.round(gF(r))},ra={test:R0("rgb","red"),parse:jC("red","green","blue"),transform:({red:r,green:e,blue:t,alpha:n=1})=>"rgba("+Og.transform(r)+", "+Og.transform(e)+", "+Og.transform(t)+", "+bu(zu.transform(n))+")"};function yF(r){let e="",t="",n="",s="";return r.length>5?(e=r.substring(1,3),t=r.substring(3,5),n=r.substring(5,7),s=r.substring(7,9)):(e=r.substring(1,2),t=r.substring(2,3),n=r.substring(3,4),s=r.substring(4,5),e+=e,t+=t,n+=n,s+=s),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(n,16),alpha:s?parseInt(s,16)/255:1}}const My={test:R0("#"),parse:yF,transform:ra.transform},Tl={test:R0("hsl","hue"),parse:jC("hue","saturation","lightness"),transform:({hue:r,saturation:e,lightness:t,alpha:n=1})=>"hsla("+Math.round(r)+", "+Ls.transform(bu(e))+", "+Ls.transform(bu(t))+", "+bu(zu.transform(n))+")"},xn={test:r=>ra.test(r)||My.test(r)||Tl.test(r),parse:r=>ra.test(r)?ra.parse(r):Tl.test(r)?Tl.parse(r):My.parse(r),transform:r=>typeof r=="string"?r:r.hasOwnProperty("red")?ra.transform(r):Tl.transform(r)},vF=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function _F(r){var e,t;return isNaN(r)&&typeof r=="string"&&(((e=r.match(P0))===null||e===void 0?void 0:e.length)||0)+(((t=r.match(vF))===null||t===void 0?void 0:t.length)||0)>0}const BC="number",UC="color",wF="var",EF="var(",wA="${}",AF=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Hu(r){const e=r.toString(),t=[],n={color:[],number:[],var:[]},s=[];let i=0;const c=e.replace(AF,u=>(xn.test(u)?(n.color.push(i),s.push(UC),t.push(xn.parse(u))):u.startsWith(EF)?(n.var.push(i),s.push(wF),t.push(u)):(n.number.push(i),s.push(BC),t.push(parseFloat(u))),++i,wA)).split(wA);return{values:t,split:c,indexes:n,types:s}}function zC(r){return Hu(r).values}function $C(r){const{split:e,types:t}=Hu(r),n=e.length;return s=>{let i="";for(let o=0;o<n;o++)if(i+=e[o],s[o]!==void 0){const c=t[o];c===BC?i+=bu(s[o]):c===UC?i+=xn.transform(s[o]):i+=s[o]}return i}}const bF=r=>typeof r=="number"?0:r;function TF(r){const e=zC(r);return $C(r)(e.map(bF))}const mo={test:_F,parse:zC,createTransformer:$C,getAnimatableNone:TF},SF=new Set(["brightness","contrast","saturate","opacity"]);function xF(r){const[e,t]=r.slice(0,-1).split("(");if(e==="drop-shadow")return r;const[n]=t.match(P0)||[];if(!n)return r;const s=t.replace(n,"");let i=SF.has(e)?1:0;return n!==t&&(i*=100),e+"("+i+s+")"}const CF=/\b([a-z-]*)\(.*?\)/gu,Ny={...mo,getAnimatableNone:r=>{const e=r.match(CF);return e?e.map(xF).join(" "):r}},IF={...m0,color:xn,backgroundColor:xn,outlineColor:xn,fill:xn,stroke:xn,borderColor:xn,borderTopColor:xn,borderRightColor:xn,borderBottomColor:xn,borderLeftColor:xn,filter:Ny,WebkitFilter:Ny},D0=r=>IF[r];function HC(r,e){let t=D0(r);return t!==Ny&&(t=mo),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const kF=new Set(["auto","none","0"]);function PF(r,e,t){let n=0,s;for(;n<r.length&&!s;){const i=r[n];typeof i=="string"&&!kF.has(i)&&Hu(i).values.length&&(s=r[n]),n++}if(s&&t)for(const i of e)r[i]=HC(t,s)}const EA=r=>r===ac||r===De,AA=(r,e)=>parseFloat(r.split(", ")[e]),bA=(r,e)=>(t,{transform:n})=>{if(n==="none"||!n)return 0;const s=n.match(/^matrix3d\((.+)\)$/u);if(s)return AA(s[1],e);{const i=n.match(/^matrix\((.+)\)$/u);return i?AA(i[1],r):0}},RF=new Set(["x","y","z"]),DF=oc.filter(r=>!RF.has(r));function LF(r){const e=[];return DF.forEach(t=>{const n=r.getValue(t);n!==void 0&&(e.push([t,n.get()]),n.set(t.startsWith("scale")?1:0))}),e}const Kl={width:({x:r},{paddingLeft:e="0",paddingRight:t="0"})=>r.max-r.min-parseFloat(e)-parseFloat(t),height:({y:r},{paddingTop:e="0",paddingBottom:t="0"})=>r.max-r.min-parseFloat(e)-parseFloat(t),top:(r,{top:e})=>parseFloat(e),left:(r,{left:e})=>parseFloat(e),bottom:({y:r},{top:e})=>parseFloat(e)+(r.max-r.min),right:({x:r},{left:e})=>parseFloat(e)+(r.max-r.min),x:bA(4,13),y:bA(5,14)};Kl.translateX=Kl.x;Kl.translateY=Kl.y;const ca=new Set;let Oy=!1,Fy=!1;function WC(){if(Fy){const r=Array.from(ca).filter(n=>n.needsMeasurement),e=new Set(r.map(n=>n.element)),t=new Map;e.forEach(n=>{const s=LF(n);s.length&&(t.set(n,s),n.render())}),r.forEach(n=>n.measureInitialState()),e.forEach(n=>{n.render();const s=t.get(n);s&&s.forEach(([i,o])=>{var c;(c=n.getValue(i))===null||c===void 0||c.set(o)})}),r.forEach(n=>n.measureEndState()),r.forEach(n=>{n.suspendedScrollY!==void 0&&window.scrollTo(0,n.suspendedScrollY)})}Fy=!1,Oy=!1,ca.forEach(r=>r.complete()),ca.clear()}function GC(){ca.forEach(r=>{r.readKeyframes(),r.needsMeasurement&&(Fy=!0)})}function MF(){GC(),WC()}class L0{constructor(e,t,n,s,i,o=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=n,this.motionValue=s,this.element=i,this.isAsync=o}scheduleResolve(){this.isScheduled=!0,this.isAsync?(ca.add(this),Oy||(Oy=!0,gt.read(GC),gt.resolveKeyframes(WC))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:n,motionValue:s}=this;for(let i=0;i<e.length;i++)if(e[i]===null)if(i===0){const o=s?.get(),c=e[e.length-1];if(o!==void 0)e[0]=o;else if(n&&t){const u=n.readValue(t,c);u!=null&&(e[0]=u)}e[0]===void 0&&(e[0]=c),s&&o===void 0&&s.set(e[0])}else e[i]=e[i-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),ca.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,ca.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const qC=r=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(r),NF=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function OF(r){const e=NF.exec(r);if(!e)return[,];const[,t,n,s]=e;return[`--${t??n}`,s]}function KC(r,e,t=1){const[n,s]=OF(r);if(!n)return;const i=window.getComputedStyle(e).getPropertyValue(n);if(i){const o=i.trim();return qC(o)?parseFloat(o):o}return p0(s)?KC(s,e,t+1):s}const XC=r=>e=>e.test(r),FF={test:r=>r==="auto",parse:r=>r},YC=[ac,De,Ls,Gi,C6,x6,FF],TA=r=>YC.find(XC(r));class QC extends L0{constructor(e,t,n,s,i){super(e,t,n,s,i,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:n}=this;if(!t||!t.current)return;super.readKeyframes();for(let u=0;u<e.length;u++){let h=e[u];if(typeof h=="string"&&(h=h.trim(),p0(h))){const f=KC(h,t.current);f!==void 0&&(e[u]=f),u===e.length-1&&(this.finalKeyframe=h)}}if(this.resolveNoneKeyframes(),!CC.has(n)||e.length!==2)return;const[s,i]=e,o=TA(s),c=TA(i);if(o!==c)if(EA(o)&&EA(c))for(let u=0;u<e.length;u++){const h=e[u];typeof h=="string"&&(e[u]=parseFloat(h))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,n=[];for(let s=0;s<e.length;s++)fF(e[s])&&n.push(s);n.length&&PF(e,n,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:n}=this;if(!e||!e.current)return;n==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Kl[n](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const s=t[t.length-1];s!==void 0&&e.getValue(n,s).jump(s,!1)}measureEndState(){var e;const{element:t,name:n,unresolvedKeyframes:s}=this;if(!t||!t.current)return;const i=t.getValue(n);i&&i.jump(this.measuredOrigin,!1);const o=s.length-1,c=s[o];s[o]=Kl[n](t.measureViewportBox(),window.getComputedStyle(t.current)),c!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=c),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([u,h])=>{t.getValue(u).set(h)}),this.resolveNoneKeyframes()}}const SA=(r,e)=>e==="zIndex"?!1:!!(typeof r=="number"||Array.isArray(r)||typeof r=="string"&&(mo.test(r)||r==="0")&&!r.startsWith("url("));function VF(r){const e=r[0];if(r.length===1)return!0;for(let t=0;t<r.length;t++)if(r[t]!==e)return!0}function jF(r,e,t,n){const s=r[0];if(s===null)return!1;if(e==="display"||e==="visibility")return!0;const i=r[r.length-1],o=SA(s,e),c=SA(i,e);return!o||!c?!1:VF(r)||(t==="spring"||A0(t))&&n}const BF=r=>r!==null;function Ip(r,{repeat:e,repeatType:t="loop"},n){const s=r.filter(BF),i=e&&t!=="loop"&&e%2===1?0:s.length-1;return!i||n===void 0?s[i]:n}const UF=40;class JC{constructor({autoplay:e=!0,delay:t=0,type:n="keyframes",repeat:s=0,repeatDelay:i=0,repeatType:o="loop",...c}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=Ms.now(),this.options={autoplay:e,delay:t,type:n,repeat:s,repeatDelay:i,repeatType:o,...c},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>UF?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&MF(),this._resolved}onKeyframesResolved(e,t){this.resolvedAt=Ms.now(),this.hasAttemptedResolve=!0;const{name:n,type:s,velocity:i,delay:o,onComplete:c,onUpdate:u,isGenerator:h}=this.options;if(!h&&!jF(e,n,s,i))if(o)this.options.duration=0;else{u&&u(Ip(e,this.options,t)),c&&c(),this.resolveFinishedPromise();return}const f=this.initPlayback(e,t);f!==!1&&(this._resolved={keyframes:e,finalKeyframe:t,...f},this.onPostResolved())}onPostResolved(){}then(e,t){return this.currentFinishedPromise.then(e,t)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const xt=(r,e,t)=>r+(e-r)*t;function Fg(r,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?r+(e-r)*6*t:t<1/2?e:t<2/3?r+(e-r)*(2/3-t)*6:r}function zF({hue:r,saturation:e,lightness:t,alpha:n}){r/=360,e/=100,t/=100;let s=0,i=0,o=0;if(!e)s=i=o=t;else{const c=t<.5?t*(1+e):t+e-t*e,u=2*t-c;s=Fg(u,c,r+1/3),i=Fg(u,c,r),o=Fg(u,c,r-1/3)}return{red:Math.round(s*255),green:Math.round(i*255),blue:Math.round(o*255),alpha:n}}function Wf(r,e){return t=>t>0?e:r}const Vg=(r,e,t)=>{const n=r*r,s=t*(e*e-n)+n;return s<0?0:Math.sqrt(s)},$F=[My,ra,Tl],HF=r=>$F.find(e=>e.test(r));function xA(r){const e=HF(r);if(!e)return!1;let t=e.parse(r);return e===Tl&&(t=zF(t)),t}const CA=(r,e)=>{const t=xA(r),n=xA(e);if(!t||!n)return Wf(r,e);const s={...t};return i=>(s.red=Vg(t.red,n.red,i),s.green=Vg(t.green,n.green,i),s.blue=Vg(t.blue,n.blue,i),s.alpha=xt(t.alpha,n.alpha,i),ra.transform(s))},WF=(r,e)=>t=>e(r(t)),dh=(...r)=>r.reduce(WF),Vy=new Set(["none","hidden"]);function GF(r,e){return Vy.has(r)?t=>t<=0?r:e:t=>t>=1?e:r}function qF(r,e){return t=>xt(r,e,t)}function M0(r){return typeof r=="number"?qF:typeof r=="string"?p0(r)?Wf:xn.test(r)?CA:YF:Array.isArray(r)?ZC:typeof r=="object"?xn.test(r)?CA:KF:Wf}function ZC(r,e){const t=[...r],n=t.length,s=r.map((i,o)=>M0(i)(i,e[o]));return i=>{for(let o=0;o<n;o++)t[o]=s[o](i);return t}}function KF(r,e){const t={...r,...e},n={};for(const s in t)r[s]!==void 0&&e[s]!==void 0&&(n[s]=M0(r[s])(r[s],e[s]));return s=>{for(const i in n)t[i]=n[i](s);return t}}function XF(r,e){var t;const n=[],s={color:0,var:0,number:0};for(let i=0;i<e.values.length;i++){const o=e.types[i],c=r.indexes[o][s[o]],u=(t=r.values[c])!==null&&t!==void 0?t:0;n[i]=u,s[o]++}return n}const YF=(r,e)=>{const t=mo.createTransformer(e),n=Hu(r),s=Hu(e);return n.indexes.var.length===s.indexes.var.length&&n.indexes.color.length===s.indexes.color.length&&n.indexes.number.length>=s.indexes.number.length?Vy.has(r)&&!s.values.length||Vy.has(e)&&!n.values.length?GF(r,e):dh(ZC(XF(n,s),s.values),t):Wf(r,e)};function eI(r,e,t){return typeof r=="number"&&typeof e=="number"&&typeof t=="number"?xt(r,e,t):M0(r)(r,e)}const QF=5;function tI(r,e,t){const n=Math.max(e-QF,0);return IC(t-r(n),e-n)}const Pt={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},jg=.001;function JF({duration:r=Pt.duration,bounce:e=Pt.bounce,velocity:t=Pt.velocity,mass:n=Pt.mass}){let s,i,o=1-e;o=gi(Pt.minDamping,Pt.maxDamping,o),r=gi(Pt.minDuration,Pt.maxDuration,ci(r)),o<1?(s=h=>{const f=h*o,m=f*r,y=f-t,_=jy(h,o),A=Math.exp(-m);return jg-y/_*A},i=h=>{const m=h*o*r,y=m*t+t,_=Math.pow(o,2)*Math.pow(h,2)*r,A=Math.exp(-m),b=jy(Math.pow(h,2),o);return(-s(h)+jg>0?-1:1)*((y-_)*A)/b}):(s=h=>{const f=Math.exp(-h*r),m=(h-t)*r+1;return-jg+f*m},i=h=>{const f=Math.exp(-h*r),m=(t-h)*(r*r);return f*m});const c=5/r,u=eV(s,i,c);if(r=li(r),isNaN(u))return{stiffness:Pt.stiffness,damping:Pt.damping,duration:r};{const h=Math.pow(u,2)*n;return{stiffness:h,damping:o*2*Math.sqrt(n*h),duration:r}}}const ZF=12;function eV(r,e,t){let n=t;for(let s=1;s<ZF;s++)n=n-r(n)/e(n);return n}function jy(r,e){return r*Math.sqrt(1-e*e)}const tV=["duration","bounce"],nV=["stiffness","damping","mass"];function IA(r,e){return e.some(t=>r[t]!==void 0)}function rV(r){let e={velocity:Pt.velocity,stiffness:Pt.stiffness,damping:Pt.damping,mass:Pt.mass,isResolvedFromDuration:!1,...r};if(!IA(r,nV)&&IA(r,tV))if(r.visualDuration){const t=r.visualDuration,n=2*Math.PI/(t*1.2),s=n*n,i=2*gi(.05,1,1-(r.bounce||0))*Math.sqrt(s);e={...e,mass:Pt.mass,stiffness:s,damping:i}}else{const t=JF(r);e={...e,...t,mass:Pt.mass},e.isResolvedFromDuration=!0}return e}function nI(r=Pt.visualDuration,e=Pt.bounce){const t=typeof r!="object"?{visualDuration:r,keyframes:[0,1],bounce:e}:r;let{restSpeed:n,restDelta:s}=t;const i=t.keyframes[0],o=t.keyframes[t.keyframes.length-1],c={done:!1,value:i},{stiffness:u,damping:h,mass:f,duration:m,velocity:y,isResolvedFromDuration:_}=rV({...t,velocity:-ci(t.velocity||0)}),A=y||0,b=h/(2*Math.sqrt(u*f)),T=o-i,x=ci(Math.sqrt(u/f)),M=Math.abs(T)<5;n||(n=M?Pt.restSpeed.granular:Pt.restSpeed.default),s||(s=M?Pt.restDelta.granular:Pt.restDelta.default);let R;if(b<1){const O=jy(x,b);R=$=>{const k=Math.exp(-b*x*$);return o-k*((A+b*x*T)/O*Math.sin(O*$)+T*Math.cos(O*$))}}else if(b===1)R=O=>o-Math.exp(-x*O)*(T+(A+x*T)*O);else{const O=x*Math.sqrt(b*b-1);R=$=>{const k=Math.exp(-b*x*$),C=Math.min(O*$,300);return o-k*((A+b*x*T)*Math.sinh(C)+O*T*Math.cosh(C))/O}}const B={calculatedDuration:_&&m||null,next:O=>{const $=R(O);if(_)c.done=O>=m;else{let k=0;b<1&&(k=O===0?li(A):tI(R,O,$));const C=Math.abs(k)<=n,P=Math.abs(o-$)<=s;c.done=C&&P}return c.value=c.done?o:$,c},toString:()=>{const O=Math.min(_C(B),Ry),$=wC(k=>B.next(O*k).value,O,30);return O+"ms "+$}};return B}function kA({keyframes:r,velocity:e=0,power:t=.8,timeConstant:n=325,bounceDamping:s=10,bounceStiffness:i=500,modifyTarget:o,min:c,max:u,restDelta:h=.5,restSpeed:f}){const m=r[0],y={done:!1,value:m},_=C=>c!==void 0&&C<c||u!==void 0&&C>u,A=C=>c===void 0?u:u===void 0||Math.abs(c-C)<Math.abs(u-C)?c:u;let b=t*e;const T=m+b,x=o===void 0?T:o(T);x!==T&&(b=x-m);const M=C=>-b*Math.exp(-C/n),R=C=>x+M(C),B=C=>{const P=M(C),N=R(C);y.done=Math.abs(P)<=h,y.value=y.done?x:N};let O,$;const k=C=>{_(y.value)&&(O=C,$=nI({keyframes:[y.value,A(y.value)],velocity:tI(R,C,y.value),damping:s,stiffness:i,restDelta:h,restSpeed:f}))};return k(0),{calculatedDuration:null,next:C=>{let P=!1;return!$&&O===void 0&&(P=!0,B(C),k(C)),O!==void 0&&C>=O?$.next(C-O):(!P&&B(C),y)}}}const sV=hh(.42,0,1,1),iV=hh(0,0,.58,1),rI=hh(.42,0,.58,1),oV=r=>Array.isArray(r)&&typeof r[0]!="number",aV={linear:ur,easeIn:sV,easeInOut:rI,easeOut:iV,circIn:k0,circInOut:FC,circOut:OC,backIn:I0,backInOut:MC,backOut:LC,anticipate:NC},PA=r=>{if(b0(r)){eC(r.length===4);const[e,t,n,s]=r;return hh(e,t,n,s)}else if(typeof r=="string")return aV[r];return r};function lV(r,e,t){const n=[],s=t||eI,i=r.length-1;for(let o=0;o<i;o++){let c=s(r[o],r[o+1]);if(e){const u=Array.isArray(e)?e[o]||ur:e;c=dh(u,c)}n.push(c)}return n}function cV(r,e,{clamp:t=!0,ease:n,mixer:s}={}){const i=r.length;if(eC(i===e.length),i===1)return()=>e[0];if(i===2&&e[0]===e[1])return()=>e[1];const o=r[0]===r[1];r[0]>r[i-1]&&(r=[...r].reverse(),e=[...e].reverse());const c=lV(e,n,s),u=c.length,h=f=>{if(o&&f<r[0])return e[0];let m=0;if(u>1)for(;m<r.length-2&&!(f<r[m+1]);m++);const y=Gl(r[m],r[m+1],f);return c[m](y)};return t?f=>h(gi(r[0],r[i-1],f)):h}function uV(r,e){const t=r[r.length-1];for(let n=1;n<=e;n++){const s=Gl(0,e,n);r.push(xt(t,1,s))}}function hV(r){const e=[0];return uV(e,r.length-1),e}function dV(r,e){return r.map(t=>t*e)}function fV(r,e){return r.map(()=>e||rI).splice(0,r.length-1)}function Gf({duration:r=300,keyframes:e,times:t,ease:n="easeInOut"}){const s=oV(n)?n.map(PA):PA(n),i={done:!1,value:e[0]},o=dV(t&&t.length===e.length?t:hV(e),r),c=cV(o,e,{ease:Array.isArray(s)?s:fV(e,s)});return{calculatedDuration:r,next:u=>(i.value=c(u),i.done=u>=r,i)}}const pV=r=>{const e=({timestamp:t})=>r(t);return{start:()=>gt.update(e,!0),stop:()=>po(e),now:()=>fn.isProcessing?fn.timestamp:Ms.now()}},mV={decay:kA,inertia:kA,tween:Gf,keyframes:Gf,spring:nI},gV=r=>r/100;class N0 extends JC{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:u}=this.options;u&&u()};const{name:t,motionValue:n,element:s,keyframes:i}=this.options,o=s?.KeyframeResolver||L0,c=(u,h)=>this.onKeyframesResolved(u,h);this.resolver=new o(i,c,t,n,s),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:t="keyframes",repeat:n=0,repeatDelay:s=0,repeatType:i,velocity:o=0}=this.options,c=A0(t)?t:mV[t]||Gf;let u,h;c!==Gf&&typeof e[0]!="number"&&(u=dh(gV,eI(e[0],e[1])),e=[0,100]);const f=c({...this.options,keyframes:e});i==="mirror"&&(h=c({...this.options,keyframes:[...e].reverse(),velocity:-o})),f.calculatedDuration===null&&(f.calculatedDuration=_C(f));const{calculatedDuration:m}=f,y=m+s,_=y*(n+1)-s;return{generator:f,mirroredGenerator:h,mapPercentToKeyframes:u,calculatedDuration:m,resolvedDuration:y,totalDuration:_}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,t=!1){const{resolved:n}=this;if(!n){const{keyframes:C}=this.options;return{done:!0,value:C[C.length-1]}}const{finalKeyframe:s,generator:i,mirroredGenerator:o,mapPercentToKeyframes:c,keyframes:u,calculatedDuration:h,totalDuration:f,resolvedDuration:m}=n;if(this.startTime===null)return i.next(0);const{delay:y,repeat:_,repeatType:A,repeatDelay:b,onUpdate:T}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-f/this.speed,this.startTime)),t?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const x=this.currentTime-y*(this.speed>=0?1:-1),M=this.speed>=0?x<0:x>f;this.currentTime=Math.max(x,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=f);let R=this.currentTime,B=i;if(_){const C=Math.min(this.currentTime,f)/m;let P=Math.floor(C),N=C%1;!N&&C>=1&&(N=1),N===1&&P--,P=Math.min(P,_+1),!!(P%2)&&(A==="reverse"?(N=1-N,b&&(N-=b/m)):A==="mirror"&&(B=o)),R=gi(0,1,N)*m}const O=M?{done:!1,value:u[0]}:B.next(R);c&&(O.value=c(O.value));let{done:$}=O;!M&&h!==null&&($=this.speed>=0?this.currentTime>=f:this.currentTime<=0);const k=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&$);return k&&s!==void 0&&(O.value=Ip(u,this.options,s)),T&&T(O.value),k&&this.finish(),O}get duration(){const{resolved:e}=this;return e?ci(e.calculatedDuration):0}get time(){return ci(this.currentTime)}set time(e){e=li(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=ci(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=pV,onPlay:t,startTime:n}=this.options;this.driver||(this.driver=e(i=>this.tick(i))),t&&t();const s=this.driver.now();this.holdTime!==null?this.startTime=s-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=s):this.startTime=n??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const yV=new Set(["opacity","clipPath","filter","transform"]);function vV(r,e,t,{delay:n=0,duration:s=300,repeat:i=0,repeatType:o="loop",ease:c="easeInOut",times:u}={}){const h={[e]:t};u&&(h.offset=u);const f=AC(c,s);return Array.isArray(f)&&(h.easing=f),r.animate(h,{delay:n,duration:s,easing:Array.isArray(f)?"linear":f,fill:"both",iterations:i+1,direction:o==="reverse"?"alternate":"normal"})}const _V=o0(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),qf=10,wV=2e4;function EV(r){return A0(r.type)||r.type==="spring"||!EC(r.ease)}function AV(r,e){const t=new N0({...e,keyframes:r,repeat:0,delay:0,isGenerator:!0});let n={done:!1,value:r[0]};const s=[];let i=0;for(;!n.done&&i<wV;)n=t.sample(i),s.push(n.value),i+=qf;return{times:void 0,keyframes:s,duration:i-qf,ease:"linear"}}const sI={anticipate:NC,backInOut:MC,circInOut:FC};function bV(r){return r in sI}class RA extends JC{constructor(e){super(e);const{name:t,motionValue:n,element:s,keyframes:i}=this.options;this.resolver=new QC(i,(o,c)=>this.onKeyframesResolved(o,c),t,n,s),this.resolver.scheduleResolve()}initPlayback(e,t){let{duration:n=300,times:s,ease:i,type:o,motionValue:c,name:u,startTime:h}=this.options;if(!c.owner||!c.owner.current)return!1;if(typeof i=="string"&&Hf()&&bV(i)&&(i=sI[i]),EV(this.options)){const{onComplete:m,onUpdate:y,motionValue:_,element:A,...b}=this.options,T=AV(e,b);e=T.keyframes,e.length===1&&(e[1]=e[0]),n=T.duration,s=T.times,i=T.ease,o="keyframes"}const f=vV(c.owner.current,u,e,{...this.options,duration:n,times:s,ease:i});return f.startTime=h??this.calcStartTime(),this.pendingTimeline?(mA(f,this.pendingTimeline),this.pendingTimeline=void 0):f.onfinish=()=>{const{onComplete:m}=this.options;c.set(Ip(e,this.options,t)),m&&m(),this.cancel(),this.resolveFinishedPromise()},{animation:f,duration:n,times:s,type:o,ease:i,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:t}=e;return ci(t)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:t}=e;return ci(t.currentTime||0)}set time(e){const{resolved:t}=this;if(!t)return;const{animation:n}=t;n.currentTime=li(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:t}=e;return t.playbackRate}set speed(e){const{resolved:t}=this;if(!t)return;const{animation:n}=t;n.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:t}=e;return t.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:t}=e;return t.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:t}=this;if(!t)return ur;const{animation:n}=t;mA(n,e)}return ur}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.playState==="finished"&&this.updateFinishedPromise(),t.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:t,keyframes:n,duration:s,type:i,ease:o,times:c}=e;if(t.playState==="idle"||t.playState==="finished")return;if(this.time){const{motionValue:h,onUpdate:f,onComplete:m,element:y,..._}=this.options,A=new N0({..._,keyframes:n,duration:s,type:i,ease:o,times:c,isGenerator:!0}),b=li(this.time);h.setWithVelocity(A.sample(b-qf).value,A.sample(b).value,qf)}const{onStop:u}=this.options;u&&u(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:t,name:n,repeatDelay:s,repeatType:i,damping:o,type:c}=e;if(!t||!t.owner||!(t.owner.current instanceof HTMLElement))return!1;const{onUpdate:u,transformTemplate:h}=t.owner.getProps();return _V()&&n&&yV.has(n)&&!u&&!h&&!s&&i!=="mirror"&&o!==0&&c!=="inertia"}}const TV={type:"spring",stiffness:500,damping:25,restSpeed:10},SV=r=>({type:"spring",stiffness:550,damping:r===0?2*Math.sqrt(550):30,restSpeed:10}),xV={type:"keyframes",duration:.8},CV={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},IV=(r,{keyframes:e})=>e.length>2?xV:xa.has(r)?r.startsWith("scale")?SV(e[1]):TV:CV;function kV({when:r,delay:e,delayChildren:t,staggerChildren:n,staggerDirection:s,repeat:i,repeatType:o,repeatDelay:c,from:u,elapsed:h,...f}){return!!Object.keys(f).length}const O0=(r,e,t,n={},s,i)=>o=>{const c=E0(n,r)||{},u=c.delay||n.delay||0;let{elapsed:h=0}=n;h=h-li(u);let f={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...c,delay:-h,onUpdate:y=>{e.set(y),c.onUpdate&&c.onUpdate(y)},onComplete:()=>{o(),c.onComplete&&c.onComplete()},name:r,motionValue:e,element:i?void 0:s};kV(c)||(f={...f,...IV(r,f)}),f.duration&&(f.duration=li(f.duration)),f.repeatDelay&&(f.repeatDelay=li(f.repeatDelay)),f.from!==void 0&&(f.keyframes[0]=f.from);let m=!1;if((f.type===!1||f.duration===0&&!f.repeatDelay)&&(f.duration=0,f.delay===0&&(m=!0)),m&&!i&&e.get()!==void 0){const y=Ip(f.keyframes,c);if(y!==void 0)return gt.update(()=>{f.onUpdate(y),f.onComplete()}),new X6([])}return!i&&RA.supports(f)?new RA(f):new N0(f)};function PV({protectedKeys:r,needsAnimating:e},t){const n=r.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,n}function iI(r,e,{delay:t=0,transitionOverride:n,type:s}={}){var i;let{transition:o=r.getDefaultTransition(),transitionEnd:c,...u}=e;n&&(o=n);const h=[],f=s&&r.animationState&&r.animationState.getState()[s];for(const m in u){const y=r.getValue(m,(i=r.latestValues[m])!==null&&i!==void 0?i:null),_=u[m];if(_===void 0||f&&PV(f,m))continue;const A={delay:t,...E0(o||{},m)};let b=!1;if(window.MotionHandoffAnimation){const x=kC(r);if(x){const M=window.MotionHandoffAnimation(x,m,gt);M!==null&&(A.startTime=M,b=!0)}}Ly(r,m),y.start(O0(m,y,_,r.shouldReduceMotion&&CC.has(m)?{type:!1}:A,r,b));const T=y.animation;T&&h.push(T)}return c&&Promise.all(h).then(()=>{gt.update(()=>{c&&lF(r,c)})}),h}function By(r,e,t={}){var n;const s=Cp(r,e,t.type==="exit"?(n=r.presenceContext)===null||n===void 0?void 0:n.custom:void 0);let{transition:i=r.getDefaultTransition()||{}}=s||{};t.transitionOverride&&(i=t.transitionOverride);const o=s?()=>Promise.all(iI(r,s,t)):()=>Promise.resolve(),c=r.variantChildren&&r.variantChildren.size?(h=0)=>{const{delayChildren:f=0,staggerChildren:m,staggerDirection:y}=i;return RV(r,e,f+h,m,y,t)}:()=>Promise.resolve(),{when:u}=i;if(u){const[h,f]=u==="beforeChildren"?[o,c]:[c,o];return h().then(()=>f())}else return Promise.all([o(),c(t.delay)])}function RV(r,e,t=0,n=0,s=1,i){const o=[],c=(r.variantChildren.size-1)*n,u=s===1?(h=0)=>h*n:(h=0)=>c-h*n;return Array.from(r.variantChildren).sort(DV).forEach((h,f)=>{h.notify("AnimationStart",e),o.push(By(h,e,{...i,delay:t+u(f)}).then(()=>h.notify("AnimationComplete",e)))}),Promise.all(o)}function DV(r,e){return r.sortNodePosition(e)}function LV(r,e,t={}){r.notify("AnimationStart",e);let n;if(Array.isArray(e)){const s=e.map(i=>By(r,i,t));n=Promise.all(s)}else if(typeof e=="string")n=By(r,e,t);else{const s=typeof e=="function"?Cp(r,e,t.custom):e;n=Promise.all(iI(r,s,t))}return n.then(()=>{r.notify("AnimationComplete",e)})}const MV=c0.length;function oI(r){if(!r)return;if(!r.isControllingVariants){const t=r.parent?oI(r.parent)||{}:{};return r.props.initial!==void 0&&(t.initial=r.props.initial),t}const e={};for(let t=0;t<MV;t++){const n=c0[t],s=r.props[n];(Uu(s)||s===!1)&&(e[n]=s)}return e}const NV=[...l0].reverse(),OV=l0.length;function FV(r){return e=>Promise.all(e.map(({animation:t,options:n})=>LV(r,t,n)))}function VV(r){let e=FV(r),t=DA(),n=!0;const s=u=>(h,f)=>{var m;const y=Cp(r,f,u==="exit"?(m=r.presenceContext)===null||m===void 0?void 0:m.custom:void 0);if(y){const{transition:_,transitionEnd:A,...b}=y;h={...h,...b,...A}}return h};function i(u){e=u(r)}function o(u){const{props:h}=r,f=oI(r.parent)||{},m=[],y=new Set;let _={},A=1/0;for(let T=0;T<OV;T++){const x=NV[T],M=t[x],R=h[x]!==void 0?h[x]:f[x],B=Uu(R),O=x===u?M.isActive:null;O===!1&&(A=T);let $=R===f[x]&&R!==h[x]&&B;if($&&n&&r.manuallyAnimateOnMount&&($=!1),M.protectedKeys={..._},!M.isActive&&O===null||!R&&!M.prevProp||Sp(R)||typeof R=="boolean")continue;const k=jV(M.prevProp,R);let C=k||x===u&&M.isActive&&!$&&B||T>A&&B,P=!1;const N=Array.isArray(R)?R:[R];let j=N.reduce(s(x),{});O===!1&&(j={});const{prevResolvedValues:z={}}=M,F={...z,...j},ue=Z=>{C=!0,y.has(Z)&&(P=!0,y.delete(Z)),M.needsAnimating[Z]=!0;const te=r.getValue(Z);te&&(te.liveStyle=!1)};for(const Z in F){const te=j[Z],de=z[Z];if(_.hasOwnProperty(Z))continue;let ee=!1;Py(te)&&Py(de)?ee=!vC(te,de):ee=te!==de,ee?te!=null?ue(Z):y.add(Z):te!==void 0&&y.has(Z)?ue(Z):M.protectedKeys[Z]=!0}M.prevProp=R,M.prevResolvedValues=j,M.isActive&&(_={..._,...j}),n&&r.blockInitialAnimation&&(C=!1),C&&(!($&&k)||P)&&m.push(...N.map(Z=>({animation:Z,options:{type:x}})))}if(y.size){const T={};y.forEach(x=>{const M=r.getBaseTarget(x),R=r.getValue(x);R&&(R.liveStyle=!0),T[x]=M??null}),m.push({animation:T})}let b=!!m.length;return n&&(h.initial===!1||h.initial===h.animate)&&!r.manuallyAnimateOnMount&&(b=!1),n=!1,b?e(m):Promise.resolve()}function c(u,h){var f;if(t[u].isActive===h)return Promise.resolve();(f=r.variantChildren)===null||f===void 0||f.forEach(y=>{var _;return(_=y.animationState)===null||_===void 0?void 0:_.setActive(u,h)}),t[u].isActive=h;const m=o(u);for(const y in t)t[y].protectedKeys={};return m}return{animateChanges:o,setActive:c,setAnimateFunction:i,getState:()=>t,reset:()=>{t=DA(),n=!0}}}function jV(r,e){return typeof e=="string"?e!==r:Array.isArray(e)?!vC(e,r):!1}function Yo(r=!1){return{isActive:r,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function DA(){return{animate:Yo(!0),whileInView:Yo(),whileHover:Yo(),whileTap:Yo(),whileDrag:Yo(),whileFocus:Yo(),exit:Yo()}}class vo{constructor(e){this.isMounted=!1,this.node=e}update(){}}class BV extends vo{constructor(e){super(e),e.animationState||(e.animationState=VV(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();Sp(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let UV=0;class zV extends vo{constructor(){super(...arguments),this.id=UV++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===n)return;const s=this.node.animationState.setActive("exit",!e);t&&!e&&s.then(()=>t(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const aI={animation:{Feature:BV},exit:{Feature:zV}};function Wu(r,e,t,n={passive:!0}){return r.addEventListener(e,t,n),()=>r.removeEventListener(e,t)}function fh(r){return{point:{x:r.pageX,y:r.pageY}}}const $V=r=>e=>T0(e)&&r(e,fh(e));function Tu(r,e,t,n){return Wu(r,e,$V(t),n)}const LA=(r,e)=>Math.abs(r-e);function HV(r,e){const t=LA(r.x,e.x),n=LA(r.y,e.y);return Math.sqrt(t**2+n**2)}class lI{constructor(e,t,{transformPagePoint:n,contextWindow:s,dragSnapToOrigin:i=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const m=Ug(this.lastMoveEventInfo,this.history),y=this.startEvent!==null,_=HV(m.offset,{x:0,y:0})>=3;if(!y&&!_)return;const{point:A}=m,{timestamp:b}=fn;this.history.push({...A,timestamp:b});const{onStart:T,onMove:x}=this.handlers;y||(T&&T(this.lastMoveEvent,m),this.startEvent=this.lastMoveEvent),x&&x(this.lastMoveEvent,m)},this.handlePointerMove=(m,y)=>{this.lastMoveEvent=m,this.lastMoveEventInfo=Bg(y,this.transformPagePoint),gt.update(this.updatePoint,!0)},this.handlePointerUp=(m,y)=>{this.end();const{onEnd:_,onSessionEnd:A,resumeAnimation:b}=this.handlers;if(this.dragSnapToOrigin&&b&&b(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const T=Ug(m.type==="pointercancel"?this.lastMoveEventInfo:Bg(y,this.transformPagePoint),this.history);this.startEvent&&_&&_(m,T),A&&A(m,T)},!T0(e))return;this.dragSnapToOrigin=i,this.handlers=t,this.transformPagePoint=n,this.contextWindow=s||window;const o=fh(e),c=Bg(o,this.transformPagePoint),{point:u}=c,{timestamp:h}=fn;this.history=[{...u,timestamp:h}];const{onSessionStart:f}=t;f&&f(e,Ug(c,this.history)),this.removeListeners=dh(Tu(this.contextWindow,"pointermove",this.handlePointerMove),Tu(this.contextWindow,"pointerup",this.handlePointerUp),Tu(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),po(this.updatePoint)}}function Bg(r,e){return e?{point:e(r.point)}:r}function MA(r,e){return{x:r.x-e.x,y:r.y-e.y}}function Ug({point:r},e){return{point:r,delta:MA(r,cI(e)),offset:MA(r,WV(e)),velocity:GV(e,.1)}}function WV(r){return r[0]}function cI(r){return r[r.length-1]}function GV(r,e){if(r.length<2)return{x:0,y:0};let t=r.length-1,n=null;const s=cI(r);for(;t>=0&&(n=r[t],!(s.timestamp-n.timestamp>li(e)));)t--;if(!n)return{x:0,y:0};const i=ci(s.timestamp-n.timestamp);if(i===0)return{x:0,y:0};const o={x:(s.x-n.x)/i,y:(s.y-n.y)/i};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}const uI=1e-4,qV=1-uI,KV=1+uI,hI=.01,XV=0-hI,YV=0+hI;function hr(r){return r.max-r.min}function QV(r,e,t){return Math.abs(r-e)<=t}function NA(r,e,t,n=.5){r.origin=n,r.originPoint=xt(e.min,e.max,r.origin),r.scale=hr(t)/hr(e),r.translate=xt(t.min,t.max,r.origin)-r.originPoint,(r.scale>=qV&&r.scale<=KV||isNaN(r.scale))&&(r.scale=1),(r.translate>=XV&&r.translate<=YV||isNaN(r.translate))&&(r.translate=0)}function Su(r,e,t,n){NA(r.x,e.x,t.x,n?n.originX:void 0),NA(r.y,e.y,t.y,n?n.originY:void 0)}function OA(r,e,t){r.min=t.min+e.min,r.max=r.min+hr(e)}function JV(r,e,t){OA(r.x,e.x,t.x),OA(r.y,e.y,t.y)}function FA(r,e,t){r.min=e.min-t.min,r.max=r.min+hr(e)}function xu(r,e,t){FA(r.x,e.x,t.x),FA(r.y,e.y,t.y)}function ZV(r,{min:e,max:t},n){return e!==void 0&&r<e?r=n?xt(e,r,n.min):Math.max(r,e):t!==void 0&&r>t&&(r=n?xt(t,r,n.max):Math.min(r,t)),r}function VA(r,e,t){return{min:e!==void 0?r.min+e:void 0,max:t!==void 0?r.max+t-(r.max-r.min):void 0}}function e5(r,{top:e,left:t,bottom:n,right:s}){return{x:VA(r.x,t,s),y:VA(r.y,e,n)}}function jA(r,e){let t=e.min-r.min,n=e.max-r.max;return e.max-e.min<r.max-r.min&&([t,n]=[n,t]),{min:t,max:n}}function t5(r,e){return{x:jA(r.x,e.x),y:jA(r.y,e.y)}}function n5(r,e){let t=.5;const n=hr(r),s=hr(e);return s>n?t=Gl(e.min,e.max-n,r.min):n>s&&(t=Gl(r.min,r.max-s,e.min)),gi(0,1,t)}function r5(r,e){const t={};return e.min!==void 0&&(t.min=e.min-r.min),e.max!==void 0&&(t.max=e.max-r.min),t}const Uy=.35;function s5(r=Uy){return r===!1?r=0:r===!0&&(r=Uy),{x:BA(r,"left","right"),y:BA(r,"top","bottom")}}function BA(r,e,t){return{min:UA(r,e),max:UA(r,t)}}function UA(r,e){return typeof r=="number"?r:r[e]||0}const zA=()=>({translate:0,scale:1,origin:0,originPoint:0}),Sl=()=>({x:zA(),y:zA()}),$A=()=>({min:0,max:0}),Ot=()=>({x:$A(),y:$A()});function Cr(r){return[r("x"),r("y")]}function dI({top:r,left:e,right:t,bottom:n}){return{x:{min:e,max:t},y:{min:r,max:n}}}function i5({x:r,y:e}){return{top:e.min,right:r.max,bottom:e.max,left:r.min}}function o5(r,e){if(!e)return r;const t=e({x:r.left,y:r.top}),n=e({x:r.right,y:r.bottom});return{top:t.y,left:t.x,bottom:n.y,right:n.x}}function zg(r){return r===void 0||r===1}function zy({scale:r,scaleX:e,scaleY:t}){return!zg(r)||!zg(e)||!zg(t)}function Zo(r){return zy(r)||fI(r)||r.z||r.rotate||r.rotateX||r.rotateY||r.skewX||r.skewY}function fI(r){return HA(r.x)||HA(r.y)}function HA(r){return r&&r!=="0%"}function Kf(r,e,t){const n=r-t,s=e*n;return t+s}function WA(r,e,t,n,s){return s!==void 0&&(r=Kf(r,s,n)),Kf(r,t,n)+e}function $y(r,e=0,t=1,n,s){r.min=WA(r.min,e,t,n,s),r.max=WA(r.max,e,t,n,s)}function pI(r,{x:e,y:t}){$y(r.x,e.translate,e.scale,e.originPoint),$y(r.y,t.translate,t.scale,t.originPoint)}const GA=.999999999999,qA=1.0000000000001;function a5(r,e,t,n=!1){const s=t.length;if(!s)return;e.x=e.y=1;let i,o;for(let c=0;c<s;c++){i=t[c],o=i.projectionDelta;const{visualElement:u}=i.options;u&&u.props.style&&u.props.style.display==="contents"||(n&&i.options.layoutScroll&&i.scroll&&i!==i.root&&Cl(r,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,pI(r,o)),n&&Zo(i.latestValues)&&Cl(r,i.latestValues))}e.x<qA&&e.x>GA&&(e.x=1),e.y<qA&&e.y>GA&&(e.y=1)}function xl(r,e){r.min=r.min+e,r.max=r.max+e}function KA(r,e,t,n,s=.5){const i=xt(r.min,r.max,s);$y(r,e,t,i,n)}function Cl(r,e){KA(r.x,e.x,e.scaleX,e.scale,e.originX),KA(r.y,e.y,e.scaleY,e.scale,e.originY)}function mI(r,e){return dI(o5(r.getBoundingClientRect(),e))}function l5(r,e,t){const n=mI(r,t),{scroll:s}=e;return s&&(xl(n.x,s.offset.x),xl(n.y,s.offset.y)),n}const gI=({current:r})=>r?r.ownerDocument.defaultView:null,c5=new WeakMap;class u5{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Ot(),this.visualElement=e}start(e,{snapToCursor:t=!1}={}){const{presenceContext:n}=this.visualElement;if(n&&n.isPresent===!1)return;const s=f=>{const{dragSnapToOrigin:m}=this.getProps();m?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(fh(f).point)},i=(f,m)=>{const{drag:y,dragPropagation:_,onDragStart:A}=this.getProps();if(y&&!_&&(this.openDragLock&&this.openDragLock(),this.openDragLock=rF(y),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Cr(T=>{let x=this.getAxisMotionValue(T).get()||0;if(Ls.test(x)){const{projection:M}=this.visualElement;if(M&&M.layout){const R=M.layout.layoutBox[T];R&&(x=hr(R)*(parseFloat(x)/100))}}this.originPoint[T]=x}),A&&gt.postRender(()=>A(f,m)),Ly(this.visualElement,"transform");const{animationState:b}=this.visualElement;b&&b.setActive("whileDrag",!0)},o=(f,m)=>{const{dragPropagation:y,dragDirectionLock:_,onDirectionLock:A,onDrag:b}=this.getProps();if(!y&&!this.openDragLock)return;const{offset:T}=m;if(_&&this.currentDirection===null){this.currentDirection=h5(T),this.currentDirection!==null&&A&&A(this.currentDirection);return}this.updateAxis("x",m.point,T),this.updateAxis("y",m.point,T),this.visualElement.render(),b&&b(f,m)},c=(f,m)=>this.stop(f,m),u=()=>Cr(f=>{var m;return this.getAnimationState(f)==="paused"&&((m=this.getAxisMotionValue(f).animation)===null||m===void 0?void 0:m.play())}),{dragSnapToOrigin:h}=this.getProps();this.panSession=new lI(e,{onSessionStart:s,onStart:i,onMove:o,onSessionEnd:c,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:h,contextWindow:gI(this.visualElement)})}stop(e,t){const n=this.isDragging;if(this.cancel(),!n)return;const{velocity:s}=t;this.startAnimation(s);const{onDragEnd:i}=this.getProps();i&&gt.postRender(()=>i(e,t))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,n){const{drag:s}=this.getProps();if(!n||!Xd(e,s,this.currentDirection))return;const i=this.getAxisMotionValue(e);let o=this.originPoint[e]+n[e];this.constraints&&this.constraints[e]&&(o=ZV(o,this.constraints[e],this.elastic[e])),i.set(o)}resolveConstraints(){var e;const{dragConstraints:t,dragElastic:n}=this.getProps(),s=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,i=this.constraints;t&&bl(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&s?this.constraints=e5(s.layoutBox,t):this.constraints=!1,this.elastic=s5(n),i!==this.constraints&&s&&this.constraints&&!this.hasMutatedConstraints&&Cr(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=r5(s.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!bl(e))return!1;const n=e.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const i=l5(n,s.root,this.visualElement.getTransformPagePoint());let o=t5(s.layout.layoutBox,i);if(t){const c=t(i5(o));this.hasMutatedConstraints=!!c,c&&(o=dI(c))}return o}startAnimation(e){const{drag:t,dragMomentum:n,dragElastic:s,dragTransition:i,dragSnapToOrigin:o,onDragTransitionEnd:c}=this.getProps(),u=this.constraints||{},h=Cr(f=>{if(!Xd(f,t,this.currentDirection))return;let m=u&&u[f]||{};o&&(m={min:0,max:0});const y=s?200:1e6,_=s?40:1e7,A={type:"inertia",velocity:n?e[f]:0,bounceStiffness:y,bounceDamping:_,timeConstant:750,restDelta:1,restSpeed:10,...i,...m};return this.startAxisValueAnimation(f,A)});return Promise.all(h).then(c)}startAxisValueAnimation(e,t){const n=this.getAxisMotionValue(e);return Ly(this.visualElement,e),n.start(O0(e,n,0,t,this.visualElement,!1))}stopAnimation(){Cr(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Cr(e=>{var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.pause()})}getAnimationState(e){var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,n=this.visualElement.getProps(),s=n[t];return s||this.visualElement.getValue(e,(n.initial?n.initial[e]:void 0)||0)}snapToCursor(e){Cr(t=>{const{drag:n}=this.getProps();if(!Xd(t,n,this.currentDirection))return;const{projection:s}=this.visualElement,i=this.getAxisMotionValue(t);if(s&&s.layout){const{min:o,max:c}=s.layout.layoutBox[t];i.set(e[t]-xt(o,c,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:n}=this.visualElement;if(!bl(t)||!n||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};Cr(o=>{const c=this.getAxisMotionValue(o);if(c&&this.constraints!==!1){const u=c.get();s[o]=n5({min:u,max:u},this.constraints[o])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),Cr(o=>{if(!Xd(o,e,null))return;const c=this.getAxisMotionValue(o),{min:u,max:h}=this.constraints[o];c.set(xt(u,h,s[o]))})}addListeners(){if(!this.visualElement.current)return;c5.set(this.visualElement,this);const e=this.visualElement.current,t=Tu(e,"pointerdown",u=>{const{drag:h,dragListener:f=!0}=this.getProps();h&&f&&this.start(u)}),n=()=>{const{dragConstraints:u}=this.getProps();bl(u)&&u.current&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,i=s.addEventListener("measure",n);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),gt.read(n);const o=Wu(window,"resize",()=>this.scalePositionWithinConstraints()),c=s.addEventListener("didUpdate",({delta:u,hasLayoutChanged:h})=>{this.isDragging&&h&&(Cr(f=>{const m=this.getAxisMotionValue(f);m&&(this.originPoint[f]+=u[f].translate,m.set(m.get()+u[f].translate))}),this.visualElement.render())});return()=>{o(),t(),i(),c&&c()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:n=!1,dragPropagation:s=!1,dragConstraints:i=!1,dragElastic:o=Uy,dragMomentum:c=!0}=e;return{...e,drag:t,dragDirectionLock:n,dragPropagation:s,dragConstraints:i,dragElastic:o,dragMomentum:c}}}function Xd(r,e,t){return(e===!0||e===r)&&(t===null||t===r)}function h5(r,e=10){let t=null;return Math.abs(r.y)>e?t="y":Math.abs(r.x)>e&&(t="x"),t}class d5 extends vo{constructor(e){super(e),this.removeGroupControls=ur,this.removeListeners=ur,this.controls=new u5(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||ur}unmount(){this.removeGroupControls(),this.removeListeners()}}const XA=r=>(e,t)=>{r&&gt.postRender(()=>r(e,t))};class f5 extends vo{constructor(){super(...arguments),this.removePointerDownListener=ur}onPointerDown(e){this.session=new lI(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:gI(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:n,onPanEnd:s}=this.node.getProps();return{onSessionStart:XA(e),onStart:XA(t),onMove:n,onEnd:(i,o)=>{delete this.session,s&&gt.postRender(()=>s(i,o))}}}mount(){this.removePointerDownListener=Tu(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const vf={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function YA(r,e){return e.max===e.min?0:r/(e.max-e.min)*100}const eu={correct:(r,e)=>{if(!e.target)return r;if(typeof r=="string")if(De.test(r))r=parseFloat(r);else return r;const t=YA(r,e.target.x),n=YA(r,e.target.y);return`${t}% ${n}%`}},p5={correct:(r,{treeScale:e,projectionDelta:t})=>{const n=r,s=mo.parse(r);if(s.length>5)return n;const i=mo.createTransformer(r),o=typeof s[0]!="number"?1:0,c=t.x.scale*e.x,u=t.y.scale*e.y;s[0+o]/=c,s[1+o]/=u;const h=xt(c,u,.5);return typeof s[2+o]=="number"&&(s[2+o]/=h),typeof s[3+o]=="number"&&(s[3+o]/=h),i(s)}};class m5 extends V.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:n,layoutId:s}=this.props,{projection:i}=e;F6(g5),i&&(t.group&&t.group.add(i),n&&n.register&&s&&n.register(i),i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),vf.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:n,drag:s,isPresent:i}=this.props,o=n.projection;return o&&(o.isPresent=i,s||e.layoutDependency!==t||t===void 0?o.willUpdate():this.safeToRemove(),e.isPresent!==i&&(i?o.promote():o.relegate()||gt.postRender(()=>{const c=o.getStack();(!c||!c.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),h0.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:n}=this.props,{projection:s}=e;s&&(s.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(s),n&&n.deregister&&n.deregister(s))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function yI(r){const[e,t]=Jx(),n=V.useContext(n0);return L.jsx(m5,{...r,layoutGroup:n,switchLayoutGroup:V.useContext(iC),isPresent:e,safeToRemove:t})}const g5={borderRadius:{...eu,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:eu,borderTopRightRadius:eu,borderBottomLeftRadius:eu,borderBottomRightRadius:eu,boxShadow:p5};function y5(r,e,t){const n=Rn(r)?r:$u(r);return n.start(O0("",n,e,t)),n.animation}function v5(r){return r instanceof SVGElement&&r.tagName!=="svg"}const _5=(r,e)=>r.depth-e.depth;class w5{constructor(){this.children=[],this.isDirty=!1}add(e){S0(this.children,e),this.isDirty=!0}remove(e){x0(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(_5),this.isDirty=!1,this.children.forEach(e)}}function E5(r,e){const t=Ms.now(),n=({timestamp:s})=>{const i=s-t;i>=e&&(po(n),r(i-e))};return gt.read(n,!0),()=>po(n)}const vI=["TopLeft","TopRight","BottomLeft","BottomRight"],A5=vI.length,QA=r=>typeof r=="string"?parseFloat(r):r,JA=r=>typeof r=="number"||De.test(r);function b5(r,e,t,n,s,i){s?(r.opacity=xt(0,t.opacity!==void 0?t.opacity:1,T5(n)),r.opacityExit=xt(e.opacity!==void 0?e.opacity:1,0,S5(n))):i&&(r.opacity=xt(e.opacity!==void 0?e.opacity:1,t.opacity!==void 0?t.opacity:1,n));for(let o=0;o<A5;o++){const c=`border${vI[o]}Radius`;let u=ZA(e,c),h=ZA(t,c);if(u===void 0&&h===void 0)continue;u||(u=0),h||(h=0),u===0||h===0||JA(u)===JA(h)?(r[c]=Math.max(xt(QA(u),QA(h),n),0),(Ls.test(h)||Ls.test(u))&&(r[c]+="%")):r[c]=h}(e.rotate||t.rotate)&&(r.rotate=xt(e.rotate||0,t.rotate||0,n))}function ZA(r,e){return r[e]!==void 0?r[e]:r.borderRadius}const T5=_I(0,.5,OC),S5=_I(.5,.95,ur);function _I(r,e,t){return n=>n<r?0:n>e?1:t(Gl(r,e,n))}function eb(r,e){r.min=e.min,r.max=e.max}function Tr(r,e){eb(r.x,e.x),eb(r.y,e.y)}function tb(r,e){r.translate=e.translate,r.scale=e.scale,r.originPoint=e.originPoint,r.origin=e.origin}function nb(r,e,t,n,s){return r-=e,r=Kf(r,1/t,n),s!==void 0&&(r=Kf(r,1/s,n)),r}function x5(r,e=0,t=1,n=.5,s,i=r,o=r){if(Ls.test(e)&&(e=parseFloat(e),e=xt(o.min,o.max,e/100)-o.min),typeof e!="number")return;let c=xt(i.min,i.max,n);r===i&&(c-=e),r.min=nb(r.min,e,t,c,s),r.max=nb(r.max,e,t,c,s)}function rb(r,e,[t,n,s],i,o){x5(r,e[t],e[n],e[s],e.scale,i,o)}const C5=["x","scaleX","originX"],I5=["y","scaleY","originY"];function sb(r,e,t,n){rb(r.x,e,C5,t?t.x:void 0,n?n.x:void 0),rb(r.y,e,I5,t?t.y:void 0,n?n.y:void 0)}function ib(r){return r.translate===0&&r.scale===1}function wI(r){return ib(r.x)&&ib(r.y)}function ob(r,e){return r.min===e.min&&r.max===e.max}function k5(r,e){return ob(r.x,e.x)&&ob(r.y,e.y)}function ab(r,e){return Math.round(r.min)===Math.round(e.min)&&Math.round(r.max)===Math.round(e.max)}function EI(r,e){return ab(r.x,e.x)&&ab(r.y,e.y)}function lb(r){return hr(r.x)/hr(r.y)}function cb(r,e){return r.translate===e.translate&&r.scale===e.scale&&r.originPoint===e.originPoint}class P5{constructor(){this.members=[]}add(e){S0(this.members,e),e.scheduleRender()}remove(e){if(x0(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(s=>e===s);if(t===0)return!1;let n;for(let s=t;s>=0;s--){const i=this.members[s];if(i.isPresent!==!1){n=i;break}}return n?(this.promote(n),!0):!1}promote(e,t){const n=this.lead;if(e!==n&&(this.prevLead=n,this.lead=e,e.show(),n)){n.instance&&n.scheduleRender(),e.scheduleRender(),e.resumeFrom=n,t&&(e.resumeFrom.preserveOpacity=!0),n.snapshot&&(e.snapshot=n.snapshot,e.snapshot.latestValues=n.animationValues||n.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:s}=e.options;s===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:n}=e;t.onExitComplete&&t.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function R5(r,e,t){let n="";const s=r.x.translate/e.x,i=r.y.translate/e.y,o=t?.z||0;if((s||i||o)&&(n=`translate3d(${s}px, ${i}px, ${o}px) `),(e.x!==1||e.y!==1)&&(n+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:h,rotate:f,rotateX:m,rotateY:y,skewX:_,skewY:A}=t;h&&(n=`perspective(${h}px) ${n}`),f&&(n+=`rotate(${f}deg) `),m&&(n+=`rotateX(${m}deg) `),y&&(n+=`rotateY(${y}deg) `),_&&(n+=`skewX(${_}deg) `),A&&(n+=`skewY(${A}deg) `)}const c=r.x.scale*e.x,u=r.y.scale*e.y;return(c!==1||u!==1)&&(n+=`scale(${c}, ${u})`),n||"none"}const ea={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},fu=typeof window<"u"&&window.MotionDebug!==void 0,$g=["","X","Y","Z"],D5={visibility:"hidden"},ub=1e3;let L5=0;function Hg(r,e,t,n){const{latestValues:s}=e;s[r]&&(t[r]=s[r],e.setStaticValue(r,0),n&&(n[r]=0))}function AI(r){if(r.hasCheckedOptimisedAppear=!0,r.root===r)return;const{visualElement:e}=r.options;if(!e)return;const t=kC(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:s,layoutId:i}=r.options;window.MotionCancelOptimisedAnimation(t,"transform",gt,!(s||i))}const{parent:n}=r;n&&!n.hasCheckedOptimisedAppear&&AI(n)}function bI({attachResizeListener:r,defaultParent:e,measureScroll:t,checkIsScrollRoot:n,resetTransform:s}){return class{constructor(o={},c=e?.()){this.id=L5++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,fu&&(ea.totalNodes=ea.resolvedTargetDeltas=ea.recalculatedProjection=0),this.nodes.forEach(O5),this.nodes.forEach(U5),this.nodes.forEach(z5),this.nodes.forEach(F5),fu&&window.MotionDebug.record(ea)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=c?c.root||c:this,this.path=c?[...c.path,c]:[],this.parent=c,this.depth=c?c.depth+1:0;for(let u=0;u<this.path.length;u++)this.path[u].shouldResetTransform=!0;this.root===this&&(this.nodes=new w5)}addEventListener(o,c){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new C0),this.eventHandlers.get(o).add(c)}notifyListeners(o,...c){const u=this.eventHandlers.get(o);u&&u.notify(...c)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,c=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=v5(o),this.instance=o;const{layoutId:u,layout:h,visualElement:f}=this.options;if(f&&!f.current&&f.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),c&&(h||u)&&(this.isLayoutDirty=!0),r){let m;const y=()=>this.root.updateBlockedByResize=!1;r(o,()=>{this.root.updateBlockedByResize=!0,m&&m(),m=E5(y,250),vf.hasAnimatedSinceResize&&(vf.hasAnimatedSinceResize=!1,this.nodes.forEach(db))})}u&&this.root.registerSharedNode(u,this),this.options.animate!==!1&&f&&(u||h)&&this.addEventListener("didUpdate",({delta:m,hasLayoutChanged:y,hasRelativeTargetChanged:_,layout:A})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const b=this.options.transition||f.getDefaultTransition()||q5,{onLayoutAnimationStart:T,onLayoutAnimationComplete:x}=f.getProps(),M=!this.targetLayout||!EI(this.targetLayout,A)||_,R=!y&&_;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||R||y&&(M||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(m,R);const B={...E0(b,"layout"),onPlay:T,onComplete:x};(f.shouldReduceMotion||this.options.layoutRoot)&&(B.delay=0,B.type=!1),this.startAnimation(B)}else y||db(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=A})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,po(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach($5),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&AI(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let f=0;f<this.path.length;f++){const m=this.path[f];m.shouldResetTransform=!0,m.updateScroll("snapshot"),m.options.layoutRoot&&m.willUpdate(!1)}const{layoutId:c,layout:u}=this.options;if(c===void 0&&!u)return;const h=this.getTransformTemplate();this.prevTransformTemplateValue=h?h(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(hb);return}this.isUpdating||this.nodes.forEach(j5),this.isUpdating=!1,this.nodes.forEach(B5),this.nodes.forEach(M5),this.nodes.forEach(N5),this.clearAllSnapshots();const c=Ms.now();fn.delta=gi(0,1e3/60,c-fn.timestamp),fn.timestamp=c,fn.isProcessing=!0,Lg.update.process(fn),Lg.preRender.process(fn),Lg.render.process(fn),fn.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,h0.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(V5),this.sharedNodes.forEach(H5)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,gt.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){gt.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let u=0;u<this.path.length;u++)this.path[u].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Ot(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:c}=this.options;c&&c.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let c=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(c=!1),c){const u=n(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:u,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:u}}}resetTransform(){if(!s)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,c=this.projectionDelta&&!wI(this.projectionDelta),u=this.getTransformTemplate(),h=u?u(this.latestValues,""):void 0,f=h!==this.prevTransformTemplateValue;o&&(c||Zo(this.latestValues)||f)&&(s(this.instance,h),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const c=this.measurePageBox();let u=this.removeElementScroll(c);return o&&(u=this.removeTransform(u)),K5(u),{animationId:this.root.animationId,measuredBox:c,layoutBox:u,latestValues:{},source:this.id}}measurePageBox(){var o;const{visualElement:c}=this.options;if(!c)return Ot();const u=c.measureViewportBox();if(!(((o=this.scroll)===null||o===void 0?void 0:o.wasRoot)||this.path.some(X5))){const{scroll:f}=this.root;f&&(xl(u.x,f.offset.x),xl(u.y,f.offset.y))}return u}removeElementScroll(o){var c;const u=Ot();if(Tr(u,o),!((c=this.scroll)===null||c===void 0)&&c.wasRoot)return u;for(let h=0;h<this.path.length;h++){const f=this.path[h],{scroll:m,options:y}=f;f!==this.root&&m&&y.layoutScroll&&(m.wasRoot&&Tr(u,o),xl(u.x,m.offset.x),xl(u.y,m.offset.y))}return u}applyTransform(o,c=!1){const u=Ot();Tr(u,o);for(let h=0;h<this.path.length;h++){const f=this.path[h];!c&&f.options.layoutScroll&&f.scroll&&f!==f.root&&Cl(u,{x:-f.scroll.offset.x,y:-f.scroll.offset.y}),Zo(f.latestValues)&&Cl(u,f.latestValues)}return Zo(this.latestValues)&&Cl(u,this.latestValues),u}removeTransform(o){const c=Ot();Tr(c,o);for(let u=0;u<this.path.length;u++){const h=this.path[u];if(!h.instance||!Zo(h.latestValues))continue;zy(h.latestValues)&&h.updateSnapshot();const f=Ot(),m=h.measurePageBox();Tr(f,m),sb(c,h.latestValues,h.snapshot?h.snapshot.layoutBox:void 0,f)}return Zo(this.latestValues)&&sb(c,this.latestValues),c}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==fn.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var c;const u=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=u.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=u.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=u.isSharedProjectionDirty);const h=!!this.resumingFrom||this!==u;if(!(o||h&&this.isSharedProjectionDirty||this.isProjectionDirty||!((c=this.parent)===null||c===void 0)&&c.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:m,layoutId:y}=this.options;if(!(!this.layout||!(m||y))){if(this.resolvedRelativeTargetAt=fn.timestamp,!this.targetDelta&&!this.relativeTarget){const _=this.getClosestProjectingParent();_&&_.layout&&this.animationProgress!==1?(this.relativeParent=_,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ot(),this.relativeTargetOrigin=Ot(),xu(this.relativeTargetOrigin,this.layout.layoutBox,_.layout.layoutBox),Tr(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Ot(),this.targetWithTransforms=Ot()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),JV(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Tr(this.target,this.layout.layoutBox),pI(this.target,this.targetDelta)):Tr(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const _=this.getClosestProjectingParent();_&&!!_.resumingFrom==!!this.resumingFrom&&!_.options.layoutScroll&&_.target&&this.animationProgress!==1?(this.relativeParent=_,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ot(),this.relativeTargetOrigin=Ot(),xu(this.relativeTargetOrigin,this.target,_.target),Tr(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}fu&&ea.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||zy(this.parent.latestValues)||fI(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const c=this.getLead(),u=!!this.resumingFrom||this!==c;let h=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(h=!1),u&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(h=!1),this.resolvedRelativeTargetAt===fn.timestamp&&(h=!1),h)return;const{layout:f,layoutId:m}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(f||m))return;Tr(this.layoutCorrected,this.layout.layoutBox);const y=this.treeScale.x,_=this.treeScale.y;a5(this.layoutCorrected,this.treeScale,this.path,u),c.layout&&!c.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(c.target=c.layout.layoutBox,c.targetWithTransforms=Ot());const{target:A}=c;if(!A){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(tb(this.prevProjectionDelta.x,this.projectionDelta.x),tb(this.prevProjectionDelta.y,this.projectionDelta.y)),Su(this.projectionDelta,this.layoutCorrected,A,this.latestValues),(this.treeScale.x!==y||this.treeScale.y!==_||!cb(this.projectionDelta.x,this.prevProjectionDelta.x)||!cb(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",A)),fu&&ea.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var c;if((c=this.options.visualElement)===null||c===void 0||c.scheduleRender(),o){const u=this.getStack();u&&u.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Sl(),this.projectionDelta=Sl(),this.projectionDeltaWithTransform=Sl()}setAnimationOrigin(o,c=!1){const u=this.snapshot,h=u?u.latestValues:{},f={...this.latestValues},m=Sl();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!c;const y=Ot(),_=u?u.source:void 0,A=this.layout?this.layout.source:void 0,b=_!==A,T=this.getStack(),x=!T||T.members.length<=1,M=!!(b&&!x&&this.options.crossfade===!0&&!this.path.some(G5));this.animationProgress=0;let R;this.mixTargetDelta=B=>{const O=B/1e3;fb(m.x,o.x,O),fb(m.y,o.y,O),this.setTargetDelta(m),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(xu(y,this.layout.layoutBox,this.relativeParent.layout.layoutBox),W5(this.relativeTarget,this.relativeTargetOrigin,y,O),R&&k5(this.relativeTarget,R)&&(this.isProjectionDirty=!1),R||(R=Ot()),Tr(R,this.relativeTarget)),b&&(this.animationValues=f,b5(f,h,this.latestValues,O,M,x)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=O},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(po(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=gt.update(()=>{vf.hasAnimatedSinceResize=!0,this.currentAnimation=y5(0,ub,{...o,onUpdate:c=>{this.mixTargetDelta(c),o.onUpdate&&o.onUpdate(c)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(ub),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:c,target:u,layout:h,latestValues:f}=o;if(!(!c||!u||!h)){if(this!==o&&this.layout&&h&&TI(this.options.animationType,this.layout.layoutBox,h.layoutBox)){u=this.target||Ot();const m=hr(this.layout.layoutBox.x);u.x.min=o.target.x.min,u.x.max=u.x.min+m;const y=hr(this.layout.layoutBox.y);u.y.min=o.target.y.min,u.y.max=u.y.min+y}Tr(c,u),Cl(c,f),Su(this.projectionDeltaWithTransform,this.layoutCorrected,c,f)}}registerSharedNode(o,c){this.sharedNodes.has(o)||this.sharedNodes.set(o,new P5),this.sharedNodes.get(o).add(c);const h=c.options.initialPromotionConfig;c.promote({transition:h?h.transition:void 0,preserveFollowOpacity:h&&h.shouldPreserveFollowOpacity?h.shouldPreserveFollowOpacity(c):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:c}=this.options;return c?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:c}=this.options;return c?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:c,preserveFollowOpacity:u}={}){const h=this.getStack();h&&h.promote(this,u),o&&(this.projectionDelta=void 0,this.needsReset=!0),c&&this.setOptions({transition:c})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let c=!1;const{latestValues:u}=o;if((u.z||u.rotate||u.rotateX||u.rotateY||u.rotateZ||u.skewX||u.skewY)&&(c=!0),!c)return;const h={};u.z&&Hg("z",o,h,this.animationValues);for(let f=0;f<$g.length;f++)Hg(`rotate${$g[f]}`,o,h,this.animationValues),Hg(`skew${$g[f]}`,o,h,this.animationValues);o.render();for(const f in h)o.setStaticValue(f,h[f]),this.animationValues&&(this.animationValues[f]=h[f]);o.scheduleRender()}getProjectionStyles(o){var c,u;if(!this.instance||this.isSVG)return;if(!this.isVisible)return D5;const h={visibility:""},f=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,h.opacity="",h.pointerEvents=gf(o?.pointerEvents)||"",h.transform=f?f(this.latestValues,""):"none",h;const m=this.getLead();if(!this.projectionDelta||!this.layout||!m.target){const b={};return this.options.layoutId&&(b.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,b.pointerEvents=gf(o?.pointerEvents)||""),this.hasProjected&&!Zo(this.latestValues)&&(b.transform=f?f({},""):"none",this.hasProjected=!1),b}const y=m.animationValues||m.latestValues;this.applyTransformsToTarget(),h.transform=R5(this.projectionDeltaWithTransform,this.treeScale,y),f&&(h.transform=f(y,h.transform));const{x:_,y:A}=this.projectionDelta;h.transformOrigin=`${_.origin*100}% ${A.origin*100}% 0`,m.animationValues?h.opacity=m===this?(u=(c=y.opacity)!==null&&c!==void 0?c:this.latestValues.opacity)!==null&&u!==void 0?u:1:this.preserveOpacity?this.latestValues.opacity:y.opacityExit:h.opacity=m===this?y.opacity!==void 0?y.opacity:"":y.opacityExit!==void 0?y.opacityExit:0;for(const b in $f){if(y[b]===void 0)continue;const{correct:T,applyTo:x}=$f[b],M=h.transform==="none"?y[b]:T(y[b],m);if(x){const R=x.length;for(let B=0;B<R;B++)h[x[B]]=M}else h[b]=M}return this.options.layoutId&&(h.pointerEvents=m===this?gf(o?.pointerEvents)||"":"none"),h}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var c;return(c=o.currentAnimation)===null||c===void 0?void 0:c.stop()}),this.root.nodes.forEach(hb),this.root.sharedNodes.clear()}}}function M5(r){r.updateLayout()}function N5(r){var e;const t=((e=r.resumeFrom)===null||e===void 0?void 0:e.snapshot)||r.snapshot;if(r.isLead()&&r.layout&&t&&r.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:s}=r.layout,{animationType:i}=r.options,o=t.source!==r.layout.source;i==="size"?Cr(m=>{const y=o?t.measuredBox[m]:t.layoutBox[m],_=hr(y);y.min=n[m].min,y.max=y.min+_}):TI(i,t.layoutBox,n)&&Cr(m=>{const y=o?t.measuredBox[m]:t.layoutBox[m],_=hr(n[m]);y.max=y.min+_,r.relativeTarget&&!r.currentAnimation&&(r.isProjectionDirty=!0,r.relativeTarget[m].max=r.relativeTarget[m].min+_)});const c=Sl();Su(c,n,t.layoutBox);const u=Sl();o?Su(u,r.applyTransform(s,!0),t.measuredBox):Su(u,n,t.layoutBox);const h=!wI(c);let f=!1;if(!r.resumeFrom){const m=r.getClosestProjectingParent();if(m&&!m.resumeFrom){const{snapshot:y,layout:_}=m;if(y&&_){const A=Ot();xu(A,t.layoutBox,y.layoutBox);const b=Ot();xu(b,n,_.layoutBox),EI(A,b)||(f=!0),m.options.layoutRoot&&(r.relativeTarget=b,r.relativeTargetOrigin=A,r.relativeParent=m)}}}r.notifyListeners("didUpdate",{layout:n,snapshot:t,delta:u,layoutDelta:c,hasLayoutChanged:h,hasRelativeTargetChanged:f})}else if(r.isLead()){const{onExitComplete:n}=r.options;n&&n()}r.options.transition=void 0}function O5(r){fu&&ea.totalNodes++,r.parent&&(r.isProjecting()||(r.isProjectionDirty=r.parent.isProjectionDirty),r.isSharedProjectionDirty||(r.isSharedProjectionDirty=!!(r.isProjectionDirty||r.parent.isProjectionDirty||r.parent.isSharedProjectionDirty)),r.isTransformDirty||(r.isTransformDirty=r.parent.isTransformDirty))}function F5(r){r.isProjectionDirty=r.isSharedProjectionDirty=r.isTransformDirty=!1}function V5(r){r.clearSnapshot()}function hb(r){r.clearMeasurements()}function j5(r){r.isLayoutDirty=!1}function B5(r){const{visualElement:e}=r.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),r.resetTransform()}function db(r){r.finishAnimation(),r.targetDelta=r.relativeTarget=r.target=void 0,r.isProjectionDirty=!0}function U5(r){r.resolveTargetDelta()}function z5(r){r.calcProjection()}function $5(r){r.resetSkewAndRotation()}function H5(r){r.removeLeadSnapshot()}function fb(r,e,t){r.translate=xt(e.translate,0,t),r.scale=xt(e.scale,1,t),r.origin=e.origin,r.originPoint=e.originPoint}function pb(r,e,t,n){r.min=xt(e.min,t.min,n),r.max=xt(e.max,t.max,n)}function W5(r,e,t,n){pb(r.x,e.x,t.x,n),pb(r.y,e.y,t.y,n)}function G5(r){return r.animationValues&&r.animationValues.opacityExit!==void 0}const q5={duration:.45,ease:[.4,0,.1,1]},mb=r=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(r),gb=mb("applewebkit/")&&!mb("chrome/")?Math.round:ur;function yb(r){r.min=gb(r.min),r.max=gb(r.max)}function K5(r){yb(r.x),yb(r.y)}function TI(r,e,t){return r==="position"||r==="preserve-aspect"&&!QV(lb(e),lb(t),.2)}function X5(r){var e;return r!==r.root&&((e=r.scroll)===null||e===void 0?void 0:e.wasRoot)}const Y5=bI({attachResizeListener:(r,e)=>Wu(r,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Wg={current:void 0},SI=bI({measureScroll:r=>({x:r.scrollLeft,y:r.scrollTop}),defaultParent:()=>{if(!Wg.current){const r=new Y5({});r.mount(window),r.setOptions({layoutScroll:!0}),Wg.current=r}return Wg.current},resetTransform:(r,e)=>{r.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:r=>window.getComputedStyle(r).position==="fixed"}),Q5={pan:{Feature:f5},drag:{Feature:d5,ProjectionNode:SI,MeasureLayout:yI}};function vb(r,e,t){const{props:n}=r;r.animationState&&n.whileHover&&r.animationState.setActive("whileHover",t==="Start");const s="onHover"+t,i=n[s];i&&gt.postRender(()=>i(e,fh(e)))}class J5 extends vo{mount(){const{current:e}=this.node;e&&(this.unmount=J6(e,t=>(vb(this.node,t,"Start"),n=>vb(this.node,n,"End"))))}unmount(){}}class Z5 extends vo{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=dh(Wu(this.node.current,"focus",()=>this.onFocus()),Wu(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function _b(r,e,t){const{props:n}=r;r.animationState&&n.whileTap&&r.animationState.setActive("whileTap",t==="Start");const s="onTap"+(t==="End"?"":t),i=n[s];i&&gt.postRender(()=>i(e,fh(e)))}class e9 extends vo{mount(){const{current:e}=this.node;e&&(this.unmount=nF(e,t=>(_b(this.node,t,"Start"),(n,{success:s})=>_b(this.node,n,s?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const Hy=new WeakMap,Gg=new WeakMap,t9=r=>{const e=Hy.get(r.target);e&&e(r)},n9=r=>{r.forEach(t9)};function r9({root:r,...e}){const t=r||document;Gg.has(t)||Gg.set(t,{});const n=Gg.get(t),s=JSON.stringify(e);return n[s]||(n[s]=new IntersectionObserver(n9,{root:r,...e})),n[s]}function s9(r,e,t){const n=r9(e);return Hy.set(r,t),n.observe(r),()=>{Hy.delete(r),n.unobserve(r)}}const i9={some:0,all:1};class o9 extends vo{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:n,amount:s="some",once:i}=e,o={root:t?t.current:void 0,rootMargin:n,threshold:typeof s=="number"?s:i9[s]},c=u=>{const{isIntersecting:h}=u;if(this.isInView===h||(this.isInView=h,i&&!h&&this.hasEnteredView))return;h&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",h);const{onViewportEnter:f,onViewportLeave:m}=this.node.getProps(),y=h?f:m;y&&y(u)};return s9(this.node.current,o,c)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(a9(e,t))&&this.startObserver()}unmount(){}}function a9({viewport:r={}},{viewport:e={}}={}){return t=>r[t]!==e[t]}const xI={inView:{Feature:o9},tap:{Feature:e9},focus:{Feature:Z5},hover:{Feature:J5}},l9={layout:{ProjectionNode:SI,MeasureLayout:yI}},Wy={current:null},CI={current:!1};function c9(){if(CI.current=!0,!!i0)if(window.matchMedia){const r=window.matchMedia("(prefers-reduced-motion)"),e=()=>Wy.current=r.matches;r.addListener(e),e()}else Wy.current=!1}const u9=[...YC,xn,mo],h9=r=>u9.find(XC(r)),wb=new WeakMap;function d9(r,e,t){for(const n in e){const s=e[n],i=t[n];if(Rn(s))r.addValue(n,s);else if(Rn(i))r.addValue(n,$u(s,{owner:r}));else if(i!==s)if(r.hasValue(n)){const o=r.getValue(n);o.liveStyle===!0?o.jump(s):o.hasAnimated||o.set(s)}else{const o=r.getStaticValue(n);r.addValue(n,$u(o!==void 0?o:s,{owner:r}))}}for(const n in t)e[n]===void 0&&r.removeValue(n);return e}const Eb=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class f9{scrapeMotionValuesFromProps(e,t,n){return{}}constructor({parent:e,props:t,presenceContext:n,reducedMotionConfig:s,blockInitialAnimation:i,visualState:o},c={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=L0,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const _=Ms.now();this.renderScheduledAt<_&&(this.renderScheduledAt=_,gt.render(this.render,!1,!0))};const{latestValues:u,renderState:h,onUpdate:f}=o;this.onUpdate=f,this.latestValues=u,this.baseTarget={...u},this.initialValues=t.initial?{...u}:{},this.renderState=h,this.parent=e,this.props=t,this.presenceContext=n,this.depth=e?e.depth+1:0,this.reducedMotionConfig=s,this.options=c,this.blockInitialAnimation=!!i,this.isControllingVariants=xp(t),this.isVariantNode=rC(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:m,...y}=this.scrapeMotionValuesFromProps(t,{},this);for(const _ in y){const A=y[_];u[_]!==void 0&&Rn(A)&&A.set(u[_],!1)}}mount(e){this.current=e,wb.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,n)=>this.bindToMotionValue(n,t)),CI.current||c9(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:Wy.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){wb.delete(this.current),this.projection&&this.projection.unmount(),po(this.notifyUpdate),po(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const n=xa.has(e),s=t.on("change",c=>{this.latestValues[e]=c,this.props.onUpdate&&gt.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0)}),i=t.on("renderRequest",this.scheduleRender);let o;window.MotionCheckAppearSync&&(o=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{s(),i(),o&&o(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in ql){const t=ql[e];if(!t)continue;const{isEnabled:n,Feature:s}=t;if(!this.features[e]&&s&&n(this.props)&&(this.features[e]=new s(this)),this.features[e]){const i=this.features[e];i.isMounted?i.update():(i.mount(),i.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Ot()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let n=0;n<Eb.length;n++){const s=Eb[n];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const i="on"+s,o=e[i];o&&(this.propEventSubscriptions[s]=this.on(s,o))}this.prevMotionValues=d9(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const n=this.values.get(e);t!==n&&(n&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let n=this.values.get(e);return n===void 0&&t!==void 0&&(n=$u(t===null?void 0:t,{owner:this}),this.addValue(e,n)),n}readValue(e,t){var n;let s=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(n=this.getBaseTargetFromProps(this.props,e))!==null&&n!==void 0?n:this.readValueFromInstance(this.current,e,this.options);return s!=null&&(typeof s=="string"&&(qC(s)||VC(s))?s=parseFloat(s):!h9(s)&&mo.test(t)&&(s=HC(e,t)),this.setBaseTarget(e,Rn(s)?s.get():s)),Rn(s)?s.get():s}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var t;const{initial:n}=this.props;let s;if(typeof n=="string"||typeof n=="object"){const o=f0(this.props,n,(t=this.presenceContext)===null||t===void 0?void 0:t.custom);o&&(s=o[e])}if(n&&s!==void 0)return s;const i=this.getBaseTargetFromProps(this.props,e);return i!==void 0&&!Rn(i)?i:this.initialValues[e]!==void 0&&s===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new C0),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}}class II extends f9{constructor(){super(...arguments),this.KeyframeResolver=QC}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:n}){delete t[e],delete n[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Rn(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function p9(r){return window.getComputedStyle(r)}class m9 extends II{constructor(){super(...arguments),this.type="html",this.renderInstance=dC}readValueFromInstance(e,t){if(xa.has(t)){const n=D0(t);return n&&n.default||0}else{const n=p9(e),s=(cC(t)?n.getPropertyValue(t):n[t])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(e,{transformPagePoint:t}){return mI(e,t)}build(e,t,n){g0(e,t,n.transformTemplate)}scrapeMotionValuesFromProps(e,t,n){return w0(e,t,n)}}class g9 extends II{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Ot}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(xa.has(t)){const n=D0(t);return n&&n.default||0}return t=fC.has(t)?t:u0(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,n){return gC(e,t,n)}build(e,t,n){y0(e,t,this.isSVGTag,n.transformTemplate)}renderInstance(e,t,n,s){pC(e,t,n,s)}mount(e){this.isSVGTag=_0(e.tagName),super.mount(e)}}const kI=(r,e)=>d0(r)?new g9(e):new m9(e,{allowProjection:r!==V.Fragment}),y9=G6({...aI,...xI,...Q5,...l9},kI),At=a6(y9),v9={renderer:kI,...aI,...xI},_9={some:0,all:1};function w9(r,e,{root:t,margin:n,amount:s="some"}={}){const i=TC(r),o=new WeakMap,c=h=>{h.forEach(f=>{const m=o.get(f.target);if(f.isIntersecting!==!!m)if(f.isIntersecting){const y=e(f);typeof y=="function"?o.set(f.target,y):u.unobserve(f.target)}else typeof m=="function"&&(m(f),o.delete(f.target))})},u=new IntersectionObserver(c,{root:t,rootMargin:n,threshold:typeof s=="number"?s:_9[s]});return i.forEach(h=>u.observe(h)),()=>u.disconnect()}function E9(r,{root:e,margin:t,amount:n,once:s=!1}={}){const[i,o]=V.useState(!1);return V.useEffect(()=>{if(!r.current||s&&i)return;const c=()=>(o(!0),s?void 0:()=>o(!1)),u={root:e&&e.current||void 0,margin:t,amount:n};return w9(r.current,c,u)},[e,r,t,s,n]),i}const PI=V.createContext(),A9=({children:r})=>{const[e,t]=V.useState(()=>{const s=window.localStorage.getItem("theme");return s?s==="dark":window.matchMedia("(prefers-color-scheme: dark)").matches});V.useEffect(()=>{const s=window.document.documentElement;e?(s.classList.add("dark"),s.classList.remove("light")):(s.classList.add("light"),s.classList.remove("dark")),window.localStorage.setItem("theme",e?"dark":"light")},[e]);const n=V.useCallback(()=>{t(s=>!s)},[]);return L.jsx(PI.Provider,{value:{isDarkMode:e,toggleTheme:n},children:r})},b9=()=>V.useContext(PI),T9=({error:r})=>{const e=()=>window.location.reload(),t=()=>window.location.assign("/Costas_Portfolio/");return L.jsx("div",{className:"min-h-screen w-full flex items-center justify-center bg-background-alt-light dark:bg-background-alt-dark p-4",children:L.jsxs("div",{className:"text-center max-w-lg mx-auto",children:[L.jsx("div",{className:"mx-auto mb-6 h-16 w-16 flex items-center justify-center rounded-full bg-primary-light/10 dark:bg-primary-dark/10 text-primary-light dark:text-primary-dark",children:L.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:L.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),L.jsx("h1",{className:"text-3xl font-bold text-text-primary-light dark:text-text-primary-dark mb-2",children:"Oops, something went wrong!"}),L.jsx("p",{className:"text-text-secondary-light dark:text-text-secondary-dark mb-8",children:"An unexpected error has occurred. Please refresh the page or try again later."}),L.jsxs("div",{className:"flex justify-center items-center gap-4",children:[L.jsx("button",{onClick:e,className:"px-6 py-2 rounded-full font-semibold text-white bg-primary-light hover:bg-primary-hover dark:bg-primary-dark dark:hover:bg-primary-dark-hover transition-colors",children:"Refresh Page"}),L.jsx("button",{onClick:t,className:"px-6 py-2 rounded-full font-semibold text-text-primary-light dark:text-text-primary-dark bg-transparent border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:"Go to Home"})]}),!1]})})};class S9 extends ht.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("Uncaught error:",e,t)}render(){return this.state.hasError?L.jsx(T9,{error:this.state.error}):this.props.children}}const x9=ht.memo(()=>L.jsxs("div",{className:"fixed top-0 left-0 w-full h-full -z-10 overflow-hidden bg-background-light dark:bg-background-dark",children:[L.jsx("div",{className:"absolute top-1/2 left-1/2 w-[150vmax] h-[150vmax] bg-radial-gradient-primary dark:bg-radial-gradient-primary-dark animate-slow-spin"}),L.jsx("div",{className:"absolute top-1/2 left-1/2 w-[120vmax] h-[120vmax] bg-radial-gradient-secondary dark:bg-radial-gradient-secondary-dark animate-reverse-spin opacity-80"})]})),Ab=ht.memo(()=>{const r=({delay:e})=>L.jsx("div",{className:"w-4 h-4 bg-gradient-to-br from-primary-light to-secondary-light dark:from-primary-dark dark:to-secondary-dark rounded-full animate-pulse-bounce",style:{animationDelay:e}});return L.jsx("div",{className:"flex justify-center items-center h-screen bg-background-light dark:bg-background-dark",children:L.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[L.jsx(r,{delay:"0s"}),L.jsx(r,{delay:"0.2s"}),L.jsx(r,{delay:"0.4s"})]})})});var RI={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},bb=ht.createContext&&ht.createContext(RI),C9=["attr","size","title"];function I9(r,e){if(r==null)return{};var t=k9(r,e),n,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);for(s=0;s<i.length;s++)n=i[s],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(r,n)&&(t[n]=r[n])}return t}function k9(r,e){if(r==null)return{};var t={};for(var n in r)if(Object.prototype.hasOwnProperty.call(r,n)){if(e.indexOf(n)>=0)continue;t[n]=r[n]}return t}function Xf(){return Xf=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},Xf.apply(this,arguments)}function Tb(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),t.push.apply(t,n)}return t}function Yf(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Tb(Object(t),!0).forEach(function(n){P9(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):Tb(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function P9(r,e,t){return e=R9(e),e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function R9(r){var e=D9(r,"string");return typeof e=="symbol"?e:e+""}function D9(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function DI(r){return r&&r.map((e,t)=>ht.createElement(e.tag,Yf({key:t},e.attr),DI(e.child)))}function Bt(r){return e=>ht.createElement(L9,Xf({attr:Yf({},r.attr)},e),DI(r.child))}function L9(r){var e=t=>{var{attr:n,size:s,title:i}=r,o=I9(r,C9),c=s||t.size||"1em",u;return t.className&&(u=t.className),r.className&&(u=(u?u+" ":"")+r.className),ht.createElement("svg",Xf({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,n,o,{className:u,style:Yf(Yf({color:r.color||t.color},t.style),r.style),height:c,width:c,xmlns:"http://www.w3.org/2000/svg"}),i&&ht.createElement("title",null,i),r.children)};return bb!==void 0?ht.createElement(bb.Consumer,null,t=>e(t)):e(RI)}function M9(r){return Bt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119.252 8 8 119.252 8 256s111.252 248 248 248 248-111.252 248-248S392.748 8 256 8zm163.97 114.366c29.503 36.046 47.369 81.957 47.835 131.955-6.984-1.477-77.018-15.682-147.502-6.818-5.752-14.041-11.181-26.393-18.617-41.614 78.321-31.977 113.818-77.482 118.284-83.523zM396.421 97.87c-3.81 5.427-35.697 48.286-111.021 76.519-34.712-63.776-73.185-116.168-79.04-124.008 67.176-16.193 137.966 1.27 190.061 47.489zm-230.48-33.25c5.585 7.659 43.438 60.116 78.537 122.509-99.087 26.313-186.36 25.934-195.834 25.809C62.38 147.205 106.678 92.573 165.941 64.62zM44.17 256.323c0-2.166.043-4.322.108-6.473 9.268.19 111.92 1.513 217.706-30.146 6.064 11.868 11.857 23.915 17.174 35.949-76.599 21.575-146.194 83.527-180.531 142.306C64.794 360.405 44.17 310.73 44.17 256.323zm81.807 167.113c22.127-45.233 82.178-103.622 167.579-132.756 29.74 77.283 42.039 142.053 45.189 160.638-68.112 29.013-150.015 21.053-212.768-27.882zm248.38 8.489c-2.171-12.886-13.446-74.897-41.152-151.033 66.38-10.626 124.7 6.768 131.947 9.055-9.442 58.941-43.273 109.844-90.795 141.978z"},child:[]}]})(r)}function N9(r){return Bt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"},child:[]}]})(r)}function O9(r){return Bt({attr:{viewBox:"0 0 496 512"},child:[{tag:"path",attr:{d:"M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"},child:[]}]})(r)}function F9(r){return Bt({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"},child:[]}]})(r)}function V9(r){return Bt({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"},child:[]}]})(r)}function j9(r){return Bt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M418.2 177.2c-5.4-1.8-10.8-3.5-16.2-5.1.9-3.7 1.7-7.4 2.5-11.1 12.3-59.6 4.2-107.5-23.1-123.3-26.3-15.1-69.2.6-112.6 38.4-4.3 3.7-8.5 7.6-12.5 11.5-2.7-2.6-5.5-5.2-8.3-7.7-45.5-40.4-91.1-57.4-118.4-41.5-26.2 15.2-34 60.3-23 116.7 1.1 5.6 2.3 11.1 3.7 16.7-6.4 1.8-12.7 3.8-18.6 5.9C38.3 196.2 0 225.4 0 255.6c0 31.2 40.8 62.5 96.3 81.5 4.5 1.5 9 3 13.6 4.3-1.5 6-2.8 11.9-4 18-10.5 55.5-2.3 99.5 23.9 114.6 27 15.6 72.4-.4 116.6-39.1 3.5-3.1 7-6.3 10.5-9.7 4.4 4.3 9 8.4 13.6 12.4 42.8 36.8 85.1 51.7 111.2 36.6 27-15.6 35.8-62.9 24.4-120.5-.9-4.4-1.9-8.9-3-13.5 3.2-.9 6.3-1.9 9.4-2.9 57.7-19.1 99.5-50 99.5-81.7 0-30.3-39.4-59.7-93.8-78.4zM282.9 92.3c37.2-32.4 71.9-45.1 87.7-36 16.9 9.7 23.4 48.9 12.8 100.4-.7 3.4-1.4 6.7-2.3 10-22.2-5-44.7-8.6-67.3-10.6-13-18.6-27.2-36.4-42.6-53.1 3.9-3.7 7.7-7.2 11.7-10.7zM167.2 307.5c5.1 8.7 10.3 17.4 15.8 25.9-15.6-1.7-31.1-4.2-46.4-7.5 4.4-14.4 9.9-29.3 16.3-44.5 4.6 8.8 9.3 17.5 14.3 26.1zm-30.3-120.3c14.4-3.2 29.7-5.8 45.6-7.8-5.3 8.3-10.5 16.8-15.4 25.4-4.9 8.5-9.7 17.2-14.2 26-6.3-14.9-11.6-29.5-16-43.6zm27.4 68.9c6.6-13.8 13.8-27.3 21.4-40.6s15.8-26.2 24.4-38.9c15-1.1 30.3-1.7 45.9-1.7s31 .6 45.9 1.7c8.5 12.6 16.6 25.5 24.3 38.7s14.9 26.7 21.7 40.4c-6.7 13.8-13.9 27.4-21.6 40.8-7.6 13.3-15.7 26.2-24.2 39-14.9 1.1-30.4 1.6-46.1 1.6s-30.9-.5-45.6-1.4c-8.7-12.7-16.9-25.7-24.6-39s-14.8-26.8-21.5-40.6zm180.6 51.2c5.1-8.8 9.9-17.7 14.6-26.7 6.4 14.5 12 29.2 16.9 44.3-15.5 3.5-31.2 6.2-47 8 5.4-8.4 10.5-17 15.5-25.6zm14.4-76.5c-4.7-8.8-9.5-17.6-14.5-26.2-4.9-8.5-10-16.9-15.3-25.2 16.1 2 31.5 4.7 45.9 8-4.6 14.8-10 29.2-16.1 43.4zM256.2 118.3c10.5 11.4 20.4 23.4 29.6 35.8-19.8-.9-39.7-.9-59.5 0 9.8-12.9 19.9-24.9 29.9-35.8zM140.2 57c16.8-9.8 54.1 4.2 93.4 39 2.5 2.2 5 4.6 7.6 7-15.5 16.7-29.8 34.5-42.9 53.1-22.6 2-45 5.5-67.2 10.4-1.3-5.1-2.4-10.3-3.5-15.5-9.4-48.4-3.2-84.9 12.6-94zm-24.5 263.6c-4.2-1.2-8.3-2.5-12.4-3.9-21.3-6.7-45.5-17.3-63-31.2-10.1-7-16.9-17.8-18.8-29.9 0-18.3 31.6-41.7 77.2-57.6 5.7-2 11.5-3.8 17.3-5.5 6.8 21.7 15 43 24.5 63.6-9.6 20.9-17.9 42.5-24.8 64.5zm116.6 98c-16.5 15.1-35.6 27.1-56.4 35.3-11.1 5.3-23.9 5.8-35.3 1.3-15.9-9.2-22.5-44.5-13.5-92 1.1-5.6 2.3-11.2 3.7-16.7 22.4 4.8 45 8.1 67.9 9.8 13.2 18.7 27.7 36.6 43.2 53.4-3.2 3.1-6.4 6.1-9.6 8.9zm24.5-24.3c-10.2-11-20.4-23.2-30.3-36.3 9.6.4 19.5.6 29.5.6 10.3 0 20.4-.2 30.4-.7-9.2 12.7-19.1 24.8-29.6 36.4zm130.7 30c-.9 12.2-6.9 23.6-16.5 31.3-15.9 9.2-49.8-2.8-86.4-34.2-4.2-3.6-8.4-7.5-12.7-11.5 15.3-16.9 29.4-34.8 42.2-53.6 22.9-1.9 45.7-5.4 68.2-10.5 1 4.1 1.9 8.2 2.7 12.2 4.9 21.6 5.7 44.1 2.5 66.3zm18.2-107.5c-2.8.9-5.6 1.8-8.5 2.6-7-21.8-15.6-43.1-25.5-63.8 9.6-20.4 17.7-41.4 24.5-62.9 5.2 1.5 10.2 3.1 15 4.7 46.6 16 79.3 39.8 79.3 58 0 19.6-34.9 44.9-84.8 61.4zm-149.7-15c25.3 0 45.8-20.5 45.8-45.8s-20.5-45.8-45.8-45.8c-25.3 0-45.8 20.5-45.8 45.8s20.5 45.8 45.8 45.8z"},child:[]}]})(r)}function B9(r){return Bt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"},child:[]}]})(r)}function U9(r){return Bt({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M208 0c-29.9 0-54.7 20.5-61.8 48.2-.8 0-1.4-.2-2.2-.2-35.3 0-64 28.7-64 64 0 4.8.6 9.5 1.7 14C52.5 138 32 166.6 32 200c0 12.6 3.2 24.3 8.3 34.9C16.3 248.7 0 274.3 0 304c0 33.3 20.4 61.9 49.4 73.9-.9 4.6-1.4 9.3-1.4 14.1 0 39.8 32.2 72 72 72 4.1 0 8.1-.5 12-1.2 9.6 28.5 36.2 49.2 68 49.2 39.8 0 72-32.2 72-72V64c0-35.3-28.7-64-64-64zm368 304c0-29.7-16.3-55.3-40.3-69.1 5.2-10.6 8.3-22.3 8.3-34.9 0-33.4-20.5-62-49.7-74 1-4.5 1.7-9.2 1.7-14 0-35.3-28.7-64-64-64-.8 0-1.5.2-2.2.2C422.7 20.5 397.9 0 368 0c-35.3 0-64 28.6-64 64v376c0 39.8 32.2 72 72 72 31.8 0 58.4-20.7 68-49.2 3.9.7 7.9 1.2 12 1.2 39.8 0 72-32.2 72-72 0-4.8-.5-9.5-1.4-14.1 29-12 49.4-40.6 49.4-73.9z"},child:[]}]})(r)}function z9(r){return Bt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M332.8 320h38.4c6.4 0 12.8-6.4 12.8-12.8V172.8c0-6.4-6.4-12.8-12.8-12.8h-38.4c-6.4 0-12.8 6.4-12.8 12.8v134.4c0 6.4 6.4 12.8 12.8 12.8zm96 0h38.4c6.4 0 12.8-6.4 12.8-12.8V76.8c0-6.4-6.4-12.8-12.8-12.8h-38.4c-6.4 0-12.8 6.4-12.8 12.8v230.4c0 6.4 6.4 12.8 12.8 12.8zm-288 0h38.4c6.4 0 12.8-6.4 12.8-12.8v-70.4c0-6.4-6.4-12.8-12.8-12.8h-38.4c-6.4 0-12.8 6.4-12.8 12.8v70.4c0 6.4 6.4 12.8 12.8 12.8zm96 0h38.4c6.4 0 12.8-6.4 12.8-12.8V108.8c0-6.4-6.4-12.8-12.8-12.8h-38.4c-6.4 0-12.8 6.4-12.8 12.8v198.4c0 6.4 6.4 12.8 12.8 12.8zM496 384H64V80c0-8.84-7.16-16-16-16H16C7.16 64 0 71.16 0 80v336c0 17.67 14.33 32 32 32h464c8.84 0 16-7.16 16-16v-32c0-8.84-7.16-16-16-16z"},child:[]}]})(r)}function $9(r){return Bt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379 0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628 0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628 0l-22.627 22.627c-6.248 6.248-6.248 16.379 0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z"},child:[]}]})(r)}function H9(r){return Bt({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z"},child:[]}]})(r)}function W9(r){return Bt({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M278.9 511.5l-61-17.7c-6.4-1.8-10-8.5-8.2-14.9L346.2 8.7c1.8-6.4 8.5-10 14.9-8.2l61 17.7c6.4 1.8 10 8.5 8.2 14.9L293.8 503.3c-1.9 6.4-8.5 10.1-14.9 8.2zm-114-112.2l43.5-46.4c4.6-4.9 4.3-12.7-.8-17.2L117 256l90.6-79.7c5.1-4.5 5.5-12.3.8-17.2l-43.5-46.4c-4.5-4.8-12.1-5.1-17-.5L3.8 247.2c-5.1 4.7-5.1 12.8 0 17.5l144.1 135.1c4.9 4.6 12.5 4.4 17-.5zm327.2.6l144.1-135.1c5.1-4.7 5.1-12.8 0-17.5L492.1 112.1c-4.8-4.5-12.4-4.3-17 .5L431.6 159c-4.6 4.9-4.3 12.7.8 17.2L523 256l-90.6 79.7c-5.1 4.5-5.5 12.3-.8 17.2l43.5 46.4c4.5 4.9 12.1 5.1 17 .6z"},child:[]}]})(r)}function G9(r){return Bt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"},child:[]}]})(r)}function q9(r){return Bt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M216 0h80c13.3 0 24 10.7 24 24v168h87.7c17.8 0 26.7 21.5 14.1 34.1L269.7 378.3c-7.5 7.5-19.8 7.5-27.3 0L90.1 226.1c-12.6-12.6-3.7-34.1 14.1-34.1H192V24c0-13.3 10.7-24 24-24zm296 376v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h146.7l49 49c20.1 20.1 52.5 20.1 72.6 0l49-49H488c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z"},child:[]}]})(r)}function K9(r){return Bt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"},child:[]}]})(r)}function X9(r){return Bt({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"},child:[]}]})(r)}function Y9(r){return Bt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M283.211 512c78.962 0 151.079-35.925 198.857-94.792 7.068-8.708-.639-21.43-11.562-19.35-124.203 23.654-238.262-71.576-238.262-196.954 0-72.222 38.662-138.635 101.498-174.394 9.686-5.512 7.25-20.197-3.756-22.23A258.156 258.156 0 0 0 283.211 0c-141.309 0-256 114.511-256 256 0 141.309 114.511 256 256 256z"},child:[]}]})(r)}function Q9(r){return Bt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 160c-52.9 0-96 43.1-96 96s43.1 96 96 96 96-43.1 96-96-43.1-96-96-96zm246.4 80.5l-94.7-47.3 33.5-100.4c4.5-13.6-8.4-26.5-21.9-21.9l-100.4 33.5-47.4-94.8c-6.4-12.8-24.6-12.8-31 0l-47.3 94.7L92.7 70.8c-13.6-4.5-26.5 8.4-21.9 21.9l33.5 100.4-94.7 47.4c-12.8 6.4-12.8 24.6 0 31l94.7 47.3-33.5 100.5c-4.5 13.6 8.4 26.5 21.9 21.9l100.4-33.5 47.3 94.7c6.4 12.8 24.6 12.8 31 0l47.3-94.7 100.4 33.5c13.6 4.5 26.5-8.4 21.9-21.9l-33.5-100.4 94.7-47.3c13-6.5 13-24.7.2-31.1zm-155.9 106c-49.9 49.9-131.1 49.9-181 0-49.9-49.9-49.9-131.1 0-181 49.9-49.9 131.1-49.9 181 0 49.9 49.9 49.9 131.1 0 181z"},child:[]}]})(r)}function J9(r){return Bt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M501.1 395.7L384 278.6c-23.1-23.1-57.6-27.6-85.4-13.9L192 158.1V96L64 0 0 64l96 128h62.1l106.6 106.6c-13.6 27.8-9.2 62.3 13.9 85.4l117.1 117.1c14.6 14.6 38.2 14.6 52.7 0l52.7-52.7c14.5-14.6 14.5-38.2 0-52.7zM331.7 225c28.3 0 54.9 11 74.9 31l19.4 19.4c15.8-6.9 30.8-16.5 43.8-29.5 37.1-37.1 49.7-89.3 37.9-136.7-2.2-9-13.5-12.1-20.1-5.5l-74.4 74.4-67.9-11.3L334 98.9l74.4-74.4c6.6-6.6 3.4-17.9-5.7-20.2-47.4-11.7-99.6.9-136.6 37.9-28.5 28.5-41.9 66.1-41.2 103.6l82.1 82.1c8.1-1.9 16.5-2.9 24.7-2.9zm-103.9 82l-56.7-56.7L18.7 402.8c-25 25-25 65.5 0 90.5s65.5 25 90.5 0l123.6-123.6c-7.6-19.9-9.9-41.6-5-62.7zM64 472c-13.2 0-24-10.8-24-24 0-13.3 10.7-24 24-24s24 10.7 24 24c0 13.2-10.7 24-24 24z"},child:[]}]})(r)}function Z9(r){return Bt({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4z"},child:[]}]})(r)}const Sb=()=>{const{isDarkMode:r,toggleTheme:e}=b9();return L.jsx(At.button,{onClick:e,className:"p-2 rounded-full text-text-primary-light dark:text-text-primary-dark bg-slate-200/50 dark:bg-slate-800/80 hover:bg-slate-300/80 dark:hover:bg-slate-700/80 transition-colors focus:outline-none focus:ring-2 focus:ring-primary-light dark:focus:ring-primary-dark",whileHover:{scale:1.1},whileTap:{scale:.9},"aria-label":"Toggle theme",children:L.jsx(bp,{mode:"wait",initial:!1,children:L.jsx(At.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},exit:{y:20,opacity:0},transition:{duration:.2},children:r?L.jsx(Q9,{size:20}):L.jsx(Y9,{size:20})},r?"dark":"light")})})},e8=({href:r,label:e,children:t,onClick:n})=>L.jsxs("a",{href:r,onClick:n,className:"group relative flex items-center justify-center p-2 rounded-full text-text-secondary-light dark:text-text-secondary-dark hover:bg-primary-light/10 dark:hover:bg-primary-dark/10 hover:text-primary-light dark:hover:text-primary-dark transition-all duration-300","aria-label":e,children:[t,L.jsx("span",{className:"absolute left-full ml-3 px-3 py-1.5 whitespace-nowrap text-sm font-medium text-white dark:text-background-dark bg-text-primary-light dark:bg-text-primary-dark rounded-md shadow-md opacity-0 group-hover:opacity-100 translate-x-2 group-hover:translate-x-0 transition-all duration-300 pointer-events-none",children:e})]}),t8=ht.memo(({isMobileMenuOpen:r,toggleMobileMenu:e,closeMobileMenu:t})=>{const n=[{href:"#about",label:"About"},{href:"#experience",label:"Experience"},{href:"#skills",label:"Skills"},{href:"#projects",label:"Projects"},{href:"#contact",label:"Contact"}],s=i=>{i.preventDefault();const o=i.currentTarget.getAttribute("href"),c=document.querySelector(o);t(),c&&setTimeout(()=>{c.scrollIntoView({behavior:"smooth",block:"start"})},100)};return L.jsxs("header",{className:"bg-white/80 dark:bg-background-dark/80 backdrop-blur-md fixed top-0 w-full z-50 border-b border-primary-light/10 dark:border-primary-dark/20",children:[L.jsxs("nav",{className:"container mx-auto px-6 py-4 flex justify-between items-center",children:[L.jsx(e8,{href:"#home",label:"Home",onClick:s,children:L.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:L.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1z"})})}),L.jsxs("div",{className:"hidden md:flex space-x-6 items-center font-medium text-text-secondary-light dark:text-text-secondary-dark",children:[n.map(i=>L.jsx("a",{href:i.href,onClick:s,className:"hover:text-secondary-light dark:hover:text-secondary-dark transition-colors",children:i.label},i.href)),L.jsx(Sb,{})]}),L.jsxs("div",{className:"md:hidden flex items-center space-x-4",children:[L.jsx(Sb,{}),L.jsx("button",{onClick:e,className:"text-text-primary-light dark:text-text-primary-dark focus:outline-none p-1","aria-label":"Toggle menu",children:L.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r?L.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"}):L.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})]})]}),L.jsx(bp,{children:r&&L.jsx(At.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3,ease:"easeInOut"},className:"md:hidden absolute top-full left-0 w-full bg-background-light dark:bg-background-dark z-40 shadow-lg px-6 py-4 space-y-3 text-text-secondary-light dark:text-text-secondary-dark font-medium",children:n.map(i=>L.jsx("a",{href:i.href,onClick:s,className:"block py-2 hover:text-secondary-light dark:hover:text-secondary-dark",children:i.label},i.href))})})]})});function kp(r,e,t,n){return new(t||(t=Promise))(function(s,i){function o(h){try{u(n.next(h))}catch(f){i(f)}}function c(h){try{u(n.throw(h))}catch(f){i(f)}}function u(h){var f;h.done?s(h.value):(f=h.value,f instanceof t?f:new t(function(m){m(f)})).then(o,c)}u((n=n.apply(r,[])).next())})}function so(r,e){var t,n,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function c(u){return function(h){return function(f){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(s=2&f[0]?n.return:f[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,f[1])).done)return s;switch(n=0,s&&(f=[2&f[0],s.value]),f[0]){case 0:case 1:s=f;break;case 4:return o.label++,{value:f[1],done:!1};case 5:o.label++,n=f[1],f=[0];continue;case 7:f=o.ops.pop(),o.trys.pop();continue;default:if(s=o.trys,!((s=s.length>0&&s[s.length-1])||f[0]!==6&&f[0]!==2)){o=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){o.label=f[1];break}if(f[0]===6&&o.label<s[1]){o.label=s[1],s=f;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(f);break}s[2]&&o.ops.pop(),o.trys.pop();continue}f=e.call(r,o)}catch(m){f=[6,m],n=0}finally{t=s=0}if(5&f[0])throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}([u,h])}}}function Gy(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Yr(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var n,s,i=t.call(r),o=[];try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)o.push(n.value)}catch(c){s={error:c}}finally{try{n&&!n.done&&(t=i.return)&&t.call(i)}finally{if(s)throw s.error}}return o}function Ts(r,e,t){if(arguments.length===2)for(var n,s=0,i=e.length;s<i;s++)!n&&s in e||(n||(n=Array.prototype.slice.call(e,0,s)),n[s]=e[s]);return r.concat(n||Array.prototype.slice.call(e))}function xb(r,e,t,n,s){for(var i=[],o=5;o<arguments.length;o++)i[o-5]=arguments[o];return kp(this,void 0,void 0,function(){var c,u,h,f,m,y;return so(this,function(_){switch(_.label){case 0:_.trys.push([0,12,13,14]),c=Gy(i),u=c.next(),_.label=1;case 1:if(u.done)return[3,11];switch(h=u.value,typeof h){case"string":return[3,2];case"number":return[3,4];case"function":return[3,6]}return[3,8];case 2:return[4,n8(r,e,h,t,n,s)];case 3:return _.sent(),[3,10];case 4:return[4,LI(h)];case 5:return _.sent(),[3,10];case 6:return[4,h.apply(void 0,Ts([r,e,t,n,s],Yr(i),!1))];case 7:return _.sent(),[3,10];case 8:return[4,h];case 9:_.sent(),_.label=10;case 10:return u=c.next(),[3,1];case 11:return[3,14];case 12:return f=_.sent(),m={error:f},[3,14];case 13:try{u&&!u.done&&(y=c.return)&&y.call(c)}finally{if(m)throw m.error}return[7];case 14:return[2]}})})}function n8(r,e,t,n,s,i){return kp(this,void 0,void 0,function(){var o,c;return so(this,function(u){switch(u.label){case 0:return o=r.textContent||"",c=function(h,f){var m=Yr(f).slice(0);return Ts(Ts([],Yr(h),!1),[NaN],!1).findIndex(function(y,_){return m[_]!==y})}(o,t),[4,r8(r,Ts(Ts([],Yr(i8(o,e,c)),!1),Yr(s8(t,e,c)),!1),n,s,i)];case 1:return u.sent(),[2]}})})}function LI(r){return kp(this,void 0,void 0,function(){return so(this,function(e){switch(e.label){case 0:return[4,new Promise(function(t){return setTimeout(t,r)})];case 1:return e.sent(),[2]}})})}function r8(r,e,t,n,s){return kp(this,void 0,void 0,function(){var i,o,c,u,h,f,m,y,_,A,b,T,x;return so(this,function(M){switch(M.label){case 0:if(i=e,s){for(o=0,c=1;c<e.length;c++)if(u=Yr([e[c-1],e[c]],2),h=u[0],(f=u[1]).length>h.length||f===""){o=c;break}i=e.slice(o,e.length)}M.label=1;case 1:M.trys.push([1,6,7,8]),m=Gy(function(R){var B,O,$,k,C,P,N;return so(this,function(j){switch(j.label){case 0:B=function(z){return so(this,function(F){switch(F.label){case 0:return[4,{op:function(ue){return requestAnimationFrame(function(){return ue.textContent=z})},opCode:function(ue){var ke=ue.textContent||"";return z===""||ke.length>z.length?"DELETE":"WRITING"}}];case 1:return F.sent(),[2]}})},j.label=1;case 1:j.trys.push([1,6,7,8]),O=Gy(R),$=O.next(),j.label=2;case 2:return $.done?[3,5]:(k=$.value,[5,B(k)]);case 3:j.sent(),j.label=4;case 4:return $=O.next(),[3,2];case 5:return[3,8];case 6:return C=j.sent(),P={error:C},[3,8];case 7:try{$&&!$.done&&(N=O.return)&&N.call(O)}finally{if(P)throw P.error}return[7];case 8:return[2]}})}(i)),y=m.next(),M.label=2;case 2:return y.done?[3,5]:(_=y.value,A=_.opCode(r)==="WRITING"?t+t*(Math.random()-.5):n+n*(Math.random()-.5),_.op(r),[4,LI(A)]);case 3:M.sent(),M.label=4;case 4:return y=m.next(),[3,2];case 5:return[3,8];case 6:return b=M.sent(),T={error:b},[3,8];case 7:try{y&&!y.done&&(x=m.return)&&x.call(m)}finally{if(T)throw T.error}return[7];case 8:return[2]}})})}function s8(r,e,t){var n,s;return t===void 0&&(t=0),so(this,function(i){switch(i.label){case 0:n=e(r),s=n.length,i.label=1;case 1:return t<s?[4,n.slice(0,++t).join("")]:[3,3];case 2:return i.sent(),[3,1];case 3:return[2]}})}function i8(r,e,t){var n,s;return t===void 0&&(t=0),so(this,function(i){switch(i.label){case 0:n=e(r),s=n.length,i.label=1;case 1:return s>t?[4,n.slice(0,--s).join("")]:[3,3];case 2:return i.sent(),[3,1];case 3:return[2]}})}var o8="index-module_type__E-SaG";(function(r,e){e===void 0&&(e={});var t=e.insertAt;if(typeof document<"u"){var n=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",t==="top"&&n.firstChild?n.insertBefore(s,n.firstChild):n.appendChild(s),s.styleSheet?s.styleSheet.cssText=r:s.appendChild(document.createTextNode(r))}})(`.index-module_type__E-SaG::after {
  content: '|';
  animation: index-module_cursor__PQg0P 1.1s infinite step-start;
}

@keyframes index-module_cursor__PQg0P {
  50% {
    opacity: 0;
  }
}
`);var a8=V.memo(V.forwardRef(function(r,e){var t=r.sequence,n=r.repeat,s=r.className,i=r.speed,o=i===void 0?40:i,c=r.deletionSpeed,u=r.omitDeletionAnimation,h=u!==void 0&&u,f=r.preRenderFirstString,m=f!==void 0&&f,y=r.wrapper,_=y===void 0?"span":y,A=r.splitter,b=A===void 0?function(ee){return Ts([],Yr(ee),!1)}:A,T=r.cursor,x=T===void 0||T,M=r.style,R=function(ee,W){var Y={};for(var ae in ee)Object.prototype.hasOwnProperty.call(ee,ae)&&W.indexOf(ae)<0&&(Y[ae]=ee[ae]);if(ee!=null&&typeof Object.getOwnPropertySymbols=="function"){var _e=0;for(ae=Object.getOwnPropertySymbols(ee);_e<ae.length;_e++)W.indexOf(ae[_e])<0&&Object.prototype.propertyIsEnumerable.call(ee,ae[_e])&&(Y[ae[_e]]=ee[ae[_e]])}return Y}(r,["sequence","repeat","className","speed","deletionSpeed","omitDeletionAnimation","preRenderFirstString","wrapper","splitter","cursor","style"]),B=R["aria-label"],O=R["aria-hidden"],$=R.role;c||(c=o);var k=new Array(2).fill(40);[o,c].forEach(function(ee,W){switch(typeof ee){case"number":k[W]=Math.abs(ee-100);break;case"object":var Y=ee.type,ae=ee.value;if(typeof ae!="number")break;Y==="keyStrokeDelayInMs"&&(k[W]=ae)}});var C,P,N,j,z,F,ue=k[0],ke=k[1],ie=function(ee,W){W===void 0&&(W=null);var Y=V.useRef(W);return V.useEffect(function(){ee&&(typeof ee=="function"?ee(Y.current):ee.current=Y.current)},[ee]),Y}(e),Z=o8;C=s?"".concat(x?Z+" ":"").concat(s):x?Z:"",P=V.useRef(function(){var ee,W=t;n===1/0?ee=xb:typeof n=="number"&&(W=Array(1+n).fill(t).flat());var Y=ee?Ts(Ts([],Yr(W),!1),[ee],!1):Ts([],Yr(W),!1);return xb.apply(void 0,Ts([ie.current,b,ue,ke,h],Yr(Y),!1)),function(){ie.current}}),N=V.useRef(),j=V.useRef(!1),z=V.useRef(!1),F=Yr(V.useState(0),2)[1],j.current&&(z.current=!0),V.useEffect(function(){return j.current||(N.current=P.current(),j.current=!0),F(function(ee){return ee+1}),function(){z.current&&N.current&&N.current()}},[]);var te=_,de=m?t.find(function(ee){return typeof ee=="string"})||"":null;return ht.createElement(te,{"aria-hidden":O,"aria-label":B,role:$,style:M,className:C,children:B?ht.createElement("span",{"aria-hidden":"true",ref:ie,children:de}):de,ref:B?void 0:ie})}),function(r,e){return!0});const l8="/Costas_Portfolio/assets/Hero-DEFoMTO8.png",c8=ht.memo(()=>L.jsx("section",{id:"home",className:`relative min-h-screen flex items-center justify-center text-center md:text-left bg-background-light dark:bg-background-dark overflow-hidden\r
      before:absolute before:inset-0 before:w-full before:h-full before:bg-[linear-gradient(to_right,rgba(30,41,59,0.05)_1px,transparent_1px),linear-gradient(to_bottom,rgba(30,41,59,0.05)_1px,transparent_1px)]\r
      dark:before:bg-[linear-gradient(to_right,rgba(203,213,225,0.05)_1px,transparent_1px),linear-gradient(to_bottom,rgba(203,213,225,0.05)_1px,transparent_1px)]\r
      before:bg-[size:40px_40px]`,children:L.jsxs("div",{className:"relative z-10 container mx-auto px-6 py-20 grid md:grid-cols-5 gap-8 items-center",children:[L.jsxs("div",{className:"md:col-span-3",children:[L.jsxs("h1",{className:"text-5xl md:text-7xl font-extrabold text-text-primary-light dark:text-text-primary-dark mb-4",children:[L.jsx("span",{className:"block mb-2 text-xl font-medium text-text-secondary-light dark:text-text-secondary-dark",children:"Hello, I'm"}),"Costas Pinto"]}),L.jsx("div",{children:L.jsx(a8,{sequence:["AI Innovator",2e3,"Data Analyst",2e3,"Data Scientist",2e3,"Problem Solver",2e3,"Creative Thinker",2e3],wrapper:"p",speed:50,className:"text-2xl md:text-3xl font-semibold mb-6 bg-clip-text text-transparent bg-gradient-to-r from-primary-light to-secondary-light dark:from-primary-dark dark:to-secondary-dark h-10",repeat:1/0})}),L.jsx("p",{className:"max-w-xl text-text-secondary-light dark:text-text-secondary-dark leading-relaxed mb-8 mx-auto md:mx-0",children:"Transforming raw data into actionable insights. I build intelligent systems and solve complex problems with a passion for machine learning and data visualization."}),L.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center md:justify-start gap-6",children:[L.jsxs(At.a,{href:"/CostasPinto_CV.pdf",download:"CostasPinto_CV.pdf",whileHover:{scale:1.05},whileTap:{scale:.95},className:"flex items-center justify-center gap-2 bg-gradient-to-r from-primary-light to-secondary-light dark:from-primary-dark dark:to-secondary-dark text-white dark:text-text-primary-dark font-bold py-3 px-8 rounded-full shadow-lg transition-all",children:[L.jsx(q9,{}),"Download CV"]}),L.jsxs("div",{className:"flex gap-4",children:[L.jsx(At.a,{whileHover:{y:-3},href:"https://www.linkedin.com/in/costaspinto/",target:"_blank",rel:"noopener noreferrer",className:"text-text-secondary-light dark:text-text-secondary-dark hover:text-secondary-light dark:hover:text-secondary-dark transition-colors",children:L.jsx(V9,{size:32})}),L.jsx(At.a,{whileHover:{y:-3},href:"https://github.com/MrCoss",target:"_blank",rel:"noopener noreferrer",className:"text-text-secondary-light dark:text-text-secondary-dark hover:text-secondary-light dark:hover:text-secondary-dark transition-colors",children:L.jsx(O9,{size:32})})]})]})]}),L.jsx(At.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{duration:.8,delay:.2,ease:[0,.71,.2,1.01]},className:"md:col-span-2 flex justify-center items-center",children:L.jsxs("div",{className:"relative w-[300px] h-[300px] md:w-[400px] md:h-[400px]",children:[L.jsx("div",{className:"absolute -inset-2 bg-gradient-to-r from-primary-light to-secondary-light dark:from-primary-dark dark:to-secondary-dark rounded-full blur-2xl opacity-50 dark:opacity-40"}),L.jsx("div",{className:"relative w-full h-full rounded-full overflow-hidden shadow-2xl border-2 border-primary-light/20 dark:border-primary-dark/20",children:L.jsx("img",{loading:"lazy",src:l8,onError:r=>{r.target.src="https://placehold.co/400x400/ffffff/1e293b?text=CP"},alt:"Costas Pinto",className:"w-full h-full object-cover"})})]})})]})})),_o=ht.memo(({children:r,id:e,className:t=""})=>{const n={hidden:{opacity:0,y:40},visible:{opacity:1,y:0,transition:{duration:.8,ease:[.25,.1,.25,1]}}};return L.jsx(At.section,{id:e,variants:n,initial:"hidden",whileInView:"visible",viewport:{once:!0,amount:.2},className:`py-16 md:py-20 ${t}`,children:r})}),wo=ht.memo(()=>{const r=V.useRef(null),e=E9(r,{once:!0,amount:.5}),t={hidden:{scaleX:0},visible:{scaleX:1,transition:{duration:.8,ease:[.25,1,.5,1]}}};return L.jsx("div",{ref:r,className:"h-1 w-24 mx-auto my-8",children:L.jsx(At.div,{className:"h-full bg-gradient-to-r from-primary to-secondary rounded-full",style:{transformOrigin:"center"},variants:t,initial:"hidden",animate:e?"visible":"hidden"})})}),u8=ht.memo(()=>L.jsxs(_o,{id:"about",children:[L.jsx("h2",{className:"text-4xl font-bold text-text-primary-light dark:text-text-primary-dark text-center",children:"About Me"}),L.jsx(wo,{}),L.jsx("div",{className:"relative p-8 md:p-12 max-w-4xl mx-auto rounded-2xl bg-white/20 dark:bg-background-dark/20 backdrop-blur-lg border border-white/30 dark:border-white/10 shadow-lg transition-all duration-300 hover:shadow-2xl hover:shadow-primary-light/20 dark:hover:shadow-primary-dark/20 hover:-translate-y-1",children:L.jsx("p",{className:"text-lg leading-relaxed text-text-primary-light/90 dark:text-text-primary-dark/90 text-center",children:"As an MCA student at Manipal University, Jaipur, with a background in Computer Science, I am deeply immersed in the fields of data analytics and machine learning. My internship at SkillFied Mentor solidified my expertise in data exploration, visualization, and interpretation using key technologies like Python, Excel, and Power BI. I am passionate about making complex subjects accessible and have a proven track record of doing so as the founder of JHT SMART STEPS LEARNING. I am now eager to apply my analytical skills and technical knowledge to solve new challenges in the AI and ML industry."})})]})),h8=ht.memo(({date:r,title:e,company:t,details:n})=>L.jsxs(At.div,{whileHover:{x:5},transition:{type:"spring",stiffness:300},className:"relative pl-8 py-4 border-l-2 border-primary-light/20 dark:border-primary-dark/20",children:[L.jsx("div",{className:"absolute -left-[11px] top-6 w-5 h-5 bg-gradient-to-br from-primary-light to-secondary-light dark:from-primary-dark dark:to-secondary-dark rounded-full border-4 border-background-light dark:border-background-dark"}),L.jsx("p",{className:"text-text-secondary-light dark:text-text-secondary-dark mb-1 font-medium",children:r}),L.jsx("h3",{className:"text-2xl font-bold text-text-primary-light dark:text-text-primary-dark",children:e}),L.jsx("p",{className:"text-lg text-primary-light dark:text-primary-dark font-semibold mb-3",children:t}),L.jsx("ul",{className:"list-disc list-inside text-text-secondary-light dark:text-text-secondary-dark space-y-2",children:n.map((s,i)=>L.jsx("li",{children:s},i))})]})),d8=ht.memo(()=>{const r=[{date:"Aug 2025 - Present",title:"Machine Learning Intern",company:"Unified Mentor (Remote)",details:["Worked on AI-powered solutions and applied advanced ML algorithms to real-world challenges.","Gained hands-on experience with Python, data preprocessing, and model development.","Collaborated with industry professionals and received mentorship on best practices in AI/ML."]},{date:"2024 - Present",title:"Data Analyst Intern",company:"SkillFied Mentor (Remote)",details:["Collected, cleaned, and preprocessed datasets from diverse sources.","Performed exploratory data analysis (EDA) using Python, Excel, and Power BI.","Generated actionable insights to support internal strategy and client deliverables."]},{date:"2022 - Present",title:"Founder",company:"JHT SMART STEPS LEARNING (On-site)",details:["Leveraged technology to make education accessible and easy to understand.","Created personalized lesson plans and educational resources for students.","Tracked and assessed student progress, offering one-on-one coaching."]}];return L.jsxs(_o,{id:"experience",children:[L.jsx("h2",{className:"text-4xl font-bold text-text-primary-light dark:text-text-primary-dark text-center",children:"Experience"}),L.jsx(wo,{}),L.jsx("div",{className:"max-w-3xl mx-auto space-y-12",children:r.map((e,t)=>L.jsx(h8,{...e},t))})]})}),f8=ht.memo(()=>{const[r,e]=V.useState("Programming Languages"),t=c=>{e(u=>u===c?null:c)},n={"Programming Languages":[{name:"Python",level:90},{name:"JavaScript",level:85},{name:"Java",level:75},{name:"SQL",level:80}],"Data Science & Analytics":[{name:"Data Analysis",level:90},{name:"Machine Learning",level:75},{name:"Power BI",level:85},{name:"Excel",level:95}],"Web & App Development":[{name:"React",level:85},{name:"Firebase",level:80},{name:"Tailwind CSS",level:80},{name:"Streamlit",level:75}],"AI & Generative AI":[{name:"Generative AI Concepts",level:85},{name:"Prompt Engineering",level:90},{name:"LangChain",level:75}],"Tools & Workflow":[{name:"Git & GitHub",level:95},{name:"Version Control",level:90}]},s={"Programming Languages":L.jsx(W9,{className:"mr-3 text-primary-light dark:text-primary-dark"}),"Data Science & Analytics":L.jsx(z9,{className:"mr-3 text-primary-light dark:text-primary-dark"}),"Web & App Development":L.jsx(j9,{className:"mr-3 text-secondary-light dark:text-secondary-dark"}),"AI & Generative AI":L.jsx(U9,{className:"mr-3 text-primary-light dark:text-primary-dark"}),"Tools & Workflow":L.jsx(J9,{className:"mr-3 text-text-secondary-light dark:text-text-secondary-dark"})},i={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},o={hidden:{y:20,opacity:0},visible:{y:0,opacity:1}};return L.jsxs(_o,{id:"skills",children:[L.jsx("h2",{className:"text-4xl font-bold text-text-primary-light dark:text-text-primary-dark text-center",children:"My Skills"}),L.jsx(wo,{}),L.jsx("div",{className:"relative p-4 md:p-8 max-w-4xl mx-auto rounded-2xl bg-white/20 dark:bg-background-alt-dark/20 backdrop-blur-lg border border-white/30 dark:border-white/10 shadow-lg dark:shadow-2xl dark:shadow-primary-dark/10 transition-all duration-300 hover:shadow-2xl hover:shadow-primary-light/20 dark:hover:shadow-primary-dark/20 hover:-translate-y-1",children:L.jsx("div",{className:"space-y-2",children:Object.entries(n).map(([c,u])=>L.jsxs("div",{className:"border-b border-primary-light/20 dark:border-primary-dark/20 last:border-b-0",children:[L.jsxs("button",{onClick:()=>t(c),className:"w-full flex justify-between items-center py-4 text-left text-xl font-semibold text-text-primary-light dark:text-text-primary-dark focus:outline-none",children:[L.jsxs("span",{className:"flex items-center",children:[s[c],c]}),L.jsx(At.span,{animate:{rotate:r===c?180:0},children:L.jsx(H9,{className:"w-5 h-5 transition-colors duration-300 text-text-secondary-light dark:text-text-secondary-dark"})})]}),L.jsx(bp,{children:r===c&&L.jsx(At.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3,ease:"easeInOut"},className:"overflow-hidden",children:L.jsx(At.div,{variants:i,initial:"hidden",animate:"visible",className:"grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-4 pt-2 pb-6 px-2",children:u.map(h=>L.jsxs(At.div,{variants:o,children:[L.jsx("p",{className:"text-lg font-medium text-text-secondary-light dark:text-text-secondary-dark mb-1",children:h.name}),L.jsx("div",{className:"bg-primary-light/10 dark:bg-primary-dark/10 w-full rounded-full h-2.5",children:L.jsx(At.div,{className:"h-2.5 rounded-full bg-gradient-to-r from-primary-light to-secondary-light dark:from-primary-dark dark:to-secondary-dark",initial:{width:0},animate:{width:`${h.level}%`},transition:{duration:1,ease:"easeOut"}})})]},h.name))})})})]},c))})})]})}),p8=ht.memo(()=>L.jsxs(_o,{id:"achievements",children:[L.jsx("h2",{className:"text-4xl font-bold text-text-primary-light dark:text-text-primary-dark text-center",children:"Key Achievements"}),L.jsx(wo,{}),L.jsx("div",{className:"relative p-8 md:p-12 max-w-4xl mx-auto rounded-2xl bg-white/20 dark:bg-background-dark/20 backdrop-blur-lg border border-white/30 dark:border-white/10 shadow-lg transition-all duration-300 hover:shadow-2xl hover:shadow-primary-light/20 dark:hover:shadow-primary-dark/20 hover:-translate-y-1",children:L.jsx("ul",{className:"space-y-4 text-lg text-text-primary-light/90 dark:text-text-primary-dark/90",children:[{id:1,text:"Completed <strong>60+ Certifications</strong> from IBM, Google, Meta, Microsoft, and Forage."},{id:2,text:"Built and deployed <strong>25+ AI/Data/Full-stack projects</strong> solving real-world problems."},{id:3,text:"Earned top-tier recognitions in job simulations at <strong>BCG, Lloyds, BA, EA, TATA</strong>, and more."},{id:4,text:"Founded <strong>JHT SMART STEPS LEARNING</strong> – empowering students through digital education."}].map(r=>L.jsxs("li",{className:"flex items-start",children:[L.jsx("span",{className:"text-primary-light dark:text-primary-dark mr-3 mt-1 font-bold",children:"✓"}),L.jsx("span",{dangerouslySetInnerHTML:{__html:r.text}})]},r.id))})})]})),m8=ht.memo(({year:r,title:e,details:t,icon:n})=>L.jsxs(At.div,{className:"relative pl-12 py-4 border-l-2 border-primary-light/20 dark:border-primary-dark/20",initial:{opacity:0,x:-20},whileInView:{opacity:1,x:0},viewport:{once:!0,amount:.5},transition:{duration:.6},children:[L.jsx("div",{className:"absolute -left-[26px] top-4 w-12 h-12 bg-background-light dark:bg-background-dark rounded-full border-4 border-primary-light/20 dark:border-primary-dark/20 flex items-center justify-center shadow-md",children:n}),L.jsx("p",{className:"text-secondary-light dark:text-secondary-dark mb-1 font-semibold",children:r}),L.jsx("h3",{className:"text-2xl font-bold text-text-primary-light dark:text-text-primary-dark",children:e}),L.jsx("p",{className:"text-text-secondary-light dark:text-text-secondary-dark mt-1",children:t})]})),g8=ht.memo(()=>{const r=[{year:"2023",title:"Foundation & Exploration",details:"Built a strong programming foundation in Python and Java while exploring front-end development. Developed and trained my first predictive models, sparking a passion for machine learning.",icon:L.jsx("svg",{className:"w-6 h-6 text-primary-light dark:text-primary-dark",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:L.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"})})},{year:"2024",title:"Accelerated Growth & Specialization",details:"Completed over 60 certifications from industry leaders like Google, IBM, and Meta, specializing in AI, Data Science, and Full-Stack Development to deepen my expertise.",icon:L.jsx("svg",{className:"w-6 h-6 text-primary-light dark:text-primary-dark",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:L.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"})})},{year:"Ongoing",title:"Application & Innovation",details:"Actively applying knowledge through internships and real-world projects. Continuously exploring new AI architectures and contributing to open-source repositories to stay at the forefront of technology.",icon:L.jsx("svg",{className:"w-6 h-6 text-primary-light dark:text-primary-dark",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:L.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})})}];return L.jsxs(_o,{id:"journey",children:[L.jsx("h2",{className:"text-4xl font-bold text-text-primary-light dark:text-text-primary-dark text-center",children:"My Learning Journey"}),L.jsx(wo,{}),L.jsx("div",{className:"relative p-8 md:p-12 max-w-4xl mx-auto rounded-2xl bg-white/20 dark:bg-background-alt-dark/20 backdrop-blur-lg border border-white/30 dark:border-white/10 shadow-lg shadow-primary-light/10 dark:shadow-primary-dark/10 transition-all duration-300 hover:shadow-2xl hover:shadow-primary-light/20 dark:hover:shadow-primary-dark/20 hover:-translate-y-1",children:L.jsx("div",{className:"space-y-12",children:r.map(e=>L.jsx(m8,{...e},e.title))})})]})}),y8=V.memo(({mediaUrl:r,title:e})=>{if(!r)return L.jsx("img",{loading:"lazy",src:"https://placehold.co/600x400/e2e8f0/334155?text=Project",alt:e,className:"rounded-lg mb-4 aspect-video object-cover border border-primary-light/10 dark:border-primary-dark/20"});const t=[".mp4",".webm",".mov"].some(n=>r.toLowerCase().includes(n));return r.toLowerCase().includes("pdf"),t?L.jsx("video",{src:r,controls:!0,className:"rounded-lg mb-4 aspect-video object-cover border border-primary-light/10 dark:border-primary-dark/20 w-full",children:"Your browser does not support the video tag."}):L.jsx("div",{className:"rounded-lg mb-4 aspect-video border border-primary-light/10 dark:border-primary-dark/20 w-full flex flex-col items-center justify-center bg-background-alt-light dark:bg-background-alt-dark transition-colors",children:L.jsx("img",{loading:"lazy",src:r,alt:e,className:"w-full h-full object-cover",onError:n=>{r.includes("pdf")?n.target.src="https://placehold.co/600x400/e2e8f0/334155?text=PDF":n.target.src="https://placehold.co/600x400/e2e8f0/334155?text=Project"}})})}),v8=V.memo(({projects:r})=>{const e={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.15}}},t={hidden:{y:20,opacity:0},visible:{y:0,opacity:1}};return L.jsxs(_o,{id:"projects",children:[L.jsx("h2",{className:"text-4xl font-bold text-text-primary-light dark:text-text-primary-dark text-center",children:"My Projects"}),L.jsx(wo,{}),L.jsx("div",{className:"min-h-[60vh] w-full",children:r.length>0?L.jsx(At.div,{variants:e,initial:"hidden",whileInView:"visible",viewport:{once:!0,amount:.1},className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:r.map(n=>L.jsxs(At.div,{variants:t,className:"p-6 flex flex-col rounded-2xl bg-white dark:bg-background-alt-dark shadow-lg dark:shadow-2xl dark:shadow-slate-900/50 border border-primary-light/10 dark:border-primary-dark/20 md:bg-white/20 md:dark:bg-slate-800/20 md:backdrop-blur-lg md:border-white/30 transition-all duration-300 md:hover:shadow-2xl md:hover:shadow-primary-light/20 md:hover:-translate-y-1 overflow-hidden",children:[L.jsx(y8,{mediaUrl:n.mediaUrl,title:n.title}),L.jsx("h3",{className:"text-xl font-bold text-text-primary-light dark:text-text-primary-dark mb-2",children:n.title}),L.jsx("p",{className:"text-text-secondary-light dark:text-text-secondary-dark flex-grow mb-4",children:n.description}),L.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:n.tags?.map(s=>L.jsx("span",{className:"bg-primary-light/10 dark:bg-primary-dark/10 text-primary-light dark:text-primary-dark text-xs font-medium px-2.5 py-1 rounded-full",children:s},s))}),n.link&&L.jsx("a",{href:n.link,target:"_blank",rel:"noopener noreferrer",className:"mt-auto text-center font-semibold text-secondary-light dark:text-secondary-dark border border-secondary-light dark:border-secondary-dark rounded-full py-2 px-4 hover:bg-secondary-light dark:hover:bg-secondary-dark hover:text-white dark:hover:text-background-dark transition-all duration-300 z-10",children:"View Project"})]},n.id))}):L.jsx("div",{className:"min-h-[20vh] flex justify-center items-center",children:L.jsx("p",{className:"text-center text-text-secondary-light dark:text-text-secondary-dark text-lg",children:"No projects found. Please add some from the admin panel."})})})]})}),Fn=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),qy=[.001,0,0,.001,0,0],qg=1.35,ar={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Ss={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},MI="pdfjs_internal_editor_",Oe={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,SIGNATURE:101},qe={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},NI={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Sn={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Cu={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Mt={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},wl={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},ph={ERRORS:0,WARNINGS:1,INFOS:5},Gu={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},Yd={moveTo:0,lineTo:1,curveTo:2,closePath:3},OI={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Pp=ph.WARNINGS;function _8(r){Number.isInteger(r)&&(Pp=r)}function w8(){return Pp}function Rp(r){Pp>=ph.INFOS&&console.log(`Info: ${r}`)}function Ve(r){Pp>=ph.WARNINGS&&console.log(`Warning: ${r}`)}function it(r){throw new Error(r)}function Wt(r,e){r||it(e)}function E8(r){switch(r?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function F0(r,e=null,t=null){if(!r)return null;if(t&&typeof r=="string"&&(t.addDefaultProtocol&&r.startsWith("www.")&&r.match(/\./g)?.length>=2&&(r=`http://${r}`),t.tryConvertEncoding))try{r=x8(r)}catch{}const n=e?URL.parse(r,e):URL.parse(r);return E8(n)?n:null}function V0(r,e,t=!1){const n=URL.parse(r);return n?(n.hash=e,n.href):t&&F0(r,"http://example.com")?r.split("#",1)[0]+`${e?`#${e}`:""}`:""}function We(r,e,t,n=!1){return Object.defineProperty(r,e,{value:t,enumerable:!n,configurable:!0,writable:!1}),t}const Ca=function(){function e(t,n){this.message=t,this.name=n}return e.prototype=new Error,e.constructor=e,e}();class Cb extends Ca{constructor(e,t){super(e,"PasswordException"),this.code=t}}class Kg extends Ca{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class Qf extends Ca{constructor(e){super(e,"InvalidPDFException")}}class qu extends Ca{constructor(e,t,n){super(e,"ResponseException"),this.status=t,this.missing=n}}class A8 extends Ca{constructor(e){super(e,"FormatError")}}class yi extends Ca{constructor(e){super(e,"AbortException")}}function FI(r){(typeof r!="object"||r?.length===void 0)&&it("Invalid argument for bytesToString");const e=r.length,t=8192;if(e<t)return String.fromCharCode.apply(null,r);const n=[];for(let s=0;s<e;s+=t){const i=Math.min(s+t,e),o=r.subarray(s,i);n.push(String.fromCharCode.apply(null,o))}return n.join("")}function mh(r){typeof r!="string"&&it("Invalid argument for stringToBytes");const e=r.length,t=new Uint8Array(e);for(let n=0;n<e;++n)t[n]=r.charCodeAt(n)&255;return t}function b8(r){return String.fromCharCode(r>>24&255,r>>16&255,r>>8&255,r&255)}function T8(){const r=new Uint8Array(4);return r[0]=1,new Uint32Array(r.buffer,0,1)[0]===1}function S8(){try{return new Function(""),!0}catch{return!1}}class ln{static get isLittleEndian(){return We(this,"isLittleEndian",T8())}static get isEvalSupported(){return We(this,"isEvalSupported",S8())}static get isOffscreenCanvasSupported(){return We(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return We(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){const{platform:e,userAgent:t}=navigator;return We(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){return We(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const Xg=Array.from(Array(256).keys(),r=>r.toString(16).padStart(2,"0"));class be{static makeHexColor(e,t,n){return`#${Xg[e]}${Xg[t]}${Xg[n]}`}static scaleMinMax(e,t){let n;e[0]?(e[0]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[3],t[3]*=e[3]):(n=t[0],t[0]=t[1],t[1]=n,n=t[2],t[2]=t[3],t[3]=n,e[1]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t,n=0){const s=e[n],i=e[n+1];e[n]=s*t[0]+i*t[2]+t[4],e[n+1]=s*t[1]+i*t[3]+t[5]}static applyTransformToBezier(e,t,n=0){const s=t[0],i=t[1],o=t[2],c=t[3],u=t[4],h=t[5];for(let f=0;f<6;f+=2){const m=e[n+f],y=e[n+f+1];e[n+f]=m*s+y*o+u,e[n+f+1]=m*i+y*c+h}}static applyInverseTransform(e,t){const n=e[0],s=e[1],i=t[0]*t[3]-t[1]*t[2];e[0]=(n*t[3]-s*t[2]+t[2]*t[5]-t[4]*t[3])/i,e[1]=(-n*t[1]+s*t[0]+t[4]*t[1]-t[5]*t[0])/i}static axialAlignedBoundingBox(e,t,n){const s=t[0],i=t[1],o=t[2],c=t[3],u=t[4],h=t[5],f=e[0],m=e[1],y=e[2],_=e[3];let A=s*f+u,b=A,T=s*y+u,x=T,M=c*m+h,R=M,B=c*_+h,O=B;if(i!==0||o!==0){const $=i*f,k=i*y,C=o*m,P=o*_;A+=C,x+=C,T+=P,b+=P,M+=$,O+=$,B+=k,R+=k}n[0]=Math.min(n[0],A,T,b,x),n[1]=Math.min(n[1],M,B,R,O),n[2]=Math.max(n[2],A,T,b,x),n[3]=Math.max(n[3],M,B,R,O)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const n=e[0],s=e[1],i=e[2],o=e[3],c=n**2+s**2,u=n*i+s*o,h=i**2+o**2,f=(c+h)/2,m=Math.sqrt(f**2-(c*h-u**2));t[0]=Math.sqrt(f+m||1),t[1]=Math.sqrt(f-m||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const n=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),s=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(n>s)return null;const i=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),o=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return i>o?null:[n,i,s,o]}static pointBoundingBox(e,t,n){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}static rectBoundingBox(e,t,n,s,i){i[0]=Math.min(i[0],e,n),i[1]=Math.min(i[1],t,s),i[2]=Math.max(i[2],e,n),i[3]=Math.max(i[3],t,s)}static#e(e,t,n,s,i,o,c,u,h,f){if(h<=0||h>=1)return;const m=1-h,y=h*h,_=y*h,A=m*(m*(m*e+3*h*t)+3*y*n)+_*s,b=m*(m*(m*i+3*h*o)+3*y*c)+_*u;f[0]=Math.min(f[0],A),f[1]=Math.min(f[1],b),f[2]=Math.max(f[2],A),f[3]=Math.max(f[3],b)}static#t(e,t,n,s,i,o,c,u,h,f,m,y){if(Math.abs(h)<1e-12){Math.abs(f)>=1e-12&&this.#e(e,t,n,s,i,o,c,u,-m/f,y);return}const _=f**2-4*m*h;if(_<0)return;const A=Math.sqrt(_),b=2*h;this.#e(e,t,n,s,i,o,c,u,(-f+A)/b,y),this.#e(e,t,n,s,i,o,c,u,(-f-A)/b,y)}static bezierBoundingBox(e,t,n,s,i,o,c,u,h){h[0]=Math.min(h[0],e,c),h[1]=Math.min(h[1],t,u),h[2]=Math.max(h[2],e,c),h[3]=Math.max(h[3],t,u),this.#t(e,n,i,c,t,s,o,u,3*(-e+3*(n-i)+c),6*(e-2*n+i),3*(n-e),h),this.#t(e,n,i,c,t,s,o,u,3*(-t+3*(s-o)+u),6*(t-2*s+o),3*(s-t),h)}}function x8(r){return decodeURIComponent(escape(r))}let Yg=null,Ib=null;function VI(r){return Yg||(Yg=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Ib=new Map([["ﬅ","ſt"]])),r.replaceAll(Yg,(e,t,n)=>t?t.normalize("NFKC"):Ib.get(n))}function j0(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const r=new Uint8Array(32);return crypto.getRandomValues(r),FI(r)}const B0="pdfjs_internal_id_";function C8(r,e,t){if(!Array.isArray(t)||t.length<2)return!1;const[n,s,...i]=t;if(!r(n)&&!Number.isInteger(n)||!e(s))return!1;const o=i.length;let c=!0;switch(s.name){case"XYZ":if(o<2||o>3)return!1;break;case"Fit":case"FitB":return o===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(o>1)return!1;break;case"FitR":if(o!==4)return!1;c=!1;break;default:return!1}for(const u of i)if(!(typeof u=="number"||c&&u===null))return!1;return!0}function Cn(r,e,t){return Math.min(Math.max(r,e),t)}function jI(r){return Uint8Array.prototype.toBase64?r.toBase64():btoa(FI(r))}function I8(r){return Uint8Array.fromBase64?Uint8Array.fromBase64(r):mh(atob(r))}typeof Promise.try!="function"&&(Promise.try=function(r,...e){return new Promise(t=>{t(r(...e))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(r){return r.reduce((e,t)=>e+t,0)});const ni="http://www.w3.org/2000/svg";class ma{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function lc(r,e="text"){if(pu(r,document.baseURI)){const t=await fetch(r);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,n)=>{const s=new XMLHttpRequest;s.open("GET",r,!0),s.responseType=e,s.onreadystatechange=()=>{if(s.readyState===XMLHttpRequest.DONE){if(s.status===200||s.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(s.response);return}t(s.responseText);return}n(new Error(s.statusText))}},s.send(null)})}class gh{constructor({viewBox:e,userUnit:t,scale:n,rotation:s,offsetX:i=0,offsetY:o=0,dontFlip:c=!1}){this.viewBox=e,this.userUnit=t,this.scale=n,this.rotation=s,this.offsetX=i,this.offsetY=o,n*=t;const u=(e[2]+e[0])/2,h=(e[3]+e[1])/2;let f,m,y,_;switch(s%=360,s<0&&(s+=360),s){case 180:f=-1,m=0,y=0,_=1;break;case 90:f=0,m=1,y=1,_=0;break;case 270:f=0,m=-1,y=-1,_=0;break;case 0:f=1,m=0,y=0,_=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}c&&(y=-y,_=-_);let A,b,T,x;f===0?(A=Math.abs(h-e[1])*n+i,b=Math.abs(u-e[0])*n+o,T=(e[3]-e[1])*n,x=(e[2]-e[0])*n):(A=Math.abs(u-e[0])*n+i,b=Math.abs(h-e[1])*n+o,T=(e[2]-e[0])*n,x=(e[3]-e[1])*n),this.transform=[f*n,m*n,y*n,_*n,A-f*n*u-y*n*h,b-m*n*u-_*n*h],this.width=T,this.height=x}get rawDims(){const e=this.viewBox;return We(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:n=this.offsetX,offsetY:s=this.offsetY,dontFlip:i=!1}={}){return new gh({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:s,dontFlip:i})}convertToViewportPoint(e,t){const n=[e,t];return be.applyTransform(n,this.transform),n}convertToViewportRectangle(e){const t=[e[0],e[1]];be.applyTransform(t,this.transform);const n=[e[2],e[3]];return be.applyTransform(n,this.transform),[t[0],t[1],n[0],n[1]]}convertToPdfPoint(e,t){const n=[e,t];return be.applyInverseTransform(n,this.transform),n}}class Dp extends Ca{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function yh(r){const e=r.length;let t=0;for(;t<e&&r[t].trim()==="";)t++;return r.substring(t,t+5).toLowerCase()==="data:"}function Lp(r){return typeof r=="string"&&/\.pdf$/i.test(r)}function BI(r){return[r]=r.split(/[#?]/,1),r.substring(r.lastIndexOf("/")+1)}function UI(r,e="document.pdf"){if(typeof r!="string")return e;if(yh(r))return Ve('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const n=(c=>{try{return new URL(c)}catch{try{return new URL(decodeURIComponent(c))}catch{try{return new URL(c,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(c),"https://foo.bar")}catch{return null}}}}})(r);if(!n)return e;const s=c=>{try{let u=decodeURIComponent(c);return u.includes("/")?(u=u.split("/").at(-1),u.test(/^\.pdf$/i)?u:c):u}catch{return c}},i=/\.pdf$/i,o=n.pathname.split("/").at(-1);if(i.test(o))return s(o);if(n.searchParams.size>0){const c=Array.from(n.searchParams.values()).reverse();for(const h of c)if(i.test(h))return s(h);const u=Array.from(n.searchParams.keys()).reverse();for(const h of u)if(i.test(h))return s(h)}if(n.hash){const u=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(n.hash);if(u)return s(u[0])}return e}class kb{started=Object.create(null);times=[];time(e){e in this.started&&Ve(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||Ve(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:n}of this.times)t=Math.max(n.length,t);for(const{name:n,start:s,end:i}of this.times)e.push(`${n.padEnd(t)} ${i-s}ms
`);return e.join("")}}function pu(r,e){const t=e?URL.parse(r,e):URL.parse(r);return t?.protocol==="http:"||t?.protocol==="https:"}function Rr(r){r.preventDefault()}function Vt(r){r.preventDefault(),r.stopPropagation()}function k8(r){console.log("Deprecated API usage: "+r)}class U0{static#e;static toDateObject(e){if(!e||typeof e!="string")return null;this.#e||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const t=this.#e.exec(e);if(!t)return null;const n=parseInt(t[1],10);let s=parseInt(t[2],10);s=s>=1&&s<=12?s-1:0;let i=parseInt(t[3],10);i=i>=1&&i<=31?i:1;let o=parseInt(t[4],10);o=o>=0&&o<=23?o:0;let c=parseInt(t[5],10);c=c>=0&&c<=59?c:0;let u=parseInt(t[6],10);u=u>=0&&u<=59?u:0;const h=t[7]||"Z";let f=parseInt(t[8],10);f=f>=0&&f<=23?f:0;let m=parseInt(t[9],10)||0;return m=m>=0&&m<=59?m:0,h==="-"?(o+=f,c+=m):h==="+"&&(o-=f,c-=m),new Date(Date.UTC(n,s,i,o,c,u))}}function zI(r,{scale:e=1,rotation:t=0}){const{width:n,height:s}=r.attributes.style,i=[0,0,parseInt(n),parseInt(s)];return new gh({viewBox:i,userUnit:1,scale:e,rotation:t})}function z0(r){if(r.startsWith("#")){const e=parseInt(r.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return r.startsWith("rgb(")?r.slice(4,-1).split(",").map(e=>parseInt(e)):r.startsWith("rgba(")?r.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(Ve(`Not a valid color format: "${r}"`),[0,0,0])}function P8(r){const e=document.createElement("span");e.style.visibility="hidden",e.style.colorScheme="only light",document.body.append(e);for(const t of r.keys()){e.style.color=t;const n=window.getComputedStyle(e).color;r.set(t,z0(n))}e.remove()}function St(r){const{a:e,b:t,c:n,d:s,e:i,f:o}=r.getTransform();return[e,t,n,s,i,o]}function vs(r){const{a:e,b:t,c:n,d:s,e:i,f:o}=r.getTransform().invertSelf();return[e,t,n,s,i,o]}function go(r,e,t=!1,n=!0){if(e instanceof gh){const{pageWidth:s,pageHeight:i}=e.rawDims,{style:o}=r,c=ln.isCSSRoundSupported,u=`var(--total-scale-factor) * ${s}px`,h=`var(--total-scale-factor) * ${i}px`,f=c?`round(down, ${u}, var(--scale-round-x))`:`calc(${u})`,m=c?`round(down, ${h}, var(--scale-round-y))`:`calc(${h})`;!t||e.rotation%180===0?(o.width=f,o.height=m):(o.width=m,o.height=f)}n&&r.setAttribute("data-main-rotation",e.rotation)}class ns{constructor(){const{pixelRatio:e}=ns;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(e,t,n,s,i=-1){let o=1/0,c=1/0,u=1/0;n=ns.capPixels(n,i),n>0&&(o=Math.sqrt(n/(e*t))),s!==-1&&(c=s/e,u=s/t);const h=Math.min(o,c,u);return this.sx>h||this.sy>h?(this.sx=h,this.sy=h,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,t){if(t>=0){const n=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+t/100));return e>0?Math.min(e,n):n}return e}}const Jf=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class Iu{#e=null;#t=null;#n;#r=null;#i=null;#s=null;static#a=null;constructor(e){this.#n=e,Iu.#a||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"})}render(){const e=this.#e=document.createElement("div");e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=this.#n._uiManager._signal;e.addEventListener("contextmenu",Rr,{signal:t}),e.addEventListener("pointerdown",Iu.#o,{signal:t});const n=this.#r=document.createElement("div");n.className="buttons",e.append(n);const s=this.#n.toolbarPosition;if(s){const{style:i}=e,o=this.#n._uiManager.direction==="ltr"?1-s[0]:s[0];i.insetInlineEnd=`${100*o}%`,i.top=`calc(${100*s[1]}% + var(--editor-toolbar-vert-offset))`}return e}get div(){return this.#e}static#o(e){e.stopPropagation()}#h(e){this.#n._focusEventsAllowed=!1,Vt(e)}#l(e){this.#n._focusEventsAllowed=!0,Vt(e)}#d(e){const t=this.#n._uiManager._signal;e.addEventListener("focusin",this.#h.bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",this.#l.bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",Rr,{signal:t})}hide(){this.#e.classList.add("hidden"),this.#t?.hideDropdown()}show(){this.#e.classList.remove("hidden"),this.#i?.shown()}addDeleteButton(){const{editorType:e,_uiManager:t}=this.#n,n=document.createElement("button");n.className="delete",n.tabIndex=0,n.setAttribute("data-l10n-id",Iu.#a[e]),this.#d(n),n.addEventListener("click",s=>{t.delete()},{signal:t._signal}),this.#r.append(n)}get#u(){const e=document.createElement("div");return e.className="divider",e}async addAltText(e){const t=await e.render();this.#d(t),this.#r.append(t,this.#u),this.#i=e}addColorPicker(e){this.#t=e;const t=e.renderButton();this.#d(t),this.#r.append(t,this.#u)}async addEditSignatureButton(e){const t=this.#s=await e.renderEditButton(this.#n);this.#d(t),this.#r.append(t,this.#u)}async addButton(e,t){switch(e){case"colorPicker":this.addColorPicker(t);break;case"altText":await this.addAltText(t);break;case"editSignature":await this.addEditSignatureButton(t);break;case"delete":this.addDeleteButton();break}}updateEditSignatureButton(e){this.#s&&(this.#s.title=e)}remove(){this.#e.remove(),this.#t?.destroy(),this.#t=null}}class R8{#e=null;#t=null;#n;constructor(e){this.#n=e}#r(){const e=this.#t=document.createElement("div");e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",Rr,{signal:this.#n._signal});const t=this.#e=document.createElement("div");return t.className="buttons",e.append(t),this.#s(),e}#i(e,t){let n=0,s=0;for(const i of e){const o=i.y+i.height;if(o<n)continue;const c=i.x+(t?i.width:0);if(o>n){s=c,n=o;continue}t?c>s&&(s=c):c<s&&(s=c)}return[t?1-s:s,n]}show(e,t,n){const[s,i]=this.#i(t,n),{style:o}=this.#t||=this.#r();e.append(this.#t),o.insetInlineEnd=`${100*s}%`,o.top=`calc(${100*i}% + var(--editor-toolbar-vert-offset))`}hide(){this.#t.remove()}#s(){const e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const n=this.#n._signal;e.addEventListener("contextmenu",Rr,{signal:n}),e.addEventListener("click",()=>{this.#n.highlightSelection("floating_button")},{signal:n}),this.#e.append(e)}}function $I(r,e,t){for(const n of t)e.addEventListener(n,r[n].bind(r))}class D8{#e=0;get id(){return`${MI}${this.#e++}`}}class $0{#e=j0();#t=0;#n=null;static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',n=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),s=new Image;s.src=e;const i=s.decode().then(()=>(n.drawImage(s,0,0,1,1,0,0,1,3),new Uint32Array(n.getImageData(0,0,1,1).data.buffer)[0]===0));return We(this,"_isSVGFittingCanvas",i)}async#r(e,t){this.#n||=new Map;let n=this.#n.get(e);if(n===null)return null;if(n?.bitmap)return n.refCounter+=1,n;try{n||={bitmap:null,id:`image_${this.#e}_${this.#t++}`,refCounter:0,isSvg:!1};let s;if(typeof t=="string"?(n.url=t,s=await lc(t,"blob")):t instanceof File?s=n.file=t:t instanceof Blob&&(s=t),s.type==="image/svg+xml"){const i=$0._isSVGFittingCanvas,o=new FileReader,c=new Image,u=new Promise((h,f)=>{c.onload=()=>{n.bitmap=c,n.isSvg=!0,h()},o.onload=async()=>{const m=n.svgUrl=o.result;c.src=await i?`${m}#svgView(preserveAspectRatio(none))`:m},c.onerror=o.onerror=f});o.readAsDataURL(s),await u}else n.bitmap=await createImageBitmap(s);n.refCounter=1}catch(s){Ve(s),n=null}return this.#n.set(e,n),n&&this.#n.set(n.id,n),n}async getFromFile(e){const{lastModified:t,name:n,size:s,type:i}=e;return this.#r(`${t}_${n}_${s}_${i}`,e)}async getFromUrl(e){return this.#r(e,e)}async getFromBlob(e,t){const n=await t;return this.#r(e,n)}async getFromId(e){this.#n||=new Map;const t=this.#n.get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:n}=t;return delete t.blobPromise,this.getFromBlob(t.id,n)}return this.getFromUrl(t.url)}getFromCanvas(e,t){this.#n||=new Map;let n=this.#n.get(e);if(n?.bitmap)return n.refCounter+=1,n;const s=new OffscreenCanvas(t.width,t.height);return s.getContext("2d").drawImage(t,0,0),n={bitmap:s.transferToImageBitmap(),id:`image_${this.#e}_${this.#t++}`,refCounter:1,isSvg:!1},this.#n.set(e,n),this.#n.set(n.id,n),n}getSvgUrl(e){const t=this.#n.get(e);return t?.isSvg?t.svgUrl:null}deleteId(e){this.#n||=new Map;const t=this.#n.get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:n}=t;if(!t.url&&!t.file){const s=new OffscreenCanvas(n.width,n.height);s.getContext("bitmaprenderer").transferFromImageBitmap(n),t.blobPromise=s.convertToBlob()}n.close?.(),t.bitmap=null}isValidId(e){return e.startsWith(`image_${this.#e}_`)}}class L8{#e=[];#t=!1;#n;#r=-1;constructor(e=128){this.#n=e}add({cmd:e,undo:t,post:n,mustExec:s,type:i=NaN,overwriteIfSameType:o=!1,keepUndo:c=!1}){if(s&&e(),this.#t)return;const u={cmd:e,undo:t,post:n,type:i};if(this.#r===-1){this.#e.length>0&&(this.#e.length=0),this.#r=0,this.#e.push(u);return}if(o&&this.#e[this.#r].type===i){c&&(u.undo=this.#e[this.#r].undo),this.#e[this.#r]=u;return}const h=this.#r+1;h===this.#n?this.#e.splice(0,1):(this.#r=h,h<this.#e.length&&this.#e.splice(h)),this.#e.push(u)}undo(){if(this.#r===-1)return;this.#t=!0;const{undo:e,post:t}=this.#e[this.#r];e(),t?.(),this.#t=!1,this.#r-=1}redo(){if(this.#r<this.#e.length-1){this.#r+=1,this.#t=!0;const{cmd:e,post:t}=this.#e[this.#r];e(),t?.(),this.#t=!1}}hasSomethingToUndo(){return this.#r!==-1}hasSomethingToRedo(){return this.#r<this.#e.length-1}cleanType(e){if(this.#r!==-1){for(let t=this.#r;t>=0;t--)if(this.#e[t].type!==e){this.#e.splice(t+1,this.#r-t),this.#r=t;return}this.#e.length=0,this.#r=-1}}destroy(){this.#e=null}}class vh{constructor(e){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=ln.platform;for(const[n,s,i={}]of e)for(const o of n){const c=o.startsWith("mac+");t&&c?(this.callbacks.set(o.slice(4),{callback:s,options:i}),this.allKeys.add(o.split("+").at(-1))):!t&&!c&&(this.callbacks.set(o,{callback:s,options:i}),this.allKeys.add(o.split("+").at(-1)))}}#e(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t}exec(e,t){if(!this.allKeys.has(t.key))return;const n=this.callbacks.get(this.#e(t));if(!n)return;const{callback:s,options:{bubbles:i=!1,args:o=[],checker:c=null}}=n;c&&!c(e,t)||(s.bind(e,...o,t)(),i||Vt(t))}}class H0{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return P8(e),We(this,"_colors",e)}convert(e){const t=z0(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[n,s]of this._colors)if(s.every((i,o)=>i===t[o]))return H0._colorsMapping.get(n);return t}getHexCode(e){const t=this._colors.get(e);return t?be.makeHexColor(...t):e}}class vi{#e=new AbortController;#t=null;#n=new Map;#r=new Map;#i=null;#s=null;#a=null;#o=new L8;#h=null;#l=null;#d=0;#u=new Set;#f=null;#p=null;#m=new Set;_editorUndoBar=null;#c=!1;#g=!1;#y=!1;#v=null;#w=null;#E=null;#A=null;#S=!1;#C=null;#k=new D8;#b=!1;#I=!1;#x=null;#R=null;#D=null;#L=null;#B=null;#T=Oe.NONE;#_=new Set;#F=null;#V=null;#$=null;#H=null;#W={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#U=[0,0];#M=null;#N=null;#z=null;#X=null;#O=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const e=vi.prototype,t=o=>o.#N.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&o.hasSomethingToControl(),n=(o,{target:c})=>{if(c instanceof HTMLInputElement){const{type:u}=c;return u!=="text"&&u!=="number"}return!0},s=this.TRANSLATE_SMALL,i=this.TRANSLATE_BIG;return We(this,"_keyboardManager",new vh([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:n}],[["ctrl+z","mac+meta+z"],e.undo,{checker:n}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:n}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:n}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(o,{target:c})=>!(c instanceof HTMLButtonElement)&&o.#N.contains(c)&&!o.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(o,{target:c})=>!(c instanceof HTMLButtonElement)&&o.#N.contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-s,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[s,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-s],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,s],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:t}]]))}constructor(e,t,n,s,i,o,c,u,h,f,m,y,_,A,b){const T=this._signal=this.#e.signal;this.#N=e,this.#z=t,this.#X=n,this.#i=s,this.#V=i,this._eventBus=o,o._on("editingaction",this.onEditingAction.bind(this),{signal:T}),o._on("pagechanging",this.onPageChanging.bind(this),{signal:T}),o._on("scalechanging",this.onScaleChanging.bind(this),{signal:T}),o._on("rotationchanging",this.onRotationChanging.bind(this),{signal:T}),o._on("setpreference",this.onSetPreference.bind(this),{signal:T}),o._on("switchannotationeditorparams",x=>this.updateParams(x.type,x.value),{signal:T}),this.#se(),this.#le(),this.#Q(),this.#s=c.annotationStorage,this.#v=c.filterFactory,this.#$=u,this.#A=h||null,this.#c=f,this.#g=m,this.#y=y,this.#B=_||null,this.viewParameters={realScale:ma.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=A||null,this._supportsPinchToZoom=b!==!1}destroy(){this.#O?.resolve(),this.#O=null,this.#e?.abort(),this.#e=null,this._signal=null;for(const e of this.#r.values())e.destroy();this.#r.clear(),this.#n.clear(),this.#m.clear(),this.#L?.clear(),this.#t=null,this.#_.clear(),this.#o.destroy(),this.#i?.destroy(),this.#V?.destroy(),this.#C?.hide(),this.#C=null,this.#D?.destroy(),this.#D=null,this.#w&&(clearTimeout(this.#w),this.#w=null),this.#M&&(clearTimeout(this.#M),this.#M=null),this._editorUndoBar?.destroy()}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return this.#B}get useNewAltTextFlow(){return this.#g}get useNewAltTextWhenAddingImage(){return this.#y}get hcmFilter(){return We(this,"hcmFilter",this.#$?this.#v.addHCMFilter(this.#$.foreground,this.#$.background):"none")}get direction(){return We(this,"direction",getComputedStyle(this.#N).direction)}get highlightColors(){return We(this,"highlightColors",this.#A?new Map(this.#A.split(",").map(e=>(e=e.split("=").map(t=>t.trim()),e[1]=e[1].toUpperCase(),e))):null)}get highlightColorNames(){return We(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#l=e}setMainHighlightColorPicker(e){this.#D=e}editAltText(e,t=!1){this.#i?.editAltText(this,e,t)}getSignature(e){this.#V?.getSignature({uiManager:this,editor:e})}get signatureManager(){return this.#V}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":this.#y=t;break}}onPageChanging({pageNumber:e}){this.#d=e-1}focusMainContainer(){this.#N.focus()}findParent(e,t){for(const n of this.#r.values()){const{x:s,y:i,width:o,height:c}=n.div.getBoundingClientRect();if(e>=s&&e<=s+o&&t>=i&&t<=i+c)return n}return null}disableUserSelect(e=!1){this.#z.classList.toggle("noUserSelect",e)}addShouldRescale(e){this.#m.add(e)}removeShouldRescale(e){this.#m.delete(e)}onScaleChanging({scale:e}){this.commitOrRemove(),this.viewParameters.realScale=e*ma.PDF_TO_CSS_UNITS;for(const t of this.#m)t.onScaleChanging();this.#l?.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}#q({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e}#Y(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const n of this.#r.values())if(n.hasTextLayer(e))return n;return null}highlightSelection(e=""){const t=document.getSelection();if(!t||t.isCollapsed)return;const{anchorNode:n,anchorOffset:s,focusNode:i,focusOffset:o}=t,c=t.toString(),h=this.#q(t).closest(".textLayer"),f=this.getSelectionBoxes(h);if(!f)return;t.empty();const m=this.#Y(h),y=this.#T===Oe.NONE,_=()=>{m?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:f,anchorNode:n,anchorOffset:s,focusNode:i,focusOffset:o,text:c}),y&&this.showAllEditors("highlight",!0,!0)};if(y){this.switchToMode(Oe.HIGHLIGHT,_);return}_()}#ne(){const e=document.getSelection();if(!e||e.isCollapsed)return;const n=this.#q(e).closest(".textLayer"),s=this.getSelectionBoxes(n);s&&(this.#C||=new R8(this),this.#C.show(n,s,this.direction==="ltr"))}addToAnnotationStorage(e){!e.isEmpty()&&this.#s&&!this.#s.has(e.id)&&this.#s.setValue(e.id,e)}a11yAlert(e,t=null){const n=this.#X;n&&(n.setAttribute("data-l10n-id",e),t?n.setAttribute("data-l10n-args",JSON.stringify(t)):n.removeAttribute("data-l10n-args"))}#re(){const e=document.getSelection();if(!e||e.isCollapsed){this.#F&&(this.#C?.hide(),this.#F=null,this.#P({hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===this.#F)return;const s=this.#q(e).closest(".textLayer");if(!s){this.#F&&(this.#C?.hide(),this.#F=null,this.#P({hasSelectedText:!1}));return}if(this.#C?.hide(),this.#F=t,this.#P({hasSelectedText:!0}),!(this.#T!==Oe.HIGHLIGHT&&this.#T!==Oe.NONE)&&(this.#T===Oe.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#S=this.isShiftKeyDown,!this.isShiftKeyDown)){const i=this.#T===Oe.HIGHLIGHT?this.#Y(s):null;i?.toggleDrawing();const o=new AbortController,c=this.combinedSignal(o),u=h=>{h.type==="pointerup"&&h.button!==0||(o.abort(),i?.toggleDrawing(!0),h.type==="pointerup"&&this.#K("main_toolbar"))};window.addEventListener("pointerup",u,{signal:c}),window.addEventListener("blur",u,{signal:c})}}#K(e=""){this.#T===Oe.HIGHLIGHT?this.highlightSelection(e):this.#c&&this.#ne()}#se(){document.addEventListener("selectionchange",this.#re.bind(this),{signal:this._signal})}#ie(){if(this.#E)return;this.#E=new AbortController;const e=this.combinedSignal(this.#E);window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})}#oe(){this.#E?.abort(),this.#E=null}blur(){if(this.isShiftKeyDown=!1,this.#S&&(this.#S=!1,this.#K("main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of this.#_)if(t.div.contains(e)){this.#R=[t,e],t._focusEventsAllowed=!1;break}}focus(){if(!this.#R)return;const[e,t]=this.#R;this.#R=null,t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}#Q(){if(this.#x)return;this.#x=new AbortController;const e=this.combinedSignal(this.#x);window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})}#ae(){this.#x?.abort(),this.#x=null}#J(){if(this.#h)return;this.#h=new AbortController;const e=this.combinedSignal(this.#h);document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})}#Z(){this.#h?.abort(),this.#h=null}#le(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})}addEditListeners(){this.#Q(),this.#J()}removeEditListeners(){this.#ae(),this.#Z()}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const n of this.#p)if(n.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const n of this.#p)if(n.isHandlingMimeForPasting(t.type)){n.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){if(e.preventDefault(),this.#t?.commitOrRemove(),!this.hasSelection)return;const t=[];for(const n of this.#_){const s=n.serialize(!0);s&&t.push(s)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const i of t.items)for(const o of this.#p)if(o.isHandlingMimeForPasting(i.type)){o.paste(i,this.currentLayer);return}let n=t.getData("application/pdfjs");if(!n)return;try{n=JSON.parse(n)}catch(i){Ve(`paste: "${i.message}".`);return}if(!Array.isArray(n))return;this.unselectAll();const s=this.currentLayer;try{const i=[];for(const u of n){const h=await s.deserialize(u);if(!h)return;i.push(h)}const o=()=>{for(const u of i)this.#ee(u);this.#te(i)},c=()=>{for(const u of i)u.remove()};this.addCommands({cmd:o,undo:c,mustExec:!0})}catch(i){Ve(`paste: "${i.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),this.#T!==Oe.NONE&&!this.isEditorHandlingKeyboard&&vi._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,this.#S&&(this.#S=!1,this.#K("main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}#P(e){Object.entries(e).some(([n,s])=>this.#W[n]!==s)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#W,e)}),this.#T===Oe.HIGHLIGHT&&e.hasSelectedEditor===!1&&this.#j([[qe.HIGHLIGHT_FREE,!0]]))}#j(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})}setEditingState(e){e?(this.#ie(),this.#J(),this.#P({isEditing:this.#T!==Oe.NONE,isEmpty:this.#G(),hasSomethingToUndo:this.#o.hasSomethingToUndo(),hasSomethingToRedo:this.#o.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#oe(),this.#Z(),this.#P({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!this.#p){this.#p=e;for(const t of this.#p)this.#j(t.defaultPropertiesToUpdate)}}getId(){return this.#k.id}get currentLayer(){return this.#r.get(this.#d)}getLayer(e){return this.#r.get(e)}get currentPageIndex(){return this.#d}addLayer(e){this.#r.set(e.pageIndex,e),this.#b?e.enable():e.disable()}removeLayer(e){this.#r.delete(e.pageIndex)}async updateMode(e,t=null,n=!1,s=!1){if(this.#T!==e&&!(this.#O&&(await this.#O.promise,!this.#O))){if(this.#O=Promise.withResolvers(),this.#l?.commitOrRemove(),this.#T=e,e===Oe.NONE){this.setEditingState(!1),this.#ue(),this._editorUndoBar?.hide(),this.#O.resolve();return}e===Oe.SIGNATURE&&await this.#V?.loadSignatures(),this.setEditingState(!0),await this.#ce(),this.unselectAll();for(const i of this.#r.values())i.updateMode(e);if(!t){n&&this.addNewEditorFromKeyboard(),this.#O.resolve();return}for(const i of this.#n.values())i.annotationElementId===t||i.id===t?(this.setSelected(i),s&&i.enterInEditMode()):i.unselect();this.#O.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==this.#T&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...e})}updateParams(e,t){if(this.#p){switch(e){case qe.CREATE:this.currentLayer.addNewEditor(t);return;case qe.HIGHLIGHT_DEFAULT_COLOR:this.#D?.updateColor(t);break;case qe.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#H||=new Map).set(e,t),this.showAllEditors("highlight",t);break}for(const n of this.#_)n.updateParams(e,t);for(const n of this.#p)n.updateDefaultParams(e,t)}}showAllEditors(e,t,n=!1){for(const i of this.#n.values())i.editorType===e&&i.show(t);(this.#H?.get(qe.HIGHLIGHT_SHOW_ALL)??!0)!==t&&this.#j([[qe.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(this.#I!==e){this.#I=e;for(const t of this.#r.values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}async#ce(){if(!this.#b){this.#b=!0;const e=[];for(const t of this.#r.values())e.push(t.enable());await Promise.all(e);for(const t of this.#n.values())t.enable()}}#ue(){if(this.unselectAll(),this.#b){this.#b=!1;for(const e of this.#r.values())e.disable();for(const e of this.#n.values())e.disable()}}getEditors(e){const t=[];for(const n of this.#n.values())n.pageIndex===e&&t.push(n);return t}getEditor(e){return this.#n.get(e)}addEditor(e){this.#n.set(e.id,e)}removeEditor(e){e.div.contains(document.activeElement)&&(this.#w&&clearTimeout(this.#w),this.#w=setTimeout(()=>{this.focusMainContainer(),this.#w=null},0)),this.#n.delete(e.id),e.annotationElementId&&this.#L?.delete(e.annotationElementId),this.unselect(e),(!e.annotationElementId||!this.#u.has(e.annotationElementId))&&this.#s?.remove(e.id)}addDeletedAnnotationElement(e){this.#u.add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return this.#u.has(e)}removeDeletedAnnotationElement(e){this.#u.delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}#ee(e){const t=this.#r.get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))}setActiveEditor(e){this.#t!==e&&(this.#t=e,e&&this.#j(e.propertiesToUpdate))}get#he(){let e=null;for(e of this.#_);return e}updateUI(e){this.#he===e&&this.#j(e.propertiesToUpdate)}updateUIForDefaultProperties(e){this.#j(e.defaultPropertiesToUpdate)}toggleSelected(e){if(this.#_.has(e)){this.#_.delete(e),e.unselect(),this.#P({hasSelectedEditor:this.hasSelection});return}this.#_.add(e),e.select(),this.#j(e.propertiesToUpdate),this.#P({hasSelectedEditor:!0})}setSelected(e){this.updateToolbar({mode:e.mode,editId:e.id}),this.#l?.commitOrRemove();for(const t of this.#_)t!==e&&t.unselect();this.#_.clear(),this.#_.add(e),e.select(),this.#j(e.propertiesToUpdate),this.#P({hasSelectedEditor:!0})}isSelected(e){return this.#_.has(e)}get firstSelectedEditor(){return this.#_.values().next().value}unselect(e){e.unselect(),this.#_.delete(e),this.#P({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#_.size!==0}get isEnterHandled(){return this.#_.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#o.undo(),this.#P({hasSomethingToUndo:this.#o.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#G()}),this._editorUndoBar?.hide()}redo(){this.#o.redo(),this.#P({hasSomethingToUndo:!0,hasSomethingToRedo:this.#o.hasSomethingToRedo(),isEmpty:this.#G()})}addCommands(e){this.#o.add(e),this.#P({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#G()})}cleanUndoStack(e){this.#o.cleanType(e)}#G(){if(this.#n.size===0)return!0;if(this.#n.size===1)for(const e of this.#n.values())return e.isEmpty();return!1}delete(){this.commitOrRemove();const e=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...this.#_],n=()=>{this._editorUndoBar?.show(s,t.length===1?t[0].editorType:t.length);for(const i of t)i.remove()},s=()=>{for(const i of t)this.#ee(i)};this.addCommands({cmd:n,undo:s,mustExec:!0})}commitOrRemove(){this.#t?.commitOrRemove()}hasSomethingToControl(){return this.#t||this.hasSelection}#te(e){for(const t of this.#_)t.unselect();this.#_.clear();for(const t of e)t.isEmpty()||(this.#_.add(t),t.select());this.#P({hasSelectedEditor:this.hasSelection})}selectAll(){for(const e of this.#_)e.commit();this.#te(this.#n.values())}unselectAll(){if(!(this.#t&&(this.#t.commitOrRemove(),this.#T!==Oe.NONE))&&!this.#l?.commitOrRemove()&&this.hasSelection){for(const e of this.#_)e.unselect();this.#_.clear(),this.#P({hasSelectedEditor:!1})}}translateSelectedEditors(e,t,n=!1){if(n||this.commitOrRemove(),!this.hasSelection)return;this.#U[0]+=e,this.#U[1]+=t;const[s,i]=this.#U,o=[...this.#_],c=1e3;this.#M&&clearTimeout(this.#M),this.#M=setTimeout(()=>{this.#M=null,this.#U[0]=this.#U[1]=0,this.addCommands({cmd:()=>{for(const u of o)this.#n.has(u.id)&&(u.translateInPage(s,i),u.translationDone())},undo:()=>{for(const u of o)this.#n.has(u.id)&&(u.translateInPage(-s,-i),u.translationDone())},mustExec:!1})},c);for(const u of o)u.translateInPage(e,t),u.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#f=new Map;for(const e of this.#_)this.#f.set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#f)return!1;this.disableUserSelect(!1);const e=this.#f;this.#f=null;let t=!1;for(const[{x:s,y:i,pageIndex:o},c]of e)c.newX=s,c.newY=i,c.newPageIndex=o,t||=s!==c.savedX||i!==c.savedY||o!==c.savedPageIndex;if(!t)return!1;const n=(s,i,o,c)=>{if(this.#n.has(s.id)){const u=this.#r.get(c);u?s._setParentAndPosition(u,i,o):(s.pageIndex=c,s.x=i,s.y=o)}};return this.addCommands({cmd:()=>{for(const[s,{newX:i,newY:o,newPageIndex:c}]of e)n(s,i,o,c)},undo:()=>{for(const[s,{savedX:i,savedY:o,savedPageIndex:c}]of e)n(s,i,o,c)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(this.#f)for(const n of this.#f.keys())n.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#_.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return this.#t===e}getActive(){return this.#t}getMode(){return this.#T}get imageManager(){return We(this,"imageManager",new $0)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let h=0,f=t.rangeCount;h<f;h++)if(!e.contains(t.getRangeAt(h).commonAncestorContainer))return null;const{x:n,y:s,width:i,height:o}=e.getBoundingClientRect();let c;switch(e.getAttribute("data-main-rotation")){case"90":c=(h,f,m,y)=>({x:(f-s)/o,y:1-(h+m-n)/i,width:y/o,height:m/i});break;case"180":c=(h,f,m,y)=>({x:1-(h+m-n)/i,y:1-(f+y-s)/o,width:m/i,height:y/o});break;case"270":c=(h,f,m,y)=>({x:1-(f+y-s)/o,y:(h-n)/i,width:y/o,height:m/i});break;default:c=(h,f,m,y)=>({x:(h-n)/i,y:(f-s)/o,width:m/i,height:y/o});break}const u=[];for(let h=0,f=t.rangeCount;h<f;h++){const m=t.getRangeAt(h);if(!m.collapsed)for(const{x:y,y:_,width:A,height:b}of m.getClientRects())A===0||b===0||u.push(c(y,_,A,b))}return u.length===0?null:u}addChangedExistingAnnotation({annotationElementId:e,id:t}){(this.#a||=new Map).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){this.#a?.delete(e)}renderAnnotationElement(e){const t=this.#a?.get(e.data.id);if(!t)return;const n=this.#s.getRawValue(t);n&&(this.#T===Oe.NONE&&!n.hasBeenModified||n.renderAnnotationElement(e))}setMissingCanvas(e,t,n){const s=this.#L?.get(e);s&&(s.setCanvas(t,n),this.#L.delete(e))}addMissingCanvas(e,t){(this.#L||=new Map).set(e,t)}}class As{#e=null;#t=!1;#n=null;#r=null;#i=null;#s=null;#a=!1;#o=null;#h=null;#l=null;#d=null;#u=!1;static#f=null;static _l10n=null;constructor(e){this.#h=e,this.#u=e._uiManager.useNewAltTextFlow,As.#f||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(e){As._l10n??=e}async render(){const e=this.#n=document.createElement("button");e.className="altText",e.tabIndex="0";const t=this.#r=document.createElement("span");e.append(t),this.#u?(e.classList.add("new"),e.setAttribute("data-l10n-id",As.#f.missing),t.setAttribute("data-l10n-id",As.#f["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const n=this.#h._uiManager._signal;e.addEventListener("contextmenu",Rr,{signal:n}),e.addEventListener("pointerdown",i=>i.stopPropagation(),{signal:n});const s=i=>{i.preventDefault(),this.#h._uiManager.editAltText(this.#h),this.#u&&this.#h._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#p}})};return e.addEventListener("click",s,{capture:!0,signal:n}),e.addEventListener("keydown",i=>{i.target===e&&i.key==="Enter"&&(this.#a=!0,s(i))},{signal:n}),await this.#m(),e}get#p(){return this.#e&&"added"||this.#e===null&&this.guessedText&&"review"||"missing"}finish(){this.#n&&(this.#n.focus({focusVisible:this.#a}),this.#a=!1)}isEmpty(){return this.#u?this.#e===null:!this.#e&&!this.#t}hasData(){return this.#u?this.#e!==null||!!this.#l:this.isEmpty()}get guessedText(){return this.#l}async setGuessedText(e){this.#e===null&&(this.#l=e,this.#d=await As._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e}),this.#m())}toggleAltTextBadge(e=!1){if(!this.#u||this.#e){this.#o?.remove(),this.#o=null;return}if(!this.#o){const t=this.#o=document.createElement("div");t.className="noAltTextBadge",this.#h.div.append(t)}this.#o.classList.toggle("hidden",!e)}serialize(e){let t=this.#e;return!e&&this.#l===t&&(t=this.#d),{altText:t,decorative:this.#t,guessedText:this.#l,textWithDisclaimer:this.#d}}get data(){return{altText:this.#e,decorative:this.#t}}set data({altText:e,decorative:t,guessedText:n,textWithDisclaimer:s,cancel:i=!1}){n&&(this.#l=n,this.#d=s),!(this.#e===e&&this.#t===t)&&(i||(this.#e=e,this.#t=t),this.#m())}toggle(e=!1){this.#n&&(!e&&this.#s&&(clearTimeout(this.#s),this.#s=null),this.#n.disabled=!e)}shown(){this.#h._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#p}})}destroy(){this.#n?.remove(),this.#n=null,this.#r=null,this.#i=null,this.#o?.remove(),this.#o=null}async#m(){const e=this.#n;if(!e)return;if(this.#u){if(e.classList.toggle("done",!!this.#e),e.setAttribute("data-l10n-id",As.#f[this.#p]),this.#r?.setAttribute("data-l10n-id",As.#f[`${this.#p}-label`]),!this.#e){this.#i?.remove();return}}else{if(!this.#e&&!this.#t){e.classList.remove("done"),this.#i?.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=this.#i;if(!t){this.#i=t=document.createElement("span"),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${this.#h.id}`;const s=100,i=this.#h._uiManager._signal;i.addEventListener("abort",()=>{clearTimeout(this.#s),this.#s=null},{once:!0}),e.addEventListener("mouseenter",()=>{this.#s=setTimeout(()=>{this.#s=null,this.#i.classList.add("show"),this.#h._reportTelemetry({action:"alt_text_tooltip"})},s)},{signal:i}),e.addEventListener("mouseleave",()=>{this.#s&&(clearTimeout(this.#s),this.#s=null),this.#i?.classList.remove("show")},{signal:i})}this.#t?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=this.#e),t.parentNode||e.append(t),this.#h.getElementForAltText()?.setAttribute("aria-describedby",t.id)}}class _h{#e;#t=!1;#n=null;#r;#i;#s;#a;#o=null;#h;#l=null;#d;#u=null;constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:n=null,onPinchStart:s=null,onPinching:i=null,onPinchEnd:o=null,signal:c}){this.#e=e,this.#n=n,this.#r=t,this.#i=s,this.#s=i,this.#a=o,this.#d=new AbortController,this.#h=AbortSignal.any([c,this.#d.signal]),e.addEventListener("touchstart",this.#f.bind(this),{passive:!1,signal:this.#h})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/ns.pixelRatio}#f(e){if(this.#r?.())return;if(e.touches.length===1){if(this.#o)return;const s=this.#o=new AbortController,i=AbortSignal.any([this.#h,s.signal]),o=this.#e,c={capture:!0,signal:i,passive:!1},u=h=>{h.pointerType==="touch"&&(this.#o?.abort(),this.#o=null)};o.addEventListener("pointerdown",h=>{h.pointerType==="touch"&&(Vt(h),u(h))},c),o.addEventListener("pointerup",u,c),o.addEventListener("pointercancel",u,c);return}if(!this.#u){this.#u=new AbortController;const s=AbortSignal.any([this.#h,this.#u.signal]),i=this.#e,o={signal:s,capture:!1,passive:!1};i.addEventListener("touchmove",this.#p.bind(this),o);const c=this.#m.bind(this);i.addEventListener("touchend",c,o),i.addEventListener("touchcancel",c,o),o.capture=!0,i.addEventListener("pointerdown",Vt,o),i.addEventListener("pointermove",Vt,o),i.addEventListener("pointercancel",Vt,o),i.addEventListener("pointerup",Vt,o),this.#i?.()}if(Vt(e),e.touches.length!==2||this.#n?.()){this.#l=null;return}let[t,n]=e.touches;t.identifier>n.identifier&&([t,n]=[n,t]),this.#l={touch0X:t.screenX,touch0Y:t.screenY,touch1X:n.screenX,touch1Y:n.screenY}}#p(e){if(!this.#l||e.touches.length!==2)return;Vt(e);let[t,n]=e.touches;t.identifier>n.identifier&&([t,n]=[n,t]);const{screenX:s,screenY:i}=t,{screenX:o,screenY:c}=n,u=this.#l,{touch0X:h,touch0Y:f,touch1X:m,touch1Y:y}=u,_=m-h,A=y-f,b=o-s,T=c-i,x=Math.hypot(b,T)||1,M=Math.hypot(_,A)||1;if(!this.#t&&Math.abs(M-x)<=_h.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(u.touch0X=s,u.touch0Y=i,u.touch1X=o,u.touch1Y=c,!this.#t){this.#t=!0;return}const R=[(s+o)/2,(i+c)/2];this.#s?.(R,M,x)}#m(e){e.touches.length>=2||(this.#u&&(this.#u.abort(),this.#u=null,this.#a?.()),this.#l&&(Vt(e),this.#l=null,this.#t=!1))}destroy(){this.#d?.abort(),this.#d=null,this.#o?.abort(),this.#o=null}}class Ie{#e=null;#t=null;#n=null;#r=!1;#i=null;#s="";#a=!1;#o=null;#h=null;#l=null;#d=null;#u="";#f=!1;#p=null;#m=!1;#c=!1;#g=!1;#y=null;#v=0;#w=0;#E=null;#A=null;isSelected=!1;_isCopy=!1;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#S=!1;#C=Ie._zIndex++;static _borderLineWidth=-1;static _colorManager=new H0;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const e=Ie.prototype._resizeWithKeyboard,t=vi.TRANSLATE_SMALL,n=vi.TRANSLATE_BIG;return We(this,"_resizerKeyboardManager",new vh([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-n,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[n,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-n]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,n]}],[["Escape","mac+Escape"],Ie.prototype._stopResizingWithKeyboard]]))}constructor(e){this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null,this.annotationElementId=e.annotationElementId||null;const{rotation:t,rawDims:{pageWidth:n,pageHeight:s,pageX:i,pageY:o}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,s],this.pageTranslation=[i,o];const[c,u]=this.parentDimensions;this.x=e.x/c,this.y=e.y/u,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return We(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new M8({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(Ie._l10n??=e,Ie._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),Ie._borderLineWidth!==-1)return;const n=getComputedStyle(document.documentElement);Ie._borderLineWidth=parseFloat(n.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){it("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#S}set _isDraggable(e){this.#S=e,this.div?.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#C}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):this.#z(),this.parent=e}focusin(e){this._focusEventsAllowed&&(this.#f?this.#f=!1:this.parent.setSelected(this))}focusout(e){!this._focusEventsAllowed||!this.isAttachedToDOM||e.relatedTarget?.closest(`#${this.id}`)||(e.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,n,s){const[i,o]=this.parentDimensions;[n,s]=this.screenToPageTranslation(n,s),this.x=(e+n)/i,this.y=(t+s)/o,this.fixAndSetPosition()}_moveAfterPaste(e,t){const[n,s]=this.parentDimensions;this.setAt(e*n,t*s,this.width*n,this.height*s),this._onTranslated()}#k([e,t],n,s){[n,s]=this.screenToPageTranslation(n,s),this.x+=n/e,this.y+=s/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(e,t){this.#k(this.parentDimensions,e,t)}translateInPage(e,t){this.#p||=[this.x,this.y,this.width,this.height],this.#k(this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){this.#p||=[this.x,this.y,this.width,this.height];const{div:n,parentDimensions:[s,i]}=this;if(this.x+=e/s,this.y+=t/i,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:m,y}=this.div.getBoundingClientRect();this.parent.findNewParent(this,m,y)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:o,y:c}=this;const[u,h]=this.getBaseTranslation();o+=u,c+=h;const{style:f}=n;f.left=`${(100*o).toFixed(2)}%`,f.top=`${(100*c).toFixed(2)}%`,this._onTranslating(o,c),n.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!this.#p&&(this.#p[0]!==this.x||this.#p[1]!==this.y)}get _hasBeenResized(){return!!this.#p&&(this.#p[2]!==this.width||this.#p[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:n}=Ie,s=n/e,i=n/t;switch(this.rotation){case 90:return[-s,i];case 180:return[s,i];case 270:return[s,-i];default:return[-s,-i]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[n,s]}=this;let{x:i,y:o,width:c,height:u}=this;if(c*=n,u*=s,i*=n,o*=s,this._mustFixPosition)switch(e){case 0:i=Cn(i,0,n-c),o=Cn(o,0,s-u);break;case 90:i=Cn(i,0,n-u),o=Cn(o,c,s);break;case 180:i=Cn(i,c,n),o=Cn(o,u,s);break;case 270:i=Cn(i,u,n),o=Cn(o,0,s-c);break}this.x=i/=n,this.y=o/=s;const[h,f]=this.getBaseTranslation();i+=h,o+=f,t.left=`${(100*i).toFixed(2)}%`,t.top=`${(100*o).toFixed(2)}%`,this.moveInDOM()}static#b(e,t,n){switch(n){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}}screenToPageTranslation(e,t){return Ie.#b(e,t,this.parentRotation)}pageTranslationToScreen(e,t){return Ie.#b(e,t,360-this.parentRotation)}#I(e){switch(e){case 90:{const[t,n]=this.pageDimensions;return[0,-t/n,n/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,n]=this.pageDimensions;return[0,t/n,-n/t,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,n]}=this;return[t*e,n*e]}setDims(e,t){const[n,s]=this.parentDimensions,{style:i}=this.div;i.width=`${(100*e/n).toFixed(2)}%`,this.#a||(i.height=`${(100*t/s).toFixed(2)}%`)}fixDims(){const{style:e}=this.div,{height:t,width:n}=e,s=n.endsWith("%"),i=!this.#a&&t.endsWith("%");if(s&&i)return;const[o,c]=this.parentDimensions;s||(e.width=`${(100*parseFloat(n)/o).toFixed(2)}%`),!this.#a&&!i&&(e.height=`${(100*parseFloat(t)/c).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}#x(){if(this.#o)return;this.#o=document.createElement("div"),this.#o.classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const n of e){const s=document.createElement("div");this.#o.append(s),s.classList.add("resizer",n),s.setAttribute("data-resizer-name",n),s.addEventListener("pointerdown",this.#R.bind(this,n),{signal:t}),s.addEventListener("contextmenu",Rr,{signal:t}),s.tabIndex=-1}this.div.prepend(this.#o)}#R(e,t){t.preventDefault();const{isMac:n}=ln.platform;if(t.button!==0||t.ctrlKey&&n)return;this.#n?.toggle(!1);const s=this._isDraggable;this._isDraggable=!1,this.#h=[t.screenX,t.screenY];const i=new AbortController,o=this._uiManager.combinedSignal(i);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#B.bind(this,e),{passive:!0,capture:!0,signal:o}),window.addEventListener("touchmove",Vt,{passive:!1,signal:o}),window.addEventListener("contextmenu",Rr,{signal:o}),this.#l={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const c=this.parent.div.style.cursor,u=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const h=()=>{i.abort(),this.parent.togglePointerEvents(!0),this.#n?.toggle(!0),this._isDraggable=s,this.parent.div.style.cursor=c,this.div.style.cursor=u,this.#L()};window.addEventListener("pointerup",h,{signal:o}),window.addEventListener("blur",h,{signal:o})}#D(e,t,n,s){this.width=n,this.height=s,this.x=e,this.y=t;const[i,o]=this.parentDimensions;this.setDims(i*n,o*s),this.fixAndSetPosition(),this._onResized()}_onResized(){}#L(){if(!this.#l)return;const{savedX:e,savedY:t,savedWidth:n,savedHeight:s}=this.#l;this.#l=null;const i=this.x,o=this.y,c=this.width,u=this.height;i===e&&o===t&&c===n&&u===s||this.addCommands({cmd:this.#D.bind(this,i,o,c,u),undo:this.#D.bind(this,e,t,n,s),mustExec:!0})}static _round(e){return Math.round(e*1e4)/1e4}#B(e,t){const[n,s]=this.parentDimensions,i=this.x,o=this.y,c=this.width,u=this.height,h=Ie.MIN_SIZE/n,f=Ie.MIN_SIZE/s,m=this.#I(this.rotation),y=(ie,Z)=>[m[0]*ie+m[2]*Z,m[1]*ie+m[3]*Z],_=this.#I(360-this.rotation),A=(ie,Z)=>[_[0]*ie+_[2]*Z,_[1]*ie+_[3]*Z];let b,T,x=!1,M=!1;switch(e){case"topLeft":x=!0,b=(ie,Z)=>[0,0],T=(ie,Z)=>[ie,Z];break;case"topMiddle":b=(ie,Z)=>[ie/2,0],T=(ie,Z)=>[ie/2,Z];break;case"topRight":x=!0,b=(ie,Z)=>[ie,0],T=(ie,Z)=>[0,Z];break;case"middleRight":M=!0,b=(ie,Z)=>[ie,Z/2],T=(ie,Z)=>[0,Z/2];break;case"bottomRight":x=!0,b=(ie,Z)=>[ie,Z],T=(ie,Z)=>[0,0];break;case"bottomMiddle":b=(ie,Z)=>[ie/2,Z],T=(ie,Z)=>[ie/2,0];break;case"bottomLeft":x=!0,b=(ie,Z)=>[0,Z],T=(ie,Z)=>[ie,0];break;case"middleLeft":M=!0,b=(ie,Z)=>[0,Z/2],T=(ie,Z)=>[ie,Z/2];break}const R=b(c,u),B=T(c,u);let O=y(...B);const $=Ie._round(i+O[0]),k=Ie._round(o+O[1]);let C=1,P=1,N,j;if(t.fromKeyboard)({deltaX:N,deltaY:j}=t);else{const{screenX:ie,screenY:Z}=t,[te,de]=this.#h;[N,j]=this.screenToPageTranslation(ie-te,Z-de),this.#h[0]=ie,this.#h[1]=Z}if([N,j]=A(N/n,j/s),x){const ie=Math.hypot(c,u);C=P=Math.max(Math.min(Math.hypot(B[0]-R[0]-N,B[1]-R[1]-j)/ie,1/c,1/u),h/c,f/u)}else M?C=Cn(Math.abs(B[0]-R[0]-N),h,1)/c:P=Cn(Math.abs(B[1]-R[1]-j),f,1)/u;const z=Ie._round(c*C),F=Ie._round(u*P);O=y(...T(z,F));const ue=$-O[0],ke=k-O[1];this.#p||=[this.x,this.y,this.width,this.height],this.width=z,this.height=F,this.x=ue,this.y=ke,this.setDims(n*z,s*F),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#n?.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||this.#c)return this._editToolbar;this._editToolbar=new Iu(this),this.div.append(this._editToolbar.render());const{toolbarButtons:e}=this;if(e)for(const[t,n]of e)await this._editToolbar.addButton(t,n);return this._editToolbar.addButton("delete"),this._editToolbar}removeEditToolbar(){this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,this.#n?.destroy())}addContainer(e){const t=this._editToolbar?.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return this.#n||(As.initialize(Ie._l10n),this.#n=new As(this),this.#e&&(this.#n.data=this.#e,this.#e=null)),this.#n}get altTextData(){return this.#n?.data}set altTextData(e){this.#n&&(this.#n.data=e)}get guessedAltText(){return this.#n?.guessedText}async setGuessedAltText(e){await this.#n?.setGuessedText(e)}serializeAltText(e){return this.#n?.serialize(e)}hasAltText(){return!!this.#n&&!this.#n.isEmpty()}hasAltTextData(){return this.#n?.hasData()??!1}render(){const e=this.div=document.createElement("div");e.setAttribute("data-editor-rotation",(360-this.rotation)%360),e.className=this.name,e.setAttribute("id",this.id),e.tabIndex=this.#r?-1:0,e.setAttribute("role","application"),this.defaultL10nId&&e.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||e.classList.add("hidden"),this.setInForeground(),this.#H();const[t,n]=this.parentDimensions;this.parentRotation%180!==0&&(e.style.maxWidth=`${(100*n/t).toFixed(2)}%`,e.style.maxHeight=`${(100*t/n).toFixed(2)}%`);const[s,i]=this.getInitialTranslation();return this.translate(s,i),$I(this,e,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#A||=new _h({container:e,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#T.bind(this),onPinching:this.#_.bind(this),onPinchEnd:this.#F.bind(this),signal:this._uiManager._signal})),this._uiManager._editorUndoBar?.hide(),e}#T(){this.#l={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#n?.toggle(!1),this.parent.togglePointerEvents(!1)}#_(e,t,n){let i=.7*(n/t)+1-.7;if(i===1)return;const o=this.#I(this.rotation),c=($,k)=>[o[0]*$+o[2]*k,o[1]*$+o[3]*k],[u,h]=this.parentDimensions,f=this.x,m=this.y,y=this.width,_=this.height,A=Ie.MIN_SIZE/u,b=Ie.MIN_SIZE/h;i=Math.max(Math.min(i,1/y,1/_),A/y,b/_);const T=Ie._round(y*i),x=Ie._round(_*i);if(T===y&&x===_)return;this.#p||=[f,m,y,_];const M=c(y/2,_/2),R=Ie._round(f+M[0]),B=Ie._round(m+M[1]),O=c(T/2,x/2);this.x=R-O[0],this.y=B-O[1],this.width=T,this.height=x,this.setDims(u*T,h*x),this.fixAndSetPosition(),this._onResizing()}#F(){this.#n?.toggle(!0),this.parent.togglePointerEvents(!0),this.#L()}pointerdown(e){const{isMac:t}=ln.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(this.#f=!0,this._isDraggable){this.#$(e);return}this.#V(e)}#V(e){const{isMac:t}=ln.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)}#$(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let n=!1;const s=new AbortController,i=this._uiManager.combinedSignal(s),o={capture:!0,passive:!1,signal:i},c=h=>{s.abort(),this.#i=null,this.#f=!1,this._uiManager.endDragSession()||this.#V(h),n&&this._onStopDragging()};t&&(this.#v=e.clientX,this.#w=e.clientY,this.#i=e.pointerId,this.#s=e.pointerType,window.addEventListener("pointermove",h=>{n||(n=!0,this._onStartDragging());const{clientX:f,clientY:m,pointerId:y}=h;if(y!==this.#i){Vt(h);return}const[_,A]=this.screenToPageTranslation(f-this.#v,m-this.#w);this.#v=f,this.#w=m,this._uiManager.dragSelectedEditors(_,A)},o),window.addEventListener("touchmove",Vt,o),window.addEventListener("pointerdown",h=>{h.pointerType===this.#s&&(this.#A||h.isPrimary)&&c(h),Vt(h)},o));const u=h=>{if(!this.#i||this.#i===h.pointerId){c(h);return}Vt(h)};window.addEventListener("pointerup",u,{signal:i}),window.addEventListener("blur",u,{signal:i})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#y&&clearTimeout(this.#y),this.#y=setTimeout(()=>{this.#y=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(e,t,n){e.changeParent(this),this.x=t,this.y=n,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,n=this.rotation){const s=this.parentScale,[i,o]=this.pageDimensions,[c,u]=this.pageTranslation,h=e/s,f=t/s,m=this.x*i,y=this.y*o,_=this.width*i,A=this.height*o;switch(n){case 0:return[m+h+c,o-y-f-A+u,m+h+_+c,o-y-f+u];case 90:return[m+f+c,o-y+h+u,m+f+A+c,o-y+h+_+u];case 180:return[m-h-_+c,o-y+f+u,m-h+c,o-y+f+A+u];case 270:return[m-f-A+c,o-y-h-_+u,m-f+c,o-y-h+u];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[n,s,i,o]=e,c=i-n,u=o-s;switch(this.rotation){case 0:return[n,t-o,c,u];case 90:return[n,t-s,u,c];case 180:return[i,t-s,c,u];case 270:return[i,t-o,u,c];default:throw new Error("Invalid rotation")}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),this.#c=!0,!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),this.#c=!1,!0):!1}isInEditMode(){return this.#c}shouldGetKeyboardEvents(){return this.#g}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:n,right:s}=this.getClientDimensions(),{innerHeight:i,innerWidth:o}=window;return t<o&&s>0&&e<i&&n>0}#H(){if(this.#d||!this.div)return;this.#d=new AbortController;const e=this._uiManager.combinedSignal(this.#d);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})}rebuild(){this.#H()}rotate(e){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(e=!1,t=null){it("An editor must be serializable")}static async deserialize(e,t,n){const s=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:n,annotationElementId:e.annotationElementId});s.rotation=e.rotation,s.#e=e.accessibilityData,s._isCopy=e.isCopy||!1;const[i,o]=s.pageDimensions,[c,u,h,f]=s.getRectInCurrentCoords(e.rect,o);return s.x=c/i,s.y=u/o,s.width=h/i,s.height=f/o,s}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#d?.abort(),this.#d=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#y&&(clearTimeout(this.#y),this.#y=null),this.#z(),this.removeEditToolbar(),this.#E){for(const e of this.#E.values())clearTimeout(e);this.#E=null}this.parent=null,this.#A?.destroy(),this.#A=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#x(),this.#o.classList.remove("hidden"))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),this.#l={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const t=this.#o.children;if(!this.#t){this.#t=Array.from(t);const o=this.#W.bind(this),c=this.#U.bind(this),u=this._uiManager._signal;for(const h of this.#t){const f=h.getAttribute("data-resizer-name");h.setAttribute("role","spinbutton"),h.addEventListener("keydown",o,{signal:u}),h.addEventListener("blur",c,{signal:u}),h.addEventListener("focus",this.#M.bind(this,f),{signal:u}),h.setAttribute("data-l10n-id",Ie._l10nResizer[f])}}const n=this.#t[0];let s=0;for(const o of t){if(o===n)break;s++}const i=(360-this.rotation+this.parentRotation)%360/90*(this.#t.length/4);if(i!==s){if(i<s)for(let c=0;c<s-i;c++)this.#o.append(this.#o.firstChild);else if(i>s)for(let c=0;c<i-s;c++)this.#o.firstChild.before(this.#o.lastChild);let o=0;for(const c of t){const h=this.#t[o++].getAttribute("data-resizer-name");c.setAttribute("data-l10n-id",Ie._l10nResizer[h])}}this.#N(0),this.#g=!0,this.#o.firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}#W(e){Ie._resizerKeyboardManager.exec(this,e)}#U(e){this.#g&&e.relatedTarget?.parentNode!==this.#o&&this.#z()}#M(e){this.#u=this.#g?e:""}#N(e){if(this.#t)for(const t of this.#t)t.tabIndex=e}_resizeWithKeyboard(e,t){this.#g&&this.#B(this.#u,{deltaX:e,deltaY:t,fromKeyboard:!0})}#z(){this.#g=!1,this.#N(-1),this.#L()}_stopResizingWithKeyboard(){this.#z(),this.div.focus()}select(){if(!(this.isSelected&&this._editToolbar)){if(this.isSelected=!0,this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#n?.toggleAltTextBadge(!1)}}unselect(){this.isSelected&&(this.isSelected=!1,this.#o?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#n?.toggleAltTextBadge(!0))}updateParams(e,t){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id})}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return this.#m}set isEditing(e){this.#m=e,this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){this.#a=!0;const n=e/t,{style:s}=this.div;s.aspectRatio=n,s.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){this.#E||=new Map;const{action:n}=e;let s=this.#E.get(n);s&&clearTimeout(s),s=setTimeout(()=>{this._reportTelemetry(e),this.#E.delete(n),this.#E.size===0&&(this.#E=null)},Ie._telemetryTimeout),this.#E.set(n,s);return}e.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),this.#r=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#r=!0}renderAnnotationElement(e){let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const n=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),n.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;t?.nodeName==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}}class M8 extends Ie{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const Pb=3285377520,Sr=4294901760,_s=65535;class HI{constructor(e){this.h1=e?e&4294967295:Pb,this.h2=e?e&4294967295:Pb}update(e){let t,n;if(typeof e=="string"){t=new Uint8Array(e.length*2),n=0;for(let b=0,T=e.length;b<T;b++){const x=e.charCodeAt(b);x<=255?t[n++]=x:(t[n++]=x>>>8,t[n++]=x&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),n=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const s=n>>2,i=n-s*4,o=new Uint32Array(t.buffer,0,s);let c=0,u=0,h=this.h1,f=this.h2;const m=3432918353,y=461845907,_=m&_s,A=y&_s;for(let b=0;b<s;b++)b&1?(c=o[b],c=c*m&Sr|c*_&_s,c=c<<15|c>>>17,c=c*y&Sr|c*A&_s,h^=c,h=h<<13|h>>>19,h=h*5+3864292196):(u=o[b],u=u*m&Sr|u*_&_s,u=u<<15|u>>>17,u=u*y&Sr|u*A&_s,f^=u,f=f<<13|f>>>19,f=f*5+3864292196);switch(c=0,i){case 3:c^=t[s*4+2]<<16;case 2:c^=t[s*4+1]<<8;case 1:c^=t[s*4],c=c*m&Sr|c*_&_s,c=c<<15|c>>>17,c=c*y&Sr|c*A&_s,s&1?h^=c:f^=c}this.h1=h,this.h2=f}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&Sr|e*36045&_s,t=t*4283543511&Sr|((t<<16|e>>>16)*2950163797&Sr)>>>16,e^=t>>>1,e=e*444984403&Sr|e*60499&_s,t=t*3301882366&Sr|((t<<16|e>>>16)*3120437893&Sr)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const Ky=Object.freeze({map:null,hash:"",transfer:void 0});class W0{#e=!1;#t=null;#n=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const n=this.#n.get(e);return n===void 0?t:Object.assign(t,n)}getRawValue(e){return this.#n.get(e)}remove(e){if(this.#n.delete(e),this.#n.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const t of this.#n.values())if(t instanceof Ie)return;this.onAnnotationEditor(null)}}setValue(e,t){const n=this.#n.get(e);let s=!1;if(n!==void 0)for(const[i,o]of Object.entries(t))n[i]!==o&&(s=!0,n[i]=o);else s=!0,this.#n.set(e,t);s&&this.#r(),t instanceof Ie&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(e){return this.#n.has(e)}get size(){return this.#n.size}#r(){this.#e||(this.#e=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#e&&(this.#e=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new WI(this)}get serializable(){if(this.#n.size===0)return Ky;const e=new Map,t=new HI,n=[],s=Object.create(null);let i=!1;for(const[o,c]of this.#n){const u=c instanceof Ie?c.serialize(!1,s):c;u&&(e.set(o,u),t.update(`${o}:${JSON.stringify(u)}`),i||=!!u.bitmap)}if(i)for(const o of e.values())o.bitmap&&n.push(o.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:n}:Ky}get editorStats(){let e=null;const t=new Map;for(const n of this.#n.values()){if(!(n instanceof Ie))continue;const s=n.telemetryFinalData;if(!s)continue;const{type:i}=s;t.has(i)||t.set(i,Object.getPrototypeOf(n).constructor),e||=Object.create(null);const o=e[i]||=new Map;for(const[c,u]of Object.entries(s)){if(c==="type")continue;let h=o.get(c);h||(h=new Map,o.set(c,h));const f=h.get(u)??0;h.set(u,f+1)}}for(const[n,s]of t)e[n]=s.computeTelemetryFinalData(e[n]);return e}resetModifiedIds(){this.#t=null}get modifiedIds(){if(this.#t)return this.#t;const e=[];for(const t of this.#n.values())!(t instanceof Ie)||!t.annotationElementId||!t.serialize()||e.push(t.annotationElementId);return this.#t={ids:new Set(e),hash:e.join(",")}}[Symbol.iterator](){return this.#n.entries()}}class WI extends W0{#e;constructor(e){super();const{map:t,hash:n,transfer:s}=e.serializable,i=structuredClone(t,s?{transfer:s}:null);this.#e={map:i,hash:n,transfer:s}}get print(){it("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#e}get modifiedIds(){return We(this,"modifiedIds",{ids:new Set,hash:""})}}class N8{#e=new Set;constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),this.#e.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,disableFontFace:t,_inspectFont:n}){if(!(!e||this.#e.has(e.loadedName))){if(Wt(!t,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:s,src:i,style:o}=e,c=new FontFace(s,i,o);this.addNativeFontFace(c);try{await c.load(),this.#e.add(s),n?.(e)}catch{Ve(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(c)}return}it("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const n=e.createNativeFontFace();if(n){this.addNativeFontFace(n);try{await n.loaded}catch(s){throw Ve(`Failed to load font '${n.family}': '${s}'.`),e.disableFontFace=!0,s}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(n=>{const s=this._queueLoadingCallback(n);this._prepareFontLoadEvent(e,s)})}}get isFontLoadingAPISupported(){const e=!!this._document?.fonts;return We(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){return We(this,"isSyncFontLoadingSupported",Fn||ln.platform.isFirefox)}_queueLoadingCallback(e){function t(){for(Wt(!s.done,"completeRequest() cannot be called twice."),s.done=!0;n.length>0&&n[0].done;){const i=n.shift();setTimeout(i.callback,0)}}const{loadingRequests:n}=this,s={done:!1,complete:t,callback:e};return n.push(s),s}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return We(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function n(B,O){return B.charCodeAt(O)<<24|B.charCodeAt(O+1)<<16|B.charCodeAt(O+2)<<8|B.charCodeAt(O+3)&255}function s(B,O,$,k){const C=B.substring(0,O),P=B.substring(O+$);return C+k+P}let i,o;const c=this._document.createElement("canvas");c.width=1,c.height=1;const u=c.getContext("2d");let h=0;function f(B,O){if(++h>30){Ve("Load test font never loaded."),O();return}if(u.font="30px "+B,u.fillText(".",0,20),u.getImageData(0,0,1,1).data[3]>0){O();return}setTimeout(f.bind(null,B,O))}const m=`lt${Date.now()}${this.loadTestFontId++}`;let y=this._loadTestFont;y=s(y,976,m.length,m);const A=16,b=1482184792;let T=n(y,A);for(i=0,o=m.length-3;i<o;i+=4)T=T-b+n(m,i)|0;i<m.length&&(T=T-b+n(m+"XXX",i)|0),y=s(y,A,4,b8(T));const x=`url(data:font/opentype;base64,${btoa(y)});`,M=`@font-face {font-family:"${m}";src:${x}}`;this.insertRule(M);const R=this._document.createElement("div");R.style.visibility="hidden",R.style.width=R.style.height="10px",R.style.position="absolute",R.style.top=R.style.left="0px";for(const B of[e.loadedName,m]){const O=this._document.createElement("span");O.textContent="Hi",O.style.fontFamily=B,R.append(O)}this._document.body.append(R),f(m,()=>{R.remove(),t.complete()})}}class O8{constructor(e,t=null){this.compiledGlyphs=Object.create(null);for(const n in e)this[n]=e[n];this._inspectFont=t}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const t={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(t.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,t)}return this._inspectFont?.(this),e}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${jI(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let n=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(n+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${n}src:${e}}`}return this._inspectFont?.(this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const n=this.loadedName+"_path_"+t;let s;try{s=e.get(n)}catch(o){Ve(`getPathGenerator - ignoring character: "${o}".`)}const i=new Path2D(s||"");return this.fontExtraProperties||e.delete(n),this.compiledGlyphs[t]=i}}function F8(r){if(r instanceof URL)return r.href;if(typeof r=="string"){if(Fn)return r;const e=URL.parse(r,window.location);if(e)return e.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function V8(r){if(Fn&&typeof Buffer<"u"&&r instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength)return r;if(typeof r=="string")return mh(r);if(r instanceof ArrayBuffer||ArrayBuffer.isView(r)||typeof r=="object"&&!isNaN(r?.length))return new Uint8Array(r);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Qd(r){if(typeof r!="string")return null;if(r.endsWith("/"))return r;throw new Error(`Invalid factory url: "${r}" must include trailing slash.`)}const Xy=r=>typeof r=="object"&&Number.isInteger(r?.num)&&r.num>=0&&Number.isInteger(r?.gen)&&r.gen>=0,j8=r=>typeof r=="object"&&typeof r?.name=="string",GI=C8.bind(null,Xy,j8);class B8{#e=new Map;#t=Promise.resolve();postMessage(e,t){const n={data:structuredClone(e,t?{transfer:t}:null)};this.#t.then(()=>{for(const[s]of this.#e)s.call(this,n)})}addEventListener(e,t,n=null){let s=null;if(n?.signal instanceof AbortSignal){const{signal:i}=n;if(i.aborted){Ve("LoopbackPort - cannot use an `aborted` signal.");return}const o=()=>this.removeEventListener(e,t);s=()=>i.removeEventListener("abort",o),i.addEventListener("abort",o)}this.#e.set(t,s)}removeEventListener(e,t){this.#e.get(t)?.(),this.#e.delete(t)}terminate(){for(const[,e]of this.#e)e?.();this.#e.clear()}}const Jd={DATA:1,ERROR:2},$t={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function Rb(){}function Qn(r){if(r instanceof yi||r instanceof Qf||r instanceof Cb||r instanceof qu||r instanceof Kg)return r;switch(r instanceof Error||typeof r=="object"&&r!==null||it('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),r.name){case"AbortException":return new yi(r.message);case"InvalidPDFException":return new Qf(r.message);case"PasswordException":return new Cb(r.message,r.code);case"ResponseException":return new qu(r.message,r.status,r.missing);case"UnknownErrorException":return new Kg(r.message,r.details)}return new Kg(r.message,r.toString())}class mu{#e=new AbortController;constructor(e,t,n){this.sourceName=e,this.targetName=t,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),n.addEventListener("message",this.#t.bind(this),{signal:this.#e.signal})}#t({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){this.#r(e);return}if(e.callback){const n=e.callbackId,s=this.callbackCapabilities[n];if(!s)throw new Error(`Cannot resolve callback ${n}`);if(delete this.callbackCapabilities[n],e.callback===Jd.DATA)s.resolve(e.data);else if(e.callback===Jd.ERROR)s.reject(Qn(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const n=this.sourceName,s=e.sourceName,i=this.comObj;Promise.try(t,e.data).then(function(o){i.postMessage({sourceName:n,targetName:s,callback:Jd.DATA,callbackId:e.callbackId,data:o})},function(o){i.postMessage({sourceName:n,targetName:s,callback:Jd.ERROR,callbackId:e.callbackId,reason:Qn(o)})});return}if(e.streamId){this.#n(e);return}t(e.data)}on(e,t){const n=this.actionHandler;if(n[e])throw new Error(`There is already an actionName called "${e}"`);n[e]=t}send(e,t,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},n)}sendWithPromise(e,t,n){const s=this.callbackId++,i=Promise.withResolvers();this.callbackCapabilities[s]=i;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:s,data:t},n)}catch(o){i.reject(o)}return i.promise}sendWithStream(e,t,n,s){const i=this.streamId++,o=this.sourceName,c=this.targetName,u=this.comObj;return new ReadableStream({start:h=>{const f=Promise.withResolvers();return this.streamControllers[i]={controller:h,startCall:f,pullCall:null,cancelCall:null,isClosed:!1},u.postMessage({sourceName:o,targetName:c,action:e,streamId:i,data:t,desiredSize:h.desiredSize},s),f.promise},pull:h=>{const f=Promise.withResolvers();return this.streamControllers[i].pullCall=f,u.postMessage({sourceName:o,targetName:c,stream:$t.PULL,streamId:i,desiredSize:h.desiredSize}),f.promise},cancel:h=>{Wt(h instanceof Error,"cancel must have a valid reason");const f=Promise.withResolvers();return this.streamControllers[i].cancelCall=f,this.streamControllers[i].isClosed=!0,u.postMessage({sourceName:o,targetName:c,stream:$t.CANCEL,streamId:i,reason:Qn(h)}),f.promise}},n)}#n(e){const t=e.streamId,n=this.sourceName,s=e.sourceName,i=this.comObj,o=this,c=this.actionHandler[e.action],u={enqueue(h,f=1,m){if(this.isCancelled)return;const y=this.desiredSize;this.desiredSize-=f,y>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),i.postMessage({sourceName:n,targetName:s,stream:$t.ENQUEUE,streamId:t,chunk:h},m)},close(){this.isCancelled||(this.isCancelled=!0,i.postMessage({sourceName:n,targetName:s,stream:$t.CLOSE,streamId:t}),delete o.streamSinks[t])},error(h){Wt(h instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,i.postMessage({sourceName:n,targetName:s,stream:$t.ERROR,streamId:t,reason:Qn(h)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};u.sinkCapability.resolve(),u.ready=u.sinkCapability.promise,this.streamSinks[t]=u,Promise.try(c,e.data,u).then(function(){i.postMessage({sourceName:n,targetName:s,stream:$t.START_COMPLETE,streamId:t,success:!0})},function(h){i.postMessage({sourceName:n,targetName:s,stream:$t.START_COMPLETE,streamId:t,reason:Qn(h)})})}#r(e){const t=e.streamId,n=this.sourceName,s=e.sourceName,i=this.comObj,o=this.streamControllers[t],c=this.streamSinks[t];switch(e.stream){case $t.START_COMPLETE:e.success?o.startCall.resolve():o.startCall.reject(Qn(e.reason));break;case $t.PULL_COMPLETE:e.success?o.pullCall.resolve():o.pullCall.reject(Qn(e.reason));break;case $t.PULL:if(!c){i.postMessage({sourceName:n,targetName:s,stream:$t.PULL_COMPLETE,streamId:t,success:!0});break}c.desiredSize<=0&&e.desiredSize>0&&c.sinkCapability.resolve(),c.desiredSize=e.desiredSize,Promise.try(c.onPull||Rb).then(function(){i.postMessage({sourceName:n,targetName:s,stream:$t.PULL_COMPLETE,streamId:t,success:!0})},function(h){i.postMessage({sourceName:n,targetName:s,stream:$t.PULL_COMPLETE,streamId:t,reason:Qn(h)})});break;case $t.ENQUEUE:if(Wt(o,"enqueue should have stream controller"),o.isClosed)break;o.controller.enqueue(e.chunk);break;case $t.CLOSE:if(Wt(o,"close should have stream controller"),o.isClosed)break;o.isClosed=!0,o.controller.close(),this.#i(o,t);break;case $t.ERROR:Wt(o,"error should have stream controller"),o.controller.error(Qn(e.reason)),this.#i(o,t);break;case $t.CANCEL_COMPLETE:e.success?o.cancelCall.resolve():o.cancelCall.reject(Qn(e.reason)),this.#i(o,t);break;case $t.CANCEL:if(!c)break;const u=Qn(e.reason);Promise.try(c.onCancel||Rb,u).then(function(){i.postMessage({sourceName:n,targetName:s,stream:$t.CANCEL_COMPLETE,streamId:t,success:!0})},function(h){i.postMessage({sourceName:n,targetName:s,stream:$t.CANCEL_COMPLETE,streamId:t,reason:Qn(h)})}),c.sinkCapability.reject(u),c.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}}async#i(e,t){await Promise.allSettled([e.startCall?.promise,e.pullCall?.promise,e.cancelCall?.promise]),delete this.streamControllers[t]}destroy(){this.#e?.abort(),this.#e=null}}class qI{#e=!1;constructor({enableHWA:e=!1}){this.#e=e}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const n=this._createCanvas(e,t);return{canvas:n,context:n.getContext("2d",{willReadFrequently:!this.#e})}}reset(e,t,n){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||n<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=n}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){it("Abstract method `_createCanvas` called.")}}class U8 extends qI{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const n=this._document.createElement("canvas");return n.width=e,n.height=t,n}}class KI{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(n=>({cMapData:n,isCompressed:this.isCompressed})).catch(n=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){it("Abstract method `_fetch` called.")}}class Db extends KI{async _fetch(e){const t=await lc(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):mh(t)}}class XI{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,n,s,i){return"none"}destroy(e=!1){}}class z8 extends XI{#e;#t;#n;#r;#i;#s;#a=0;constructor({docId:e,ownerDocument:t=globalThis.document}){super(),this.#r=e,this.#i=t}get#o(){return this.#t||=new Map}get#h(){return this.#s||=new Map}get#l(){if(!this.#n){const e=this.#i.createElement("div"),{style:t}=e;t.visibility="hidden",t.contain="strict",t.width=t.height=0,t.position="absolute",t.top=t.left=0,t.zIndex=-1;const n=this.#i.createElementNS(ni,"svg");n.setAttribute("width",0),n.setAttribute("height",0),this.#n=this.#i.createElementNS(ni,"defs"),e.append(n),n.append(this.#n),this.#i.body.append(e)}return this.#n}#d(e){if(e.length===1){const u=e[0],h=new Array(256);for(let m=0;m<256;m++)h[m]=u[m]/255;const f=h.join(",");return[f,f,f]}const[t,n,s]=e,i=new Array(256),o=new Array(256),c=new Array(256);for(let u=0;u<256;u++)i[u]=t[u]/255,o[u]=n[u]/255,c[u]=s[u]/255;return[i.join(","),o.join(","),c.join(",")]}#u(e){if(this.#e===void 0){this.#e="";const t=this.#i.URL;t!==this.#i.baseURI&&(yh(t)?Ve('#createUrl: ignore "data:"-URL for performance reasons.'):this.#e=V0(t,""))}return`url(${this.#e}#${e})`}addFilter(e){if(!e)return"none";let t=this.#o.get(e);if(t)return t;const[n,s,i]=this.#d(e),o=e.length===1?n:`${n}${s}${i}`;if(t=this.#o.get(o),t)return this.#o.set(e,t),t;const c=`g_${this.#r}_transfer_map_${this.#a++}`,u=this.#u(c);this.#o.set(e,u),this.#o.set(o,u);const h=this.#m(c);return this.#g(n,s,i,h),u}addHCMFilter(e,t){const n=`${e}-${t}`,s="base";let i=this.#h.get(s);if(i?.key===n||(i?(i.filter?.remove(),i.key=n,i.url="none",i.filter=null):(i={key:n,url:"none",filter:null},this.#h.set(s,i)),!e||!t))return i.url;const o=this.#v(e);e=be.makeHexColor(...o);const c=this.#v(t);if(t=be.makeHexColor(...c),this.#l.style.color="",e==="#000000"&&t==="#ffffff"||e===t)return i.url;const u=new Array(256);for(let _=0;_<=255;_++){const A=_/255;u[_]=A<=.03928?A/12.92:((A+.055)/1.055)**2.4}const h=u.join(","),f=`g_${this.#r}_hcm_filter`,m=i.filter=this.#m(f);this.#g(h,h,h,m),this.#p(m);const y=(_,A)=>{const b=o[_]/255,T=c[_]/255,x=new Array(A+1);for(let M=0;M<=A;M++)x[M]=b+M/A*(T-b);return x.join(",")};return this.#g(y(0,5),y(1,5),y(2,5),m),i.url=this.#u(f),i.url}addAlphaFilter(e){let t=this.#o.get(e);if(t)return t;const[n]=this.#d([e]),s=`alpha_${n}`;if(t=this.#o.get(s),t)return this.#o.set(e,t),t;const i=`g_${this.#r}_alpha_map_${this.#a++}`,o=this.#u(i);this.#o.set(e,o),this.#o.set(s,o);const c=this.#m(i);return this.#y(n,c),o}addLuminosityFilter(e){let t=this.#o.get(e||"luminosity");if(t)return t;let n,s;if(e?([n]=this.#d([e]),s=`luminosity_${n}`):s="luminosity",t=this.#o.get(s),t)return this.#o.set(e,t),t;const i=`g_${this.#r}_luminosity_map_${this.#a++}`,o=this.#u(i);this.#o.set(e,o),this.#o.set(s,o);const c=this.#m(i);return this.#f(c),e&&this.#y(n,c),o}addHighlightHCMFilter(e,t,n,s,i){const o=`${t}-${n}-${s}-${i}`;let c=this.#h.get(e);if(c?.key===o||(c?(c.filter?.remove(),c.key=o,c.url="none",c.filter=null):(c={key:o,url:"none",filter:null},this.#h.set(e,c)),!t||!n))return c.url;const[u,h]=[t,n].map(this.#v.bind(this));let f=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),m=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),[y,_]=[s,i].map(this.#v.bind(this));m<f&&([f,m,y,_]=[m,f,_,y]),this.#l.style.color="";const A=(x,M,R)=>{const B=new Array(256),O=(m-f)/R,$=x/255,k=(M-x)/(255*R);let C=0;for(let P=0;P<=R;P++){const N=Math.round(f+P*O),j=$+P*k;for(let z=C;z<=N;z++)B[z]=j;C=N+1}for(let P=C;P<256;P++)B[P]=B[C-1];return B.join(",")},b=`g_${this.#r}_hcm_${e}_filter`,T=c.filter=this.#m(b);return this.#p(T),this.#g(A(y[0],_[0],5),A(y[1],_[1],5),A(y[2],_[2],5),T),c.url=this.#u(b),c.url}destroy(e=!1){e&&this.#s?.size||(this.#n?.parentNode.parentNode.remove(),this.#n=null,this.#t?.clear(),this.#t=null,this.#s?.clear(),this.#s=null,this.#a=0)}#f(e){const t=this.#i.createElementNS(ni,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(t)}#p(e){const t=this.#i.createElementNS(ni,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(t)}#m(e){const t=this.#i.createElementNS(ni,"filter");return t.setAttribute("color-interpolation-filters","sRGB"),t.setAttribute("id",e),this.#l.append(t),t}#c(e,t,n){const s=this.#i.createElementNS(ni,t);s.setAttribute("type","discrete"),s.setAttribute("tableValues",n),e.append(s)}#g(e,t,n,s){const i=this.#i.createElementNS(ni,"feComponentTransfer");s.append(i),this.#c(i,"feFuncR",e),this.#c(i,"feFuncG",t),this.#c(i,"feFuncB",n)}#y(e,t){const n=this.#i.createElementNS(ni,"feComponentTransfer");t.append(n),this.#c(n,"feFuncA",e)}#v(e){return this.#l.style.color=e,z0(getComputedStyle(this.#l).getPropertyValue("color"))}}class YI{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(n=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){it("Abstract method `_fetch` called.")}}class Lb extends YI{async _fetch(e){const t=await lc(e,"arraybuffer");return new Uint8Array(t)}}class QI{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!e)throw new Error("Wasm filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(n=>{throw new Error(`Unable to load wasm data at: ${t}`)})}async _fetch(e){it("Abstract method `_fetch` called.")}}class Mb extends QI{async _fetch(e){const t=await lc(e,"arraybuffer");return new Uint8Array(t)}}Fn&&Ve("Please use the `legacy` build in Node.js environments.");async function G0(r){const t=await process.getBuiltinModule("fs").promises.readFile(r);return new Uint8Array(t)}class $8 extends XI{}class H8 extends qI{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class W8 extends KI{async _fetch(e){return G0(e)}}class G8 extends YI{async _fetch(e){return G0(e)}}class q8 extends QI{async _fetch(e){return G0(e)}}const mn={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function Yy(r,e){if(!e)return;const t=e[2]-e[0],n=e[3]-e[1],s=new Path2D;s.rect(e[0],e[1],t,n),r.clip(s)}class q0{isModifyingCurrentTransform(){return!1}getPattern(){it("Abstract method `getPattern` called.")}}class K8 extends q0{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const n of this._colorStops)t.addColorStop(n[0],n[1]);return t}getPattern(e,t,n,s){let i;if(s===mn.STROKE||s===mn.FILL){const o=t.current.getClippedPathBoundingBox(s,St(e))||[0,0,0,0],c=Math.ceil(o[2]-o[0])||1,u=Math.ceil(o[3]-o[1])||1,h=t.cachedCanvases.getCanvas("pattern",c,u),f=h.context;f.clearRect(0,0,f.canvas.width,f.canvas.height),f.beginPath(),f.rect(0,0,f.canvas.width,f.canvas.height),f.translate(-o[0],-o[1]),n=be.transform(n,[1,0,0,1,o[0],o[1]]),f.transform(...t.baseTransform),this.matrix&&f.transform(...this.matrix),Yy(f,this._bbox),f.fillStyle=this._createGradient(f),f.fill(),i=e.createPattern(h.canvas,"no-repeat");const m=new DOMMatrix(n);i.setTransform(m)}else Yy(e,this._bbox),i=this._createGradient(e);return i}}function Qg(r,e,t,n,s,i,o,c){const u=e.coords,h=e.colors,f=r.data,m=r.width*4;let y;u[t+1]>u[n+1]&&(y=t,t=n,n=y,y=i,i=o,o=y),u[n+1]>u[s+1]&&(y=n,n=s,s=y,y=o,o=c,c=y),u[t+1]>u[n+1]&&(y=t,t=n,n=y,y=i,i=o,o=y);const _=(u[t]+e.offsetX)*e.scaleX,A=(u[t+1]+e.offsetY)*e.scaleY,b=(u[n]+e.offsetX)*e.scaleX,T=(u[n+1]+e.offsetY)*e.scaleY,x=(u[s]+e.offsetX)*e.scaleX,M=(u[s+1]+e.offsetY)*e.scaleY;if(A>=M)return;const R=h[i],B=h[i+1],O=h[i+2],$=h[o],k=h[o+1],C=h[o+2],P=h[c],N=h[c+1],j=h[c+2],z=Math.round(A),F=Math.round(M);let ue,ke,ie,Z,te,de,ee,W;for(let Y=z;Y<=F;Y++){if(Y<T){const Ee=Y<A?0:(A-Y)/(A-T);ue=_-(_-b)*Ee,ke=R-(R-$)*Ee,ie=B-(B-k)*Ee,Z=O-(O-C)*Ee}else{let Ee;Y>M?Ee=1:T===M?Ee=0:Ee=(T-Y)/(T-M),ue=b-(b-x)*Ee,ke=$-($-P)*Ee,ie=k-(k-N)*Ee,Z=C-(C-j)*Ee}let ae;Y<A?ae=0:Y>M?ae=1:ae=(A-Y)/(A-M),te=_-(_-x)*ae,de=R-(R-P)*ae,ee=B-(B-N)*ae,W=O-(O-j)*ae;const _e=Math.round(Math.min(ue,te)),Te=Math.round(Math.max(ue,te));let Pe=m*Y+_e*4;for(let Ee=_e;Ee<=Te;Ee++)ae=(ue-Ee)/(ue-te),ae<0?ae=0:ae>1&&(ae=1),f[Pe++]=ke-(ke-de)*ae|0,f[Pe++]=ie-(ie-ee)*ae|0,f[Pe++]=Z-(Z-W)*ae|0,f[Pe++]=255}}function X8(r,e,t){const n=e.coords,s=e.colors;let i,o;switch(e.type){case"lattice":const c=e.verticesPerRow,u=Math.floor(n.length/c)-1,h=c-1;for(i=0;i<u;i++){let f=i*c;for(let m=0;m<h;m++,f++)Qg(r,t,n[f],n[f+1],n[f+c],s[f],s[f+1],s[f+c]),Qg(r,t,n[f+c+1],n[f+1],n[f+c],s[f+c+1],s[f+1],s[f+c])}break;case"triangles":for(i=0,o=n.length;i<o;i+=3)Qg(r,t,n[i],n[i+1],n[i+2],s[i],s[i+1],s[i+2]);break;default:throw new Error("illegal figure")}}class Y8 extends q0{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,n){const c=Math.floor(this._bounds[0]),u=Math.floor(this._bounds[1]),h=Math.ceil(this._bounds[2])-c,f=Math.ceil(this._bounds[3])-u,m=Math.min(Math.ceil(Math.abs(h*e[0]*1.1)),3e3),y=Math.min(Math.ceil(Math.abs(f*e[1]*1.1)),3e3),_=h/m,A=f/y,b={coords:this._coords,colors:this._colors,offsetX:-c,offsetY:-u,scaleX:1/_,scaleY:1/A},T=m+4,x=y+4,M=n.getCanvas("mesh",T,x),R=M.context,B=R.createImageData(m,y);if(t){const $=B.data;for(let k=0,C=$.length;k<C;k+=4)$[k]=t[0],$[k+1]=t[1],$[k+2]=t[2],$[k+3]=255}for(const $ of this._figures)X8(B,$,b);return R.putImageData(B,2,2),{canvas:M.canvas,offsetX:c-2*_,offsetY:u-2*A,scaleX:_,scaleY:A}}isModifyingCurrentTransform(){return!0}getPattern(e,t,n,s){Yy(e,this._bbox);const i=new Float32Array(2);if(s===mn.SHADING)be.singularValueDecompose2dScale(St(e),i);else if(this.matrix){be.singularValueDecompose2dScale(this.matrix,i);const[c,u]=i;be.singularValueDecompose2dScale(t.baseTransform,i),i[0]*=c,i[1]*=u}else be.singularValueDecompose2dScale(t.baseTransform,i);const o=this._createMeshCanvas(i,s===mn.SHADING?null:this._background,t.cachedCanvases);return s!==mn.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(o.offsetX,o.offsetY),e.scale(o.scaleX,o.scaleY),e.createPattern(o.canvas,"no-repeat")}}class Q8 extends q0{getPattern(){return"hotpink"}}function J8(r){switch(r[0]){case"RadialAxial":return new K8(r);case"Mesh":return new Y8(r);case"Dummy":return new Q8}throw new Error(`Unknown IR type: ${r[0]}`)}const Nb={COLORED:1,UNCOLORED:2};class K0{static MAX_PATTERN_SIZE=3e3;constructor(e,t,n,s){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=t,this.canvasGraphicsFactory=n,this.baseTransform=s}createPatternCanvas(e){const{bbox:t,operatorList:n,paintType:s,tilingType:i,color:o,canvasGraphicsFactory:c}=this;let{xstep:u,ystep:h}=this;u=Math.abs(u),h=Math.abs(h),Rp("TilingType: "+i);const f=t[0],m=t[1],y=t[2],_=t[3],A=y-f,b=_-m,T=new Float32Array(2);be.singularValueDecompose2dScale(this.matrix,T);const[x,M]=T;be.singularValueDecompose2dScale(this.baseTransform,T);const R=x*T[0],B=M*T[1];let O=A,$=b,k=!1,C=!1;const P=Math.ceil(u*R),N=Math.ceil(h*B),j=Math.ceil(A*R),z=Math.ceil(b*B);P>=j?O=u:k=!0,N>=z?$=h:C=!0;const F=this.getSizeAndScale(O,this.ctx.canvas.width,R),ue=this.getSizeAndScale($,this.ctx.canvas.height,B),ke=e.cachedCanvases.getCanvas("pattern",F.size,ue.size),ie=ke.context,Z=c.createCanvasGraphics(ie);if(Z.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(Z,s,o),ie.translate(-F.scale*f,-ue.scale*m),Z.transform(F.scale,0,0,ue.scale,0,0),ie.save(),this.clipBbox(Z,f,m,y,_),Z.baseTransform=St(Z.ctx),Z.executeOperatorList(n),Z.endDrawing(),ie.restore(),k||C){const te=ke.canvas;k&&(O=u),C&&($=h);const de=this.getSizeAndScale(O,this.ctx.canvas.width,R),ee=this.getSizeAndScale($,this.ctx.canvas.height,B),W=de.size,Y=ee.size,ae=e.cachedCanvases.getCanvas("pattern-workaround",W,Y),_e=ae.context,Te=k?Math.floor(A/u):0,Pe=C?Math.floor(b/h):0;for(let Ee=0;Ee<=Te;Ee++)for(let Be=0;Be<=Pe;Be++)_e.drawImage(te,W*Ee,Y*Be,W,Y,0,0,W,Y);return{canvas:ae.canvas,scaleX:de.scale,scaleY:ee.scale,offsetX:f,offsetY:m}}return{canvas:ke.canvas,scaleX:F.scale,scaleY:ue.scale,offsetX:f,offsetY:m}}getSizeAndScale(e,t,n){const s=Math.max(K0.MAX_PATTERN_SIZE,t);let i=Math.ceil(e*n);return i>=s?i=s:n=i/e,{scale:n,size:i}}clipBbox(e,t,n,s,i){const o=s-t,c=i-n;e.ctx.rect(t,n,o,c),be.axialAlignedBoundingBox([t,n,s,i],St(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,n){const s=e.ctx,i=e.current;switch(t){case Nb.COLORED:const{fillStyle:o,strokeStyle:c}=this.ctx;s.fillStyle=i.fillColor=o,s.strokeStyle=i.strokeColor=c;break;case Nb.UNCOLORED:s.fillStyle=s.strokeStyle=n,i.fillColor=i.strokeColor=n;break;default:throw new A8(`Unsupported paint type: ${t}`)}}isModifyingCurrentTransform(){return!1}getPattern(e,t,n,s){let i=n;s!==mn.SHADING&&(i=be.transform(i,t.baseTransform),this.matrix&&(i=be.transform(i,this.matrix)));const o=this.createPatternCanvas(t);let c=new DOMMatrix(i);c=c.translate(o.offsetX,o.offsetY),c=c.scale(1/o.scaleX,1/o.scaleY);const u=e.createPattern(o.canvas,"repeat");return u.setTransform(c),u}}function Z8({src:r,srcPos:e=0,dest:t,width:n,height:s,nonBlackColor:i=4294967295,inverseDecode:o=!1}){const c=ln.isLittleEndian?4278190080:255,[u,h]=o?[i,c]:[c,i],f=n>>3,m=n&7,y=r.length;t=new Uint32Array(t.buffer);let _=0;for(let A=0;A<s;A++){for(const T=e+f;e<T;e++){const x=e<y?r[e]:255;t[_++]=x&128?h:u,t[_++]=x&64?h:u,t[_++]=x&32?h:u,t[_++]=x&16?h:u,t[_++]=x&8?h:u,t[_++]=x&4?h:u,t[_++]=x&2?h:u,t[_++]=x&1?h:u}if(m===0)continue;const b=e<y?r[e++]:255;for(let T=0;T<m;T++)t[_++]=b&1<<7-T?h:u}return{srcPos:e,destPos:_}}const Ob=16,Fb=100,ej=15,Vb=10,Jn=16,Jg=new DOMMatrix,cr=new Float32Array(2),Il=new Float32Array([1/0,1/0,-1/0,-1/0]);function tj(r,e){if(r._removeMirroring)throw new Error("Context is already forwarding operations.");r.__originalSave=r.save,r.__originalRestore=r.restore,r.__originalRotate=r.rotate,r.__originalScale=r.scale,r.__originalTranslate=r.translate,r.__originalTransform=r.transform,r.__originalSetTransform=r.setTransform,r.__originalResetTransform=r.resetTransform,r.__originalClip=r.clip,r.__originalMoveTo=r.moveTo,r.__originalLineTo=r.lineTo,r.__originalBezierCurveTo=r.bezierCurveTo,r.__originalRect=r.rect,r.__originalClosePath=r.closePath,r.__originalBeginPath=r.beginPath,r._removeMirroring=()=>{r.save=r.__originalSave,r.restore=r.__originalRestore,r.rotate=r.__originalRotate,r.scale=r.__originalScale,r.translate=r.__originalTranslate,r.transform=r.__originalTransform,r.setTransform=r.__originalSetTransform,r.resetTransform=r.__originalResetTransform,r.clip=r.__originalClip,r.moveTo=r.__originalMoveTo,r.lineTo=r.__originalLineTo,r.bezierCurveTo=r.__originalBezierCurveTo,r.rect=r.__originalRect,r.closePath=r.__originalClosePath,r.beginPath=r.__originalBeginPath,delete r._removeMirroring},r.save=function(){e.save(),this.__originalSave()},r.restore=function(){e.restore(),this.__originalRestore()},r.translate=function(t,n){e.translate(t,n),this.__originalTranslate(t,n)},r.scale=function(t,n){e.scale(t,n),this.__originalScale(t,n)},r.transform=function(t,n,s,i,o,c){e.transform(t,n,s,i,o,c),this.__originalTransform(t,n,s,i,o,c)},r.setTransform=function(t,n,s,i,o,c){e.setTransform(t,n,s,i,o,c),this.__originalSetTransform(t,n,s,i,o,c)},r.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},r.rotate=function(t){e.rotate(t),this.__originalRotate(t)},r.clip=function(t){e.clip(t),this.__originalClip(t)},r.moveTo=function(t,n){e.moveTo(t,n),this.__originalMoveTo(t,n)},r.lineTo=function(t,n){e.lineTo(t,n),this.__originalLineTo(t,n)},r.bezierCurveTo=function(t,n,s,i,o,c){e.bezierCurveTo(t,n,s,i,o,c),this.__originalBezierCurveTo(t,n,s,i,o,c)},r.rect=function(t,n,s,i){e.rect(t,n,s,i),this.__originalRect(t,n,s,i)},r.closePath=function(){e.closePath(),this.__originalClosePath()},r.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class nj{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,n){let s;return this.cache[e]!==void 0?(s=this.cache[e],this.canvasFactory.reset(s,t,n)):(s=this.canvasFactory.create(t,n),this.cache[e]=s),s}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function Zd(r,e,t,n,s,i,o,c,u,h){const[f,m,y,_,A,b]=St(r);if(m===0&&y===0){const M=o*f+A,R=Math.round(M),B=c*_+b,O=Math.round(B),$=(o+u)*f+A,k=Math.abs(Math.round($)-R)||1,C=(c+h)*_+b,P=Math.abs(Math.round(C)-O)||1;return r.setTransform(Math.sign(f),0,0,Math.sign(_),R,O),r.drawImage(e,t,n,s,i,0,0,k,P),r.setTransform(f,m,y,_,A,b),[k,P]}if(f===0&&_===0){const M=c*y+A,R=Math.round(M),B=o*m+b,O=Math.round(B),$=(c+h)*y+A,k=Math.abs(Math.round($)-R)||1,C=(o+u)*m+b,P=Math.abs(Math.round(C)-O)||1;return r.setTransform(0,Math.sign(m),Math.sign(y),0,R,O),r.drawImage(e,t,n,s,i,0,0,P,k),r.setTransform(f,m,y,_,A,b),[P,k]}r.drawImage(e,t,n,s,i,o,c,u,h);const T=Math.hypot(f,m),x=Math.hypot(y,_);return[T*u,x*h]}class jb{alphaIsShape=!1;fontSize=0;fontSizeScale=1;textMatrix=null;textMatrixScale=1;fontMatrix=qy;leading=0;x=0;y=0;lineX=0;lineY=0;charSpacing=0;wordSpacing=0;textHScale=1;textRenderingMode=Sn.FILL;textRise=0;fillColor="#000000";strokeColor="#000000";patternFill=!1;patternStroke=!1;fillAlpha=1;strokeAlpha=1;lineWidth=1;activeSMask=null;transferMaps="none";constructor(e,t){this.clipBox=new Float32Array([0,0,e,t]),this.minMax=Il.slice()}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(e=mn.FILL,t=null){const n=this.minMax.slice();if(e===mn.STROKE){t||it("Stroke bounding box must include transform."),be.singularValueDecompose2dScale(t,cr);const s=cr[0]*this.lineWidth/2,i=cr[1]*this.lineWidth/2;n[0]-=s,n[1]-=i,n[2]+=s,n[3]+=i}return n}updateClipFromPath(){const e=be.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set(Il,0)}getClippedPathBoundingBox(e=mn.FILL,t=null){return be.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function Bb(r,e){if(e instanceof ImageData){r.putImageData(e,0,0);return}const t=e.height,n=e.width,s=t%Jn,i=(t-s)/Jn,o=s===0?i:i+1,c=r.createImageData(n,Jn);let u=0,h;const f=e.data,m=c.data;let y,_,A,b;if(e.kind===Cu.GRAYSCALE_1BPP){const T=f.byteLength,x=new Uint32Array(m.buffer,0,m.byteLength>>2),M=x.length,R=n+7>>3,B=4294967295,O=ln.isLittleEndian?4278190080:255;for(y=0;y<o;y++){for(A=y<i?Jn:s,h=0,_=0;_<A;_++){const $=T-u;let k=0;const C=$>R?n:$*8-7,P=C&-8;let N=0,j=0;for(;k<P;k+=8)j=f[u++],x[h++]=j&128?B:O,x[h++]=j&64?B:O,x[h++]=j&32?B:O,x[h++]=j&16?B:O,x[h++]=j&8?B:O,x[h++]=j&4?B:O,x[h++]=j&2?B:O,x[h++]=j&1?B:O;for(;k<C;k++)N===0&&(j=f[u++],N=128),x[h++]=j&N?B:O,N>>=1}for(;h<M;)x[h++]=0;r.putImageData(c,0,y*Jn)}}else if(e.kind===Cu.RGBA_32BPP){for(_=0,b=n*Jn*4,y=0;y<i;y++)m.set(f.subarray(u,u+b)),u+=b,r.putImageData(c,0,_),_+=Jn;y<o&&(b=n*s*4,m.set(f.subarray(u,u+b)),r.putImageData(c,0,_))}else if(e.kind===Cu.RGB_24BPP)for(A=Jn,b=n*A,y=0;y<o;y++){for(y>=i&&(A=s,b=n*A),h=0,_=b;_--;)m[h++]=f[u++],m[h++]=f[u++],m[h++]=f[u++],m[h++]=255;r.putImageData(c,0,y*Jn)}else throw new Error(`bad image kind: ${e.kind}`)}function Ub(r,e){if(e.bitmap){r.drawImage(e.bitmap,0,0);return}const t=e.height,n=e.width,s=t%Jn,i=(t-s)/Jn,o=s===0?i:i+1,c=r.createImageData(n,Jn);let u=0;const h=e.data,f=c.data;for(let m=0;m<o;m++){const y=m<i?Jn:s;({srcPos:u}=Z8({src:h,srcPos:u,dest:f,width:n,height:y,nonBlackColor:0})),r.putImageData(c,0,m*Jn)}}function tu(r,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const n of t)r[n]!==void 0&&(e[n]=r[n]);r.setLineDash!==void 0&&(e.setLineDash(r.getLineDash()),e.lineDashOffset=r.lineDashOffset)}function ef(r){r.strokeStyle=r.fillStyle="#000000",r.fillRule="nonzero",r.globalAlpha=1,r.lineWidth=1,r.lineCap="butt",r.lineJoin="miter",r.miterLimit=10,r.globalCompositeOperation="source-over",r.font="10px sans-serif",r.setLineDash!==void 0&&(r.setLineDash([]),r.lineDashOffset=0);const{filter:e}=r;e!=="none"&&e!==""&&(r.filter="none")}function zb(r,e){if(e)return!0;be.singularValueDecompose2dScale(r,cr);const t=Math.fround(ns.pixelRatio*ma.PDF_TO_CSS_UNITS);return cr[0]<=t&&cr[1]<=t}const rj=["butt","round","square"],sj=["miter","round","bevel"],ij={},$b={};class Nl{constructor(e,t,n,s,i,{optionalContentConfig:o,markedContentStack:c=null},u,h){this.ctx=e,this.current=new jb(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=n,this.canvasFactory=s,this.filterFactory=i,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=c||[],this.optionalContentConfig=o,this.cachedCanvases=new nj(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=u,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=h,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,t=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing({transform:e,viewport:t,transparency:n=!1,background:s=null}){const i=this.ctx.canvas.width,o=this.ctx.canvas.height,c=this.ctx.fillStyle;if(this.ctx.fillStyle=s||"#ffffff",this.ctx.fillRect(0,0,i,o),this.ctx.fillStyle=c,n){const u=this.cachedCanvases.getCanvas("transparent",i,o);this.compositeCtx=this.ctx,this.transparentCanvas=u.canvas,this.ctx=u.context,this.ctx.save(),this.ctx.transform(...St(this.compositeCtx))}this.ctx.save(),ef(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=St(this.ctx)}executeOperatorList(e,t,n,s){const i=e.argsArray,o=e.fnArray;let c=t||0;const u=i.length;if(u===c)return c;const h=u-c>Vb&&typeof n=="function",f=h?Date.now()+ej:0;let m=0;const y=this.commonObjs,_=this.objs;let A;for(;;){if(s!==void 0&&c===s.nextBreakPoint)return s.breakIt(c,n),c;if(A=o[c],A!==Gu.dependency)this[A].apply(this,i[c]);else for(const b of i[c]){const T=b.startsWith("g_")?y:_;if(!T.has(b))return T.get(b,n),c}if(c++,c===u)return c;if(h&&++m>Vb){if(Date.now()>f)return n(),c;m=0}}}#e(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#e(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),this.#t()}#t(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}}_scaleImage(e,t){const n=e.width??e.displayWidth,s=e.height??e.displayHeight;let i=Math.max(Math.hypot(t[0],t[1]),1),o=Math.max(Math.hypot(t[2],t[3]),1),c=n,u=s,h="prescale1",f,m;for(;i>2&&c>1||o>2&&u>1;){let y=c,_=u;i>2&&c>1&&(y=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c/2),i/=c/y),o>2&&u>1&&(_=u>=16384?Math.floor(u/2)-1||1:Math.ceil(u)/2,o/=u/_),f=this.cachedCanvases.getCanvas(h,y,_),m=f.context,m.clearRect(0,0,y,_),m.drawImage(e,0,0,c,u,0,0,y,_),e=f.canvas,c=y,u=_,h=h==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:c,paintHeight:u}}_createMaskCanvas(e){const t=this.ctx,{width:n,height:s}=e,i=this.current.fillColor,o=this.current.patternFill,c=St(t);let u,h,f,m;if((e.bitmap||e.data)&&e.count>1){const P=e.bitmap||e.data.buffer;h=JSON.stringify(o?c:[c.slice(0,4),i]),u=this._cachedBitmapsMap.get(P),u||(u=new Map,this._cachedBitmapsMap.set(P,u));const N=u.get(h);if(N&&!o){const j=Math.round(Math.min(c[0],c[2])+c[4]),z=Math.round(Math.min(c[1],c[3])+c[5]);return{canvas:N,offsetX:j,offsetY:z}}f=N}f||(m=this.cachedCanvases.getCanvas("maskCanvas",n,s),Ub(m.context,e));let y=be.transform(c,[1/n,0,0,-1/s,0,0]);y=be.transform(y,[1,0,0,1,0,-s]);const _=Il.slice();be.axialAlignedBoundingBox([0,0,n,s],y,_);const[A,b,T,x]=_,M=Math.round(T-A)||1,R=Math.round(x-b)||1,B=this.cachedCanvases.getCanvas("fillCanvas",M,R),O=B.context,$=A,k=b;O.translate(-$,-k),O.transform(...y),f||(f=this._scaleImage(m.canvas,vs(O)),f=f.img,u&&o&&u.set(h,f)),O.imageSmoothingEnabled=zb(St(O),e.interpolate),Zd(O,f,0,0,f.width,f.height,0,0,n,s),O.globalCompositeOperation="source-in";const C=be.transform(vs(O),[1,0,0,1,-$,-k]);return O.fillStyle=o?i.getPattern(t,this,C,mn.FILL):i,O.fillRect(0,0,n,s),u&&!o&&(this.cachedCanvases.delete("fillCanvas"),u.set(h,B.canvas)),{canvas:B.canvas,offsetX:Math.round($),offsetY:Math.round(k)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=rj[e]}setLineJoin(e){this.ctx.lineJoin=sj[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){const n=this.ctx;n.setLineDash!==void 0&&(n.setLineDash(e),n.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,n]of e)switch(t){case"LW":this.setLineWidth(n);break;case"LC":this.setLineCap(n);break;case"LJ":this.setLineJoin(n);break;case"ML":this.setMiterLimit(n);break;case"D":this.setDash(n[0],n[1]);break;case"RI":this.setRenderingIntent(n);break;case"FL":this.setFlatness(n);break;case"Font":this.setFont(n[0],n[1]);break;case"CA":this.current.strokeAlpha=n;break;case"ca":this.ctx.globalAlpha=this.current.fillAlpha=n;break;case"BM":this.ctx.globalCompositeOperation=n;break;case"SMask":this.current.activeSMask=n?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(n);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,t=this.ctx.canvas.height,n="smaskGroupAt"+this.groupLevel,s=this.cachedCanvases.getCanvas(n,e,t);this.suspendedCtx=this.ctx;const i=this.ctx=s.context;i.setTransform(this.suspendedCtx.getTransform()),tu(this.suspendedCtx,i),tj(i,this.suspendedCtx),this.setGState([["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),tu(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,n,s){const i=s[0],o=s[1],c=s[2]-i,u=s[3]-o;c===0||u===0||(this.genericComposeSMask(t.context,n,c,u,t.subtype,t.backdrop,t.transferMap,i,o,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(n.canvas,0,0),e.restore())}genericComposeSMask(e,t,n,s,i,o,c,u,h,f,m){let y=e.canvas,_=u-f,A=h-m;if(o)if(_<0||A<0||_+n>y.width||A+s>y.height){const T=this.cachedCanvases.getCanvas("maskExtension",n,s),x=T.context;x.drawImage(y,-_,-A),x.globalCompositeOperation="destination-atop",x.fillStyle=o,x.fillRect(0,0,n,s),x.globalCompositeOperation="source-over",y=T.canvas,_=A=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const T=new Path2D;T.rect(_,A,n,s),e.clip(T),e.globalCompositeOperation="destination-atop",e.fillStyle=o,e.fillRect(_,A,n,s),e.restore()}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),i==="Alpha"&&c?t.filter=this.filterFactory.addAlphaFilter(c):i==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(c));const b=new Path2D;b.rect(u,h,n,s),t.clip(b),t.globalCompositeOperation="destination-in",t.drawImage(y,_,A,n,s,u,h,n,s),t.restore()}save(){this.inSMaskMode&&tu(this.ctx,this.suspendedCtx),this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){if(this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&tu(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(e,t,n,s,i,o){this.ctx.transform(e,t,n,s,i,o),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,n){let[s]=t;if(!n){s||=t[0]=new Path2D,this[e](s);return}if(!(s instanceof Path2D)){const i=t[0]=new Path2D;for(let o=0,c=s.length;o<c;)switch(s[o++]){case Yd.moveTo:i.moveTo(s[o++],s[o++]);break;case Yd.lineTo:i.lineTo(s[o++],s[o++]);break;case Yd.curveTo:i.bezierCurveTo(s[o++],s[o++],s[o++],s[o++],s[o++],s[o++]);break;case Yd.closePath:i.closePath();break;default:Ve(`Unrecognized drawing path operator: ${s[o-1]}`);break}s=i}be.axialAlignedBoundingBox(n,St(this.ctx),this.current.minMax),this[e](s)}closePath(){this.ctx.closePath()}stroke(e,t=!0){const n=this.ctx,s=this.current.strokeColor;if(n.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof s=="object"&&s?.getPattern){const i=s.isModifyingCurrentTransform()?n.getTransform():null;if(n.save(),n.strokeStyle=s.getPattern(n,this,vs(n),mn.STROKE),i){const o=new Path2D;o.addPath(e,n.getTransform().invertSelf().multiplySelf(i)),e=o}this.rescaleAndStroke(e,!1),n.restore()}else this.rescaleAndStroke(e,!0);t&&this.consumePath(e,this.current.getClippedPathBoundingBox(mn.STROKE,St(this.ctx))),n.globalAlpha=this.current.fillAlpha}closeStroke(e){this.stroke(e)}fill(e,t=!0){const n=this.ctx,s=this.current.fillColor,i=this.current.patternFill;let o=!1;if(i){const u=s.isModifyingCurrentTransform()?n.getTransform():null;if(n.save(),n.fillStyle=s.getPattern(n,this,vs(n),mn.FILL),u){const h=new Path2D;h.addPath(e,n.getTransform().invertSelf().multiplySelf(u)),e=h}o=!0}const c=this.current.getClippedPathBoundingBox();this.contentVisible&&c!==null&&(this.pendingEOFill?(n.fill(e,"evenodd"),this.pendingEOFill=!1):n.fill(e)),o&&n.restore(),t&&this.consumePath(e,c)}eoFill(e){this.pendingEOFill=!0,this.fill(e)}fillStroke(e){this.fill(e,!1),this.stroke(e,!1),this.consumePath(e)}eoFillStroke(e){this.pendingEOFill=!0,this.fillStroke(e)}closeFillStroke(e){this.fillStroke(e)}closeEOFillStroke(e){this.pendingEOFill=!0,this.fillStroke(e)}endPath(e){this.consumePath(e)}rawFillPath(e){this.ctx.fill(e)}clip(){this.pendingClip=ij}eoClip(){this.pendingClip=$b}beginText(){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,t=this.ctx;if(e===void 0)return;const n=new Path2D,s=t.getTransform().invertSelf();for(const{transform:i,x:o,y:c,fontSize:u,path:h}of e)n.addPath(h,new DOMMatrix(i).preMultiplySelf(s).translate(o,c).scale(u,-u));t.clip(n),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){const n=this.commonObjs.get(e),s=this.current;if(!n)throw new Error(`Can't find font for ${e}`);if(s.fontMatrix=n.fontMatrix||qy,(s.fontMatrix[0]===0||s.fontMatrix[3]===0)&&Ve("Invalid font matrix for font "+e),t<0?(t=-t,s.fontDirection=-1):s.fontDirection=1,this.current.font=n,this.current.fontSize=t,n.isType3Font)return;const i=n.loadedName||"sans-serif",o=n.systemFontInfo?.css||`"${i}", ${n.fallbackName}`;let c="normal";n.black?c="900":n.bold&&(c="bold");const u=n.italic?"italic":"normal";let h=t;t<Ob?h=Ob:t>Fb&&(h=Fb),this.current.fontSizeScale=t/h,this.ctx.font=`${u} ${c} ${h}px ${o}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e){const{current:t}=this;t.textMatrix=e,t.textMatrixScale=Math.hypot(e[0],e[1]),t.x=t.lineX=0,t.y=t.lineY=0}nextLine(){this.moveText(0,this.current.leading)}#n(e,t,n){const s=new Path2D;return s.addPath(e,new DOMMatrix(n).invertSelf().multiplySelf(t)),s}paintChar(e,t,n,s,i){const o=this.ctx,c=this.current,u=c.font,h=c.textRenderingMode,f=c.fontSize/c.fontSizeScale,m=h&Sn.FILL_STROKE_MASK,y=!!(h&Sn.ADD_TO_PATH_FLAG),_=c.patternFill&&!u.missingFile,A=c.patternStroke&&!u.missingFile;let b;if((u.disableFontFace||y||_||A)&&(b=u.getPathGenerator(this.commonObjs,e)),u.disableFontFace||_||A){o.save(),o.translate(t,n),o.scale(f,-f);let T;if((m===Sn.FILL||m===Sn.FILL_STROKE)&&(s?(T=o.getTransform(),o.setTransform(...s),o.fill(this.#n(b,T,s))):o.fill(b)),m===Sn.STROKE||m===Sn.FILL_STROKE)if(i){T||=o.getTransform(),o.setTransform(...i);const{a:x,b:M,c:R,d:B}=T,O=be.inverseTransform(i),$=be.transform([x,M,R,B,0,0],O);be.singularValueDecompose2dScale($,cr),o.lineWidth*=Math.max(cr[0],cr[1])/f,o.stroke(this.#n(b,T,i))}else o.lineWidth/=f,o.stroke(b);o.restore()}else(m===Sn.FILL||m===Sn.FILL_STROKE)&&o.fillText(e,t,n),(m===Sn.STROKE||m===Sn.FILL_STROKE)&&o.strokeText(e,t,n);y&&(this.pendingTextPaths||=[]).push({transform:St(o),x:t,y:n,fontSize:f,path:b})}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let n=!1;for(let s=3;s<t.length;s+=4)if(t[s]>0&&t[s]<255){n=!0;break}return We(this,"isFontSubpixelAAEnabled",n)}showText(e){const t=this.current,n=t.font;if(n.isType3Font)return this.showType3Text(e);const s=t.fontSize;if(s===0)return;const i=this.ctx,o=t.fontSizeScale,c=t.charSpacing,u=t.wordSpacing,h=t.fontDirection,f=t.textHScale*h,m=e.length,y=n.vertical,_=y?1:-1,A=n.defaultVMetrics,b=s*t.fontMatrix[0],T=t.textRenderingMode===Sn.FILL&&!n.disableFontFace&&!t.patternFill;i.save(),t.textMatrix&&i.transform(...t.textMatrix),i.translate(t.x,t.y+t.textRise),h>0?i.scale(f,-1):i.scale(f,1);let x,M;if(t.patternFill){i.save();const k=t.fillColor.getPattern(i,this,vs(i),mn.FILL);x=St(i),i.restore(),i.fillStyle=k}if(t.patternStroke){i.save();const k=t.strokeColor.getPattern(i,this,vs(i),mn.STROKE);M=St(i),i.restore(),i.strokeStyle=k}let R=t.lineWidth;const B=t.textMatrixScale;if(B===0||R===0){const k=t.textRenderingMode&Sn.FILL_STROKE_MASK;(k===Sn.STROKE||k===Sn.FILL_STROKE)&&(R=this.getSinglePixelWidth())}else R/=B;if(o!==1&&(i.scale(o,o),R/=o),i.lineWidth=R,n.isInvalidPDFjsFont){const k=[];let C=0;for(const P of e)k.push(P.unicode),C+=P.width;i.fillText(k.join(""),0,0),t.x+=C*b*f,i.restore(),this.compose();return}let O=0,$;for($=0;$<m;++$){const k=e[$];if(typeof k=="number"){O+=_*k*s/1e3;continue}let C=!1;const P=(k.isSpace?u:0)+c,N=k.fontChar,j=k.accent;let z,F,ue=k.width;if(y){const ie=k.vmetric||A,Z=-(k.vmetric?ie[1]:ue*.5)*b,te=ie[2]*b;ue=ie?-ie[0]:ue,z=Z/o,F=(O+te)/o}else z=O/o,F=0;if(n.remeasure&&ue>0){const ie=i.measureText(N).width*1e3/s*o;if(ue<ie&&this.isFontSubpixelAAEnabled){const Z=ue/ie;C=!0,i.save(),i.scale(Z,1),z/=Z}else ue!==ie&&(z+=(ue-ie)/2e3*s/o)}if(this.contentVisible&&(k.isInFont||n.missingFile)){if(T&&!j)i.fillText(N,z,F);else if(this.paintChar(N,z,F,x,M),j){const ie=z+s*j.offset.x/o,Z=F-s*j.offset.y/o;this.paintChar(j.fontChar,ie,Z,x,M)}}const ke=y?ue*b-P*h:ue*b+P*h;O+=ke,C&&i.restore()}y?t.y-=O:t.x+=O*f,i.restore(),this.compose()}showType3Text(e){const t=this.ctx,n=this.current,s=n.font,i=n.fontSize,o=n.fontDirection,c=s.vertical?1:-1,u=n.charSpacing,h=n.wordSpacing,f=n.textHScale*o,m=n.fontMatrix||qy,y=e.length,_=n.textRenderingMode===Sn.INVISIBLE;let A,b,T,x;if(!(_||i===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),n.textMatrix&&t.transform(...n.textMatrix),t.translate(n.x,n.y+n.textRise),t.scale(f,o),A=0;A<y;++A){if(b=e[A],typeof b=="number"){x=c*b*i/1e3,this.ctx.translate(x,0),n.x+=x*f;continue}const M=(b.isSpace?h:0)+u,R=s.charProcOperatorList[b.operatorListId];R?this.contentVisible&&(this.save(),t.scale(i,i),t.transform(...m),this.executeOperatorList(R),this.restore()):Ve(`Type3 character "${b.operatorListId}" is not available.`);const B=[b.width,0];be.applyTransform(B,m),T=B[0]*i+M,t.translate(T,0),n.x+=T*f}t.restore()}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,n,s,i,o){const c=new Path2D;c.rect(n,s,i-n,o-s),this.ctx.clip(c),this.endPath()}getColorN_Pattern(e){let t;if(e[0]==="TilingPattern"){const n=this.baseTransform||St(this.ctx),s={createCanvasGraphics:i=>new Nl(i,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new K0(e,this.ctx,s,n)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e){this.ctx.strokeStyle=this.current.strokeColor=e,this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e){this.ctx.fillStyle=this.current.fillColor=e,this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t=null){let n;return this.cachedPatterns.has(e)?n=this.cachedPatterns.get(e):(n=J8(this.getObject(e)),this.cachedPatterns.set(e,n)),t&&(n.matrix=t),n}shadingFill(e){if(!this.contentVisible)return;const t=this.ctx;this.save();const n=this._getPattern(e);t.fillStyle=n.getPattern(t,this,vs(t),mn.SHADING);const s=vs(t);if(s){const{width:i,height:o}=t.canvas,c=Il.slice();be.axialAlignedBoundingBox([0,0,i,o],s,c);const[u,h,f,m]=c;this.ctx.fillRect(u,h,f-u,m-h)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){it("Should not call beginInlineImage")}beginImageData(){it("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=St(this.ctx),t)){be.axialAlignedBoundingBox(t,this.baseTransform,this.current.minMax);const[n,s,i,o]=t,c=new Path2D;c.rect(n,s,i-n,o-s),this.ctx.clip(c),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const t=this.ctx;e.isolated||Rp("TODO: Support non-isolated groups."),e.knockout&&Ve("Knockout groups not supported.");const n=St(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let s=Il.slice();be.axialAlignedBoundingBox(e.bbox,St(t),s);const i=[0,0,t.canvas.width,t.canvas.height];s=be.intersect(s,i)||[0,0,0,0];const o=Math.floor(s[0]),c=Math.floor(s[1]),u=Math.max(Math.ceil(s[2])-o,1),h=Math.max(Math.ceil(s[3])-c,1);this.current.startNewPathAndClipBox([0,0,u,h]);let f="groupAt"+this.groupLevel;e.smask&&(f+="_smask_"+this.smaskCounter++%2);const m=this.cachedCanvases.getCanvas(f,u,h),y=m.context;y.translate(-o,-c),y.transform(...n);let _=new Path2D;const[A,b,T,x]=e.bbox;if(_.rect(A,b,T-A,x-b),e.matrix){const M=new Path2D;M.addPath(_,new DOMMatrix(e.matrix)),_=M}y.clip(_),e.smask?this.smaskStack.push({canvas:m.canvas,context:y,offsetX:o,offsetY:c,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(o,c),t.save()),tu(t,y),this.ctx=y,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const t=this.ctx,n=this.groupStack.pop();if(this.ctx=n,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const s=St(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...s);const i=Il.slice();be.axialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],s,i),this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(i)}}beginAnnotation(e,t,n,s,i){if(this.#e(),ef(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),t){const o=t[2]-t[0],c=t[3]-t[1];if(i&&this.annotationCanvasMap){n=n.slice(),n[4]-=t[0],n[5]-=t[1],t=t.slice(),t[0]=t[1]=0,t[2]=o,t[3]=c,be.singularValueDecompose2dScale(St(this.ctx),cr);const{viewportScale:u}=this,h=Math.ceil(o*this.outputScaleX*u),f=Math.ceil(c*this.outputScaleY*u);this.annotationCanvas=this.canvasFactory.create(h,f);const{canvas:m,context:y}=this.annotationCanvas;this.annotationCanvasMap.set(e,m),this.annotationCanvas.savedCtx=this.ctx,this.ctx=y,this.ctx.save(),this.ctx.setTransform(cr[0],0,0,-cr[1],0,c*cr[1]),ef(this.ctx)}else{ef(this.ctx),this.endPath();const u=new Path2D;u.rect(t[0],t[1],o,c),this.ctx.clip(u)}}this.current=new jb(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...n),this.transform(...s)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),this.#t(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const t=e.count;e=this.getObject(e.data,e),e.count=t;const n=this.ctx,s=this._createMaskCanvas(e),i=s.canvas;n.save(),n.setTransform(1,0,0,1,0,0),n.drawImage(i,s.offsetX,s.offsetY),n.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,n=0,s=0,i,o){if(!this.contentVisible)return;e=this.getObject(e.data,e);const c=this.ctx;c.save();const u=St(c);c.transform(t,n,s,i,0,0);const h=this._createMaskCanvas(e);c.setTransform(1,0,0,1,h.offsetX-u[4],h.offsetY-u[5]);for(let f=0,m=o.length;f<m;f+=2){const y=be.transform(u,[t,n,s,i,o[f],o[f+1]]);c.drawImage(h.canvas,y[4],y[5])}c.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const t=this.ctx,n=this.current.fillColor,s=this.current.patternFill;for(const i of e){const{data:o,width:c,height:u,transform:h}=i,f=this.cachedCanvases.getCanvas("maskCanvas",c,u),m=f.context;m.save();const y=this.getObject(o,i);Ub(m,y),m.globalCompositeOperation="source-in",m.fillStyle=s?n.getPattern(m,this,vs(t),mn.FILL):n,m.fillRect(0,0,c,u),m.restore(),t.save(),t.transform(...h),t.scale(1,-1),Zd(t,f.canvas,0,0,c,u,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const t=this.getObject(e);if(!t){Ve("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t)}paintImageXObjectRepeat(e,t,n,s){if(!this.contentVisible)return;const i=this.getObject(e);if(!i){Ve("Dependent image isn't ready yet");return}const o=i.width,c=i.height,u=[];for(let h=0,f=s.length;h<f;h+=2)u.push({transform:[t,0,0,n,s[h],s[h+1]],x:0,y:0,w:o,h:c});this.paintInlineImageXObjectGroup(i,u)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:n,height:s}=e,i=this.cachedCanvases.getCanvas("inlineImage",n,s),o=i.context;return o.filter=this.current.transferMaps,o.drawImage(t,0,0),o.filter="none",i.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;const t=e.width,n=e.height,s=this.ctx;this.save();const{filter:i}=s;i!=="none"&&i!==""&&(s.filter="none"),s.scale(1/t,-1/n);let o;if(e.bitmap)o=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)o=e;else{const h=this.cachedCanvases.getCanvas("inlineImage",t,n).context;Bb(h,e),o=this.applyTransferMapsToCanvas(h)}const c=this._scaleImage(o,vs(s));s.imageSmoothingEnabled=zb(St(s),e.interpolate),Zd(s,c.img,0,0,c.paintWidth,c.paintHeight,0,-n,t,n),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;const n=this.ctx;let s;if(e.bitmap)s=e.bitmap;else{const i=e.width,o=e.height,u=this.cachedCanvases.getCanvas("inlineImage",i,o).context;Bb(u,e),s=this.applyTransferMapsToCanvas(u)}for(const i of t)n.save(),n.transform(...i.transform),n.scale(1,-1),Zd(n,s,i.x,i.y,i.w,i.h,0,-1,1,1),n.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e,t){const n=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(t);const s=this.ctx;this.pendingClip&&(n||(this.pendingClip===$b?s.clip(e,"evenodd"):s.clip(e)),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=St(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),n=Math.hypot(e[0],e[2]),s=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(n,s)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:n,c:s,d:i}=this.ctx.getTransform();let o,c;if(n===0&&s===0){const u=Math.abs(t),h=Math.abs(i);if(u===h)if(e===0)o=c=1/u;else{const f=u*e;o=c=f<1?1/f:1}else if(e===0)o=1/u,c=1/h;else{const f=u*e,m=h*e;o=f<1?1/f:1,c=m<1?1/m:1}}else{const u=Math.abs(t*i-n*s),h=Math.hypot(t,n),f=Math.hypot(s,i);if(e===0)o=f/u,c=h/u;else{const m=e*u;o=f>m?f/m:1,c=h>m?h/m:1}}this._cachedScaleForStroking[0]=o,this._cachedScaleForStroking[1]=c}return this._cachedScaleForStroking}rescaleAndStroke(e,t){const{ctx:n,current:{lineWidth:s}}=this,[i,o]=this.getScaleForStroking();if(i===o){n.lineWidth=(s||1)*i,n.stroke(e);return}const c=n.getLineDash();t&&n.save(),n.scale(i,o),Jg.a=1/i,Jg.d=1/o;const u=new Path2D;if(u.addPath(e,Jg),c.length>0){const h=Math.max(i,o);n.setLineDash(c.map(f=>f/h)),n.lineDashOffset/=h}n.lineWidth=s||1,n.stroke(u),t&&n.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}}for(const r in Gu)Nl.prototype[r]!==void 0&&(Nl.prototype[Gu[r]]=Nl.prototype[r]);class io{static#e=null;static#t="";static get workerPort(){return this.#e}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");this.#e=e}static get workerSrc(){return this.#t}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");this.#t=e}}class oj{#e;#t;constructor({parsedData:e,rawData:t}){this.#e=e,this.#t=t}getRaw(){return this.#t}get(e){return this.#e.get(e)??null}[Symbol.iterator](){return this.#e.entries()}}const El=Symbol("INTERNAL");class aj{#e=!1;#t=!1;#n=!1;#r=!0;constructor(e,{name:t,intent:n,usage:s,rbGroups:i}){this.#e=!!(e&ar.DISPLAY),this.#t=!!(e&ar.PRINT),this.name=t,this.intent=n,this.usage=s,this.rbGroups=i}get visible(){if(this.#n)return this.#r;if(!this.#r)return!1;const{print:e,view:t}=this.usage;return this.#e?t?.viewState!=="OFF":this.#t?e?.printState!=="OFF":!0}_setVisible(e,t,n=!1){e!==El&&it("Internal method `_setVisible` called."),this.#n=n,this.#r=t}}class lj{#e=null;#t=new Map;#n=null;#r=null;constructor(e,t=ar.DISPLAY){if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,this.#r=e.order;for(const n of e.groups)this.#t.set(n.id,new aj(t,n));if(e.baseState==="OFF")for(const n of this.#t.values())n._setVisible(El,!1);for(const n of e.on)this.#t.get(n)._setVisible(El,!0);for(const n of e.off)this.#t.get(n)._setVisible(El,!1);this.#n=this.getHash()}}#i(e){const t=e.length;if(t<2)return!0;const n=e[0];for(let s=1;s<t;s++){const i=e[s];let o;if(Array.isArray(i))o=this.#i(i);else if(this.#t.has(i))o=this.#t.get(i).visible;else return Ve(`Optional content group not found: ${i}`),!0;switch(n){case"And":if(!o)return!1;break;case"Or":if(o)return!0;break;case"Not":return!o;default:return!0}}return n==="And"}isVisible(e){if(this.#t.size===0)return!0;if(!e)return Rp("Optional content group not defined."),!0;if(e.type==="OCG")return this.#t.has(e.id)?this.#t.get(e.id).visible:(Ve(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return this.#i(e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!this.#t.has(t))return Ve(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!this.#t.has(t))return Ve(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!this.#t.has(t))return Ve(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!this.#t.has(t))return Ve(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!1}return!0}return Ve(`Unknown optional content policy ${e.policy}.`),!0}return Ve(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,n=!0){const s=this.#t.get(e);if(!s){Ve(`Optional content group not found: ${e}`);return}if(n&&t&&s.rbGroups.length)for(const i of s.rbGroups)for(const o of i)o!==e&&this.#t.get(o)?._setVisible(El,!1,!0);s._setVisible(El,!!t,!0),this.#e=null}setOCGState({state:e,preserveRB:t}){let n;for(const s of e){switch(s){case"ON":case"OFF":case"Toggle":n=s;continue}const i=this.#t.get(s);if(i)switch(n){case"ON":this.setVisibility(s,!0,t);break;case"OFF":this.setVisibility(s,!1,t);break;case"Toggle":this.setVisibility(s,!i.visible,t);break}}this.#e=null}get hasInitialVisibility(){return this.#n===null||this.getHash()===this.#n}getOrder(){return this.#t.size?this.#r?this.#r.slice():[...this.#t.keys()]:null}getGroup(e){return this.#t.get(e)||null}getHash(){if(this.#e!==null)return this.#e;const e=new HI;for(const[t,n]of this.#t)e.update(`${t}:${n.visible}`);return this.#e=e.hexdigest()}[Symbol.iterator](){return this.#t.entries()}}class cj{constructor(e,{disableRange:t=!1,disableStream:n=!1}){Wt(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:s,initialData:i,progressiveDone:o,contentDispositionFilename:c}=e;if(this._queuedChunks=[],this._progressiveDone=o,this._contentDispositionFilename=c,i?.length>0){const u=i instanceof Uint8Array&&i.byteLength===i.buffer.byteLength?i.buffer:new Uint8Array(i).buffer;this._queuedChunks.push(u)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!n,this._isRangeSupported=!t,this._contentLength=s,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((u,h)=>{this._onReceiveData({begin:u,chunk:h})}),e.addProgressListener((u,h)=>{this._onProgress({loaded:u,total:h})}),e.addProgressiveReadListener(u=>{this._onReceiveData({chunk:u})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const n=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(n):this._queuedChunks.push(n);else{const s=this._rangeReaders.some(function(i){return i._begin!==e?!1:(i._enqueue(n),!0)});Wt(s,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(e){e.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:e.loaded}):this._fullRequestReader?.onProgress?.({loaded:e.loaded,total:e.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){Wt(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new uj(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new hj(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeReaders.slice(0))t.cancel(e);this._pdfDataRangeTransport.abort()}}class uj{constructor(e,t,n=!1,s=null){this._stream=e,this._done=n||!1,this._filename=Lp(s)?s:null,this._queuedChunks=t||[],this._loaded=0;for(const i of this._queuedChunks)this._loaded+=i.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class hj{constructor(e,t,n){this._stream=e,this._begin=t,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function dj(r){let e=!0,t=n("filename\\*","i").exec(r);if(t){t=t[1];let f=c(t);return f=unescape(f),f=u(f),f=h(f),i(f)}if(t=o(r),t){const f=h(t);return i(f)}if(t=n("filename","i").exec(r),t){t=t[1];let f=c(t);return f=h(f),i(f)}function n(f,m){return new RegExp("(?:^|;)\\s*"+f+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',m)}function s(f,m){if(f){if(!/^[\x00-\xFF]+$/.test(m))return m;try{const y=new TextDecoder(f,{fatal:!0}),_=mh(m);m=y.decode(_),e=!1}catch{}}return m}function i(f){return e&&/[\x80-\xff]/.test(f)&&(f=s("utf-8",f),e&&(f=s("iso-8859-1",f))),f}function o(f){const m=[];let y;const _=n("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(y=_.exec(f))!==null;){let[,b,T,x]=y;if(b=parseInt(b,10),b in m){if(b===0)break;continue}m[b]=[T,x]}const A=[];for(let b=0;b<m.length&&b in m;++b){let[T,x]=m[b];x=c(x),T&&(x=unescape(x),b===0&&(x=u(x))),A.push(x)}return A.join("")}function c(f){if(f.startsWith('"')){const m=f.slice(1).split('\\"');for(let y=0;y<m.length;++y){const _=m[y].indexOf('"');_!==-1&&(m[y]=m[y].slice(0,_),m.length=y+1),m[y]=m[y].replaceAll(/\\(.)/g,"$1")}f=m.join('"')}return f}function u(f){const m=f.indexOf("'");if(m===-1)return f;const y=f.slice(0,m),A=f.slice(m+1).replace(/^[^']*'/,"");return s(y,A)}function h(f){return!f.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(f)?f:f.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(m,y,_,A){if(_==="q"||_==="Q")return A=A.replaceAll("_"," "),A=A.replaceAll(/=([0-9a-fA-F]{2})/g,function(b,T){return String.fromCharCode(parseInt(T,16))}),s(y,A);try{A=atob(A)}catch{}return s(y,A)})}return""}function JI(r,e){const t=new Headers;if(!r||!e||typeof e!="object")return t;for(const n in e){const s=e[n];s!==void 0&&t.append(n,s)}return t}function Mp(r){return URL.parse(r)?.origin??null}function ZI({responseHeaders:r,isHttp:e,rangeChunkSize:t,disableRange:n}){const s={allowRangeRequests:!1,suggestedLength:void 0},i=parseInt(r.get("Content-Length"),10);return!Number.isInteger(i)||(s.suggestedLength=i,i<=2*t)||n||!e||r.get("Accept-Ranges")!=="bytes"||(r.get("Content-Encoding")||"identity")!=="identity"||(s.allowRangeRequests=!0),s}function ek(r){const e=r.get("Content-Disposition");if(e){let t=dj(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(Lp(t))return t}return null}function wh(r,e){return new qu(`Unexpected server response (${r}) while retrieving PDF "${e}".`,r,r===404||r===0&&e.startsWith("file:"))}function tk(r){return r===200||r===206}function nk(r,e,t){return{method:"GET",headers:r,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function rk(r){return r instanceof Uint8Array?r.buffer:r instanceof ArrayBuffer?r:(Ve(`getArrayBuffer - unexpected data format: ${r}`),new Uint8Array(r).buffer)}class fj{_responseOrigin=null;constructor(e){this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=JI(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Wt(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new pj(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new mj(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class pj{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const n=new Headers(e.headers),s=t.url;fetch(s,nk(n,this._withCredentials,this._abortController)).then(i=>{if(e._responseOrigin=Mp(i.url),!tk(i.status))throw wh(i.status,s);this._reader=i.body.getReader(),this._headersCapability.resolve();const o=i.headers,{allowRangeRequests:c,suggestedLength:u}=ZI({responseHeaders:o,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=c,this._contentLength=u||this._contentLength,this._filename=ek(o),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new yi("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:rk(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}class mj{constructor(e,t,n){this._stream=e,this._reader=null,this._loaded=0;const s=e.source;this._withCredentials=s.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!s.disableStream,this._abortController=new AbortController;const i=new Headers(e.headers);i.append("Range",`bytes=${t}-${n-1}`);const o=s.url;fetch(o,nk(i,this._withCredentials,this._abortController)).then(c=>{const u=Mp(c.url);if(u!==e._responseOrigin)throw new Error(`Expected range response-origin "${u}" to match "${e._responseOrigin}".`);if(!tk(c.status))throw wh(c.status,o);this._readCapability.resolve(),this._reader=c.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded}),{value:rk(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}const Zg=200,ey=206;function gj(r){const e=r.response;return typeof e!="string"?e:mh(e).buffer}class yj{_responseOrigin=null;constructor({url:e,httpHeaders:t,withCredentials:n}){this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=JI(this.isHttp,t),this.withCredentials=n||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,n=this.currXhrId++,s=this.pendingRequests[n]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[i,o]of this.headers)t.setRequestHeader(i,o);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),s.expectedStatus=ey):s.expectedStatus=Zg,t.responseType="arraybuffer",Wt(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,n),t.onprogress=this.onProgress.bind(this,n),s.onHeadersReceived=e.onHeadersReceived,s.onDone=e.onDone,s.onError=e.onError,s.onProgress=e.onProgress,t.send(null),n}onProgress(e,t){const n=this.pendingRequests[e];n&&n.onProgress?.(t)}onStateChange(e,t){const n=this.pendingRequests[e];if(!n)return;const s=n.xhr;if(s.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),s.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],s.status===0&&this.isHttp){n.onError(s.status);return}const i=s.status||Zg;if(!(i===Zg&&n.expectedStatus===ey)&&i!==n.expectedStatus){n.onError(s.status);return}const c=gj(s);if(i===ey){const u=s.getResponseHeader("Content-Range"),h=/bytes (\d+)-(\d+)\/(\d+)/.exec(u);h?n.onDone({begin:parseInt(h[1],10),chunk:c}):(Ve('Missing or invalid "Content-Range" header.'),n.onError(0))}else c?n.onDone({begin:0,chunk:c}):n.onError(s.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class vj{constructor(e){this._source=e,this._manager=new yj(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return Wt(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new _j(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const n=new wj(this._manager,e,t);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class _j{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=Mp(t.responseURL);const n=t.getAllResponseHeaders(),s=new Headers(n?n.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(c=>{const[u,...h]=c.split(": ");return[u,h.join(": ")]}):[]),{allowRangeRequests:i,suggestedLength:o}=ZI({responseHeaders:s,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});i&&(this._isRangeSupported=!0),this._contentLength=o||this._contentLength,this._filename=ek(s),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=wh(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){this.onProgress?.({loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class wj{constructor(e,t,n){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:n,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const e=Mp(this._manager.getRequestXhr(this._requestId)?.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??=wh(e,this._url);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){this.isStreamingSupported||this.onProgress?.({loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const Ej=/^[a-z][a-z0-9\-+.]+:/i;function Aj(r){if(Ej.test(r))return new URL(r);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(r))}class bj{constructor(e){this.source=e,this.url=Aj(e.url),Wt(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Wt(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new Tj(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new Sj(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class Tj{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const n=process.getBuiltinModule("fs");n.promises.lstat(this._url).then(s=>{this._contentLength=s.size,this._setReadableStream(n.createReadStream(this._url)),this._headersCapability.resolve()},s=>{s.code==="ENOENT"&&(s=wh(0,this._url.href)),this._storedError=s,this._headersCapability.reject(s)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new yi("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class Sj{constructor(e,t,n){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const s=e.source;this._isStreamingSupported=!s.disableStream;const i=process.getBuiltinModule("fs");this._setReadableStream(i.createReadStream(this._url,{start:t,end:n-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const nu=Symbol("INITIAL_DATA");class sk{#e=Object.create(null);#t(e){return this.#e[e]||={...Promise.withResolvers(),data:nu}}get(e,t=null){if(t){const s=this.#t(e);return s.promise.then(()=>t(s.data)),null}const n=this.#e[e];if(!n||n.data===nu)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return n.data}has(e){const t=this.#e[e];return!!t&&t.data!==nu}delete(e){const t=this.#e[e];return!t||t.data===nu?!1:(delete this.#e[e],!0)}resolve(e,t=null){const n=this.#t(e);n.data=t,n.resolve()}clear(){for(const e in this.#e){const{data:t}=this.#e[e];t?.bitmap?.close()}this.#e=Object.create(null)}*[Symbol.iterator](){for(const e in this.#e){const{data:t}=this.#e[e];t!==nu&&(yield[e,t])}}}const xj=1e5,Hb=30;let Ku=class xr{#e=Promise.withResolvers();#t=null;#n=!1;#r=!!globalThis.FontInspector?.enabled;#i=null;#s=null;#a=0;#o=0;#h=null;#l=null;#d=0;#u=0;#f=Object.create(null);#p=[];#m=null;#c=[];#g=new WeakMap;#y=null;static#v=new Map;static#w=new Map;static#E=new WeakMap;static#A=null;static#S=new Set;constructor({textContentSource:e,container:t,viewport:n}){if(e instanceof ReadableStream)this.#m=e;else if(typeof e=="object")this.#m=new ReadableStream({start(u){u.enqueue(e),u.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#t=this.#l=t,this.#u=n.scale*ns.pixelRatio,this.#d=n.rotation,this.#s={div:null,properties:null,ctx:null};const{pageWidth:s,pageHeight:i,pageX:o,pageY:c}=n.rawDims;this.#y=[1,0,0,-1,-o,c+i],this.#o=s,this.#a=i,xr.#R(),go(t,n),this.#e.promise.finally(()=>{xr.#S.delete(this),this.#s=null,this.#f=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=ln.platform;return We(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{this.#h.read().then(({value:t,done:n})=>{if(n){this.#e.resolve();return}this.#i??=t.lang,Object.assign(this.#f,t.styles),this.#C(t.items),e()},this.#e.reject)};return this.#h=this.#m.getReader(),xr.#S.add(this),e(),this.#e.promise}update({viewport:e,onBefore:t=null}){const n=e.scale*ns.pixelRatio,s=e.rotation;if(s!==this.#d&&(t?.(),this.#d=s,go(this.#l,{rotation:s})),n!==this.#u){t?.(),this.#u=n;const i={div:null,properties:null,ctx:xr.#I(this.#i)};for(const o of this.#c)i.properties=this.#g.get(o),i.div=o,this.#b(i)}}cancel(){const e=new yi("TextLayer task cancelled.");this.#h?.cancel(e).catch(()=>{}),this.#h=null,this.#e.reject(e)}get textDivs(){return this.#c}get textContentItemsStr(){return this.#p}#C(e){if(this.#n)return;this.#s.ctx??=xr.#I(this.#i);const t=this.#c,n=this.#p;for(const s of e){if(t.length>xj){Ve("Ignoring additional textDivs for performance reasons."),this.#n=!0;return}if(s.str===void 0){if(s.type==="beginMarkedContentProps"||s.type==="beginMarkedContent"){const i=this.#t;this.#t=document.createElement("span"),this.#t.classList.add("markedContent"),s.id!==null&&this.#t.setAttribute("id",`${s.id}`),i.append(this.#t)}else s.type==="endMarkedContent"&&(this.#t=this.#t.parentNode);continue}n.push(s.str),this.#k(s)}}#k(e){const t=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};this.#c.push(t);const s=be.transform(this.#y,e.transform);let i=Math.atan2(s[1],s[0]);const o=this.#f[e.fontName];o.vertical&&(i+=Math.PI/2);let c=this.#r&&o.fontSubstitution||o.fontFamily;c=xr.fontFamilyMap.get(c)||c;const u=Math.hypot(s[2],s[3]),h=u*xr.#D(c,o,this.#i);let f,m;i===0?(f=s[4],m=s[5]-h):(f=s[4]+h*Math.sin(i),m=s[5]-h*Math.cos(i));const y="calc(var(--total-scale-factor) *",_=t.style;this.#t===this.#l?(_.left=`${(100*f/this.#o).toFixed(2)}%`,_.top=`${(100*m/this.#a).toFixed(2)}%`):(_.left=`${y}${f.toFixed(2)}px)`,_.top=`${y}${m.toFixed(2)}px)`),_.fontSize=`${y}${(xr.#A*u).toFixed(2)}px)`,_.fontFamily=c,n.fontSize=u,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,this.#r&&(t.dataset.fontName=o.fontSubstitutionLoadedName||e.fontName),i!==0&&(n.angle=i*(180/Math.PI));let A=!1;if(e.str.length>1)A=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const b=Math.abs(e.transform[0]),T=Math.abs(e.transform[3]);b!==T&&Math.max(b,T)/Math.min(b,T)>1.5&&(A=!0)}if(A&&(n.canvasWidth=o.vertical?e.height:e.width),this.#g.set(t,n),this.#s.div=t,this.#s.properties=n,this.#b(this.#s),n.hasText&&this.#t.append(t),n.hasEOL){const b=document.createElement("br");b.setAttribute("role","presentation"),this.#t.append(b)}}#b(e){const{div:t,properties:n,ctx:s}=e,{style:i}=t;let o="";if(xr.#A>1&&(o=`scale(${1/xr.#A})`),n.canvasWidth!==0&&n.hasText){const{fontFamily:c}=i,{canvasWidth:u,fontSize:h}=n;xr.#x(s,h*this.#u,c);const{width:f}=s.measureText(t.textContent);f>0&&(o=`scaleX(${u*this.#u/f}) ${o}`)}n.angle!==0&&(o=`rotate(${n.angle}deg) ${o}`),o.length>0&&(i.transform=o)}static cleanup(){if(!(this.#S.size>0)){this.#v.clear();for(const{canvas:e}of this.#w.values())e.remove();this.#w.clear()}}static#I(e=null){let t=this.#w.get(e||="");if(!t){const n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=e,document.body.append(n),t=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#w.set(e,t),this.#E.set(t,{size:0,family:""})}return t}static#x(e,t,n){const s=this.#E.get(e);t===s.size&&n===s.family||(e.font=`${t}px ${n}`,s.size=t,s.family=n)}static#R(){if(this.#A!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),this.#A=e.getBoundingClientRect().height,e.remove()}static#D(e,t,n){const s=this.#v.get(e);if(s)return s;const i=this.#I(n);i.canvas.width=i.canvas.height=Hb,this.#x(i,Hb,e);const o=i.measureText(""),c=o.fontBoundingBoxAscent,u=Math.abs(o.fontBoundingBoxDescent);i.canvas.width=i.canvas.height=0;let h=.8;return c?h=c/(c+u):(ln.platform.isFirefox&&Ve("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),t.ascent?h=t.ascent:t.descent&&(h=1+t.descent)),this.#v.set(e,h),h}};class Xu{static textContent(e){const t=[],n={items:t,styles:Object.create(null)};function s(i){if(!i)return;let o=null;const c=i.name;if(c==="#text")o=i.value;else if(Xu.shouldBuildText(c))i?.attributes?.textContent?o=i.attributes.textContent:i.value&&(o=i.value);else return;if(o!==null&&t.push({str:o}),!!i.children)for(const u of i.children)s(u)}return s(e),n}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}const Cj=100;function X0(r={}){typeof r=="string"||r instanceof URL?r={url:r}:(r instanceof ArrayBuffer||ArrayBuffer.isView(r))&&(r={data:r});const e=new Y0,{docId:t}=e,n=r.url?F8(r.url):null,s=r.data?V8(r.data):null,i=r.httpHeaders||null,o=r.withCredentials===!0,c=r.password??null,u=r.range instanceof Q0?r.range:null,h=Number.isInteger(r.rangeChunkSize)&&r.rangeChunkSize>0?r.rangeChunkSize:2**16;let f=r.worker instanceof Xl?r.worker:null;const m=r.verbosity,y=typeof r.docBaseUrl=="string"&&!yh(r.docBaseUrl)?r.docBaseUrl:null,_=Qd(r.cMapUrl),A=r.cMapPacked!==!1,b=r.CMapReaderFactory||(Fn?W8:Db),T=Qd(r.iccUrl),x=Qd(r.standardFontDataUrl),M=r.StandardFontDataFactory||(Fn?G8:Lb),R=Qd(r.wasmUrl),B=r.WasmFactory||(Fn?q8:Mb),O=r.stopAtErrors!==!0,$=Number.isInteger(r.maxImageSize)&&r.maxImageSize>-1?r.maxImageSize:-1,k=r.isEvalSupported!==!1,C=typeof r.isOffscreenCanvasSupported=="boolean"?r.isOffscreenCanvasSupported:!Fn,P=typeof r.isImageDecoderSupported=="boolean"?r.isImageDecoderSupported:!Fn&&(ln.platform.isFirefox||!globalThis.chrome),N=Number.isInteger(r.canvasMaxAreaInBytes)?r.canvasMaxAreaInBytes:-1,j=typeof r.disableFontFace=="boolean"?r.disableFontFace:Fn,z=r.fontExtraProperties===!0,F=r.enableXfa===!0,ue=r.ownerDocument||globalThis.document,ke=r.disableRange===!0,ie=r.disableStream===!0,Z=r.disableAutoFetch===!0,te=r.pdfBug===!0,de=r.CanvasFactory||(Fn?H8:U8),ee=r.FilterFactory||(Fn?$8:z8),W=r.enableHWA===!0,Y=r.useWasm!==!1,ae=u?u.length:r.length??NaN,_e=typeof r.useSystemFonts=="boolean"?r.useSystemFonts:!Fn&&!j,Te=typeof r.useWorkerFetch=="boolean"?r.useWorkerFetch:!!(b===Db&&M===Lb&&B===Mb&&_&&x&&R&&pu(_,document.baseURI)&&pu(x,document.baseURI)&&pu(R,document.baseURI)),Pe=null;_8(m);const Ee={canvasFactory:new de({ownerDocument:ue,enableHWA:W}),filterFactory:new ee({docId:t,ownerDocument:ue}),cMapReaderFactory:Te?null:new b({baseUrl:_,isCompressed:A}),standardFontDataFactory:Te?null:new M({baseUrl:x}),wasmFactory:Te?null:new B({baseUrl:R})};f||(f=Xl.create({verbosity:m,port:io.workerPort}),e._worker=f);const Be={docId:t,apiVersion:"5.3.93",data:s,password:c,disableAutoFetch:Z,rangeChunkSize:h,length:ae,docBaseUrl:y,enableXfa:F,evaluatorOptions:{maxImageSize:$,disableFontFace:j,ignoreErrors:O,isEvalSupported:k,isOffscreenCanvasSupported:C,isImageDecoderSupported:P,canvasMaxAreaInBytes:N,fontExtraProperties:z,useSystemFonts:_e,useWasm:Y,useWorkerFetch:Te,cMapUrl:_,iccUrl:T,standardFontDataUrl:x,wasmUrl:R}},$e={ownerDocument:ue,pdfBug:te,styleElement:Pe,loadingParams:{disableAutoFetch:Z,enableXfa:F}};return f.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(f.destroyed)throw new Error("Worker was destroyed");const Ue=f.messageHandler.sendWithPromise("GetDocRequest",Be,s?[s.buffer]:null);let qt;if(u)qt=new cj(u,{disableRange:ke,disableStream:ie});else if(!s){if(!n)throw new Error("getDocument - no `url` parameter provided.");const vn=pu(n)?fj:Fn?bj:vj;qt=new vn({url:n,length:ae,httpHeaders:i,withCredentials:o,rangeChunkSize:h,disableRange:ke,disableStream:ie})}return Ue.then(vn=>{if(e.destroyed)throw new Error("Loading aborted");if(f.destroyed)throw new Error("Worker was destroyed");const ze=new mu(t,vn,f.port),et=new Pj(ze,e,qt,$e,Ee);e._transport=et,ze.send("Ready",null)})}).catch(e._capability.reject),e}class Y0{static#e=0;_capability=Promise.withResolvers();_transport=null;_worker=null;docId=`d${Y0.#e++}`;destroyed=!1;onPassword=null;onProgress=null;get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(e){throw this._worker?.port&&delete this._worker._pendingDestroy,e}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}}let Q0=class{#e=Promise.withResolvers();#t=[];#n=[];#r=[];#i=[];constructor(e,t,n=!1,s=null){this.length=e,this.initialData=t,this.progressiveDone=n,this.contentDispositionFilename=s}addRangeListener(e){this.#i.push(e)}addProgressListener(e){this.#r.push(e)}addProgressiveReadListener(e){this.#n.push(e)}addProgressiveDoneListener(e){this.#t.push(e)}onDataRange(e,t){for(const n of this.#i)n(e,t)}onDataProgress(e,t){this.#e.promise.then(()=>{for(const n of this.#r)n(e,t)})}onDataProgressiveRead(e){this.#e.promise.then(()=>{for(const t of this.#n)t(e)})}onDataProgressiveDone(){this.#e.promise.then(()=>{for(const e of this.#t)e()})}transportReady(){this.#e.resolve()}requestDataRange(e,t){it("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}};class Ij{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return We(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class kj{#e=!1;constructor(e,t,n,s=!1){this._pageIndex=e,this._pageInfo=t,this._transport=n,this._stats=s?new kb:null,this._pdfBug=s,this.commonObjs=n.commonObjs,this.objs=new sk,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:n=0,offsetY:s=0,dontFlip:i=!1}={}){return new gh({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:s,dontFlip:i})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return We(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:e,viewport:t,intent:n="display",annotationMode:s=Ss.ENABLE,transform:i=null,background:o=null,optionalContentConfigPromise:c=null,annotationCanvasMap:u=null,pageColors:h=null,printAnnotationStorage:f=null,isEditing:m=!1}){this._stats?.time("Overall");const y=this._transport.getRenderingIntent(n,s,f,m),{renderingIntent:_,cacheKey:A}=y;this.#e=!1,c||=this._transport.getOptionalContentConfig(_);let b=this._intentStates.get(A);b||(b=Object.create(null),this._intentStates.set(A,b)),b.streamReaderCancelTimeout&&(clearTimeout(b.streamReaderCancelTimeout),b.streamReaderCancelTimeout=null);const T=!!(_&ar.PRINT);b.displayReadyCapability||(b.displayReadyCapability=Promise.withResolvers(),b.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(y));const x=B=>{b.renderTasks.delete(M),T&&(this.#e=!0),this.#t(),B?(M.capability.reject(B),this._abortOperatorList({intentState:b,reason:B instanceof Error?B:new Error(B)})):M.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},M=new kl({callback:x,params:{canvasContext:e,viewport:t,transform:i,background:o},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:u,operatorList:b.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!T,pdfBug:this._pdfBug,pageColors:h});(b.renderTasks||=new Set).add(M);const R=M.task;return Promise.all([b.displayReadyCapability.promise,c]).then(([B,O])=>{if(this.destroyed){x();return}if(this._stats?.time("Rendering"),!(O.renderingIntent&_))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");M.initializeGraphics({transparency:B,optionalContentConfig:O}),M.operatorListChanged()}).catch(x),R}getOperatorList({intent:e="display",annotationMode:t=Ss.ENABLE,printAnnotationStorage:n=null,isEditing:s=!1}={}){function i(){c.operatorList.lastChunk&&(c.opListReadCapability.resolve(c.operatorList),c.renderTasks.delete(u))}const o=this._transport.getRenderingIntent(e,t,n,s,!0);let c=this._intentStates.get(o.cacheKey);c||(c=Object.create(null),this._intentStates.set(o.cacheKey,c));let u;return c.opListReadCapability||(u=Object.create(null),u.operatorListChanged=i,c.opListReadCapability=Promise.withResolvers(),(c.renderTasks||=new Set).add(u),c.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(o)),c.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(s){return s.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(n=>Xu.textContent(n));const t=this.streamTextContent(e);return new Promise(function(n,s){function i(){o.read().then(function({value:u,done:h}){if(h){n(c);return}c.lang??=u.lang,Object.assign(c.styles,u.styles),c.items.push(...u.items),i()},s)}const o=t.getReader(),c={items:[],styles:Object.create(null),lang:null};i()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const n of t.renderTasks)e.push(n.completed),n.cancel();return this.objs.clear(),this.#e=!1,Promise.all(e)}cleanup(e=!1){this.#e=!0;const t=this.#t();return e&&t&&(this._stats&&=new kb),t}#t(){if(!this.#e||this.destroyed)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#e=!1,!0}_startRenderPage(e,t){const n=this._intentStates.get(t);n&&(this._stats?.timeEnd("Page Request"),n.displayReadyCapability?.resolve(e))}_renderPageChunk(e,t){for(let n=0,s=e.length;n<s;n++)t.operatorList.fnArray.push(e.fnArray[n]),t.operatorList.argsArray.push(e.argsArray[n]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const n of t.renderTasks)n.operatorListChanged();e.lastChunk&&this.#t()}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:n,modifiedIds:s}){const{map:i,transfer:o}=n,u=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:i,modifiedIds:s},o).getReader(),h=this._intentStates.get(t);h.streamReader=u;const f=()=>{u.read().then(({value:m,done:y})=>{if(y){h.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(m,h),f())},m=>{if(h.streamReader=null,!this._transport.destroyed){if(h.operatorList){h.operatorList.lastChunk=!0;for(const y of h.renderTasks)y.operatorListChanged();this.#t()}if(h.displayReadyCapability)h.displayReadyCapability.reject(m);else if(h.opListReadCapability)h.opListReadCapability.reject(m);else throw m}})};f()}_abortOperatorList({intentState:e,reason:t,force:n=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!n){if(e.renderTasks.size>0)return;if(t instanceof Dp){let s=Cj;t.extraDelay>0&&t.extraDelay<1e3&&(s+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},s);return}}if(e.streamReader.cancel(new yi(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[s,i]of this._intentStates)if(i===e){this._intentStates.delete(s);break}this.cleanup()}}}get stats(){return this._stats}}var Qi,Xr,ri,ia,Zf,oa,aa,Vn,_f,ik,ok,gu,Vl,wf;const Et=class Et{constructor({name:e=null,port:t=null,verbosity:n=w8()}={}){gs(this,Vn);gs(this,Qi,Promise.withResolvers());gs(this,Xr,null);gs(this,ri,null);gs(this,ia,null);if(this.name=e,this.destroyed=!1,this.verbosity=n,t){if(wt(Et,aa).has(t))throw new Error("Cannot use more than one PDFWorker per port.");wt(Et,aa).set(t,this),ys(this,Vn,ik).call(this,t)}else ys(this,Vn,ok).call(this)}get promise(){return wt(this,Qi).promise}get port(){return wt(this,ri)}get messageHandler(){return wt(this,Xr)}destroy(){this.destroyed=!0,wt(this,ia)?.terminate(),Xn(this,ia,null),wt(Et,aa).delete(wt(this,ri)),Xn(this,ri,null),wt(this,Xr)?.destroy(),Xn(this,Xr,null)}static create(e){const t=wt(this,aa).get(e?.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new Et(e)}static get workerSrc(){if(io.workerSrc)return io.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return We(this,"_setupFakeWorkerGlobal",(async()=>wt(this,Vl,wf)?wt(this,Vl,wf):(await import(this.workerSrc)).WorkerMessageHandler)())}};Qi=new WeakMap,Xr=new WeakMap,ri=new WeakMap,ia=new WeakMap,Zf=new WeakMap,oa=new WeakMap,aa=new WeakMap,Vn=new WeakSet,_f=function(){wt(this,Qi).resolve(),wt(this,Xr).send("configure",{verbosity:this.verbosity})},ik=function(e){Xn(this,ri,e),Xn(this,Xr,new mu("main","worker",e)),wt(this,Xr).on("ready",()=>{}),ys(this,Vn,_f).call(this)},ok=function(){if(wt(Et,oa)||wt(Et,Vl,wf)){ys(this,Vn,gu).call(this);return}let{workerSrc:e}=Et;try{Et._isSameOrigin(window.location,e)||(e=Et._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),n=new mu("main","worker",t),s=()=>{i.abort(),n.destroy(),t.terminate(),this.destroyed?wt(this,Qi).reject(new Error("Worker was destroyed")):ys(this,Vn,gu).call(this)},i=new AbortController;t.addEventListener("error",()=>{wt(this,ia)||s()},{signal:i.signal}),n.on("test",c=>{if(i.abort(),this.destroyed||!c){s();return}Xn(this,Xr,n),Xn(this,ri,t),Xn(this,ia,t),ys(this,Vn,_f).call(this)}),n.on("ready",c=>{if(i.abort(),this.destroyed){s();return}try{o()}catch{ys(this,Vn,gu).call(this)}});const o=()=>{const c=new Uint8Array;n.send("test",c,[c.buffer])};o();return}catch{Rp("The worker has been disabled.")}ys(this,Vn,gu).call(this)},gu=function(){wt(Et,oa)||(Ve("Setting up fake worker."),Xn(Et,oa,!0)),Et._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){wt(this,Qi).reject(new Error("Worker was destroyed"));return}const t=new B8;Xn(this,ri,t);const n=`fake${d1(Et,Zf)._++}`,s=new mu(n+"_worker",n,t);e.setup(s,t),Xn(this,Xr,new mu(n,n+"_worker",t)),ys(this,Vn,_f).call(this)}).catch(e=>{wt(this,Qi).reject(new Error(`Setting up fake worker failed: "${e.message}".`))})},Vl=new WeakSet,wf=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},gs(Et,Vl),gs(Et,Zf,0),gs(Et,oa,!1),gs(Et,aa,new WeakMap),Fn&&(Xn(Et,oa,!0),io.workerSrc||="./pdf.worker.mjs"),Et._isSameOrigin=(e,t)=>{const n=URL.parse(e);if(!n?.origin||n.origin==="null")return!1;const s=new URL(t,n);return n.origin===s.origin},Et._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},Et.fromPort=e=>{if(k8("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!e?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return Et.create(e)};let Xl=Et;class Pj{#e=new Map;#t=new Map;#n=new Map;#r=new Map;#i=null;constructor(e,t,n,s,i){this.messageHandler=e,this.loadingTask=t,this.commonObjs=new sk,this.fontLoader=new N8({ownerDocument:s.ownerDocument,styleElement:s.styleElement}),this.loadingParams=s.loadingParams,this._params=s,this.canvasFactory=i.canvasFactory,this.filterFactory=i.filterFactory,this.cMapReaderFactory=i.cMapReaderFactory,this.standardFontDataFactory=i.standardFontDataFactory,this.wasmFactory=i.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}#s(e,t=null){const n=this.#e.get(e);if(n)return n;const s=this.messageHandler.sendWithPromise(e,t);return this.#e.set(e,s),s}get annotationStorage(){return We(this,"annotationStorage",new W0)}getRenderingIntent(e,t=Ss.ENABLE,n=null,s=!1,i=!1){let o=ar.DISPLAY,c=Ky;switch(e){case"any":o=ar.ANY;break;case"display":break;case"print":o=ar.PRINT;break;default:Ve(`getRenderingIntent - invalid intent: ${e}`)}const u=o&ar.PRINT&&n instanceof WI?n:this.annotationStorage;switch(t){case Ss.DISABLE:o+=ar.ANNOTATIONS_DISABLE;break;case Ss.ENABLE:break;case Ss.ENABLE_FORMS:o+=ar.ANNOTATIONS_FORMS;break;case Ss.ENABLE_STORAGE:o+=ar.ANNOTATIONS_STORAGE,c=u.serializable;break;default:Ve(`getRenderingIntent - invalid annotationMode: ${t}`)}s&&(o+=ar.IS_EDITING),i&&(o+=ar.OPLIST);const{ids:h,hash:f}=u.modifiedIds,m=[o,c.hash,f];return{renderingIntent:o,cacheKey:m.join("_"),annotationStorageSerializable:c,modifiedIds:h}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#i?.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const n of this.#t.values())e.push(n._destroy());this.#t.clear(),this.#n.clear(),this.#r.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(),Ku.cleanup(),this._networkStream?.cancelAllRequests(new yi("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(n,s)=>{Wt(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=i=>{this._lastProgress={loaded:i.loaded,total:i.total}},s.onPull=()=>{this._fullReader.read().then(function({value:i,done:o}){if(o){s.close();return}Wt(i instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(i),1,[i])}).catch(i=>{s.error(i)})},s.onCancel=i=>{this._fullReader.cancel(i),s.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("ReaderHeadersReady",async n=>{await this._fullReader.headersReady;const{isStreamingSupported:s,isRangeSupported:i,contentLength:o}=this._fullReader;return(!s||!i)&&(this._lastProgress&&t.onProgress?.(this._lastProgress),this._fullReader.onProgress=c=>{t.onProgress?.({loaded:c.loaded,total:c.total})}),{isStreamingSupported:s,isRangeSupported:i,contentLength:o}}),e.on("GetRangeReader",(n,s)=>{Wt(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const i=this._networkStream.getRangeReader(n.begin,n.end);if(!i){s.close();return}s.onPull=()=>{i.read().then(function({value:o,done:c}){if(c){s.close();return}Wt(o instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{s.error(o)})},s.onCancel=o=>{i.cancel(o),s.ready.catch(c=>{if(!this.destroyed)throw c})}}),e.on("GetDoc",({pdfInfo:n})=>{this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,t._capability.resolve(new Ij(n,this))}),e.on("DocException",n=>{t._capability.reject(Qn(n))}),e.on("PasswordRequest",n=>{this.#i=Promise.withResolvers();try{if(!t.onPassword)throw Qn(n);const s=i=>{i instanceof Error?this.#i.reject(i):this.#i.resolve({password:i})};t.onPassword(s,n.code)}catch(s){this.#i.reject(s)}return this.#i.promise}),e.on("DataLoaded",n=>{t.onProgress?.({loaded:n.length,total:n.length}),this.downloadInfoCapability.resolve(n)}),e.on("StartRenderPage",n=>{if(this.destroyed)return;this.#t.get(n.pageIndex)._startRenderPage(n.transparency,n.cacheKey)}),e.on("commonobj",([n,s,i])=>{if(this.destroyed||this.commonObjs.has(n))return null;switch(s){case"Font":if("error"in i){const h=i.error;Ve(`Error during font loading: ${h}`),this.commonObjs.resolve(n,h);break}const o=this._params.pdfBug&&globalThis.FontInspector?.enabled?(h,f)=>globalThis.FontInspector.fontAdded(h,f):null,c=new O8(i,o);this.fontLoader.bind(c).catch(()=>e.sendWithPromise("FontFallback",{id:n})).finally(()=>{!c.fontExtraProperties&&c.data&&(c.data=null),this.commonObjs.resolve(n,c)});break;case"CopyLocalImage":const{imageRef:u}=i;Wt(u,"The imageRef must be defined.");for(const h of this.#t.values())for(const[,f]of h.objs)if(f?.ref===u)return f.dataLen?(this.commonObjs.resolve(n,structuredClone(f)),f.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(n,i);break;default:throw new Error(`Got unknown common object type ${s}`)}return null}),e.on("obj",([n,s,i,o])=>{if(this.destroyed)return;const c=this.#t.get(s);if(!c.objs.has(n)){if(c._intentStates.size===0){o?.bitmap?.close();return}switch(i){case"Image":case"Pattern":c.objs.resolve(n,o);break;default:throw new Error(`Got unknown object type ${i}`)}}}),e.on("DocProgress",n=>{this.destroyed||t.onProgress?.({loaded:n.loaded,total:n.total})}),e.on("FetchBinaryData",async n=>{if(this.destroyed)throw new Error("Worker was destroyed.");const s=this[n.type];if(!s)throw new Error(`${n.type} not initialized, see the \`useWorkerFetch\` parameter.`);return s.fetch(n)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&Ve("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:this._fullReader?.filename??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,n=this.#n.get(t);if(n)return n;const s=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(i=>{if(this.destroyed)throw new Error("Transport destroyed");i.refStr&&this.#r.set(i.refStr,e);const o=new kj(t,i,this,this._params.pdfBug);return this.#t.set(t,o),o});return this.#n.set(t,s),s}getPageIndex(e){return Xy(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return this.#s("GetFieldObjects")}hasJSActions(){return this.#s("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return this.#s("GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return this.#s("GetOptionalContentConfig").then(t=>new lj(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=this.#e.get(e);if(t)return t;const n=this.messageHandler.sendWithPromise(e,null).then(s=>({info:s[0],metadata:s[1]?new oj(s[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#e.set(e,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of this.#t.values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(!0),Ku.cleanup()}}cachedPageNumber(e){if(!Xy(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return this.#r.get(t)??null}}class Rj{#e=null;onContinue=null;onError=null;constructor(e){this.#e=e}get promise(){return this.#e.capability.promise}cancel(e=0){this.#e.cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=this.#e.operatorList;if(!e)return!1;const{annotationCanvasMap:t}=this.#e;return e.form||e.canvas&&t?.size>0}}class kl{#e=null;static#t=new WeakSet;constructor({callback:e,params:t,objs:n,commonObjs:s,annotationCanvasMap:i,operatorList:o,pageIndex:c,canvasFactory:u,filterFactory:h,useRequestAnimationFrame:f=!1,pdfBug:m=!1,pageColors:y=null}){this.callback=e,this.params=t,this.objs=n,this.commonObjs=s,this.annotationCanvasMap=i,this.operatorListIdx=null,this.operatorList=o,this._pageIndex=c,this.canvasFactory=u,this.filterFactory=h,this._pdfBug=m,this.pageColors=y,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=f===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new Rj(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){if(this.cancelled)return;if(this._canvas){if(kl.#t.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");kl.#t.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:n,viewport:s,transform:i,background:o}=this.params;this.gfx=new Nl(n,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:i,viewport:s,transparency:e,background:o}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(e=null,t=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#e&&(window.cancelAnimationFrame(this.#e),this.#e=null),kl.#t.delete(this._canvas),e||=new Dp(`Rendering cancelled, page ${this._pageIndex+1}`,t),this.callback(e),this.task.onError?.(e)}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#e=window.requestAnimationFrame(()=>{this.#e=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),kl.#t.delete(this._canvas),this.callback())))}}const J0="5.3.93",ak="cbeef3233";function Wb(r){return Math.floor(Math.max(0,Math.min(1,r))*255).toString(16).padStart(2,"0")}function ru(r){return Math.max(0,Math.min(255,255*r))}class Gb{static CMYK_G([e,t,n,s]){return["G",1-Math.min(1,.3*e+.59*n+.11*t+s)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=ru(e),[e,e,e]}static G_HTML([e]){const t=Wb(e);return`#${t}${t}${t}`}static RGB_G([e,t,n]){return["G",.3*e+.59*t+.11*n]}static RGB_rgb(e){return e.map(ru)}static RGB_HTML(e){return`#${e.map(Wb).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,n,s]){return["RGB",1-Math.min(1,e+s),1-Math.min(1,n+s),1-Math.min(1,t+s)]}static CMYK_rgb([e,t,n,s]){return[ru(1-Math.min(1,e+s)),ru(1-Math.min(1,n+s)),ru(1-Math.min(1,t+s))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,n]){const s=1-e,i=1-t,o=1-n,c=Math.min(s,i,o);return["CMYK",s,i,o,c]}}class Dj{create(e,t,n=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const s=this._createSVG("svg:svg");return s.setAttribute("version","1.1"),n||(s.setAttribute("width",`${e}px`),s.setAttribute("height",`${t}px`)),s.setAttribute("preserveAspectRatio","none"),s.setAttribute("viewBox",`0 0 ${e} ${t}`),s}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){it("Abstract method `_createSVG` called.")}}class Yu extends Dj{_createSVG(e){return document.createElementNS(ni,e)}}class Z0{static setupStorage(e,t,n,s,i){const o=s.getValue(t,{value:null});switch(n.name){case"textarea":if(o.value!==null&&(e.textContent=o.value),i==="print")break;e.addEventListener("input",c=>{s.setValue(t,{value:c.target.value})});break;case"input":if(n.attributes.type==="radio"||n.attributes.type==="checkbox"){if(o.value===n.attributes.xfaOn?e.setAttribute("checked",!0):o.value===n.attributes.xfaOff&&e.removeAttribute("checked"),i==="print")break;e.addEventListener("change",c=>{s.setValue(t,{value:c.target.checked?c.target.getAttribute("xfaOn"):c.target.getAttribute("xfaOff")})})}else{if(o.value!==null&&e.setAttribute("value",o.value),i==="print")break;e.addEventListener("input",c=>{s.setValue(t,{value:c.target.value})})}break;case"select":if(o.value!==null){e.setAttribute("value",o.value);for(const c of n.children)c.attributes.value===o.value?c.attributes.selected=!0:c.attributes.hasOwnProperty("selected")&&delete c.attributes.selected}e.addEventListener("input",c=>{const u=c.target.options,h=u.selectedIndex===-1?"":u[u.selectedIndex].value;s.setValue(t,{value:h})});break}}static setAttributes({html:e,element:t,storage:n=null,intent:s,linkService:i}){const{attributes:o}=t,c=e instanceof HTMLAnchorElement;o.type==="radio"&&(o.name=`${o.name}-${s}`);for(const[u,h]of Object.entries(o))if(h!=null)switch(u){case"class":h.length&&e.setAttribute(u,h.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",h);break;case"style":Object.assign(e.style,h);break;case"textContent":e.textContent=h;break;default:(!c||u!=="href"&&u!=="newWindow")&&e.setAttribute(u,h)}c&&i.addLinkAttributes(e,o.href,o.newWindow),n&&o.dataId&&this.setupStorage(e,o.dataId,t,n)}static render(e){const t=e.annotationStorage,n=e.linkService,s=e.xfaHtml,i=e.intent||"display",o=document.createElement(s.name);s.attributes&&this.setAttributes({html:o,element:s,intent:i,linkService:n});const c=i!=="richText",u=e.div;if(u.append(o),e.viewport){const m=`matrix(${e.viewport.transform.join(",")})`;u.style.transform=m}c&&u.setAttribute("class","xfaLayer xfaFont");const h=[];if(s.children.length===0){if(s.value){const m=document.createTextNode(s.value);o.append(m),c&&Xu.shouldBuildText(s.name)&&h.push(m)}return{textDivs:h}}const f=[[s,-1,o]];for(;f.length>0;){const[m,y,_]=f.at(-1);if(y+1===m.children.length){f.pop();continue}const A=m.children[++f.at(-1)[1]];if(A===null)continue;const{name:b}=A;if(b==="#text"){const x=document.createTextNode(A.value);h.push(x),_.append(x);continue}const T=A?.attributes?.xmlns?document.createElementNS(A.attributes.xmlns,b):document.createElement(b);if(_.append(T),A.attributes&&this.setAttributes({html:T,element:A,storage:t,intent:i,linkService:n}),A.children?.length>0)f.push([A,-1,T]);else if(A.value){const x=document.createTextNode(A.value);c&&Xu.shouldBuildText(b)&&h.push(x),T.append(x)}}for(const m of u.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))m.setAttribute("readOnly",!0);return{textDivs:h}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const Lj=9,ga=new WeakSet;class qb{static create(e){switch(e.data.annotationType){case Mt.LINK:return new lk(e);case Mt.TEXT:return new Mj(e);case Mt.WIDGET:switch(e.data.fieldType){case"Tx":return new Nj(e);case"Btn":return e.data.radioButton?new ck(e):e.data.checkBox?new Fj(e):new Vj(e);case"Ch":return new jj(e);case"Sig":return new Oj(e)}return new Ia(e);case Mt.POPUP:return new Qy(e);case Mt.FREETEXT:return new uk(e);case Mt.LINE:return new Uj(e);case Mt.SQUARE:return new zj(e);case Mt.CIRCLE:return new $j(e);case Mt.POLYLINE:return new hk(e);case Mt.CARET:return new Wj(e);case Mt.INK:return new e_(e);case Mt.POLYGON:return new Hj(e);case Mt.HIGHLIGHT:return new dk(e);case Mt.UNDERLINE:return new Gj(e);case Mt.SQUIGGLY:return new qj(e);case Mt.STRIKEOUT:return new Kj(e);case Mt.STAMP:return new fk(e);case Mt.FILEATTACHMENT:return new Xj(e);default:return new jt(e)}}}class jt{#e=null;#t=!1;#n=null;constructor(e,{isRenderable:t=!1,ignoreBorder:n=!1,createQuadrilaterals:s=!1}={}){this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(n)),s&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:e,richText:t}){return!!(e?.str||t?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return jt._hasPopupData(this.data)}updateEdited(e){if(!this.container)return;this.#e||={rect:this.data.rect.slice(0)};const{rect:t}=e;t&&this.#r(t),this.#n?.popup.updateEdited(e)}resetEdited(){this.#e&&(this.#r(this.#e.rect),this.#n?.popup.resetEdited(),this.#e=null)}#r(e){const{container:{style:t},data:{rect:n,rotation:s},parent:{viewport:{rawDims:{pageWidth:i,pageHeight:o,pageX:c,pageY:u}}}}=this;n?.splice(0,4,...e),t.left=`${100*(e[0]-c)/i}%`,t.top=`${100*(o-e[3]+u)/o}%`,s===0?(t.width=`${100*(e[2]-e[0])/i}%`,t.height=`${100*(e[3]-e[1])/o}%`):this.setRotation(s)}_createContainer(e){const{data:t,parent:{page:n,viewport:s}}=this,i=document.createElement("section");i.setAttribute("data-annotation-id",t.id),this instanceof Ia||(i.tabIndex=0);const{style:o}=i;if(o.zIndex=this.parent.zIndex++,t.alternativeText&&(i.title=t.alternativeText),t.noRotate&&i.classList.add("norotate"),!t.rect||this instanceof Qy){const{rotation:b}=t;return!t.hasOwnCanvas&&b!==0&&this.setRotation(b,i),i}const{width:c,height:u}=this;if(!e&&t.borderStyle.width>0){o.borderWidth=`${t.borderStyle.width}px`;const b=t.borderStyle.horizontalCornerRadius,T=t.borderStyle.verticalCornerRadius;if(b>0||T>0){const M=`calc(${b}px * var(--total-scale-factor)) / calc(${T}px * var(--total-scale-factor))`;o.borderRadius=M}else if(this instanceof ck){const M=`calc(${c}px * var(--total-scale-factor)) / calc(${u}px * var(--total-scale-factor))`;o.borderRadius=M}switch(t.borderStyle.style){case wl.SOLID:o.borderStyle="solid";break;case wl.DASHED:o.borderStyle="dashed";break;case wl.BEVELED:Ve("Unimplemented border style: beveled");break;case wl.INSET:Ve("Unimplemented border style: inset");break;case wl.UNDERLINE:o.borderBottomStyle="solid";break}const x=t.borderColor||null;x?(this.#t=!0,o.borderColor=be.makeHexColor(x[0]|0,x[1]|0,x[2]|0)):o.borderWidth=0}const h=be.normalizeRect([t.rect[0],n.view[3]-t.rect[1]+n.view[1],t.rect[2],n.view[3]-t.rect[3]+n.view[1]]),{pageWidth:f,pageHeight:m,pageX:y,pageY:_}=s.rawDims;o.left=`${100*(h[0]-y)/f}%`,o.top=`${100*(h[1]-_)/m}%`;const{rotation:A}=t;return t.hasOwnCanvas||A===0?(o.width=`${100*c/f}%`,o.height=`${100*u/m}%`):this.setRotation(A,i),i}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:n,pageHeight:s}=this.parent.viewport.rawDims;let{width:i,height:o}=this;e%180!==0&&([i,o]=[o,i]),t.style.width=`${100*i/n}%`,t.style.height=`${100*o/s}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,n,s)=>{const i=s.detail[t],o=i[0],c=i.slice(1);s.target.style[n]=Gb[`${o}_HTML`](c),this.annotationStorage.setValue(this.data.id,{[n]:Gb[`${o}_rgb`](c)})};return We(this,"_commonActions",{display:t=>{const{display:n}=t.detail,s=n%2===1;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:s,noPrint:n===1||n===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:n}=t.detail;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:n,noView:n})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const n=t.detail.rotation;this.setRotation(n),this.annotationStorage.setValue(this.data.id,{rotation:n})}})}_dispatchEventFromSandbox(e,t){const n=this._commonActions;for(const s of Object.keys(t.detail))(e[s]||n[s])?.(t)}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const n=this._commonActions;for(const[s,i]of Object.entries(t)){const o=n[s];if(o){const c={detail:{[s]:i},target:e};o(c),delete t[s]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,n,s,i]=this.data.rect.map(b=>Math.fround(b));if(e.length===8){const[b,T,x,M]=e.subarray(2,6);if(s===b&&i===T&&t===x&&n===M)return}const{style:o}=this.container;let c;if(this.#t){const{borderColor:b,borderWidth:T}=o;o.borderWidth=0,c=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${b}" stroke-width="${T}">`],this.container.classList.add("hasBorder")}const u=s-t,h=i-n,{svgFactory:f}=this,m=f.createElement("svg");m.classList.add("quadrilateralsContainer"),m.setAttribute("width",0),m.setAttribute("height",0),m.role="none";const y=f.createElement("defs");m.append(y);const _=f.createElement("clipPath"),A=`clippath_${this.data.id}`;_.setAttribute("id",A),_.setAttribute("clipPathUnits","objectBoundingBox"),y.append(_);for(let b=2,T=e.length;b<T;b+=8){const x=e[b],M=e[b+1],R=e[b+2],B=e[b+3],O=f.createElement("rect"),$=(R-t)/u,k=(i-M)/h,C=(x-R)/u,P=(M-B)/h;O.setAttribute("x",$),O.setAttribute("y",k),O.setAttribute("width",C),O.setAttribute("height",P),_.append(O),c?.push(`<rect vector-effect="non-scaling-stroke" x="${$}" y="${k}" width="${C}" height="${P}"/>`)}this.#t&&(c.push("</g></svg>')"),o.backgroundImage=c.join("")),this.container.append(m),this.container.style.clipPath=`url(#${A})`}_createPopup(){const{data:e}=this,t=this.#n=new Qy({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation,noRotate:!0},parent:this.parent,elements:[this]});this.parent.div.append(t.render())}render(){it("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const n=[];if(this._fieldObjects){const s=this._fieldObjects[e];if(s)for(const{page:i,id:o,exportValues:c}of s){if(i===-1||o===t)continue;const u=typeof c=="string"?c:null,h=document.querySelector(`[data-element-id="${o}"]`);if(h&&!ga.has(h)){Ve(`_getElementsByName - element not allowed: ${o}`);continue}n.push({id:o,exportValue:u,domElement:h})}return n}for(const s of document.getElementsByName(e)){const{exportValue:i}=s,o=s.getAttribute("data-element-id");o!==t&&ga.has(s)&&n.push({id:o,exportValue:i,domElement:s})}return n}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class lk extends jt{constructor(e,t=null){super(e,{isRenderable:!0,ignoreBorder:!!t?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:t}=this,n=document.createElement("a");n.setAttribute("data-element-id",e.id);let s=!1;return e.url?(t.addLinkAttributes(n,e.url,e.newWindow),s=!0):e.action?(this._bindNamedAction(n,e.action),s=!0):e.attachment?(this.#t(n,e.attachment,e.attachmentDest),s=!0):e.setOCGState?(this.#n(n,e.setOCGState),s=!0):e.dest?(this._bindLink(n,e.dest),s=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(n,e),s=!0),e.resetForm?(this._bindResetFormAction(n,e.resetForm),s=!0):this.isTooltipOnly&&!s&&(this._bindLink(n,""),s=!0)),this.container.classList.add("linkAnnotation"),s&&this.container.append(n),this.container}#e(){this.container.setAttribute("data-internal-link","")}_bindLink(e,t){e.href=this.linkService.getDestinationHash(t),e.onclick=()=>(t&&this.linkService.goToDestination(t),!1),(t||t==="")&&this.#e()}_bindNamedAction(e,t){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(t),!1),this.#e()}#t(e,t,n=null){e.href=this.linkService.getAnchorUrl(""),t.description&&(e.title=t.description),e.onclick=()=>(this.downloadManager?.openOrDownloadData(t.content,t.filename,n),!1),this.#e()}#n(e,t){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(t),!1),this.#e()}_bindJSAction(e,t){e.href=this.linkService.getAnchorUrl("");const n=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const s of Object.keys(t.actions)){const i=n.get(s);i&&(e[i]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t.id,name:s}}),!1))}e.onclick||(e.onclick=()=>!1),this.#e()}_bindResetFormAction(e,t){const n=e.onclick;if(n||(e.href=this.linkService.getAnchorUrl("")),this.#e(),!this._fieldObjects){Ve('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),n||(e.onclick=()=>!1);return}e.onclick=()=>{n?.();const{fields:s,refs:i,include:o}=t,c=[];if(s.length!==0||i.length!==0){const f=new Set(i);for(const m of s){const y=this._fieldObjects[m]||[];for(const{id:_}of y)f.add(_)}for(const m of Object.values(this._fieldObjects))for(const y of m)f.has(y.id)===o&&c.push(y)}else for(const f of Object.values(this._fieldObjects))c.push(...f);const u=this.annotationStorage,h=[];for(const f of c){const{id:m}=f;switch(h.push(m),f.type){case"text":{const _=f.defaultValue||"";u.setValue(m,{value:_});break}case"checkbox":case"radiobutton":{const _=f.defaultValue===f.exportValues;u.setValue(m,{value:_});break}case"combobox":case"listbox":{const _=f.defaultValue||"";u.setValue(m,{value:_});break}default:continue}const y=document.querySelector(`[data-element-id="${m}"]`);if(y){if(!ga.has(y)){Ve(`_bindResetFormAction - element not allowed: ${m}`);continue}}else continue;y.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:h,name:"ResetForm"}}),!1}}}class Mj extends jt{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class Ia extends jt{render(){return this.container}showElementAndHideCanvas(e){this.data.hasOwnCanvas&&(e.previousSibling?.nodeName==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return ln.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,n,s,i){n.includes("mouse")?e.addEventListener(n,o=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:i(o),shift:o.shiftKey,modifier:this._getKeyModifier(o)}})}):e.addEventListener(n,o=>{if(n==="blur"){if(!t.focused||!o.relatedTarget)return;t.focused=!1}else if(n==="focus"){if(t.focused)return;t.focused=!0}i&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:i(o)}})})}_setEventListeners(e,t,n,s){for(const[i,o]of n)(o==="Action"||this.data.actions?.[o])&&((o==="Focus"||o==="Blur")&&(t||={focused:!1}),this._setEventListener(e,t,i,o,s),o==="Focus"&&!this.data.actions?.Blur?this._setEventListener(e,t,"blur","Blur",null):o==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":be.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:n}=this.data.defaultAppearanceData,s=this.data.defaultAppearanceData.fontSize||Lj,i=e.style;let o;const c=2,u=h=>Math.round(10*h)/10;if(this.data.multiLine){const h=Math.abs(this.data.rect[3]-this.data.rect[1]-c),f=Math.round(h/(qg*s))||1,m=h/f;o=Math.min(s,u(m/qg))}else{const h=Math.abs(this.data.rect[3]-this.data.rect[1]-c);o=Math.min(s,u(h/qg))}i.fontSize=`calc(${o}px * var(--total-scale-factor))`,i.color=be.makeHexColor(n[0],n[1],n[2]),this.data.textAlignment!==null&&(i.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class Nj extends Ia{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,n,s){const i=this.annotationStorage;for(const o of this._getElementsByName(e.name,e.id))o.domElement&&(o.domElement[t]=n),i.setValue(o.id,{[s]:n})}render(){const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){const s=e.getValue(t,{value:this.data.fieldValue});let i=s.value||"";const o=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;o&&i.length>o&&(i=i.slice(0,o));let c=s.formattedValue||this.data.textContent?.join(`
`)||null;c&&this.data.comb&&(c=c.replaceAll(/\s+/g,""));const u={userValue:i,formattedValue:c,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=c??i,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type=this.data.password?"password":"text",n.setAttribute("value",c??i),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),ga.add(n),n.setAttribute("data-element-id",t),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=0;const h=this.data.dateFormat||this.data.timeFormat;h&&(n.title=h),this._setRequired(n,this.data.required),o&&(n.maxLength=o),n.addEventListener("input",m=>{e.setValue(t,{value:m.target.value}),this.setPropertyOnSiblings(n,"value",m.target.value,"value"),u.formattedValue=null}),n.addEventListener("resetform",m=>{const y=this.data.defaultFieldValue??"";n.value=u.userValue=y,u.formattedValue=null});let f=m=>{const{formattedValue:y}=u;y!=null&&(m.target.value=y),m.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){n.addEventListener("focus",y=>{if(u.focused)return;const{target:_}=y;u.userValue&&(_.value=u.userValue),u.lastCommittedValue=_.value,u.commitKey=1,this.data.actions?.Focus||(u.focused=!0)}),n.addEventListener("updatefromsandbox",y=>{this.showElementAndHideCanvas(y.target);const _={value(A){u.userValue=A.detail.value??"",e.setValue(t,{value:u.userValue.toString()}),A.target.value=u.userValue},formattedValue(A){const{formattedValue:b}=A.detail;u.formattedValue=b,b!=null&&A.target!==document.activeElement&&(A.target.value=b),e.setValue(t,{formattedValue:b})},selRange(A){A.target.setSelectionRange(...A.detail.selRange)},charLimit:A=>{const{charLimit:b}=A.detail,{target:T}=A;if(b===0){T.removeAttribute("maxLength");return}T.setAttribute("maxLength",b);let x=u.userValue;!x||x.length<=b||(x=x.slice(0,b),T.value=u.userValue=x,e.setValue(t,{value:x}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:x,willCommit:!0,commitKey:1,selStart:T.selectionStart,selEnd:T.selectionEnd}}))}};this._dispatchEventFromSandbox(_,y)}),n.addEventListener("keydown",y=>{u.commitKey=1;let _=-1;if(y.key==="Escape"?_=0:y.key==="Enter"&&!this.data.multiLine?_=2:y.key==="Tab"&&(u.commitKey=3),_===-1)return;const{value:A}=y.target;u.lastCommittedValue!==A&&(u.lastCommittedValue=A,u.userValue=A,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:A,willCommit:!0,commitKey:_,selStart:y.target.selectionStart,selEnd:y.target.selectionEnd}}))});const m=f;f=null,n.addEventListener("blur",y=>{if(!u.focused||!y.relatedTarget)return;this.data.actions?.Blur||(u.focused=!1);const{value:_}=y.target;u.userValue=_,u.lastCommittedValue!==_&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:_,willCommit:!0,commitKey:u.commitKey,selStart:y.target.selectionStart,selEnd:y.target.selectionEnd}}),m(y)}),this.data.actions?.Keystroke&&n.addEventListener("beforeinput",y=>{u.lastCommittedValue=null;const{data:_,target:A}=y,{value:b,selectionStart:T,selectionEnd:x}=A;let M=T,R=x;switch(y.inputType){case"deleteWordBackward":{const B=b.substring(0,T).match(/\w*[^\w]*$/);B&&(M-=B[0].length);break}case"deleteWordForward":{const B=b.substring(T).match(/^[^\w]*\w*/);B&&(R+=B[0].length);break}case"deleteContentBackward":T===x&&(M-=1);break;case"deleteContentForward":T===x&&(R+=1);break}y.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:b,change:_||"",willCommit:!1,selStart:M,selEnd:R}})}),this._setEventListeners(n,u,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],y=>y.target.value)}if(f&&n.addEventListener("blur",f),this.data.comb){const y=(this.data.rect[2]-this.data.rect[0])/o;n.classList.add("comb"),n.style.letterSpacing=`calc(${y}px * var(--total-scale-factor) - 1ch)`}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell",this.data.hasOwnCanvas&&(n.hidden=!0);return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class Oj extends Ia{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class Fj extends Ia{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,n=t.id;let s=e.getValue(n,{value:t.exportValue===t.fieldValue}).value;typeof s=="string"&&(s=s!=="Off",e.setValue(n,{value:s})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const i=document.createElement("input");return ga.add(i),i.setAttribute("data-element-id",n),i.disabled=t.readOnly,this._setRequired(i,this.data.required),i.type="checkbox",i.name=t.fieldName,s&&i.setAttribute("checked",!0),i.setAttribute("exportValue",t.exportValue),i.tabIndex=0,i.addEventListener("change",o=>{const{name:c,checked:u}=o.target;for(const h of this._getElementsByName(c,n)){const f=u&&h.exportValue===t.exportValue;h.domElement&&(h.domElement.checked=f),e.setValue(h.id,{value:f})}e.setValue(n,{value:u})}),i.addEventListener("resetform",o=>{const c=t.defaultFieldValue||"Off";o.target.checked=c===t.exportValue}),this.enableScripting&&this.hasJSActions&&(i.addEventListener("updatefromsandbox",o=>{const c={value(u){u.target.checked=u.detail.value!=="Off",e.setValue(n,{value:u.target.checked})}};this._dispatchEventFromSandbox(c,o)}),this._setEventListeners(i,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class ck extends Ia{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,n=t.id;let s=e.getValue(n,{value:t.fieldValue===t.buttonValue}).value;if(typeof s=="string"&&(s=s!==t.buttonValue,e.setValue(n,{value:s})),s)for(const o of this._getElementsByName(t.fieldName,n))e.setValue(o.id,{value:!1});const i=document.createElement("input");if(ga.add(i),i.setAttribute("data-element-id",n),i.disabled=t.readOnly,this._setRequired(i,this.data.required),i.type="radio",i.name=t.fieldName,s&&i.setAttribute("checked",!0),i.tabIndex=0,i.addEventListener("change",o=>{const{name:c,checked:u}=o.target;for(const h of this._getElementsByName(c,n))e.setValue(h.id,{value:!1});e.setValue(n,{value:u})}),i.addEventListener("resetform",o=>{const c=t.defaultFieldValue;o.target.checked=c!=null&&c===t.buttonValue}),this.enableScripting&&this.hasJSActions){const o=t.buttonValue;i.addEventListener("updatefromsandbox",c=>{const u={value:h=>{const f=o===h.detail.value;for(const m of this._getElementsByName(h.target.name)){const y=f&&m.id===n;m.domElement&&(m.domElement.checked=y),e.setValue(m.id,{value:y})}}};this._dispatchEventFromSandbox(u,c)}),this._setEventListeners(i,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],c=>c.target.checked)}return this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class Vj extends lk{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",n=>{this._dispatchEventFromSandbox({},n)})),e}}class jj extends Ia{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,n=e.getValue(t,{value:this.data.fieldValue}),s=document.createElement("select");ga.add(s),s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,this._setRequired(s,this.data.required),s.name=this.data.fieldName,s.tabIndex=0;let i=this.data.combo&&this.data.options.length>0;this.data.combo||(s.size=this.data.options.length,this.data.multiSelect&&(s.multiple=!0)),s.addEventListener("resetform",f=>{const m=this.data.defaultFieldValue;for(const y of s.options)y.selected=y.value===m});for(const f of this.data.options){const m=document.createElement("option");m.textContent=f.displayValue,m.value=f.exportValue,n.value.includes(f.exportValue)&&(m.setAttribute("selected",!0),i=!1),s.append(m)}let o=null;if(i){const f=document.createElement("option");f.value=" ",f.setAttribute("hidden",!0),f.setAttribute("selected",!0),s.prepend(f),o=()=>{f.remove(),s.removeEventListener("input",o),o=null},s.addEventListener("input",o)}const c=f=>{const m=f?"value":"textContent",{options:y,multiple:_}=s;return _?Array.prototype.filter.call(y,A=>A.selected).map(A=>A[m]):y.selectedIndex===-1?null:y[y.selectedIndex][m]};let u=c(!1);const h=f=>{const m=f.target.options;return Array.prototype.map.call(m,y=>({displayValue:y.textContent,exportValue:y.value}))};return this.enableScripting&&this.hasJSActions?(s.addEventListener("updatefromsandbox",f=>{const m={value(y){o?.();const _=y.detail.value,A=new Set(Array.isArray(_)?_:[_]);for(const b of s.options)b.selected=A.has(b.value);e.setValue(t,{value:c(!0)}),u=c(!1)},multipleSelection(y){s.multiple=!0},remove(y){const _=s.options,A=y.detail.remove;_[A].selected=!1,s.remove(A),_.length>0&&Array.prototype.findIndex.call(_,T=>T.selected)===-1&&(_[0].selected=!0),e.setValue(t,{value:c(!0),items:h(y)}),u=c(!1)},clear(y){for(;s.length!==0;)s.remove(0);e.setValue(t,{value:null,items:[]}),u=c(!1)},insert(y){const{index:_,displayValue:A,exportValue:b}=y.detail.insert,T=s.children[_],x=document.createElement("option");x.textContent=A,x.value=b,T?T.before(x):s.append(x),e.setValue(t,{value:c(!0),items:h(y)}),u=c(!1)},items(y){const{items:_}=y.detail;for(;s.length!==0;)s.remove(0);for(const A of _){const{displayValue:b,exportValue:T}=A,x=document.createElement("option");x.textContent=b,x.value=T,s.append(x)}s.options.length>0&&(s.options[0].selected=!0),e.setValue(t,{value:c(!0),items:h(y)}),u=c(!1)},indices(y){const _=new Set(y.detail.indices);for(const A of y.target.options)A.selected=_.has(A.index);e.setValue(t,{value:c(!0)}),u=c(!1)},editable(y){y.target.disabled=!y.detail.editable}};this._dispatchEventFromSandbox(m,f)}),s.addEventListener("input",f=>{const m=c(!0),y=c(!1);e.setValue(t,{value:m}),f.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:u,change:y,changeEx:m,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(s,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],f=>f.target.value)):s.addEventListener("input",function(f){e.setValue(t,{value:c(!0)})}),this.data.combo&&this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class Qy extends jt{constructor(e){const{data:t,elements:n}=e;super(e,{isRenderable:jt._hasPopupData(t)}),this.elements=n,this.popup=null}render(){const{container:e}=this;e.classList.add("popupAnnotation"),e.role="comment";const t=this.popup=new Bj({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),n=[];for(const s of this.elements)s.popup=t,s.container.ariaHasPopup="dialog",n.push(s.data.id),s.addHighlightArea();return this.container.setAttribute("aria-controls",n.map(s=>`${B0}${s}`).join(",")),this.container}}class Bj{#e=this.#C.bind(this);#t=this.#x.bind(this);#n=this.#I.bind(this);#r=this.#b.bind(this);#i=null;#s=null;#a=null;#o=null;#h=null;#l=null;#d=null;#u=!1;#f=null;#p=null;#m=null;#c=null;#g=null;#y=null;#v=!1;constructor({container:e,color:t,elements:n,titleObj:s,modificationDate:i,contentsObj:o,richText:c,parent:u,rect:h,parentRect:f,open:m}){this.#s=e,this.#g=s,this.#a=o,this.#c=c,this.#l=u,this.#i=t,this.#m=h,this.#d=f,this.#h=n,this.#o=U0.toDateObject(i),this.trigger=n.flatMap(y=>y.getElementsToTriggerPopup());for(const y of this.trigger)y.addEventListener("click",this.#r),y.addEventListener("mouseenter",this.#n),y.addEventListener("mouseleave",this.#t),y.classList.add("popupTriggerArea");for(const y of n)y.container?.addEventListener("keydown",this.#e);this.#s.hidden=!0,m&&this.#b()}render(){if(this.#f)return;const e=this.#f=document.createElement("div");if(e.className="popup",this.#i){const i=e.style.outlineColor=be.makeHexColor(...this.#i);e.style.backgroundColor=`color-mix(in srgb, ${i} 30%, white)`}const t=document.createElement("span");t.className="header";const n=document.createElement("h1");if(t.append(n),{dir:n.dir,str:n.textContent}=this.#g,e.append(t),this.#o){const i=document.createElement("time");i.classList.add("popupDate"),i.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),i.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#o.valueOf()})),i.dateTime=this.#o.toISOString(),t.append(i)}const s=this.#w;if(s)Z0.render({xfaHtml:s,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{const i=this._formatContents(this.#a);e.append(i)}this.#s.append(e)}get#w(){const e=this.#c,t=this.#a;return e?.str&&(!t?.str||t.str===e.str)&&this.#c.html||null}get#E(){return this.#w?.attributes?.style?.fontSize||0}get#A(){return this.#w?.attributes?.style?.color||null}#S(e){const t=[],n={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},s={style:{color:this.#A,fontSize:this.#E?`calc(${this.#E}px * var(--total-scale-factor))`:""}};for(const i of e.split(`
`))t.push({name:"span",value:i,attributes:s});return n}_formatContents({str:e,dir:t}){const n=document.createElement("p");n.classList.add("popupContent"),n.dir=t;const s=e.split(/(?:\r\n?|\n)/);for(let i=0,o=s.length;i<o;++i){const c=s[i];n.append(document.createTextNode(c)),i<o-1&&n.append(document.createElement("br"))}return n}#C(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&this.#u)&&this.#b()}updateEdited({rect:e,popupContent:t}){this.#y||={contentsObj:this.#a,richText:this.#c},e&&(this.#p=null),t&&(this.#c=this.#S(t),this.#a=null),this.#f?.remove(),this.#f=null}resetEdited(){this.#y&&({contentsObj:this.#a,richText:this.#c}=this.#y,this.#y=null,this.#f?.remove(),this.#f=null,this.#p=null)}#k(){if(this.#p!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:n,pageX:s,pageY:i}}}=this.#l;let o=!!this.#d,c=o?this.#d:this.#m;for(const A of this.#h)if(!c||be.intersect(A.data.rect,c)!==null){c=A.data.rect,o=!0;break}const u=be.normalizeRect([c[0],e[3]-c[1]+e[1],c[2],e[3]-c[3]+e[1]]),f=o?c[2]-c[0]+5:0,m=u[0]+f,y=u[1];this.#p=[100*(m-s)/t,100*(y-i)/n];const{style:_}=this.#s;_.left=`${this.#p[0]}%`,_.top=`${this.#p[1]}%`}#b(){this.#u=!this.#u,this.#u?(this.#I(),this.#s.addEventListener("click",this.#r),this.#s.addEventListener("keydown",this.#e)):(this.#x(),this.#s.removeEventListener("click",this.#r),this.#s.removeEventListener("keydown",this.#e))}#I(){this.#f||this.render(),this.isVisible?this.#u&&this.#s.classList.add("focused"):(this.#k(),this.#s.hidden=!1,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)+1e3)}#x(){this.#s.classList.remove("focused"),!(this.#u||!this.isVisible)&&(this.#s.hidden=!0,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)-1e3)}forceHide(){this.#v=this.isVisible,this.#v&&(this.#s.hidden=!0)}maybeShow(){this.#v&&(this.#f||this.#I(),this.#v=!1,this.#s.hidden=!1)}get isVisible(){return this.#s.hidden===!1}}class uk extends jt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=Oe.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const n=document.createElement("span");n.textContent=t,e.append(n)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class Uj extends jt{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const{data:e,width:t,height:n}=this,s=this.svgFactory.create(t,n,!0),i=this.#e=this.svgFactory.createElement("svg:line");return i.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),i.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),i.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),i.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),i.setAttribute("stroke-width",e.borderStyle.width||1),i.setAttribute("stroke","transparent"),i.setAttribute("fill","transparent"),s.append(i),this.container.append(s),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class zj extends jt{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const{data:e,width:t,height:n}=this,s=this.svgFactory.create(t,n,!0),i=e.borderStyle.width,o=this.#e=this.svgFactory.createElement("svg:rect");return o.setAttribute("x",i/2),o.setAttribute("y",i/2),o.setAttribute("width",t-i),o.setAttribute("height",n-i),o.setAttribute("stroke-width",i||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),s.append(o),this.container.append(s),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class $j extends jt{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const{data:e,width:t,height:n}=this,s=this.svgFactory.create(t,n,!0),i=e.borderStyle.width,o=this.#e=this.svgFactory.createElement("svg:ellipse");return o.setAttribute("cx",t/2),o.setAttribute("cy",n/2),o.setAttribute("rx",t/2-i/2),o.setAttribute("ry",n/2-i/2),o.setAttribute("stroke-width",i||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),s.append(o),this.container.append(s),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class hk extends jt{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,vertices:t,borderStyle:n,popupRef:s},width:i,height:o}=this;if(!t)return this.container;const c=this.svgFactory.create(i,o,!0);let u=[];for(let f=0,m=t.length;f<m;f+=2){const y=t[f]-e[0],_=e[3]-t[f+1];u.push(`${y},${_}`)}u=u.join(" ");const h=this.#e=this.svgFactory.createElement(this.svgElementName);return h.setAttribute("points",u),h.setAttribute("stroke-width",n.width||1),h.setAttribute("stroke","transparent"),h.setAttribute("fill","transparent"),c.append(h),this.container.append(c),!s&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class Hj extends hk{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Wj extends jt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class e_ extends jt{#e=null;#t=[];constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?Oe.HIGHLIGHT:Oe.INK}#n(e,t){switch(e){case 90:return{transform:`rotate(90) translate(${-t[0]},${t[1]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};case 180:return{transform:`rotate(180) translate(${-t[2]},${t[1]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]};case 270:return{transform:`rotate(270) translate(${-t[2]},${t[3]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};default:return{transform:`translate(${-t[0]},${t[3]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,rotation:t,inkLists:n,borderStyle:s,popupRef:i}}=this,{transform:o,width:c,height:u}=this.#n(t,e),h=this.svgFactory.create(c,u,!0),f=this.#e=this.svgFactory.createElement("svg:g");h.append(f),f.setAttribute("stroke-width",s.width||1),f.setAttribute("stroke-linecap","round"),f.setAttribute("stroke-linejoin","round"),f.setAttribute("stroke-miterlimit",10),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),f.setAttribute("transform",o);for(let m=0,y=n.length;m<y;m++){const _=this.svgFactory.createElement(this.svgElementName);this.#t.push(_),_.setAttribute("points",n[m].join(",")),f.append(_)}return!i&&this.hasPopupData&&this._createPopup(),this.container.append(h),this._editOnDoubleClick(),this.container}updateEdited(e){super.updateEdited(e);const{thickness:t,points:n,rect:s}=e,i=this.#e;if(t>=0&&i.setAttribute("stroke-width",t||1),n)for(let o=0,c=this.#t.length;o<c;o++)this.#t[o].setAttribute("points",n[o].join(","));if(s){const{transform:o,width:c,height:u}=this.#n(this.data.rotation,s);i.parentElement.setAttribute("viewBox",`0 0 ${c} ${u}`),i.setAttribute("transform",o)}}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class dk extends jt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Oe.HIGHLIGHT}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),e){const n=document.createElement("mark");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class Gj extends jt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),e){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class qj extends jt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),e){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class Kj extends jt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),e){const n=document.createElement("s");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class fk extends jt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Oe.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class Xj extends jt{#e=null;constructor(e){super(e,{isRenderable:!0});const{file:t}=this.data;this.filename=t.filename,this.content=t.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...t})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:t}=this;let n;t.hasAppearance||t.fillAlpha===0?n=document.createElement("div"):(n=document.createElement("img"),n.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(t.name)?"paperclip":"pushpin"}.svg`,t.fillAlpha&&t.fillAlpha<1&&(n.style=`filter: opacity(${Math.round(t.fillAlpha*100)}%);`)),n.addEventListener("dblclick",this.#t.bind(this)),this.#e=n;const{isMac:s}=ln.platform;return e.addEventListener("keydown",i=>{i.key==="Enter"&&(s?i.metaKey:i.ctrlKey)&&this.#t()}),!t.popupRef&&this.hasPopupData?this._createPopup():n.classList.add("popupTriggerArea"),e.append(n),e}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}#t(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}let t_=class pk{#e=null;#t=null;#n=new Map;#r=null;constructor({div:e,accessibilityManager:t,annotationCanvasMap:n,annotationEditorUIManager:s,page:i,viewport:o,structTreeLayer:c}){this.div=e,this.#e=t,this.#t=n,this.#r=c||null,this.page=i,this.viewport=o,this.zIndex=0,this._annotationEditorUIManager=s}hasEditableAnnotations(){return this.#n.size>0}async#i(e,t,n){const s=e.firstChild||e,i=s.id=`${B0}${t}`,o=await this.#r?.getAriaAttributes(i);if(o)for(const[c,u]of o)s.setAttribute(c,u);n?n.at(-1).container.after(e):(this.div.append(e),this.#e?.moveElementInDOM(this.div,e,s,!1))}async render(e){const{annotations:t}=e,n=this.div;go(n,this.viewport);const s=new Map,i={data:null,layer:n,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new Yu,annotationStorage:e.annotationStorage||new W0,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const o of t){if(o.noHTML)continue;const c=o.annotationType===Mt.POPUP;if(c){const f=s.get(o.id);if(!f)continue;i.elements=f}else if(o.rect[2]===o.rect[0]||o.rect[3]===o.rect[1])continue;i.data=o;const u=qb.create(i);if(!u.isRenderable)continue;if(!c&&o.popupRef){const f=s.get(o.popupRef);f?f.push(u):s.set(o.popupRef,[u])}const h=u.render();o.hidden&&(h.style.visibility="hidden"),await this.#i(h,o.id,i.elements),u._isEditable&&(this.#n.set(u.data.id,u),this._annotationEditorUIManager?.renderAnnotationElement(u))}this.#s()}async addLinkAnnotations(e,t){const n={data:null,layer:this.div,linkService:t,svgFactory:new Yu,parent:this};for(const s of e){s.borderStyle||=pk._defaultBorderStyle,n.data=s;const i=qb.create(n);if(!i.isRenderable)continue;const o=i.render();await this.#i(o,s.id,null)}}update({viewport:e}){const t=this.div;this.viewport=e,go(t,{rotation:e.rotation}),this.#s(),t.hidden=!1}#s(){if(!this.#t)return;const e=this.div;for(const[t,n]of this.#t){const s=e.querySelector(`[data-annotation-id="${t}"]`);if(!s)continue;n.className="annotationContent";const{firstChild:i}=s;i?i.nodeName==="CANVAS"?i.replaceWith(n):i.classList.contains("annotationContent")?i.after(n):i.before(n):s.append(n);const o=this.#n.get(t);o&&(o._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(t,s.id,n),o._hasNoCanvas=!1):o.canvas=n)}this.#t.clear()}getEditableAnnotations(){return Array.from(this.#n.values())}getEditableAnnotation(e){return this.#n.get(e)}static get _defaultBorderStyle(){return We(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:wl.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}};const tf=/\r\n?|\n/g;class Qt extends Ie{#e;#t="";#n=`${this.id}-editor`;#r=null;#i;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const e=Qt.prototype,t=i=>i.isEmpty(),n=vi.TRANSLATE_SMALL,s=vi.TRANSLATE_BIG;return We(this,"_keyboardManager",new vh([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-n,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-s,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[n,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[s,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-n],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-s],checker:t}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,n],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,s],checker:t}]]))}static _type="freetext";static _editorType=Oe.FREETEXT;constructor(e){super({...e,name:"freeTextEditor"}),this.#e=e.color||Qt._defaultColor||Ie._defaultLineColor,this.#i=e.fontSize||Qt._defaultFontSize,this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert")}static initialize(e,t){Ie.initialize(e,t);const n=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(n.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,t){switch(e){case qe.FREETEXT_SIZE:Qt._defaultFontSize=t;break;case qe.FREETEXT_COLOR:Qt._defaultColor=t;break}}updateParams(e,t){switch(e){case qe.FREETEXT_SIZE:this.#s(t);break;case qe.FREETEXT_COLOR:this.#a(t);break}}static get defaultPropertiesToUpdate(){return[[qe.FREETEXT_SIZE,Qt._defaultFontSize],[qe.FREETEXT_COLOR,Qt._defaultColor||Ie._defaultLineColor]]}get propertiesToUpdate(){return[[qe.FREETEXT_SIZE,this.#i],[qe.FREETEXT_COLOR,this.#e]]}#s(e){const t=s=>{this.editorDiv.style.fontSize=`calc(${s}px * var(--total-scale-factor))`,this.translate(0,-(s-this.#i)*this.parentScale),this.#i=s,this.#h()},n=this.#i;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:qe.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#a(e){const t=s=>{this.#e=this.editorDiv.style.color=s},n=this.#e;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:qe.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(e,t){this._uiManager.translateSelectedEditors(e,t,!0)}getInitialTranslation(){const e=this.parentScale;return[-Qt._internalPadding*e,-(Qt._internalPadding+this.#i)*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#r=new AbortController;const e=this._uiManager.combinedSignal(this.#r);return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e}),!0}disableEditMode(){return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#n),this._isDraggable=!0,this.#r?.abort(),this.#r=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(e){this.width||(this.enableEditMode(),e&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#o(){const e=[];this.editorDiv.normalize();let t=null;for(const n of this.editorDiv.childNodes)t?.nodeType===Node.TEXT_NODE&&n.nodeName==="BR"||(e.push(Qt.#l(n)),t=n);return e.join(`
`)}#h(){const[e,t]=this.parentDimensions;let n;if(this.isAttachedToDOM)n=this.div.getBoundingClientRect();else{const{currentLayer:s,div:i}=this,o=i.style.display,c=i.classList.contains("hidden");i.classList.remove("hidden"),i.style.display="hidden",s.div.append(this.div),n=i.getBoundingClientRect(),i.remove(),i.style.display=o,i.classList.toggle("hidden",c)}this.rotation%180===this.parentRotation%180?(this.width=n.width/e,this.height=n.height/t):(this.width=n.height/e,this.height=n.width/t),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=this.#t,t=this.#t=this.#o().trimEnd();if(e===t)return;const n=s=>{if(this.#t=s,!s){this.remove();return}this.#d(),this._uiManager.rebuild(this),this.#h()};this.addCommands({cmd:()=>{n(t)},undo:()=>{n(e)},mustExec:!1}),this.#h()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){Qt._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let e,t;(this._isCopy||this.annotationElementId)&&(e=this.x,t=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#n),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:n}=this.editorDiv;if(n.fontSize=`calc(${this.#i}px * var(--total-scale-factor))`,n.color=this.#e,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[s,i]=this.parentDimensions;if(this.annotationElementId){const{position:o}=this._initialData;let[c,u]=this.getInitialTranslation();[c,u]=this.pageTranslationToScreen(c,u);const[h,f]=this.pageDimensions,[m,y]=this.pageTranslation;let _,A;switch(this.rotation){case 0:_=e+(o[0]-m)/h,A=t+this.height-(o[1]-y)/f;break;case 90:_=e+(o[0]-m)/h,A=t-(o[1]-y)/f,[c,u]=[u,-c];break;case 180:_=e-this.width+(o[0]-m)/h,A=t-(o[1]-y)/f,[c,u]=[-c,-u];break;case 270:_=e+(o[0]-m-this.height*f)/h,A=t+(o[1]-y-this.width*h)/f,[c,u]=[-u,c];break}this.setAt(_*s,A*i,c,u)}else this._moveAfterPaste(e,t);this.#d(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#l(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(tf,"")}editorDivPaste(e){const t=e.clipboardData||window.clipboardData,{types:n}=t;if(n.length===1&&n[0]==="text/plain")return;e.preventDefault();const s=Qt.#f(t.getData("text")||"").replaceAll(tf,`
`);if(!s)return;const i=window.getSelection();if(!i.rangeCount)return;this.editorDiv.normalize(),i.deleteFromDocument();const o=i.getRangeAt(0);if(!s.includes(`
`)){o.insertNode(document.createTextNode(s)),this.editorDiv.normalize(),i.collapseToStart();return}const{startContainer:c,startOffset:u}=o,h=[],f=[];if(c.nodeType===Node.TEXT_NODE){const _=c.parentElement;if(f.push(c.nodeValue.slice(u).replaceAll(tf,"")),_!==this.editorDiv){let A=h;for(const b of this.editorDiv.childNodes){if(b===_){A=f;continue}A.push(Qt.#l(b))}}h.push(c.nodeValue.slice(0,u).replaceAll(tf,""))}else if(c===this.editorDiv){let _=h,A=0;for(const b of this.editorDiv.childNodes)A++===u&&(_=f),_.push(Qt.#l(b))}this.#t=`${h.join(`
`)}${s}${f.join(`
`)}`,this.#d();const m=new Range;let y=Math.sumPrecise(h.map(_=>_.length));for(const{firstChild:_}of this.editorDiv.childNodes)if(_.nodeType===Node.TEXT_NODE){const A=_.nodeValue.length;if(y<=A){m.setStart(_,y),m.setEnd(_,y);break}y-=A}i.removeAllRanges(),i.addRange(m)}#d(){if(this.editorDiv.replaceChildren(),!!this.#t)for(const e of this.#t.split(`
`)){const t=document.createElement("div");t.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(t)}}#u(){return this.#t.replaceAll(" "," ")}static#f(e){return e.replaceAll(" "," ")}get contentDiv(){return this.editorDiv}static async deserialize(e,t,n){let s=null;if(e instanceof uk){const{data:{defaultAppearanceData:{fontSize:o,fontColor:c},rect:u,rotation:h,id:f,popupRef:m},textContent:y,textPosition:_,parent:{page:{pageNumber:A}}}=e;if(!y||y.length===0)return null;s=e={annotationType:Oe.FREETEXT,color:Array.from(c),fontSize:o,value:y.join(`
`),position:_,pageIndex:A-1,rect:u.slice(0),rotation:h,annotationElementId:f,id:f,deleted:!1,popupRef:m}}const i=await super.deserialize(e,t,n);return i.#i=e.fontSize,i.#e=be.makeHexColor(...e.color),i.#t=Qt.#f(e.value),i._initialData=s,i}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const t=Qt._internalPadding*this.parentScale,n=this.getRect(t,t),s=Ie._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#e),i={annotationType:Oe.FREETEXT,color:s,fontSize:this.#i,value:this.#u(),pageIndex:this.pageIndex,rect:n,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?(i.isCopy=!0,i):this.annotationElementId&&!this.#p(i)?null:(i.id=this.annotationElementId,i)}#p(e){const{value:t,fontSize:n,color:s,pageIndex:i}=this._initialData;return this._hasBeenMoved||e.value!==t||e.fontSize!==n||e.color.some((o,c)=>o!==s[c])||e.pageIndex!==i}renderAnnotationElement(e){const t=super.renderAnnotationElement(e);if(this.deleted)return t;const{style:n}=t;n.fontSize=`calc(${this.#i}px * var(--total-scale-factor))`,n.color=this.#e,t.replaceChildren();for(const i of this.#t.split(`
`)){const o=document.createElement("div");o.append(i?document.createTextNode(i):document.createElement("br")),t.append(o)}const s=Qt._internalPadding*this.parentScale;return e.updateEdited({rect:this.getRect(s,s),popupContent:this.#t}),t}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}}class ge{static PRECISION=1e-4;toSVGPath(){it("Abstract method `toSVGPath` must be implemented.")}get box(){it("Abstract getter `box` must be implemented.")}serialize(e,t){it("Abstract method `serialize` must be implemented.")}static _rescale(e,t,n,s,i,o){o||=new Float32Array(e.length);for(let c=0,u=e.length;c<u;c+=2)o[c]=t+e[c]*s,o[c+1]=n+e[c+1]*i;return o}static _rescaleAndSwap(e,t,n,s,i,o){o||=new Float32Array(e.length);for(let c=0,u=e.length;c<u;c+=2)o[c]=t+e[c+1]*s,o[c+1]=n+e[c]*i;return o}static _translate(e,t,n,s){s||=new Float32Array(e.length);for(let i=0,o=e.length;i<o;i+=2)s[i]=t+e[i],s[i+1]=n+e[i+1];return s}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,n,s,i){switch(i){case 90:return[1-t/n,e/s];case 180:return[1-e/n,1-t/s];case 270:return[t/n,1-e/s];default:return[e/n,t/s]}}static _normalizePagePoint(e,t,n){switch(n){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,n,s,i,o){return[(e+5*n)/6,(t+5*s)/6,(5*n+i)/6,(5*s+o)/6,(n+i)/2,(s+o)/2]}}class sa{#e;#t=[];#n;#r;#i=[];#s=new Float32Array(18);#a;#o;#h;#l;#d;#u;#f=[];static#p=8;static#m=2;static#c=sa.#p+sa.#m;constructor({x:e,y:t},n,s,i,o,c=0){this.#e=n,this.#u=i*s,this.#r=o,this.#s.set([NaN,NaN,NaN,NaN,e,t],6),this.#n=c,this.#l=sa.#p*s,this.#h=sa.#c*s,this.#d=s,this.#f.push(e,t)}isEmpty(){return isNaN(this.#s[8])}#g(){const e=this.#s.subarray(4,6),t=this.#s.subarray(16,18),[n,s,i,o]=this.#e;return[(this.#a+(e[0]-t[0])/2-n)/i,(this.#o+(e[1]-t[1])/2-s)/o,(this.#a+(t[0]-e[0])/2-n)/i,(this.#o+(t[1]-e[1])/2-s)/o]}add({x:e,y:t}){this.#a=e,this.#o=t;const[n,s,i,o]=this.#e;let[c,u,h,f]=this.#s.subarray(8,12);const m=e-h,y=t-f,_=Math.hypot(m,y);if(_<this.#h)return!1;const A=_-this.#l,b=A/_,T=b*m,x=b*y;let M=c,R=u;c=h,u=f,h+=T,f+=x,this.#f?.push(e,t);const B=-x/A,O=T/A,$=B*this.#u,k=O*this.#u;return this.#s.set(this.#s.subarray(2,8),0),this.#s.set([h+$,f+k],4),this.#s.set(this.#s.subarray(14,18),12),this.#s.set([h-$,f-k],16),isNaN(this.#s[6])?(this.#i.length===0&&(this.#s.set([c+$,u+k],2),this.#i.push(NaN,NaN,NaN,NaN,(c+$-n)/i,(u+k-s)/o),this.#s.set([c-$,u-k],14),this.#t.push(NaN,NaN,NaN,NaN,(c-$-n)/i,(u-k-s)/o)),this.#s.set([M,R,c,u,h,f],6),!this.isEmpty()):(this.#s.set([M,R,c,u,h,f],6),Math.abs(Math.atan2(R-u,M-c)-Math.atan2(x,T))<Math.PI/2?([c,u,h,f]=this.#s.subarray(2,6),this.#i.push(NaN,NaN,NaN,NaN,((c+h)/2-n)/i,((u+f)/2-s)/o),[c,u,M,R]=this.#s.subarray(14,18),this.#t.push(NaN,NaN,NaN,NaN,((M+c)/2-n)/i,((R+u)/2-s)/o),!0):([M,R,c,u,h,f]=this.#s.subarray(0,6),this.#i.push(((M+5*c)/6-n)/i,((R+5*u)/6-s)/o,((5*c+h)/6-n)/i,((5*u+f)/6-s)/o,((c+h)/2-n)/i,((u+f)/2-s)/o),[h,f,c,u,M,R]=this.#s.subarray(12,18),this.#t.push(((M+5*c)/6-n)/i,((R+5*u)/6-s)/o,((5*c+h)/6-n)/i,((5*u+f)/6-s)/o,((c+h)/2-n)/i,((u+f)/2-s)/o),!0))}toSVGPath(){if(this.isEmpty())return"";const e=this.#i,t=this.#t;if(isNaN(this.#s[6])&&!this.isEmpty())return this.#y();const n=[];n.push(`M${e[4]} ${e[5]}`);for(let s=6;s<e.length;s+=6)isNaN(e[s])?n.push(`L${e[s+4]} ${e[s+5]}`):n.push(`C${e[s]} ${e[s+1]} ${e[s+2]} ${e[s+3]} ${e[s+4]} ${e[s+5]}`);this.#w(n);for(let s=t.length-6;s>=6;s-=6)isNaN(t[s])?n.push(`L${t[s+4]} ${t[s+5]}`):n.push(`C${t[s]} ${t[s+1]} ${t[s+2]} ${t[s+3]} ${t[s+4]} ${t[s+5]}`);return this.#v(n),n.join(" ")}#y(){const[e,t,n,s]=this.#e,[i,o,c,u]=this.#g();return`M${(this.#s[2]-e)/n} ${(this.#s[3]-t)/s} L${(this.#s[4]-e)/n} ${(this.#s[5]-t)/s} L${i} ${o} L${c} ${u} L${(this.#s[16]-e)/n} ${(this.#s[17]-t)/s} L${(this.#s[14]-e)/n} ${(this.#s[15]-t)/s} Z`}#v(e){const t=this.#t;e.push(`L${t[4]} ${t[5]} Z`)}#w(e){const[t,n,s,i]=this.#e,o=this.#s.subarray(4,6),c=this.#s.subarray(16,18),[u,h,f,m]=this.#g();e.push(`L${(o[0]-t)/s} ${(o[1]-n)/i} L${u} ${h} L${f} ${m} L${(c[0]-t)/s} ${(c[1]-n)/i}`)}newFreeDrawOutline(e,t,n,s,i,o){return new mk(e,t,n,s,i,o)}getOutlines(){const e=this.#i,t=this.#t,n=this.#s,[s,i,o,c]=this.#e,u=new Float32Array((this.#f?.length??0)+2);for(let m=0,y=u.length-2;m<y;m+=2)u[m]=(this.#f[m]-s)/o,u[m+1]=(this.#f[m+1]-i)/c;if(u[u.length-2]=(this.#a-s)/o,u[u.length-1]=(this.#o-i)/c,isNaN(n[6])&&!this.isEmpty())return this.#E(u);const h=new Float32Array(this.#i.length+24+this.#t.length);let f=e.length;for(let m=0;m<f;m+=2){if(isNaN(e[m])){h[m]=h[m+1]=NaN;continue}h[m]=e[m],h[m+1]=e[m+1]}f=this.#S(h,f);for(let m=t.length-6;m>=6;m-=6)for(let y=0;y<6;y+=2){if(isNaN(t[m+y])){h[f]=h[f+1]=NaN,f+=2;continue}h[f]=t[m+y],h[f+1]=t[m+y+1],f+=2}return this.#A(h,f),this.newFreeDrawOutline(h,u,this.#e,this.#d,this.#n,this.#r)}#E(e){const t=this.#s,[n,s,i,o]=this.#e,[c,u,h,f]=this.#g(),m=new Float32Array(36);return m.set([NaN,NaN,NaN,NaN,(t[2]-n)/i,(t[3]-s)/o,NaN,NaN,NaN,NaN,(t[4]-n)/i,(t[5]-s)/o,NaN,NaN,NaN,NaN,c,u,NaN,NaN,NaN,NaN,h,f,NaN,NaN,NaN,NaN,(t[16]-n)/i,(t[17]-s)/o,NaN,NaN,NaN,NaN,(t[14]-n)/i,(t[15]-s)/o],0),this.newFreeDrawOutline(m,e,this.#e,this.#d,this.#n,this.#r)}#A(e,t){const n=this.#t;return e.set([NaN,NaN,NaN,NaN,n[4],n[5]],t),t+=6}#S(e,t){const n=this.#s.subarray(4,6),s=this.#s.subarray(16,18),[i,o,c,u]=this.#e,[h,f,m,y]=this.#g();return e.set([NaN,NaN,NaN,NaN,(n[0]-i)/c,(n[1]-o)/u,NaN,NaN,NaN,NaN,h,f,NaN,NaN,NaN,NaN,m,y,NaN,NaN,NaN,NaN,(s[0]-i)/c,(s[1]-o)/u],t),t+=24}}class mk extends ge{#e;#t=new Float32Array(4);#n;#r;#i;#s;#a;constructor(e,t,n,s,i,o){super(),this.#a=e,this.#i=t,this.#e=n,this.#s=s,this.#n=i,this.#r=o,this.lastPoint=[NaN,NaN],this.#o(o);const[c,u,h,f]=this.#t;for(let m=0,y=e.length;m<y;m+=2)e[m]=(e[m]-c)/h,e[m+1]=(e[m+1]-u)/f;for(let m=0,y=t.length;m<y;m+=2)t[m]=(t[m]-c)/h,t[m+1]=(t[m+1]-u)/f}toSVGPath(){const e=[`M${this.#a[4]} ${this.#a[5]}`];for(let t=6,n=this.#a.length;t<n;t+=6){if(isNaN(this.#a[t])){e.push(`L${this.#a[t+4]} ${this.#a[t+5]}`);continue}e.push(`C${this.#a[t]} ${this.#a[t+1]} ${this.#a[t+2]} ${this.#a[t+3]} ${this.#a[t+4]} ${this.#a[t+5]}`)}return e.push("Z"),e.join(" ")}serialize([e,t,n,s],i){const o=n-e,c=s-t;let u,h;switch(i){case 0:u=ge._rescale(this.#a,e,s,o,-c),h=ge._rescale(this.#i,e,s,o,-c);break;case 90:u=ge._rescaleAndSwap(this.#a,e,t,o,c),h=ge._rescaleAndSwap(this.#i,e,t,o,c);break;case 180:u=ge._rescale(this.#a,n,t,-o,c),h=ge._rescale(this.#i,n,t,-o,c);break;case 270:u=ge._rescaleAndSwap(this.#a,n,s,-o,-c),h=ge._rescaleAndSwap(this.#i,n,s,-o,-c);break}return{outline:Array.from(u),points:[Array.from(h)]}}#o(e){const t=this.#a;let n=t[4],s=t[5];const i=[n,s,n,s];let o=n,c=s;const u=e?Math.max:Math.min;for(let f=6,m=t.length;f<m;f+=6){const y=t[f+4],_=t[f+5];if(isNaN(t[f]))be.pointBoundingBox(y,_,i),c<_?(o=y,c=_):c===_&&(o=u(o,y));else{const A=[1/0,1/0,-1/0,-1/0];be.bezierBoundingBox(n,s,...t.slice(f,f+6),A),be.rectBoundingBox(...A,i),c<A[3]?(o=A[2],c=A[3]):c===A[3]&&(o=u(o,A[2]))}n=y,s=_}const h=this.#t;h[0]=i[0]-this.#n,h[1]=i[1]-this.#n,h[2]=i[2]-i[0]+2*this.#n,h[3]=i[3]-i[1]+2*this.#n,this.lastPoint=[o,c]}get box(){return this.#t}newOutliner(e,t,n,s,i,o=0){return new sa(e,t,n,s,i,o)}getNewOutline(e,t){const[n,s,i,o]=this.#t,[c,u,h,f]=this.#e,m=i*h,y=o*f,_=n*h+c,A=s*f+u,b=this.newOutliner({x:this.#i[0]*m+_,y:this.#i[1]*y+A},this.#e,this.#s,e,this.#r,t??this.#n);for(let T=2;T<this.#i.length;T+=2)b.add({x:this.#i[T]*m+_,y:this.#i[T+1]*y+A});return b.getOutlines()}}class Jy{#e;#t;#n=[];#r=[];constructor(e,t=0,n=0,s=!0){const i=[1/0,1/0,-1/0,-1/0],o=10**-4;for(const{x:_,y:A,width:b,height:T}of e){const x=Math.floor((_-t)/o)*o,M=Math.ceil((_+b+t)/o)*o,R=Math.floor((A-t)/o)*o,B=Math.ceil((A+T+t)/o)*o,O=[x,R,B,!0],$=[M,R,B,!1];this.#n.push(O,$),be.rectBoundingBox(x,R,M,B,i)}const c=i[2]-i[0]+2*n,u=i[3]-i[1]+2*n,h=i[0]-n,f=i[1]-n,m=this.#n.at(s?-1:-2),y=[m[0],m[2]];for(const _ of this.#n){const[A,b,T]=_;_[0]=(A-h)/c,_[1]=(b-f)/u,_[2]=(T-f)/u}this.#e=new Float32Array([h,f,c,u]),this.#t=y}getOutlines(){this.#n.sort((t,n)=>t[0]-n[0]||t[1]-n[1]||t[2]-n[2]);const e=[];for(const t of this.#n)t[3]?(e.push(...this.#h(t)),this.#a(t)):(this.#o(t),e.push(...this.#h(t)));return this.#i(e)}#i(e){const t=[],n=new Set;for(const o of e){const[c,u,h]=o;t.push([c,u,o],[c,h,o])}t.sort((o,c)=>o[1]-c[1]||o[0]-c[0]);for(let o=0,c=t.length;o<c;o+=2){const u=t[o][2],h=t[o+1][2];u.push(h),h.push(u),n.add(u),n.add(h)}const s=[];let i;for(;n.size>0;){const o=n.values().next().value;let[c,u,h,f,m]=o;n.delete(o);let y=c,_=u;for(i=[c,h],s.push(i);;){let A;if(n.has(f))A=f;else if(n.has(m))A=m;else break;n.delete(A),[c,u,h,f,m]=A,y!==c&&(i.push(y,_,c,_===u?u:h),y=c),_=_===u?h:u}i.push(y,_)}return new Yj(s,this.#e,this.#t)}#s(e){const t=this.#r;let n=0,s=t.length-1;for(;n<=s;){const i=n+s>>1,o=t[i][0];if(o===e)return i;o<e?n=i+1:s=i-1}return s+1}#a([,e,t]){const n=this.#s(e);this.#r.splice(n,0,[e,t])}#o([,e,t]){const n=this.#s(e);for(let s=n;s<this.#r.length;s++){const[i,o]=this.#r[s];if(i!==e)break;if(i===e&&o===t){this.#r.splice(s,1);return}}for(let s=n-1;s>=0;s--){const[i,o]=this.#r[s];if(i!==e)break;if(i===e&&o===t){this.#r.splice(s,1);return}}}#h(e){const[t,n,s]=e,i=[[t,n,s]],o=this.#s(s);for(let c=0;c<o;c++){const[u,h]=this.#r[c];for(let f=0,m=i.length;f<m;f++){const[,y,_]=i[f];if(!(h<=y||_<=u)){if(y>=u){if(_>h)i[f][1]=h;else{if(m===1)return[];i.splice(f,1),f--,m--}continue}i[f][2]=u,_>h&&i.push([t,h,_])}}}return i}}class Yj extends ge{#e;#t;constructor(e,t,n){super(),this.#t=e,this.#e=t,this.lastPoint=n}toSVGPath(){const e=[];for(const t of this.#t){let[n,s]=t;e.push(`M${n} ${s}`);for(let i=2;i<t.length;i+=2){const o=t[i],c=t[i+1];o===n?(e.push(`V${c}`),s=c):c===s&&(e.push(`H${o}`),n=o)}e.push("Z")}return e.join(" ")}serialize([e,t,n,s],i){const o=[],c=n-e,u=s-t;for(const h of this.#t){const f=new Array(h.length);for(let m=0;m<h.length;m+=2)f[m]=e+h[m]*c,f[m+1]=s-h[m+1]*u;o.push(f)}return o}get box(){return this.#e}get classNamesForOutlining(){return["highlightOutline"]}}class Zy extends sa{newFreeDrawOutline(e,t,n,s,i,o){return new Qj(e,t,n,s,i,o)}}class Qj extends mk{newOutliner(e,t,n,s,i,o=0){return new Zy(e,t,n,s,i,o)}}class lr{#e=null;#t=null;#n;#r=null;#i=!1;#s=!1;#a=null;#o;#h=null;#l=null;#d;static#u=null;static get _keyboardManager(){return We(this,"_keyboardManager",new vh([[["Escape","mac+Escape"],lr.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],lr.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],lr.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],lr.prototype._moveToPrevious],[["Home","mac+Home"],lr.prototype._moveToBeginning],[["End","mac+End"],lr.prototype._moveToEnd]]))}constructor({editor:e=null,uiManager:t=null}){e?(this.#s=!1,this.#d=qe.HIGHLIGHT_COLOR,this.#a=e):(this.#s=!0,this.#d=qe.HIGHLIGHT_DEFAULT_COLOR),this.#l=e?._uiManager||t,this.#o=this.#l._eventBus,this.#n=e?.color?.toUpperCase()||this.#l?.highlightColors.values().next().value||"#FFFF98",lr.#u||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const e=this.#e=document.createElement("button");e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.ariaHasPopup="true",this.#a&&(e.ariaControls=`${this.#a.id}_colorpicker_dropdown`);const t=this.#l._signal;e.addEventListener("click",this.#c.bind(this),{signal:t}),e.addEventListener("keydown",this.#m.bind(this),{signal:t});const n=this.#t=document.createElement("span");return n.className="swatch",n.ariaHidden="true",n.style.backgroundColor=this.#n,e.append(n),e}renderMainDropdown(){const e=this.#r=this.#f();return e.ariaOrientation="horizontal",e.ariaLabelledBy="highlightColorPickerLabel",e}#f(){const e=document.createElement("div"),t=this.#l._signal;e.addEventListener("contextmenu",Rr,{signal:t}),e.className="dropdown",e.role="listbox",e.ariaMultiSelectable="false",e.ariaOrientation="vertical",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),this.#a&&(e.id=`${this.#a.id}_colorpicker_dropdown`);for(const[n,s]of this.#l.highlightColors){const i=document.createElement("button");i.tabIndex="0",i.role="option",i.setAttribute("data-color",s),i.title=n,i.setAttribute("data-l10n-id",lr.#u[n]);const o=document.createElement("span");i.append(o),o.className="swatch",o.style.backgroundColor=s,i.ariaSelected=s===this.#n,i.addEventListener("click",this.#p.bind(this,s),{signal:t}),e.append(i)}return e.addEventListener("keydown",this.#m.bind(this),{signal:t}),e}#p(e,t){t.stopPropagation(),this.#o.dispatch("switchannotationeditorparams",{source:this,type:this.#d,value:e})}_colorSelectFromKeyboard(e){if(e.target===this.#e){this.#c(e);return}const t=e.target.getAttribute("data-color");t&&this.#p(t,e)}_moveToNext(e){if(!this.#y){this.#c(e);return}if(e.target===this.#e){this.#r.firstChild?.focus();return}e.target.nextSibling?.focus()}_moveToPrevious(e){if(e.target===this.#r?.firstChild||e.target===this.#e){this.#y&&this._hideDropdownFromKeyboard();return}this.#y||this.#c(e),e.target.previousSibling?.focus()}_moveToBeginning(e){if(!this.#y){this.#c(e);return}this.#r.firstChild?.focus()}_moveToEnd(e){if(!this.#y){this.#c(e);return}this.#r.lastChild?.focus()}#m(e){lr._keyboardManager.exec(this,e)}#c(e){if(this.#y){this.hideDropdown();return}if(this.#i=e.detail===0,this.#h||(this.#h=new AbortController,window.addEventListener("pointerdown",this.#g.bind(this),{signal:this.#l.combinedSignal(this.#h)})),this.#e.ariaExpanded="true",this.#r){this.#r.classList.remove("hidden");return}const t=this.#r=this.#f();this.#e.append(t)}#g(e){this.#r?.contains(e.target)||this.hideDropdown()}hideDropdown(){this.#r?.classList.add("hidden"),this.#e.ariaExpanded="false",this.#h?.abort(),this.#h=null}get#y(){return this.#r&&!this.#r.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#s){if(!this.#y){this.#a?.unselect();return}this.hideDropdown(),this.#e.focus({preventScroll:!0,focusVisible:this.#i})}}updateColor(e){if(this.#t&&(this.#t.style.backgroundColor=e),!this.#r)return;const t=this.#l.highlightColors.values();for(const n of this.#r.children)n.ariaSelected=t.next().value===e.toUpperCase()}destroy(){this.#e?.remove(),this.#e=null,this.#t=null,this.#r?.remove(),this.#r=null}}class Nt extends Ie{#e=null;#t=0;#n;#r=null;#i=null;#s=null;#a=null;#o=0;#h=null;#l=null;#d=null;#u=!1;#f=null;#p;#m=null;#c="";#g;#y="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=Oe.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const e=Nt.prototype;return We(this,"_keyboardManager",new vh([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}constructor(e){super({...e,name:"highlightEditor"}),this.color=e.color||Nt._defaultColor,this.#g=e.thickness||Nt._defaultThickness,this.#p=e.opacity||Nt._defaultOpacity,this.#n=e.boxes||null,this.#y=e.methodOfCreation||"",this.#c=e.text||"",this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",e.highlightId>-1?(this.#u=!0,this.#w(e),this.#k()):this.#n&&(this.#e=e.anchorNode,this.#t=e.anchorOffset,this.#a=e.focusNode,this.#o=e.focusOffset,this.#v(),this.#k(),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}get telemetryInitialData(){return{action:"added",type:this.#u?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:this.#g,methodOfCreation:this.#y}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}#v(){const e=new Jy(this.#n,.001);this.#l=e.getOutlines(),[this.x,this.y,this.width,this.height]=this.#l.box;const t=new Jy(this.#n,.0025,.001,this._uiManager.direction==="ltr");this.#s=t.getOutlines();const{lastPoint:n}=this.#s;this.#f=[(n[0]-this.x)/this.width,(n[1]-this.y)/this.height]}#w({highlightOutlines:e,highlightId:t,clipPathId:n}){this.#l=e;const s=1.5;if(this.#s=e.getNewOutline(this.#g/2+s,.0025),t>=0)this.#d=t,this.#r=n,this.parent.drawLayer.finalizeDraw(t,{bbox:e.box,path:{d:e.toSVGPath()}}),this.#m=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#s.box,path:{d:this.#s.toSVGPath()}},!0);else if(this.parent){const f=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#d,{bbox:Nt.#b(this.#l.box,(f-this.rotation+360)%360),path:{d:e.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#m,{bbox:Nt.#b(this.#s.box,f),path:{d:this.#s.toSVGPath()}})}const[i,o,c,u]=e.box;switch(this.rotation){case 0:this.x=i,this.y=o,this.width=c,this.height=u;break;case 90:{const[f,m]=this.parentDimensions;this.x=o,this.y=1-i,this.width=c*m/f,this.height=u*f/m;break}case 180:this.x=1-i,this.y=1-o,this.width=c,this.height=u;break;case 270:{const[f,m]=this.parentDimensions;this.x=1-o,this.y=i,this.width=c*m/f,this.height=u*f/m;break}}const{lastPoint:h}=this.#s;this.#f=[(h[0]-i)/c,(h[1]-o)/u]}static initialize(e,t){Ie.initialize(e,t),Nt._defaultColor||=t.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(e,t){switch(e){case qe.HIGHLIGHT_DEFAULT_COLOR:Nt._defaultColor=t;break;case qe.HIGHLIGHT_THICKNESS:Nt._defaultThickness=t;break}}translateInPage(e,t){}get toolbarPosition(){return this.#f}updateParams(e,t){switch(e){case qe.HIGHLIGHT_COLOR:this.#E(t);break;case qe.HIGHLIGHT_THICKNESS:this.#A(t);break}}static get defaultPropertiesToUpdate(){return[[qe.HIGHLIGHT_DEFAULT_COLOR,Nt._defaultColor],[qe.HIGHLIGHT_THICKNESS,Nt._defaultThickness]]}get propertiesToUpdate(){return[[qe.HIGHLIGHT_COLOR,this.color||Nt._defaultColor],[qe.HIGHLIGHT_THICKNESS,this.#g||Nt._defaultThickness],[qe.HIGHLIGHT_FREE,this.#u]]}#E(e){const t=(i,o)=>{this.color=i,this.#p=o,this.parent?.drawLayer.updateProperties(this.#d,{root:{fill:i,"fill-opacity":o}}),this.#i?.updateColor(i)},n=this.color,s=this.#p;this.addCommands({cmd:t.bind(this,e,Nt._defaultOpacity),undo:t.bind(this,n,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:qe.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(e)},!0)}#A(e){const t=this.#g,n=s=>{this.#g=s,this.#S(s)};this.addCommands({cmd:n.bind(this,e),undo:n.bind(this,t),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:qe.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",this.#i=new lr({editor:this})]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#R())}getBaseTranslation(){return[0,0]}getRect(e,t){return super.getRect(e,t,this.#R())}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),e&&this.div.focus()}remove(){this.#C(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#k(),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?this.#C():e&&(this.#k(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),this.show(this._isVisible),t&&this.select()}#S(e){if(!this.#u)return;this.#w({highlightOutlines:this.#l.getNewOutline(e/2)}),this.fixAndSetPosition();const[t,n]=this.parentDimensions;this.setDims(this.width*t,this.height*n)}#C(){this.#d===null||!this.parent||(this.parent.drawLayer.remove(this.#d),this.#d=null,this.parent.drawLayer.remove(this.#m),this.#m=null)}#k(e=this.parent){this.#d===null&&({id:this.#d,clipPathId:this.#r}=e.drawLayer.draw({bbox:this.#l.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.#p},rootClass:{highlight:!0,free:this.#u},path:{d:this.#l.toSVGPath()}},!1,!0),this.#m=e.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#u},bbox:this.#s.box,path:{d:this.#s.toSVGPath()}},this.#u),this.#h&&(this.#h.style.clipPath=this.#r))}static#b([e,t,n,s],i){switch(i){case 90:return[1-t-s,e,s,n];case 180:return[1-e-n,1-t-s,n,s];case 270:return[t,1-e-n,s,n]}return[e,t,n,s]}rotate(e){const{drawLayer:t}=this.parent;let n;this.#u?(e=(e-this.rotation+360)%360,n=Nt.#b(this.#l.box,e)):n=Nt.#b([this.x,this.y,this.width,this.height],e),t.updateProperties(this.#d,{bbox:n,root:{"data-main-rotation":e}}),t.updateProperties(this.#m,{bbox:Nt.#b(this.#s.box,e),root:{"data-main-rotation":e}})}render(){if(this.div)return this.div;const e=super.render();this.#c&&(e.setAttribute("aria-label",this.#c),e.setAttribute("role","mark")),this.#u?e.classList.add("free"):this.div.addEventListener("keydown",this.#I.bind(this),{signal:this._uiManager._signal});const t=this.#h=document.createElement("div");e.append(t),t.setAttribute("aria-hidden","true"),t.className="internal",t.style.clipPath=this.#r;const[n,s]=this.parentDimensions;return this.setDims(this.width*n,this.height*s),$I(this,this.#h,["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#m,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#m,{rootClass:{hovered:!1}})}#I(e){Nt._keyboardManager.exec(this,e)}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:this.#x(!0);break;case 1:case 3:this.#x(!1);break}}#x(e){if(!this.#e)return;const t=window.getSelection();e?t.setPosition(this.#e,this.#t):t.setPosition(this.#a,this.#o)}select(){super.select(),this.#m&&this.parent?.drawLayer.updateProperties(this.#m,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#m&&(this.parent?.drawLayer.updateProperties(this.#m,{rootClass:{selected:!1}}),this.#u||this.#x(!1))}get _mustFixPosition(){return!this.#u}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.updateProperties(this.#d,{rootClass:{hidden:!e}}),this.parent.drawLayer.updateProperties(this.#m,{rootClass:{hidden:!e}}))}#R(){return this.#u?this.rotation:0}#D(){if(this.#u)return null;const[e,t]=this.pageDimensions,[n,s]=this.pageTranslation,i=this.#n,o=new Float32Array(i.length*8);let c=0;for(const{x:u,y:h,width:f,height:m}of i){const y=u*e+n,_=(1-h)*t+s;o[c]=o[c+4]=y,o[c+1]=o[c+3]=_,o[c+2]=o[c+6]=y+f*e,o[c+5]=o[c+7]=_-m*t,c+=8}return o}#L(e){return this.#l.serialize(e,this.#R())}static startHighlighting(e,t,{target:n,x:s,y:i}){const{x:o,y:c,width:u,height:h}=n.getBoundingClientRect(),f=new AbortController,m=e.combinedSignal(f),y=_=>{f.abort(),this.#T(e,_)};window.addEventListener("blur",y,{signal:m}),window.addEventListener("pointerup",y,{signal:m}),window.addEventListener("pointerdown",Vt,{capture:!0,passive:!1,signal:m}),window.addEventListener("contextmenu",Rr,{signal:m}),n.addEventListener("pointermove",this.#B.bind(this,e),{signal:m}),this._freeHighlight=new Zy({x:s,y:i},[o,c,u,h],e.scale,this._defaultThickness/2,t,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#B(e,t){this._freeHighlight.add(t)&&e.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#T(e,t){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(t,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(e,t,n){let s=null;if(e instanceof dk){const{data:{quadPoints:A,rect:b,rotation:T,id:x,color:M,opacity:R,popupRef:B},parent:{page:{pageNumber:O}}}=e;s=e={annotationType:Oe.HIGHLIGHT,color:Array.from(M),opacity:R,quadPoints:A,boxes:null,pageIndex:O-1,rect:b.slice(0),rotation:T,annotationElementId:x,id:x,deleted:!1,popupRef:B}}else if(e instanceof e_){const{data:{inkLists:A,rect:b,rotation:T,id:x,color:M,borderStyle:{rawWidth:R},popupRef:B},parent:{page:{pageNumber:O}}}=e;s=e={annotationType:Oe.HIGHLIGHT,color:Array.from(M),thickness:R,inkLists:A,boxes:null,pageIndex:O-1,rect:b.slice(0),rotation:T,annotationElementId:x,id:x,deleted:!1,popupRef:B}}const{color:i,quadPoints:o,inkLists:c,opacity:u}=e,h=await super.deserialize(e,t,n);h.color=be.makeHexColor(...i),h.#p=u||1,c&&(h.#g=e.thickness),h._initialData=s;const[f,m]=h.pageDimensions,[y,_]=h.pageTranslation;if(o){const A=h.#n=[];for(let b=0;b<o.length;b+=8)A.push({x:(o[b]-y)/f,y:1-(o[b+1]-_)/m,width:(o[b+2]-o[b])/f,height:(o[b+1]-o[b+5])/m});h.#v(),h.#k(),h.rotate(h.rotation)}else if(c){h.#u=!0;const A=c[0],b={x:A[0]-y,y:m-(A[1]-_)},T=new Zy(b,[0,0,f,m],1,h.#g/2,!0,.001);for(let R=0,B=A.length;R<B;R+=2)b.x=A[R]-y,b.y=m-(A[R+1]-_),T.add(b);const{id:x,clipPathId:M}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:h.color,"fill-opacity":h._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:T.toSVGPath()}},!0,!0);h.#w({highlightOutlines:T.getOutlines(),highlightId:x,clipPathId:M}),h.#k(),h.rotate(h.parentRotation)}return h}serialize(e=!1){if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();const t=this.getRect(0,0),n=Ie._colorManager.convert(this.color),s={annotationType:Oe.HIGHLIGHT,color:n,opacity:this.#p,thickness:this.#g,quadPoints:this.#D(),outlines:this.#L(t),pageIndex:this.pageIndex,rect:t,rotation:this.#R(),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!this.#_(s)?null:(s.id=this.annotationElementId,s)}#_(e){const{color:t}=this._initialData;return e.color.some((n,s)=>n!==t[s])}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}}class gk{#e=Object.create(null);updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,n]of Object.entries(e))t.startsWith("_")||this.updateProperty(t,n)}updateSVGProperty(e,t){this.#e[e]=t}toSVGProperties(){const e=this.#e;return this.#e=Object.create(null),{root:e}}reset(){this.#e=Object.create(null)}updateAll(e=this){this.updateProperties(e)}clone(){it("Not implemented")}}class Re extends Ie{#e=null;#t;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#n=null;static#r=null;static#i=null;static#s=NaN;static#a=null;static#o=null;static#h=NaN;static _INNER_MARGIN=3;constructor(e){super(e),this.#t=e.mustBeCommitted||!1,this._addOutlines(e)}_addOutlines(e){e.drawOutlines&&(this.#l(e),this.#f())}#l({drawOutlines:e,drawId:t,drawingOptions:n}){this.#e=e,this._drawingOptions||=n,this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),t>=0?(this._drawId=t,this.parent.drawLayer.finalizeDraw(t,e.defaultProperties)):this._drawId=this.#d(e,this.parent),this.#c(e.box)}#d(e,t){const{id:n}=t.drawLayer.draw(Re._mergeSVGProperties(this._drawingOptions.toSVGProperties(),e.defaultSVGProperties),!1,!1);return n}static _mergeSVGProperties(e,t){const n=new Set(Object.keys(e));for(const[s,i]of Object.entries(t))n.has(s)?Object.assign(e[s],i):e[s]=i;return e}static getDefaultDrawingOptions(e){it("Not implemented")}static get typesMap(){it("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(e,t){const n=this.typesMap.get(e);n&&this._defaultDrawingOptions.updateProperty(n,t),this._currentParent&&(Re.#n.updateProperty(n,t),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(e,t){const n=this.constructor.typesMap.get(e);n&&this._updateProperty(e,n,t)}static get defaultPropertiesToUpdate(){const e=[],t=this._defaultDrawingOptions;for(const[n,s]of this.typesMap)e.push([n,t[s]]);return e}get propertiesToUpdate(){const e=[],{_drawingOptions:t}=this;for(const[n,s]of this.constructor.typesMap)e.push([n,t[s]]);return e}_updateProperty(e,t,n){const s=this._drawingOptions,i=s[t],o=c=>{s.updateProperty(t,c);const u=this.#e.updateProperty(t,c);u&&this.#c(u),this.parent?.drawLayer.updateProperties(this._drawId,s.toSVGProperties())};this.addCommands({cmd:o.bind(this,n),undo:o.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,Re._mergeSVGProperties(this.#e.getPathResizingSVGProperties(this.#m()),{bbox:this.#g()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,Re._mergeSVGProperties(this.#e.getPathResizedSVGProperties(this.#m()),{bbox:this.#g()}))}_onTranslating(e,t){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#g()})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,Re._mergeSVGProperties(this.#e.getPathTranslatedSVGProperties(this.#m(),this.parentDimensions),{bbox:this.#g()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#t&&(this.#t=!1,this.commit(),this.parent.setSelected(this),e&&this.isOnScreen&&this.div.focus())}remove(){this.#u(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#f(),this.#c(this.#e.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?(this._uiManager.removeShouldRescale(this),this.#u()):e&&(this._uiManager.addShouldRescale(this),this.#f(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),t&&this.select()}#u(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#f(e=this.parent){if(!(this._drawId!==null&&this.parent===e)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,e.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#d(this.#e,e)}}#p([e,t,n,s]){const{parentDimensions:[i,o],rotation:c}=this;switch(c){case 90:return[t,1-e,n*(o/i),s*(i/o)];case 180:return[1-e,1-t,n,s];case 270:return[1-t,e,n*(o/i),s*(i/o)];default:return[e,t,n,s]}}#m(){const{x:e,y:t,width:n,height:s,parentDimensions:[i,o],rotation:c}=this;switch(c){case 90:return[1-t,e,n*(i/o),s*(o/i)];case 180:return[1-e,1-t,n,s];case 270:return[t,1-e,n*(i/o),s*(o/i)];default:return[e,t,n,s]}}#c(e){if([this.x,this.y,this.width,this.height]=this.#p(e),this.div){this.fixAndSetPosition();const[t,n]=this.parentDimensions;this.setDims(this.width*t,this.height*n)}this._onResized()}#g(){const{x:e,y:t,width:n,height:s,rotation:i,parentRotation:o,parentDimensions:[c,u]}=this;switch((i*4+o)/90){case 1:return[1-t-s,e,s,n];case 2:return[1-e-n,1-t-s,n,s];case 3:return[t,1-e-n,s,n];case 4:return[e,t-n*(c/u),s*(u/c),n*(c/u)];case 5:return[1-t,e,n*(c/u),s*(u/c)];case 6:return[1-e-s*(u/c),1-t,s*(u/c),n*(c/u)];case 7:return[t-n*(c/u),1-e-s*(u/c),n*(c/u),s*(u/c)];case 8:return[e-n,t-s,n,s];case 9:return[1-t,e-n,s,n];case 10:return[1-e,1-t,n,s];case 11:return[t-s,1-e,s,n];case 12:return[e-s*(u/c),t,s*(u/c),n*(c/u)];case 13:return[1-t-n*(c/u),e-s*(u/c),n*(c/u),s*(u/c)];case 14:return[1-e,1-t-n*(c/u),s*(u/c),n*(c/u)];case 15:return[t,1-e,n*(c/u),s*(u/c)];default:return[e,t,n,s]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,Re._mergeSVGProperties({bbox:this.#g()},this.#e.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#c(this.#e.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let e,t;this._isCopy&&(e=this.x,t=this.y);const n=super.render();n.classList.add("draw");const s=document.createElement("div");n.append(s),s.setAttribute("aria-hidden","true"),s.className="internal";const[i,o]=this.parentDimensions;return this.setDims(this.width*i,this.height*o),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(e,t),n}static createDrawerInstance(e,t,n,s,i){it("Not implemented")}static startDrawing(e,t,n,s){const{target:i,offsetX:o,offsetY:c,pointerId:u,pointerType:h}=s;if(Re.#a&&Re.#a!==h)return;const{viewport:{rotation:f}}=e,{width:m,height:y}=i.getBoundingClientRect(),_=Re.#r=new AbortController,A=e.combinedSignal(_);if(Re.#s||=u,Re.#a??=h,window.addEventListener("pointerup",b=>{Re.#s===b.pointerId?this._endDraw(b):Re.#o?.delete(b.pointerId)},{signal:A}),window.addEventListener("pointercancel",b=>{Re.#s===b.pointerId?this._currentParent.endDrawingSession():Re.#o?.delete(b.pointerId)},{signal:A}),window.addEventListener("pointerdown",b=>{Re.#a===b.pointerType&&((Re.#o||=new Set).add(b.pointerId),Re.#n.isCancellable()&&(Re.#n.removeLastElement(),Re.#n.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:A}),window.addEventListener("contextmenu",Rr,{signal:A}),i.addEventListener("pointermove",this._drawMove.bind(this),{signal:A}),i.addEventListener("touchmove",b=>{b.timeStamp===Re.#h&&Vt(b)},{signal:A}),e.toggleDrawing(),t._editorUndoBar?.hide(),Re.#n){e.drawLayer.updateProperties(this._currentDrawId,Re.#n.startNew(o,c,m,y,f));return}t.updateUIForDefaultProperties(this),Re.#n=this.createDrawerInstance(o,c,m,y,f),Re.#i=this.getDefaultDrawingOptions(),this._currentParent=e,{id:this._currentDrawId}=e.drawLayer.draw(this._mergeSVGProperties(Re.#i.toSVGProperties(),Re.#n.defaultSVGProperties),!0,!1)}static _drawMove(e){if(Re.#h=-1,!Re.#n)return;const{offsetX:t,offsetY:n,pointerId:s}=e;if(Re.#s===s){if(Re.#o?.size>=1){this._endDraw(e);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,Re.#n.add(t,n)),Re.#h=e.timeStamp,Vt(e)}}static _cleanup(e){e&&(this._currentDrawId=-1,this._currentParent=null,Re.#n=null,Re.#i=null,Re.#a=null,Re.#h=NaN),Re.#r&&(Re.#r.abort(),Re.#r=null,Re.#s=NaN,Re.#o=null)}static _endDraw(e){const t=this._currentParent;if(t){if(t.toggleDrawing(!0),this._cleanup(!1),e?.target===t.div&&t.drawLayer.updateProperties(this._currentDrawId,Re.#n.end(e.offsetX,e.offsetY)),this.supportMultipleDrawings){const n=Re.#n,s=this._currentDrawId,i=n.getLastElement();t.addCommands({cmd:()=>{t.drawLayer.updateProperties(s,n.setLastElement(i))},undo:()=>{t.drawLayer.updateProperties(s,n.removeLastElement())},mustExec:!1,type:qe.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(e){const t=this._currentParent;if(!t)return null;if(t.toggleDrawing(!0),t.cleanUndoStack(qe.DRAW_STEP),!Re.#n.isEmpty()){const{pageDimensions:[n,s],scale:i}=t,o=t.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:Re.#n.getOutlines(n*i,s*i,i,this._INNER_MARGIN),drawingOptions:Re.#i,mustBeCommitted:!e});return this._cleanup(!0),o}return t.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(e){}static deserializeDraw(e,t,n,s,i,o){it("Not implemented")}static async deserialize(e,t,n){const{rawDims:{pageWidth:s,pageHeight:i,pageX:o,pageY:c}}=t.viewport,u=this.deserializeDraw(o,c,s,i,this._INNER_MARGIN,e),h=await super.deserialize(e,t,n);return h.createDrawingOptions(e),h.#l({drawOutlines:u}),h.#f(),h.onScaleChanging(),h.rotate(),h}serializeDraw(e){const[t,n]=this.pageTranslation,[s,i]=this.pageDimensions;return this.#e.serialize([t,n,s,i],e)}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}}class Jj{#e=new Float64Array(6);#t;#n;#r;#i;#s;#a="";#o=0;#h=new Eh;#l;#d;constructor(e,t,n,s,i,o){this.#l=n,this.#d=s,this.#r=i,this.#i=o,[e,t]=this.#u(e,t);const c=this.#t=[NaN,NaN,NaN,NaN,e,t];this.#s=[e,t],this.#n=[{line:c,points:this.#s}],this.#e.set(c,0)}updateProperty(e,t){e==="stroke-width"&&(this.#i=t)}#u(e,t){return ge._normalizePoint(e,t,this.#l,this.#d,this.#r)}isEmpty(){return!this.#n||this.#n.length===0}isCancellable(){return this.#s.length<=10}add(e,t){[e,t]=this.#u(e,t);const[n,s,i,o]=this.#e.subarray(2,6),c=e-i,u=t-o;return Math.hypot(this.#l*c,this.#d*u)<=2?null:(this.#s.push(e,t),isNaN(n)?(this.#e.set([i,o,e,t],2),this.#t.push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(this.#e[0])&&this.#t.splice(6,6),this.#e.set([n,s,i,o,e,t],0),this.#t.push(...ge.createBezierPoints(n,s,i,o,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const n=this.add(e,t);return n||(this.#s.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,n,s,i){this.#l=n,this.#d=s,this.#r=i,[e,t]=this.#u(e,t);const o=this.#t=[NaN,NaN,NaN,NaN,e,t];this.#s=[e,t];const c=this.#n.at(-1);return c&&(c.line=new Float32Array(c.line),c.points=new Float32Array(c.points)),this.#n.push({line:o,points:this.#s}),this.#e.set(o,0),this.#o=0,this.toSVGPath(),null}getLastElement(){return this.#n.at(-1)}setLastElement(e){return this.#n?(this.#n.push(e),this.#t=e.line,this.#s=e.points,this.#o=0,{path:{d:this.toSVGPath()}}):this.#h.setLastElement(e)}removeLastElement(){if(!this.#n)return this.#h.removeLastElement();this.#n.pop(),this.#a="";for(let e=0,t=this.#n.length;e<t;e++){const{line:n,points:s}=this.#n[e];this.#t=n,this.#s=s,this.#o=0,this.toSVGPath()}return{path:{d:this.#a}}}toSVGPath(){const e=ge.svgRound(this.#t[4]),t=ge.svgRound(this.#t[5]);if(this.#s.length===2)return this.#a=`${this.#a} M ${e} ${t} Z`,this.#a;if(this.#s.length<=6){const s=this.#a.lastIndexOf("M");this.#a=`${this.#a.slice(0,s)} M ${e} ${t}`,this.#o=6}if(this.#s.length===4){const s=ge.svgRound(this.#t[10]),i=ge.svgRound(this.#t[11]);return this.#a=`${this.#a} L ${s} ${i}`,this.#o=12,this.#a}const n=[];this.#o===0&&(n.push(`M ${e} ${t}`),this.#o=6);for(let s=this.#o,i=this.#t.length;s<i;s+=6){const[o,c,u,h,f,m]=this.#t.slice(s,s+6).map(ge.svgRound);n.push(`C${o} ${c} ${u} ${h} ${f} ${m}`)}return this.#a+=n.join(" "),this.#o=this.#t.length,this.#a}getOutlines(e,t,n,s){const i=this.#n.at(-1);return i.line=new Float32Array(i.line),i.points=new Float32Array(i.points),this.#h.build(this.#n,e,t,n,this.#r,this.#i,s),this.#e=null,this.#t=null,this.#n=null,this.#a=null,this.#h}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class Eh extends ge{#e;#t=0;#n;#r;#i;#s;#a;#o;#h;build(e,t,n,s,i,o,c){this.#i=t,this.#s=n,this.#a=s,this.#o=i,this.#h=o,this.#n=c??0,this.#r=e,this.#u()}get thickness(){return this.#h}setLastElement(e){return this.#r.push(e),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#r.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const e=[];for(const{line:t}of this.#r){if(e.push(`M${ge.svgRound(t[4])} ${ge.svgRound(t[5])}`),t.length===6){e.push("Z");continue}if(t.length===12&&isNaN(t[6])){e.push(`L${ge.svgRound(t[10])} ${ge.svgRound(t[11])}`);continue}for(let n=6,s=t.length;n<s;n+=6){const[i,o,c,u,h,f]=t.subarray(n,n+6).map(ge.svgRound);e.push(`C${i} ${o} ${c} ${u} ${h} ${f}`)}}return e.join("")}serialize([e,t,n,s],i){const o=[],c=[],[u,h,f,m]=this.#d();let y,_,A,b,T,x,M,R,B;switch(this.#o){case 0:B=ge._rescale,y=e,_=t+s,A=n,b=-s,T=e+u*n,x=t+(1-h-m)*s,M=e+(u+f)*n,R=t+(1-h)*s;break;case 90:B=ge._rescaleAndSwap,y=e,_=t,A=n,b=s,T=e+h*n,x=t+u*s,M=e+(h+m)*n,R=t+(u+f)*s;break;case 180:B=ge._rescale,y=e+n,_=t,A=-n,b=s,T=e+(1-u-f)*n,x=t+h*s,M=e+(1-u)*n,R=t+(h+m)*s;break;case 270:B=ge._rescaleAndSwap,y=e+n,_=t+s,A=-n,b=-s,T=e+(1-h-m)*n,x=t+(1-u-f)*s,M=e+(1-h)*n,R=t+(1-u)*s;break}for(const{line:O,points:$}of this.#r)o.push(B(O,y,_,A,b,i?new Array(O.length):null)),c.push(B($,y,_,A,b,i?new Array($.length):null));return{lines:o,points:c,rect:[T,x,M,R]}}static deserialize(e,t,n,s,i,{paths:{lines:o,points:c},rotation:u,thickness:h}){const f=[];let m,y,_,A,b;switch(u){case 0:b=ge._rescale,m=-e/n,y=t/s+1,_=1/n,A=-1/s;break;case 90:b=ge._rescaleAndSwap,m=-t/s,y=-e/n,_=1/s,A=1/n;break;case 180:b=ge._rescale,m=e/n+1,y=-t/s,_=-1/n,A=1/s;break;case 270:b=ge._rescaleAndSwap,m=t/s+1,y=e/n+1,_=-1/s,A=-1/n;break}if(!o){o=[];for(const x of c){const M=x.length;if(M===2){o.push(new Float32Array([NaN,NaN,NaN,NaN,x[0],x[1]]));continue}if(M===4){o.push(new Float32Array([NaN,NaN,NaN,NaN,x[0],x[1],NaN,NaN,NaN,NaN,x[2],x[3]]));continue}const R=new Float32Array(3*(M-2));o.push(R);let[B,O,$,k]=x.subarray(0,4);R.set([NaN,NaN,NaN,NaN,B,O],0);for(let C=4;C<M;C+=2){const P=x[C],N=x[C+1];R.set(ge.createBezierPoints(B,O,$,k,P,N),(C-2)*3),[B,O,$,k]=[$,k,P,N]}}}for(let x=0,M=o.length;x<M;x++)f.push({line:b(o[x].map(R=>R??NaN),m,y,_,A),points:b(c[x].map(R=>R??NaN),m,y,_,A)});const T=new this.prototype.constructor;return T.build(f,n,s,1,u,h,i),T}#l(e=this.#h){const t=this.#n+e/2*this.#a;return this.#o%180===0?[t/this.#i,t/this.#s]:[t/this.#s,t/this.#i]}#d(){const[e,t,n,s]=this.#e,[i,o]=this.#l(0);return[e+i,t+o,n-2*i,s-2*o]}#u(){const e=this.#e=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:s}of this.#r){if(s.length<=12){for(let c=4,u=s.length;c<u;c+=6)be.pointBoundingBox(s[c],s[c+1],e);continue}let i=s[4],o=s[5];for(let c=6,u=s.length;c<u;c+=6){const[h,f,m,y,_,A]=s.subarray(c,c+6);be.bezierBoundingBox(i,o,h,f,m,y,_,A,e),i=_,o=A}}const[t,n]=this.#l();e[0]=Cn(e[0]-t,0,1),e[1]=Cn(e[1]-n,0,1),e[2]=Cn(e[2]+t,0,1),e[3]=Cn(e[3]+n,0,1),e[2]-=e[0],e[3]-=e[1]}get box(){return this.#e}updateProperty(e,t){return e==="stroke-width"?this.#f(t):null}#f(e){const[t,n]=this.#l();this.#h=e;const[s,i]=this.#l(),[o,c]=[s-t,i-n],u=this.#e;return u[0]-=o,u[1]-=c,u[2]+=2*o,u[3]+=2*c,u}updateParentDimensions([e,t],n){const[s,i]=this.#l();this.#i=e,this.#s=t,this.#a=n;const[o,c]=this.#l(),u=o-s,h=c-i,f=this.#e;return f[0]-=u,f[1]-=h,f[2]+=2*u,f[3]+=2*h,f}updateRotation(e){return this.#t=e,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#e.map(ge.svgRound).join(" ")}get defaultProperties(){const[e,t]=this.#e;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ge.svgRound(e)} ${ge.svgRound(t)}`}}}get rotationTransform(){const[,,e,t]=this.#e;let n=0,s=0,i=0,o=0,c=0,u=0;switch(this.#t){case 90:s=t/e,i=-e/t,c=e;break;case 180:n=-1,o=-1,c=e,u=t;break;case 270:s=-t/e,i=e/t,u=t;break;default:return""}return`matrix(${n} ${s} ${i} ${o} ${ge.svgRound(c)} ${ge.svgRound(u)})`}getPathResizingSVGProperties([e,t,n,s]){const[i,o]=this.#l(),[c,u,h,f]=this.#e;if(Math.abs(h-i)<=ge.PRECISION||Math.abs(f-o)<=ge.PRECISION){const b=e+n/2-(c+h/2),T=t+s/2-(u+f/2);return{path:{"transform-origin":`${ge.svgRound(e)} ${ge.svgRound(t)}`,transform:`${this.rotationTransform} translate(${b} ${T})`}}}const m=(n-2*i)/(h-2*i),y=(s-2*o)/(f-2*o),_=h/n,A=f/s;return{path:{"transform-origin":`${ge.svgRound(c)} ${ge.svgRound(u)}`,transform:`${this.rotationTransform} scale(${_} ${A}) translate(${ge.svgRound(i)} ${ge.svgRound(o)}) scale(${m} ${y}) translate(${ge.svgRound(-i)} ${ge.svgRound(-o)})`}}}getPathResizedSVGProperties([e,t,n,s]){const[i,o]=this.#l(),c=this.#e,[u,h,f,m]=c;if(c[0]=e,c[1]=t,c[2]=n,c[3]=s,Math.abs(f-i)<=ge.PRECISION||Math.abs(m-o)<=ge.PRECISION){const T=e+n/2-(u+f/2),x=t+s/2-(h+m/2);for(const{line:M,points:R}of this.#r)ge._translate(M,T,x,M),ge._translate(R,T,x,R);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ge.svgRound(e)} ${ge.svgRound(t)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const y=(n-2*i)/(f-2*i),_=(s-2*o)/(m-2*o),A=-y*(u+i)+e+i,b=-_*(h+o)+t+o;if(y!==1||_!==1||A!==0||b!==0)for(const{line:T,points:x}of this.#r)ge._rescale(T,A,b,y,_,T),ge._rescale(x,A,b,y,_,x);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ge.svgRound(e)} ${ge.svgRound(t)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([e,t],n){const[s,i]=n,o=this.#e,c=e-o[0],u=t-o[1];if(this.#i===s&&this.#s===i)for(const{line:h,points:f}of this.#r)ge._translate(h,c,u,h),ge._translate(f,c,u,f);else{const h=this.#i/s,f=this.#s/i;this.#i=s,this.#s=i;for(const{line:m,points:y}of this.#r)ge._rescale(m,c,u,h,f,m),ge._rescale(y,c,u,h,f,y);o[2]*=h,o[3]*=f}return o[0]=e,o[1]=t,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${ge.svgRound(e)} ${ge.svgRound(t)}`}}}get defaultSVGProperties(){const e=this.#e;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${ge.svgRound(e[0])} ${ge.svgRound(e[1])}`,transform:this.rotationTransform||null},bbox:e}}}class Np extends gk{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:Ie._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??=this["stroke-width"],t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){const e=new Np(this._viewParameters);return e.updateAll(this),e}}class n_ extends Re{static _type="ink";static _editorType=Oe.INK;static _defaultDrawingOptions=null;constructor(e){super({...e,name:"inkEditor"}),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(e,t){Ie.initialize(e,t),this._defaultDrawingOptions=new Np(t.viewParameters)}static getDefaultDrawingOptions(e){const t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!0}static get typesMap(){return We(this,"typesMap",new Map([[qe.INK_THICKNESS,"stroke-width"],[qe.INK_COLOR,"stroke"],[qe.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(e,t,n,s,i){return new Jj(e,t,n,s,i,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(e,t,n,s,i,o){return Eh.deserialize(e,t,n,s,i,o)}static async deserialize(e,t,n){let s=null;if(e instanceof e_){const{data:{inkLists:o,rect:c,rotation:u,id:h,color:f,opacity:m,borderStyle:{rawWidth:y},popupRef:_},parent:{page:{pageNumber:A}}}=e;s=e={annotationType:Oe.INK,color:Array.from(f),thickness:y,opacity:m,paths:{points:o},boxes:null,pageIndex:A-1,rect:c.slice(0),rotation:u,annotationElementId:h,id:h,deleted:!1,popupRef:_}}const i=await super.deserialize(e,t,n);return i._initialData=s,i}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:e,_drawingOptions:t,parent:n}=this;t.updateSVGProperty("stroke-width"),n.drawLayer.updateProperties(e,t.toSVGProperties())}static onScaleChangingWhenDrawing(){const e=this._currentParent;e&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),e.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:e,thickness:t,opacity:n}){this._drawingOptions=n_.getDefaultDrawingOptions({stroke:be.makeHexColor(...e),"stroke-width":t,"stroke-opacity":n})}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:t,points:n,rect:s}=this.serializeDraw(e),{_drawingOptions:{stroke:i,"stroke-opacity":o,"stroke-width":c}}=this,u={annotationType:Oe.INK,color:Ie._colorManager.convert(i),opacity:o,thickness:c,paths:{lines:t,points:n},pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?(u.isCopy=!0,u):this.annotationElementId&&!this.#e(u)?null:(u.id=this.annotationElementId,u)}#e(e){const{color:t,thickness:n,opacity:s,pageIndex:i}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||e.color.some((o,c)=>o!==t[c])||e.thickness!==n||e.opacity!==s||e.pageIndex!==i}renderAnnotationElement(e){const{points:t,rect:n}=this.serializeDraw(!1);return e.updateEdited({rect:n,thickness:this._drawingOptions["stroke-width"],points:t}),null}}class ev extends Eh{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}const nf=8,su=3;class ta{static#e={maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16};static#t(e,t,n,s){return n-=e,s-=t,n===0?s>0?0:4:n===1?s+6:2-s}static#n=new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]);static#r(e,t,n,s,i,o,c){const u=this.#t(n,s,i,o);for(let h=0;h<8;h++){const f=(-h+u-c+16)%8,m=this.#n[2*f],y=this.#n[2*f+1];if(e[(n+m)*t+(s+y)]!==0)return f}return-1}static#i(e,t,n,s,i,o,c){const u=this.#t(n,s,i,o);for(let h=0;h<8;h++){const f=(h+u+c+16)%8,m=this.#n[2*f],y=this.#n[2*f+1];if(e[(n+m)*t+(s+y)]!==0)return f}return-1}static#s(e,t,n,s){const i=e.length,o=new Int32Array(i);for(let f=0;f<i;f++)o[f]=e[f]<=s?1:0;for(let f=1;f<n-1;f++)o[f*t]=o[f*t+t-1]=0;for(let f=0;f<t;f++)o[f]=o[t*n-1-f]=0;let c=1,u;const h=[];for(let f=1;f<n-1;f++){u=1;for(let m=1;m<t-1;m++){const y=f*t+m,_=o[y];if(_===0)continue;let A=f,b=m;if(_===1&&o[y-1]===0)c+=1,b-=1;else if(_>=1&&o[y+1]===0)c+=1,b+=1,_>1&&(u=_);else{_!==1&&(u=Math.abs(_));continue}const T=[m,f],x=b===m+1,M={isHole:x,points:T,id:c,parent:0};h.push(M);let R;for(const j of h)if(j.id===u){R=j;break}R?R.isHole?M.parent=x?R.parent:u:M.parent=x?u:R.parent:M.parent=x?u:0;const B=this.#r(o,t,f,m,A,b,0);if(B===-1){o[y]=-c,o[y]!==1&&(u=Math.abs(o[y]));continue}let O=this.#n[2*B],$=this.#n[2*B+1];const k=f+O,C=m+$;A=k,b=C;let P=f,N=m;for(;;){const j=this.#i(o,t,P,N,A,b,1);O=this.#n[2*j],$=this.#n[2*j+1];const z=P+O,F=N+$;T.push(F,z);const ue=P*t+N;if(o[ue+1]===0?o[ue]=-c:o[ue]===1&&(o[ue]=c),z===f&&F===m&&P===k&&N===C){o[y]!==1&&(u=Math.abs(o[y]));break}else A=P,b=N,P=z,N=F}}}return h}static#a(e,t,n,s){if(n-t<=4){for(let k=t;k<n-2;k+=2)s.push(e[k],e[k+1]);return}const i=e[t],o=e[t+1],c=e[n-4]-i,u=e[n-3]-o,h=Math.hypot(c,u),f=c/h,m=u/h,y=f*o-m*i,_=u/c,A=1/h,b=Math.atan(_),T=Math.cos(b),x=Math.sin(b),M=A*(Math.abs(T)+Math.abs(x)),R=A*(1-M+M**2),B=Math.max(Math.atan(Math.abs(x+T)*R),Math.atan(Math.abs(x-T)*R));let O=0,$=t;for(let k=t+2;k<n-2;k+=2){const C=Math.abs(y-f*e[k+1]+m*e[k]);C>O&&($=k,O=C)}O>(h*B)**2?(this.#a(e,t,$+2,s),this.#a(e,$,n,s)):s.push(i,o)}static#o(e){const t=[],n=e.length;return this.#a(e,0,n,t),t.push(e[n-2],e[n-1]),t.length<=4?null:t}static#h(e,t,n,s,i,o){const c=new Float32Array(o**2),u=-2*s**2,h=o>>1;for(let b=0;b<o;b++){const T=(b-h)**2;for(let x=0;x<o;x++)c[b*o+x]=Math.exp((T+(x-h)**2)/u)}const f=new Float32Array(256),m=-2*i**2;for(let b=0;b<256;b++)f[b]=Math.exp(b**2/m);const y=e.length,_=new Uint8Array(y),A=new Uint32Array(256);for(let b=0;b<n;b++)for(let T=0;T<t;T++){const x=b*t+T,M=e[x];let R=0,B=0;for(let $=0;$<o;$++){const k=b+$-h;if(!(k<0||k>=n))for(let C=0;C<o;C++){const P=T+C-h;if(P<0||P>=t)continue;const N=e[k*t+P],j=c[$*o+C]*f[Math.abs(N-M)];R+=N*j,B+=j}}const O=_[x]=Math.round(R/B);A[O]++}return[_,A]}static#l(e){const t=new Uint32Array(256);for(const n of e)t[n]++;return t}static#d(e){const t=e.length,n=new Uint8ClampedArray(t>>2);let s=-1/0,i=1/0;for(let c=0,u=n.length;c<u;c++){if(e[(c<<2)+3]===0){s=n[c]=255;continue}const f=n[c]=e[c<<2];f>s&&(s=f),f<i&&(i=f)}const o=255/(s-i);for(let c=0;c<t;c++)n[c]=(n[c]-i)*o;return n}static#u(e){let t,n=-1/0,s=-1/0;const i=e.findIndex(u=>u!==0);let o=i,c=i;for(t=i;t<256;t++){const u=e[t];u>n&&(t-o>s&&(s=t-o,c=t-1),n=u,o=t)}for(t=c-1;t>=0&&!(e[t]>e[t+1]);t--);return t}static#f(e){const t=e,{width:n,height:s}=e,{maxDim:i}=this.#e;let o=n,c=s;if(n>i||s>i){let y=n,_=s,A=Math.log2(Math.max(n,s)/i);const b=Math.floor(A);A=A===b?b-1:b;for(let x=0;x<A;x++){o=Math.ceil(y/2),c=Math.ceil(_/2);const M=new OffscreenCanvas(o,c);M.getContext("2d").drawImage(e,0,0,y,_,0,0,o,c),y=o,_=c,e!==t&&e.close(),e=M.transferToImageBitmap()}const T=Math.min(i/o,i/c);o=Math.round(o*T),c=Math.round(c*T)}const h=new OffscreenCanvas(o,c).getContext("2d",{willReadFrequently:!0});h.filter="grayscale(1)",h.drawImage(e,0,0,e.width,e.height,0,0,o,c);const f=h.getImageData(0,0,o,c).data;return[this.#d(f),o,c]}static extractContoursFromText(e,{fontFamily:t,fontStyle:n,fontWeight:s},i,o,c,u){let h=new OffscreenCanvas(1,1),f=h.getContext("2d",{alpha:!1});const m=200,y=f.font=`${n} ${s} ${m}px ${t}`,{actualBoundingBoxLeft:_,actualBoundingBoxRight:A,actualBoundingBoxAscent:b,actualBoundingBoxDescent:T,fontBoundingBoxAscent:x,fontBoundingBoxDescent:M,width:R}=f.measureText(e),B=1.5,O=Math.ceil(Math.max(Math.abs(_)+Math.abs(A)||0,R)*B),$=Math.ceil(Math.max(Math.abs(b)+Math.abs(T)||m,Math.abs(x)+Math.abs(M)||m)*B);h=new OffscreenCanvas(O,$),f=h.getContext("2d",{alpha:!0,willReadFrequently:!0}),f.font=y,f.filter="grayscale(1)",f.fillStyle="white",f.fillRect(0,0,O,$),f.fillStyle="black",f.fillText(e,O*(B-1)/2,$*(3-B)/2);const k=this.#d(f.getImageData(0,0,O,$).data),C=this.#l(k),P=this.#u(C),N=this.#s(k,O,$,P);return this.processDrawnLines({lines:{curves:N,width:O,height:$},pageWidth:i,pageHeight:o,rotation:c,innerMargin:u,mustSmooth:!0,areContours:!0})}static process(e,t,n,s,i){const[o,c,u]=this.#f(e),[h,f]=this.#h(o,c,u,Math.hypot(c,u)*this.#e.sigmaSFactor,this.#e.sigmaR,this.#e.kernelSize),m=this.#u(f),y=this.#s(h,c,u,m);return this.processDrawnLines({lines:{curves:y,width:c,height:u},pageWidth:t,pageHeight:n,rotation:s,innerMargin:i,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:e,pageWidth:t,pageHeight:n,rotation:s,innerMargin:i,mustSmooth:o,areContours:c}){s%180!==0&&([t,n]=[n,t]);const{curves:u,width:h,height:f}=e,m=e.thickness??0,y=[],_=Math.min(t/h,n/f),A=_/t,b=_/n,T=[];for(const{points:M}of u){const R=o?this.#o(M):M;if(!R)continue;T.push(R);const B=R.length,O=new Float32Array(B),$=new Float32Array(3*(B===2?2:B-2));if(y.push({line:$,points:O}),B===2){O[0]=R[0]*A,O[1]=R[1]*b,$.set([NaN,NaN,NaN,NaN,O[0],O[1]],0);continue}let[k,C,P,N]=R;k*=A,C*=b,P*=A,N*=b,O.set([k,C,P,N],0),$.set([NaN,NaN,NaN,NaN,k,C],0);for(let j=4;j<B;j+=2){const z=O[j]=R[j]*A,F=O[j+1]=R[j+1]*b;$.set(ge.createBezierPoints(k,C,P,N,z,F),(j-2)*3),[k,C,P,N]=[P,N,z,F]}}if(y.length===0)return null;const x=c?new ev:new Eh;return x.build(y,t,n,1,s,c?0:m,i),{outline:x,newCurves:T,areContours:c,thickness:m,width:h,height:f}}static async compressSignature({outlines:e,areContours:t,thickness:n,width:s,height:i}){let o=1/0,c=-1/0,u=0;for(const R of e){u+=R.length;for(let B=2,O=R.length;B<O;B++){const $=R[B]-R[B-2];o=Math.min(o,$),c=Math.max(c,$)}}let h;o>=-128&&c<=127?h=Int8Array:o>=-32768&&c<=32767?h=Int16Array:h=Int32Array;const f=e.length,m=nf+su*f,y=new Uint32Array(m);let _=0;y[_++]=m*Uint32Array.BYTES_PER_ELEMENT+(u-2*f)*h.BYTES_PER_ELEMENT,y[_++]=0,y[_++]=s,y[_++]=i,y[_++]=t?0:1,y[_++]=Math.max(0,Math.floor(n??0)),y[_++]=f,y[_++]=h.BYTES_PER_ELEMENT;for(const R of e)y[_++]=R.length-2,y[_++]=R[0],y[_++]=R[1];const A=new CompressionStream("deflate-raw"),b=A.writable.getWriter();await b.ready,b.write(y);const T=h.prototype.constructor;for(const R of e){const B=new T(R.length-2);for(let O=2,$=R.length;O<$;O++)B[O-2]=R[O]-R[O-2];b.write(B)}b.close();const x=await new Response(A.readable).arrayBuffer(),M=new Uint8Array(x);return jI(M)}static async decompressSignature(e){try{const t=I8(e),{readable:n,writable:s}=new DecompressionStream("deflate-raw"),i=s.getWriter();await i.ready,i.write(t).then(async()=>{await i.ready,await i.close()}).catch(()=>{});let o=null,c=0;for await(const R of n)o||=new Uint8Array(new Uint32Array(R.buffer,0,4)[0]),o.set(R,c),c+=R.length;const u=new Uint32Array(o.buffer,0,o.length>>2),h=u[1];if(h!==0)throw new Error(`Invalid version: ${h}`);const f=u[2],m=u[3],y=u[4]===0,_=u[5],A=u[6],b=u[7],T=[],x=(nf+su*A)*Uint32Array.BYTES_PER_ELEMENT;let M;switch(b){case Int8Array.BYTES_PER_ELEMENT:M=new Int8Array(o.buffer,x);break;case Int16Array.BYTES_PER_ELEMENT:M=new Int16Array(o.buffer,x);break;case Int32Array.BYTES_PER_ELEMENT:M=new Int32Array(o.buffer,x);break}c=0;for(let R=0;R<A;R++){const B=u[su*R+nf],O=new Float32Array(B+2);T.push(O);for(let $=0;$<su-1;$++)O[$]=u[su*R+nf+$+1];for(let $=0;$<B;$++)O[$+2]=O[$]+M[c++]}return{areContours:y,thickness:_,outlines:T,width:f,height:m}}catch(t){return Ve(`decompressSignature: ${t}`),null}}}class r_ extends gk{constructor(){super(),super.updateProperties({fill:Ie._defaultLineColor,"stroke-width":0})}clone(){const e=new r_;return e.updateAll(this),e}}class s_ extends Np{constructor(e){super(e),super.updateProperties({stroke:Ie._defaultLineColor,"stroke-width":1})}clone(){const e=new s_(this._viewParameters);return e.updateAll(this),e}}class ws extends Re{#e=!1;#t=null;#n=null;#r=null;static _type="signature";static _editorType=Oe.SIGNATURE;static _defaultDrawingOptions=null;constructor(e){super({...e,mustBeCommitted:!0,name:"signatureEditor"}),this._willKeepAspectRatio=!0,this.#n=e.signatureData||null,this.#t=null,this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(e,t){Ie.initialize(e,t),this._defaultDrawingOptions=new r_,this._defaultDrawnSignatureOptions=new s_(t.viewParameters)}static getDefaultDrawingOptions(e){const t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!1}static get typesMap(){return We(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!this.#t}}static computeTelemetryFinalData(e){const t=e.get("hasDescription");return{hasAltText:t.get(!0)??0,hasNoAltText:t.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let e,t;const{_isCopy:n}=this;if(n&&(this._isCopy=!1,e=this.x,t=this.y),super.render(),this._drawId===null)if(this.#n){const{lines:s,mustSmooth:i,areContours:o,description:c,uuid:u,heightInPage:h}=this.#n,{rawDims:{pageWidth:f,pageHeight:m},rotation:y}=this.parent.viewport,_=ta.processDrawnLines({lines:s,pageWidth:f,pageHeight:m,rotation:y,innerMargin:ws._INNER_MARGIN,mustSmooth:i,areContours:o});this.addSignature(_,h,c,u)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);return n&&(this._isCopy=!0,this._moveAfterPaste(e,t)),this.div}setUuid(e){this.#r=e,this.addEditToolbar()}getUuid(){return this.#r}get description(){return this.#t}set description(e){this.#t=e,super.addEditToolbar().then(t=>{t?.updateEditSignatureButton(e)})}getSignaturePreview(){const{newCurves:e,areContours:t,thickness:n,width:s,height:i}=this.#n,o=Math.max(s,i),c=ta.processDrawnLines({lines:{curves:e.map(u=>({points:u})),thickness:n,width:s,height:i},pageWidth:o,pageHeight:o,rotation:0,innerMargin:0,mustSmooth:!1,areContours:t});return{areContours:t,outline:c.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(e,t,n,s){const{x:i,y:o}=this,{outline:c}=this.#n=e;this.#e=c instanceof ev,this.description=n,this.div.setAttribute("data-l10n-args",JSON.stringify({description:n}));let u;this.#e?u=ws.getDefaultDrawingOptions():(u=ws._defaultDrawnSignatureOptions.clone(),u.updateProperties({"stroke-width":c.thickness})),this._addOutlines({drawOutlines:c,drawingOptions:u});const[h,f]=this.parentDimensions,[,m]=this.pageDimensions;let y=t/m;y=y>=1?.5:y,this.width*=y/this.height,this.width>=1&&(y*=.9/this.width,this.width=.9),this.height=y,this.setDims(h*this.width,f*this.height),this.x=i,this.y=o,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(s),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!s,hasDescription:!!n}}),this.div.hidden=!1}getFromImage(e){const{rawDims:{pageWidth:t,pageHeight:n},rotation:s}=this.parent.viewport;return ta.process(e,t,n,s,ws._INNER_MARGIN)}getFromText(e,t){const{rawDims:{pageWidth:n,pageHeight:s},rotation:i}=this.parent.viewport;return ta.extractContoursFromText(e,t,n,s,i,ws._INNER_MARGIN)}getDrawnSignature(e){const{rawDims:{pageWidth:t,pageHeight:n},rotation:s}=this.parent.viewport;return ta.processDrawnLines({lines:e,pageWidth:t,pageHeight:n,rotation:s,innerMargin:ws._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:e,thickness:t}){e?this._drawingOptions=ws.getDefaultDrawingOptions():(this._drawingOptions=ws._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":t}))}serialize(e=!1){if(this.isEmpty())return null;const{lines:t,points:n,rect:s}=this.serializeDraw(e),{_drawingOptions:{"stroke-width":i}}=this,o={annotationType:Oe.SIGNATURE,isSignature:!0,areContours:this.#e,color:[0,0,0],thickness:this.#e?0:i,pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?(o.paths={lines:t,points:n},o.uuid=this.#r,o.isCopy=!0):o.lines=t,this.#t&&(o.accessibilityData={type:"Figure",alt:this.#t}),o}static deserializeDraw(e,t,n,s,i,o){return o.areContours?ev.deserialize(e,t,n,s,i,o):Eh.deserialize(e,t,n,s,i,o)}static async deserialize(e,t,n){const s=await super.deserialize(e,t,n);return s.#e=e.areContours,s.#t=e.accessibilityData?.alt||"",s.#r=e.uuid,s}}class Zj extends Ie{#e=null;#t=null;#n=null;#r=null;#i=null;#s="";#a=null;#o=!1;#h=null;#l=!1;#d=!1;static _type="stamp";static _editorType=Oe.STAMP;constructor(e){super({...e,name:"stampEditor"}),this.#r=e.bitmapUrl,this.#i=e.bitmapFile,this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(e,t){Ie.initialize(e,t)}static isHandlingMimeForPasting(e){return Jf.includes(e)}static paste(e,t){t.pasteEditor({mode:Oe.STAMP},{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(e){const t=e.get("hasAltText");return{hasAltText:t.get(!0)??0,hasNoAltText:t.get(!1)??0}}#u(e,t=!1){if(!e){this.remove();return}this.#e=e.bitmap,t||(this.#t=e.id,this.#l=e.isSvg),e.file&&(this.#s=e.file.name),this.#m()}#f(){if(this.#n=null,this._uiManager.enableWaiting(!1),!!this.#a){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(e=null,t=!0){if(this.hasAltTextData())return null;const{mlManager:n}=this._uiManager;if(!n)throw new Error("No ML.");if(!await n.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:s,width:i,height:o}=e||this.copyCanvas(null,null,!0).imageData,c=await n.guess({name:"altText",request:{data:s,width:i,height:o,channels:s.length/(i*o)}});if(!c)throw new Error("No response from the AI service.");if(c.error)throw new Error("Error from the AI service.");if(c.cancel)return null;if(!c.output)throw new Error("No valid response from the AI service.");const u=c.output;return await this.setGuessedAltText(u),t&&!this.hasAltTextData()&&(this.altTextData={alt:u,decorative:!1}),u}#p(){if(this.#t){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#t).then(n=>this.#u(n,!0)).finally(()=>this.#f());return}if(this.#r){const n=this.#r;this.#r=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromUrl(n).then(s=>this.#u(s)).finally(()=>this.#f());return}if(this.#i){const n=this.#i;this.#i=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromFile(n).then(s=>this.#u(s)).finally(()=>this.#f());return}const e=document.createElement("input");e.type="file",e.accept=Jf.join(",");const t=this._uiManager._signal;this.#n=new Promise(n=>{e.addEventListener("change",async()=>{if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const s=await this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#u(s)}n()},{signal:t}),e.addEventListener("cancel",()=>{this.remove(),n()},{signal:t})}).finally(()=>this.#f()),e.click()}remove(){this.#t&&(this.#e=null,this._uiManager.imageManager.deleteId(this.#t),this.#a?.remove(),this.#a=null,this.#h&&(clearTimeout(this.#h),this.#h=null)),super.remove()}rebuild(){if(!this.parent){this.#t&&this.#p();return}super.rebuild(),this.div!==null&&(this.#t&&this.#a===null&&this.#p(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(e){this._isDraggable=!0,e&&this.div.focus()}isEmpty(){return!(this.#n||this.#e||this.#r||this.#i||this.#t||this.#o)}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let e,t;return this._isCopy&&(e=this.x,t=this.y),super.render(),this.div.hidden=!0,this.createAltText(),this.#o||(this.#e?this.#m():this.#p()),this._isCopy&&this._moveAfterPaste(e,t),this._uiManager.addShouldRescale(this),this.div}setCanvas(e,t){const{id:n,bitmap:s}=this._uiManager.imageManager.getFromCanvas(e,t);t.remove(),n&&this._uiManager.imageManager.isValidId(n)&&(this.#t=n,s&&(this.#e=s),this.#o=!1,this.#m())}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#h!==null&&clearTimeout(this.#h);const e=200;this.#h=setTimeout(()=>{this.#h=null,this.#g()},e)}#m(){const{div:e}=this;let{width:t,height:n}=this.#e;const[s,i]=this.pageDimensions,o=.75;if(this.width)t=this.width*s,n=this.height*i;else if(t>o*s||n>o*i){const f=Math.min(o*s/t,o*i/n);t*=f,n*=f}const[c,u]=this.parentDimensions;this.setDims(t*c/s,n*u/i),this._uiManager.enableWaiting(!1);const h=this.#a=document.createElement("canvas");h.setAttribute("role","img"),this.addContainer(h),this.width=t/s,this.height=n/i,this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(e.hidden=!1),this.#g(),this.#d||(this.parent.addUndoableEditor(this),this.#d=!0),this._reportTelemetry({action:"inserted_image"}),this.#s&&this.div.setAttribute("aria-description",this.#s),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")}copyCanvas(e,t,n=!1){e||(e=224);const{width:s,height:i}=this.#e,o=new ns;let c=this.#e,u=s,h=i,f=null;if(t){if(s>t||i>t){const $=Math.min(t/s,t/i);u=Math.floor(s*$),h=Math.floor(i*$)}f=document.createElement("canvas");const y=f.width=Math.ceil(u*o.sx),_=f.height=Math.ceil(h*o.sy);this.#l||(c=this.#c(y,_));const A=f.getContext("2d");A.filter=this._uiManager.hcmFilter;let b="white",T="#cfcfd8";this._uiManager.hcmFilter!=="none"?T="black":window.matchMedia?.("(prefers-color-scheme: dark)").matches&&(b="#8f8f9d",T="#42414d");const x=15,M=x*o.sx,R=x*o.sy,B=new OffscreenCanvas(M*2,R*2),O=B.getContext("2d");O.fillStyle=b,O.fillRect(0,0,M*2,R*2),O.fillStyle=T,O.fillRect(0,0,M,R),O.fillRect(M,R,M,R),A.fillStyle=A.createPattern(B,"repeat"),A.fillRect(0,0,y,_),A.drawImage(c,0,0,c.width,c.height,0,0,y,_)}let m=null;if(n){let y,_;if(o.symmetric&&c.width<e&&c.height<e)y=c.width,_=c.height;else if(c=this.#e,s>e||i>e){const T=Math.min(e/s,e/i);y=Math.floor(s*T),_=Math.floor(i*T),this.#l||(c=this.#c(y,_))}const b=new OffscreenCanvas(y,_).getContext("2d",{willReadFrequently:!0});b.drawImage(c,0,0,c.width,c.height,0,0,y,_),m={width:y,height:_,data:b.getImageData(0,0,y,_).data}}return{canvas:f,width:u,height:h,imageData:m}}#c(e,t){const{width:n,height:s}=this.#e;let i=n,o=s,c=this.#e;for(;i>2*e||o>2*t;){const u=i,h=o;i>2*e&&(i=i>=16384?Math.floor(i/2)-1:Math.ceil(i/2)),o>2*t&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2));const f=new OffscreenCanvas(i,o);f.getContext("2d").drawImage(c,0,0,u,h,0,0,i,o),c=f.transferToImageBitmap()}return c}#g(){const[e,t]=this.parentDimensions,{width:n,height:s}=this,i=new ns,o=Math.ceil(n*e*i.sx),c=Math.ceil(s*t*i.sy),u=this.#a;if(!u||u.width===o&&u.height===c)return;u.width=o,u.height=c;const h=this.#l?this.#e:this.#c(o,c),f=u.getContext("2d");f.filter=this._uiManager.hcmFilter,f.drawImage(h,0,0,h.width,h.height,0,0,o,c)}#y(e){if(e){if(this.#l){const s=this._uiManager.imageManager.getSvgUrl(this.#t);if(s)return s}const t=document.createElement("canvas");return{width:t.width,height:t.height}=this.#e,t.getContext("2d").drawImage(this.#e,0,0),t.toDataURL()}if(this.#l){const[t,n]=this.pageDimensions,s=Math.round(this.width*t*ma.PDF_TO_CSS_UNITS),i=Math.round(this.height*n*ma.PDF_TO_CSS_UNITS),o=new OffscreenCanvas(s,i);return o.getContext("2d").drawImage(this.#e,0,0,this.#e.width,this.#e.height,0,0,s,i),o.transferToImageBitmap()}return structuredClone(this.#e)}static async deserialize(e,t,n){let s=null,i=!1;if(e instanceof fk){const{data:{rect:b,rotation:T,id:x,structParent:M,popupRef:R},container:B,parent:{page:{pageNumber:O}},canvas:$}=e;let k,C;$?(delete e.canvas,{id:k,bitmap:C}=n.imageManager.getFromCanvas(B.id,$),$.remove()):(i=!0,e._hasNoCanvas=!0);const P=(await t._structTree.getAriaAttributes(`${B0}${x}`))?.get("aria-label")||"";s=e={annotationType:Oe.STAMP,bitmapId:k,bitmap:C,pageIndex:O-1,rect:b.slice(0),rotation:T,annotationElementId:x,id:x,deleted:!1,accessibilityData:{decorative:!1,altText:P},isSvg:!1,structParent:M,popupRef:R}}const o=await super.deserialize(e,t,n),{rect:c,bitmap:u,bitmapUrl:h,bitmapId:f,isSvg:m,accessibilityData:y}=e;i?(n.addMissingCanvas(e.id,o),o.#o=!0):f&&n.imageManager.isValidId(f)?(o.#t=f,u&&(o.#e=u)):o.#r=h,o.#l=m;const[_,A]=o.pageDimensions;return o.width=(c[2]-c[0])/_,o.height=(c[3]-c[1])/A,y&&(o.altTextData=y),o._initialData=s,o.#d=!!s,o}serialize(e=!1,t=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n={annotationType:Oe.STAMP,bitmapId:this.#t,pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:this.#l,structTreeParentId:this._structTreeParentId};if(e)return n.bitmapUrl=this.#y(!0),n.accessibilityData=this.serializeAltText(!0),n.isCopy=!0,n;const{decorative:s,altText:i}=this.serializeAltText(!1);if(!s&&i&&(n.accessibilityData={type:"Figure",alt:i}),this.annotationElementId){const c=this.#v(n);if(c.isSame)return null;c.isSameAltText?delete n.accessibilityData:n.accessibilityData.structParent=this._initialData.structParent??-1}if(n.id=this.annotationElementId,t===null)return n;t.stamps||=new Map;const o=this.#l?(n.rect[2]-n.rect[0])*(n.rect[3]-n.rect[1]):null;if(!t.stamps.has(this.#t))t.stamps.set(this.#t,{area:o,serialized:n}),n.bitmap=this.#y(!1);else if(this.#l){const c=t.stamps.get(this.#t);o>c.area&&(c.area=o,c.serialized.bitmap.close(),c.serialized.bitmap=this.#y(!1))}return n}#v(e){const{pageIndex:t,accessibilityData:{altText:n}}=this._initialData,s=e.pageIndex===t,i=(e.accessibilityData?.alt||"")===n;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&s&&i,isSameAltText:i}}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}}class bs{#e;#t=!1;#n=null;#r=null;#i=null;#s=new Map;#a=!1;#o=!1;#h=!1;#l=null;#d=null;#u=null;#f=null;#p=null;#m=-1;#c;static _initialized=!1;static#g=new Map([Qt,n_,Zj,Nt,ws].map(e=>[e._editorType,e]));constructor({uiManager:e,pageIndex:t,div:n,structTreeLayer:s,accessibilityManager:i,annotationLayer:o,drawLayer:c,textLayer:u,viewport:h,l10n:f}){const m=[...bs.#g.values()];if(!bs._initialized){bs._initialized=!0;for(const y of m)y.initialize(f,e)}e.registerEditorTypes(m),this.#c=e,this.pageIndex=t,this.div=n,this.#e=i,this.#n=o,this.viewport=h,this.#u=u,this.drawLayer=c,this._structTree=s,this.#c.addLayer(this)}get isEmpty(){return this.#s.size===0}get isInvisible(){return this.isEmpty&&this.#c.getMode()===Oe.NONE}updateToolbar(e){this.#c.updateToolbar(e)}updateMode(e=this.#c.getMode()){switch(this.#A(),e){case Oe.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Oe.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Oe.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;for(const n of bs.#g.values())t.toggle(`${n._type}Editing`,e===n._editorType);this.div.hidden=!1}hasTextLayer(e){return e===this.#u?.div}setEditingState(e){this.#c.setEditingState(e)}addCommands(e){this.#c.addCommands(e)}cleanUndoStack(e){this.#c.cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){this.#n?.div.classList.toggle("disabled",!e)}async enable(){this.#h=!0,this.div.tabIndex=0,this.togglePointerEvents(!0),this.#p?.abort(),this.#p=null;const e=new Set;for(const n of this.#s.values())n.enableEditing(),n.show(!0),n.annotationElementId&&(this.#c.removeChangedExistingAnnotation(n),e.add(n.annotationElementId));if(!this.#n){this.#h=!1;return}const t=this.#n.getEditableAnnotations();for(const n of t){if(n.hide(),this.#c.isDeletedAnnotationElement(n.data.id)||e.has(n.data.id))continue;const s=await this.deserialize(n);s&&(this.addOrRebuild(s),s.enableEditing())}this.#h=!1}disable(){if(this.#o=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1),this.#u&&!this.#p){this.#p=new AbortController;const s=this.#c.combinedSignal(this.#p);this.#u.div.addEventListener("pointerdown",i=>{const{clientX:c,clientY:u,timeStamp:h}=i,f=this.#m;if(h-f>500){this.#m=h;return}this.#m=-1;const{classList:m}=this.div;m.toggle("getElements",!0);const y=document.elementsFromPoint(c,u);if(m.toggle("getElements",!1),!this.div.contains(y[0]))return;let _;const A=new RegExp(`^${MI}[0-9]+$`);for(const T of y)if(A.test(T.id)){_=T.id;break}if(!_)return;const b=this.#s.get(_);b?.annotationElementId===null&&(i.stopPropagation(),i.preventDefault(),b.dblclick())},{signal:s,capture:!0})}const e=new Map,t=new Map;for(const s of this.#s.values())if(s.disableEditing(),!!s.annotationElementId){if(s.serialize()!==null){e.set(s.annotationElementId,s);continue}else t.set(s.annotationElementId,s);this.getEditableAnnotation(s.annotationElementId)?.show(),s.remove()}if(this.#n){const s=this.#n.getEditableAnnotations();for(const i of s){const{id:o}=i.data;if(this.#c.isDeletedAnnotationElement(o))continue;let c=t.get(o);if(c){c.resetAnnotationElement(i),c.show(!1),i.show();continue}c=e.get(o),c&&(this.#c.addChangedExistingAnnotation(c),c.renderAnnotationElement(i)&&c.show(!1)),i.show()}}this.#A(),this.isEmpty&&(this.div.hidden=!0);const{classList:n}=this.div;for(const s of bs.#g.values())n.remove(`${s._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),this.#o=!1}getEditableAnnotation(e){return this.#n?.getEditableAnnotation(e)||null}setActiveEditor(e){this.#c.getActive()!==e&&this.#c.setActiveEditor(e)}enableTextSelection(){if(this.div.tabIndex=-1,this.#u?.div&&!this.#f){this.#f=new AbortController;const e=this.#c.combinedSignal(this.#f);this.#u.div.addEventListener("pointerdown",this.#y.bind(this),{signal:e}),this.#u.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#u?.div&&this.#f&&(this.#f.abort(),this.#f=null,this.#u.div.classList.remove("highlighting"))}#y(e){this.#c.unselectAll();const{target:t}=e;if(t===this.#u.div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&this.#u.div.contains(t)){const{isMac:n}=ln.platform;if(e.button!==0||e.ctrlKey&&n)return;this.#c.showAllEditors("highlight",!0,!0),this.#u.div.classList.add("free"),this.toggleDrawing(),Nt.startHighlighting(this,this.#c.direction==="ltr",{target:this.#u.div,x:e.x,y:e.y}),this.#u.div.addEventListener("pointerup",()=>{this.#u.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#c._signal}),e.preventDefault()}}enableClick(){if(this.#r)return;this.#r=new AbortController;const e=this.#c.combinedSignal(this.#r);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){this.#r?.abort(),this.#r=null}attach(e){this.#s.set(e.id,e);const{annotationElementId:t}=e;t&&this.#c.isDeletedAnnotationElement(t)&&this.#c.removeDeletedAnnotationElement(e)}detach(e){this.#s.delete(e.id),this.#e?.removePointerInTextLayer(e.contentDiv),!this.#o&&e.annotationElementId&&this.#c.addDeletedAnnotationElement(e)}remove(e){this.detach(e),this.#c.removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){e.parent!==this&&(e.parent&&e.annotationElementId&&(this.#c.addDeletedAnnotationElement(e.annotationElementId),Ie.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),e.parent?.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),this.#c.addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!this.#h),this.#c.addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!this.#i&&(e._focusEventsAllowed=!1,this.#i=setTimeout(()=>{this.#i=null,e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this.#c._signal}),t.focus())},0)),e._structTreeParentId=this.#e?.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||=this,e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),n=()=>{e.remove()};this.addCommands({cmd:t,undo:n,mustExec:!1})}getNextId(){return this.#c.getId()}get#v(){return bs.#g.get(this.#c.getMode())}combinedSignal(e){return this.#c.combinedSignal(e)}#w(e){const t=this.#v;return t?new t.prototype.constructor(e):null}canCreateNewEmptyEditor(){return this.#v?.canCreateNewEmptyEditor()}async pasteEditor(e,t){this.updateToolbar(e),await this.#c.updateMode(e.mode);const{offsetX:n,offsetY:s}=this.#E(),i=this.getNextId(),o=this.#w({parent:this,id:i,x:n,y:s,uiManager:this.#c,isCentered:!0,...t});o&&this.add(o)}async deserialize(e){return await bs.#g.get(e.annotationType??e.annotationEditorType)?.deserialize(e,this,this.#c)||null}createAndAddNewEditor(e,t,n={}){const s=this.getNextId(),i=this.#w({parent:this,id:s,x:e.offsetX,y:e.offsetY,uiManager:this.#c,isCentered:t,...n});return i&&this.add(i),i}#E(){const{x:e,y:t,width:n,height:s}=this.div.getBoundingClientRect(),i=Math.max(0,e),o=Math.max(0,t),c=Math.min(window.innerWidth,e+n),u=Math.min(window.innerHeight,t+s),h=(i+c)/2-e,f=(o+u)/2-t,[m,y]=this.viewport.rotation%180===0?[h,f]:[f,h];return{offsetX:m,offsetY:y}}addNewEditor(e={}){this.createAndAddNewEditor(this.#E(),!0,e)}setSelected(e){this.#c.setSelected(e)}toggleSelected(e){this.#c.toggleSelected(e)}unselect(e){this.#c.unselect(e)}pointerup(e){const{isMac:t}=ln.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div||!this.#a||(this.#a=!1,this.#v?.isDrawer&&this.#v.supportMultipleDrawings))return;if(!this.#t){this.#t=!0;return}const n=this.#c.getMode();if(n===Oe.STAMP||n===Oe.SIGNATURE){this.#c.unselectAll();return}this.createAndAddNewEditor(e,!1)}pointerdown(e){if(this.#c.getMode()===Oe.HIGHLIGHT&&this.enableTextSelection(),this.#a){this.#a=!1;return}const{isMac:t}=ln.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(this.#a=!0,this.#v?.isDrawer){this.startDrawingSession(e);return}const n=this.#c.getActive();this.#t=!n||n.isEmpty()}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),this.#l){this.#v.startDrawing(this,this.#c,!1,e);return}this.#c.setCurrentDrawingSession(this),this.#l=new AbortController;const t=this.#c.combinedSignal(this.#l);this.div.addEventListener("blur",({relatedTarget:n})=>{n&&!this.div.contains(n)&&(this.#d=null,this.commitOrRemove())},{signal:t}),this.#v.startDrawing(this,this.#c,!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&(this.#d=t);return}this.#d&&setTimeout(()=>{this.#d?.focus(),this.#d=null},0)}endDrawingSession(e=!1){return this.#l?(this.#c.setCurrentDrawingSession(null),this.#l.abort(),this.#l=null,this.#d=null,this.#v.endDrawing(e)):null}findNewParent(e,t,n){const s=this.#c.findParent(t,n);return s===null||s===this?!1:(s.changeParent(e),!0)}commitOrRemove(){return this.#l?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#l&&this.#v.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#c.getActive()?.parent===this&&(this.#c.commitOrRemove(),this.#c.setActiveEditor(null)),this.#i&&(clearTimeout(this.#i),this.#i=null);for(const e of this.#s.values())this.#e?.removePointerInTextLayer(e.contentDiv),e.setParent(null),e.isAttachedToDOM=!1,e.div.remove();this.div=null,this.#s.clear(),this.#c.removeLayer(this)}#A(){for(const e of this.#s.values())e.isEmpty()&&e.remove()}render({viewport:e}){this.viewport=e,go(this.div,e);for(const t of this.#c.getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){this.#c.commitOrRemove(),this.#A();const t=this.viewport.rotation,n=e.rotation;if(this.viewport=e,go(this.div,{rotation:n}),t!==n)for(const s of this.#s.values())s.rotate(n)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return this.#c.viewParameters.realScale}}class on{#e=null;#t=new Map;#n=new Map;static#r=0;constructor({pageIndex:e}){this.pageIndex=e}setParent(e){if(!this.#e){this.#e=e;return}if(this.#e!==e){if(this.#t.size>0)for(const t of this.#t.values())t.remove(),e.append(t);this.#e=e}}static get _svgFactory(){return We(this,"_svgFactory",new Yu)}static#i(e,[t,n,s,i]){const{style:o}=e;o.top=`${100*n}%`,o.left=`${100*t}%`,o.width=`${100*s}%`,o.height=`${100*i}%`}#s(){const e=on._svgFactory.create(1,1,!0);return this.#e.append(e),e.setAttribute("aria-hidden",!0),e}#a(e,t){const n=on._svgFactory.createElement("clipPath");e.append(n);const s=`clip_${t}`;n.setAttribute("id",s),n.setAttribute("clipPathUnits","objectBoundingBox");const i=on._svgFactory.createElement("use");return n.append(i),i.setAttribute("href",`#${t}`),i.classList.add("clip"),s}#o(e,t){for(const[n,s]of Object.entries(t))s===null?e.removeAttribute(n):e.setAttribute(n,s)}draw(e,t=!1,n=!1){const s=on.#r++,i=this.#s(),o=on._svgFactory.createElement("defs");i.append(o);const c=on._svgFactory.createElement("path");o.append(c);const u=`path_p${this.pageIndex}_${s}`;c.setAttribute("id",u),c.setAttribute("vector-effect","non-scaling-stroke"),t&&this.#n.set(s,c);const h=n?this.#a(o,u):null,f=on._svgFactory.createElement("use");return i.append(f),f.setAttribute("href",`#${u}`),this.updateProperties(i,e),this.#t.set(s,i),{id:s,clipPathId:`url(#${h})`}}drawOutline(e,t){const n=on.#r++,s=this.#s(),i=on._svgFactory.createElement("defs");s.append(i);const o=on._svgFactory.createElement("path");i.append(o);const c=`path_p${this.pageIndex}_${n}`;o.setAttribute("id",c),o.setAttribute("vector-effect","non-scaling-stroke");let u;if(t){const m=on._svgFactory.createElement("mask");i.append(m),u=`mask_p${this.pageIndex}_${n}`,m.setAttribute("id",u),m.setAttribute("maskUnits","objectBoundingBox");const y=on._svgFactory.createElement("rect");m.append(y),y.setAttribute("width","1"),y.setAttribute("height","1"),y.setAttribute("fill","white");const _=on._svgFactory.createElement("use");m.append(_),_.setAttribute("href",`#${c}`),_.setAttribute("stroke","none"),_.setAttribute("fill","black"),_.setAttribute("fill-rule","nonzero"),_.classList.add("mask")}const h=on._svgFactory.createElement("use");s.append(h),h.setAttribute("href",`#${c}`),u&&h.setAttribute("mask",`url(#${u})`);const f=h.cloneNode();return s.append(f),h.classList.add("mainOutline"),f.classList.add("secondaryOutline"),this.updateProperties(s,e),this.#t.set(n,s),n}finalizeDraw(e,t){this.#n.delete(e),this.updateProperties(e,t)}updateProperties(e,t){if(!t)return;const{root:n,bbox:s,rootClass:i,path:o}=t,c=typeof e=="number"?this.#t.get(e):e;if(c){if(n&&this.#o(c,n),s&&on.#i(c,s),i){const{classList:u}=c;for(const[h,f]of Object.entries(i))u.toggle(h,f)}if(o){const h=c.firstChild.firstChild;this.#o(h,o)}}}updateParent(e,t){if(t===this)return;const n=this.#t.get(e);n&&(t.#e.append(n),this.#t.delete(e),t.#t.set(e,n))}remove(e){this.#n.delete(e),this.#e!==null&&(this.#t.get(e).remove(),this.#t.delete(e))}destroy(){this.#e=null;for(const e of this.#t.values())e.remove();this.#t.clear(),this.#n.clear()}}globalThis._pdfjsTestingUtils={HighlightOutliner:Jy};globalThis.pdfjsLib={AbortException:yi,AnnotationEditorLayer:bs,AnnotationEditorParamsType:qe,AnnotationEditorType:Oe,AnnotationEditorUIManager:vi,AnnotationLayer:t_,AnnotationMode:Ss,AnnotationType:Mt,build:ak,ColorPicker:lr,createValidAbsoluteUrl:F0,DOMSVGFactory:Yu,DrawLayer:on,FeatureTest:ln,fetchData:lc,getDocument:X0,getFilenameFromUrl:BI,getPdfFilenameFromUrl:UI,getUuid:j0,getXfaPageViewport:zI,GlobalWorkerOptions:io,ImageKind:Cu,InvalidPDFException:Qf,isDataScheme:yh,isPdfFile:Lp,isValidExplicitDest:GI,MathClamp:Cn,noContextMenu:Rr,normalizeUnicode:VI,OPS:Gu,OutputScale:ns,PasswordResponses:OI,PDFDataRangeTransport:Q0,PDFDateString:U0,PDFWorker:Xl,PermissionFlag:NI,PixelsPerInch:ma,RenderingCancelledException:Dp,ResponseException:qu,setLayerDimensions:go,shadow:We,SignatureExtractor:ta,stopEvent:Vt,SupportedImageMimeTypes:Jf,TextLayer:Ku,TouchManager:_h,updateUrlHash:V0,Util:be,VerbosityLevel:ph,version:J0,XfaLayer:Z0};const eB=Object.freeze(Object.defineProperty({__proto__:null,AbortException:yi,AnnotationEditorLayer:bs,AnnotationEditorParamsType:qe,AnnotationEditorType:Oe,AnnotationEditorUIManager:vi,AnnotationLayer:t_,AnnotationMode:Ss,AnnotationType:Mt,ColorPicker:lr,DOMSVGFactory:Yu,DrawLayer:on,FeatureTest:ln,GlobalWorkerOptions:io,ImageKind:Cu,InvalidPDFException:Qf,MathClamp:Cn,OPS:Gu,OutputScale:ns,PDFDataRangeTransport:Q0,PDFDateString:U0,PDFWorker:Xl,PasswordResponses:OI,PermissionFlag:NI,PixelsPerInch:ma,RenderingCancelledException:Dp,ResponseException:qu,SignatureExtractor:ta,SupportedImageMimeTypes:Jf,TextLayer:Ku,TouchManager:_h,Util:be,VerbosityLevel:ph,XfaLayer:Z0,build:ak,createValidAbsoluteUrl:F0,fetchData:lc,getDocument:X0,getFilenameFromUrl:BI,getPdfFilenameFromUrl:UI,getUuid:j0,getXfaPageViewport:zI,isDataScheme:yh,isPdfFile:Lp,isValidExplicitDest:GI,noContextMenu:Rr,normalizeUnicode:VI,setLayerDimensions:go,shadow:We,stopEvent:Vt,updateUrlHash:V0,version:J0},Symbol.toStringTag,{value:"Module"}));function yk(r){var e,t,n="";if(typeof r=="string"||typeof r=="number")n+=r;else if(typeof r=="object")if(Array.isArray(r)){var s=r.length;for(e=0;e<s;e++)r[e]&&(t=yk(r[e]))&&(n&&(n+=" "),n+=t)}else for(t in r)r[t]&&(n&&(n+=" "),n+=t);return n}function Op(){for(var r,e,t=0,n="",s=arguments.length;t<s;t++)(r=arguments[t])&&(e=yk(r))&&(n&&(n+=" "),n+=e);return n}var Kb=Object.prototype.hasOwnProperty;function Xb(r,e,t){for(t of r.keys())if(Ol(t,e))return t}function Ol(r,e){var t,n,s;if(r===e)return!0;if(r&&e&&(t=r.constructor)===e.constructor){if(t===Date)return r.getTime()===e.getTime();if(t===RegExp)return r.toString()===e.toString();if(t===Array){if((n=r.length)===e.length)for(;n--&&Ol(r[n],e[n]););return n===-1}if(t===Set){if(r.size!==e.size)return!1;for(n of r)if(s=n,s&&typeof s=="object"&&(s=Xb(e,s),!s)||!e.has(s))return!1;return!0}if(t===Map){if(r.size!==e.size)return!1;for(n of r)if(s=n[0],s&&typeof s=="object"&&(s=Xb(e,s),!s)||!Ol(n[1],e.get(s)))return!1;return!0}if(t===ArrayBuffer)r=new Uint8Array(r),e=new Uint8Array(e);else if(t===DataView){if((n=r.byteLength)===e.byteLength)for(;n--&&r.getInt8(n)===e.getInt8(n););return n===-1}if(ArrayBuffer.isView(r)){if((n=r.byteLength)===e.byteLength)for(;n--&&r[n]===e[n];);return n===-1}if(!t||typeof r=="object"){n=0;for(t in r)if(Kb.call(r,t)&&++n&&!Kb.call(e,t)||!(t in e)||!Ol(r[t],e[t]))return!1;return Object.keys(e).length===n}}return r!==r&&e!==e}function Ah(r){let e=!1;return{promise:new Promise((n,s)=>{r.then(i=>!e&&n(i)).catch(i=>!e&&s(i))}),cancel(){e=!0}}}const tB=["onCopy","onCut","onPaste"],nB=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],rB=["onFocus","onBlur"],sB=["onInput","onInvalid","onReset","onSubmit"],iB=["onLoad","onError"],oB=["onKeyDown","onKeyPress","onKeyUp"],aB=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],lB=["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],cB=["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],uB=["onSelect"],hB=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],dB=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],fB=["onScroll"],pB=["onWheel"],mB=["onAnimationStart","onAnimationEnd","onAnimationIteration"],gB=["onTransitionEnd"],yB=["onToggle"],vB=["onChange"],_B=[...tB,...nB,...rB,...sB,...iB,...oB,...aB,...lB,...cB,...uB,...hB,...dB,...fB,...pB,...mB,...gB,...vB,...yB];function vk(r,e){const t={};for(const n of _B){const s=r[n];s&&(e?t[n]=i=>s(i,e(n)):t[n]=s)}return t}var wB="Invariant failed";function at(r,e){if(!r)throw new Error(wB)}var ty,Yb;function EB(){if(Yb)return ty;Yb=1;var r=function(){};return ty=r,ty}var AB=EB();const Pn=rv(AB),_k=V.createContext(null),bB="noopener noreferrer nofollow";class TB{constructor(){this.externalLinkEnabled=!0,this.externalLinkRel=void 0,this.externalLinkTarget=void 0,this.isInPresentationMode=!1,this.pdfDocument=void 0,this.pdfViewer=void 0}setDocument(e){this.pdfDocument=e}setViewer(e){this.pdfViewer=e}setExternalLinkRel(e){this.externalLinkRel=e}setExternalLinkTarget(e){this.externalLinkTarget=e}setHistory(){}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return at(this.pdfViewer),this.pdfViewer.currentPageNumber||0}set page(e){at(this.pdfViewer),this.pdfViewer.currentPageNumber=e}get rotation(){return 0}set rotation(e){}goToDestination(e){return new Promise(t=>{at(this.pdfDocument),at(e),typeof e=="string"?this.pdfDocument.getDestination(e).then(t):Array.isArray(e)?t(e):e.then(t)}).then(t=>{at(Array.isArray(t));const n=t[0];new Promise(s=>{at(this.pdfDocument),n instanceof Object?this.pdfDocument.getPageIndex(n).then(i=>{s(i)}).catch(()=>{at(!1)}):typeof n=="number"?s(n):at(!1)}).then(s=>{const i=s+1;at(this.pdfViewer),at(i>=1&&i<=this.pagesCount),this.pdfViewer.scrollPageIntoView({dest:t,pageIndex:s,pageNumber:i})})})}navigateTo(e){this.goToDestination(e)}goToPage(e){const t=e-1;at(this.pdfViewer),at(e>=1&&e<=this.pagesCount),this.pdfViewer.scrollPageIntoView({pageIndex:t,pageNumber:e})}addLinkAttributes(e,t,n){e.href=t,e.rel=this.externalLinkRel||bB,e.target=n?"_blank":this.externalLinkTarget||""}getDestinationHash(){return"#"}getAnchorUrl(){return"#"}setHash(){}executeNamedAction(){}cachePageRef(){}isPageVisible(){return!0}isPageCached(){return!0}executeSetOCGState(){}}function Fl({children:r,type:e}){return L.jsx("div",{className:`react-pdf__message react-pdf__message--${e}`,children:r})}const Qb={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};function SB(r,e){switch(e.type){case"RESOLVE":return{value:e.value,error:void 0};case"REJECT":return{value:!1,error:e.error};case"RESET":return{value:void 0,error:void 0};default:return r}}function Yl(){return V.useReducer(SB,{value:void 0,error:void 0})}const Fp=typeof window<"u",wk=Fp&&window.location.protocol==="file:";function xB(r){return typeof r<"u"}function Qo(r){return xB(r)&&r!==null}function CB(r){return typeof r=="string"}function IB(r){return r instanceof ArrayBuffer}function kB(r){return at(Fp),r instanceof Blob}function tv(r){return CB(r)&&/^data:/.test(r)}function Jb(r){at(tv(r));const[e="",t=""]=r.split(",");return e.split(";").indexOf("base64")!==-1?atob(t):unescape(t)}function PB(){return Fp&&window.devicePixelRatio||1}const Ek="On Chromium based browsers, you can use --allow-file-access-from-files flag for debugging purposes.";function Zb(){Pn(!wk,`Loading PDF as base64 strings/URLs may not work on protocols other than HTTP/HTTPS. ${Ek}`)}function RB(){Pn(!wk,`Loading PDF.js worker may not work on protocols other than HTTP/HTTPS. ${Ek}`)}function ya(r){r?.cancel&&r.cancel()}function nv(r,e){return Object.defineProperty(r,"width",{get(){return this.view[2]*e},configurable:!0}),Object.defineProperty(r,"height",{get(){return this.view[3]*e},configurable:!0}),Object.defineProperty(r,"originalWidth",{get(){return this.view[2]},configurable:!0}),Object.defineProperty(r,"originalHeight",{get(){return this.view[3]},configurable:!0}),r}function DB(r){return r.name==="RenderingCancelledException"}function LB(r){return new Promise((e,t)=>{const n=new FileReader;n.onload=()=>{if(!n.result)return t(new Error("Error while reading a file."));e(n.result)},n.onerror=s=>{if(!s.target)return t(new Error("Error while reading a file."));const{error:i}=s.target;if(!i)return t(new Error("Error while reading a file."));switch(i.code){case i.NOT_FOUND_ERR:return t(new Error("Error while reading a file: File not found."));case i.SECURITY_ERR:return t(new Error("Error while reading a file: Security error."));case i.ABORT_ERR:return t(new Error("Error while reading a file: Aborted."));default:return t(new Error("Error while reading a file."))}},n.readAsArrayBuffer(r)})}const{PDFDataRangeTransport:MB}=eB,NB=(r,e)=>{switch(e){case Qb.NEED_PASSWORD:{const t=prompt("Enter the password to open this PDF file.");r(t);break}case Qb.INCORRECT_PASSWORD:{const t=prompt("Invalid password. Please try again.");r(t);break}}};function eT(r){return typeof r=="object"&&r!==null&&("data"in r||"range"in r||"url"in r)}const OB=V.forwardRef(function({children:e,className:t,error:n="Failed to load PDF file.",externalLinkRel:s,externalLinkTarget:i,file:o,inputRef:c,imageResourcesPath:u,loading:h="Loading PDF…",noData:f="No PDF file specified.",onItemClick:m,onLoadError:y,onLoadProgress:_,onLoadSuccess:A,onPassword:b=NB,onSourceError:T,onSourceSuccess:x,options:M,renderMode:R,rotate:B,scale:O,...$},k){const[C,P]=Yl(),{value:N,error:j}=C,[z,F]=Yl(),{value:ue,error:ke}=z,ie=V.useRef(new TB),Z=V.useRef([]),te=V.useRef(void 0),de=V.useRef(void 0);o&&o!==te.current&&eT(o)&&(Pn(!Ol(o,te.current),`File prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "file" prop.`),te.current=o),M&&M!==de.current&&(Pn(!Ol(M,de.current),`Options prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "options" prop.`),de.current=M);const ee=V.useRef({scrollPageIntoView:ze=>{const{dest:et,pageNumber:lt,pageIndex:yt=lt-1}=ze;if(m){m({dest:et,pageIndex:yt,pageNumber:lt});return}const dr=Z.current[yt];if(dr){dr.scrollIntoView();return}Pn(!1,`An internal link leading to page ${lt} was clicked, but neither <Document> was provided with onItemClick nor it was able to find the page within itself. Either provide onItemClick to <Document> and handle navigating by yourself or ensure that all pages are rendered within <Document>.`)}});V.useImperativeHandle(k,()=>({linkService:ie,pages:Z,viewer:ee}),[]);function W(){x&&x()}function Y(){j&&(Pn(!1,j.toString()),T&&T(j))}function ae(){P({type:"RESET"})}V.useEffect(ae,[o,P]);const _e=V.useCallback(async()=>{if(!o)return null;if(typeof o=="string")return tv(o)?{data:Jb(o)}:(Zb(),{url:o});if(o instanceof MB)return{range:o};if(IB(o))return{data:o};if(Fp&&kB(o))return{data:await LB(o)};if(at(typeof o=="object"),at(eT(o)),"url"in o&&typeof o.url=="string"){if(tv(o.url)){const{url:ze,...et}=o;return{data:Jb(ze),...et}}Zb()}return o},[o]);V.useEffect(()=>{const ze=Ah(_e());return ze.promise.then(et=>{P({type:"RESOLVE",value:et})}).catch(et=>{P({type:"REJECT",error:et})}),()=>{ya(ze)}},[_e,P]),V.useEffect(()=>{if(!(typeof N>"u")){if(N===!1){Y();return}W()}},[N]);function Te(){ue&&(A&&A(ue),Z.current=new Array(ue.numPages),ie.current.setDocument(ue))}function Pe(){ke&&(Pn(!1,ke.toString()),y&&y(ke))}V.useEffect(function(){F({type:"RESET"})},[F,N]),V.useEffect(function(){if(!N)return;const et=M?{...N,...M}:N,lt=X0(et);_&&(lt.onProgress=_),b&&(lt.onPassword=b);const yt=lt,dr=yt.promise.then(rs=>{F({type:"RESOLVE",value:rs})}).catch(rs=>{yt.destroyed||F({type:"REJECT",error:rs})});return()=>{dr.finally(()=>yt.destroy())}},[M,F,N]),V.useEffect(()=>{if(!(typeof ue>"u")){if(ue===!1){Pe();return}Te()}},[ue]),V.useEffect(function(){ie.current.setViewer(ee.current),ie.current.setExternalLinkRel(s),ie.current.setExternalLinkTarget(i)},[s,i]);const Ee=V.useCallback((ze,et)=>{Z.current[ze]=et},[]),Be=V.useCallback(ze=>{delete Z.current[ze]},[]),$e=V.useMemo(()=>({imageResourcesPath:u,linkService:ie.current,onItemClick:m,pdf:ue,registerPage:Ee,renderMode:R,rotate:B,scale:O,unregisterPage:Be}),[u,m,ue,Ee,R,B,O,Be]),Ue=V.useMemo(()=>vk($,()=>ue),[$,ue]);function qt(){function ze(lt){return!!lt?.pdf}if(!ze($e))throw new Error("pdf is undefined");const et=typeof e=="function"?e($e):e;return L.jsx(_k.Provider,{value:$e,children:et})}function vn(){return o?ue==null?L.jsx(Fl,{type:"loading",children:typeof h=="function"?h():h}):ue===!1?L.jsx(Fl,{type:"error",children:typeof n=="function"?n():n}):qt():L.jsx(Fl,{type:"no-data",children:typeof f=="function"?f():f})}return L.jsx("div",{className:Op("react-pdf__Document",t),ref:c,...Ue,children:vn()})});function Ak(){return V.useContext(_k)}function bk(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];var t=r.filter(Boolean);if(t.length<=1){var n=t[0];return n||null}return function(i){for(var o=0,c=t;o<c.length;o++){var u=c[o];typeof u=="function"?u(i):u&&(u.current=i)}}}const Tk=V.createContext(null);function Vp(){return V.useContext(Tk)}function FB(){const r=Ak(),e=Vp();at(e);const t={...r,...e},{imageResourcesPath:n,linkService:s,onGetAnnotationsError:i,onGetAnnotationsSuccess:o,onRenderAnnotationLayerError:c,onRenderAnnotationLayerSuccess:u,page:h,pdf:f,renderForms:m,rotate:y,scale:_=1}=t;at(f),at(h),at(s);const[A,b]=Yl(),{value:T,error:x}=A,M=V.useRef(null);Pn(Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10)===1,"AnnotationLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-annotations");function R(){T&&o&&o(T)}function B(){x&&(Pn(!1,x.toString()),i&&i(x))}V.useEffect(function(){b({type:"RESET"})},[b,h]),V.useEffect(function(){if(!h)return;const P=Ah(h.getAnnotations()),N=P;return P.promise.then(j=>{b({type:"RESOLVE",value:j})}).catch(j=>{b({type:"REJECT",error:j})}),()=>{ya(N)}},[b,h]),V.useEffect(()=>{if(T!==void 0){if(T===!1){B();return}R()}},[T]);function O(){u&&u()}function $(C){Pn(!1,`${C}`),c&&c(C)}const k=V.useMemo(()=>h.getViewport({scale:_,rotation:y}),[h,y,_]);return V.useEffect(function(){if(!f||!h||!s||!T)return;const{current:P}=M;if(!P)return;const N=k.clone({dontFlip:!0}),j={accessibilityManager:null,annotationCanvasMap:null,annotationEditorUIManager:null,div:P,l10n:null,page:h,structTreeLayer:null,viewport:N},z={annotations:T,annotationStorage:f.annotationStorage,div:P,imageResourcesPath:n,linkService:s,page:h,renderForms:m,viewport:N};P.innerHTML="";try{new t_(j).render(z),O()}catch(F){$(F)}return()=>{}},[T,n,s,h,f,m,k]),L.jsx("div",{className:Op("react-pdf__Page__annotations","annotationLayer"),ref:M})}const Sk={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},VB=/^H(\d+)$/;function jB(r){return r in Sk}function jp(r){return"children"in r}function xk(r){return jp(r)?r.children.length===1&&0 in r.children&&"id"in r.children[0]:!1}function BB(r){const e={};if(jp(r)){const{role:t}=r,n=t.match(VB);if(n)e.role="heading",e["aria-level"]=Number(n[1]);else if(jB(t)){const s=Sk[t];s&&(e.role=s)}}return e}function Ck(r){const e={};if(jp(r)){if(r.alt!==void 0&&(e["aria-label"]=r.alt),r.lang!==void 0&&(e.lang=r.lang),xk(r)){const[t]=r.children;if(t){const n=Ck(t);return{...e,...n}}}}else"id"in r&&(e["aria-owns"]=r.id);return e}function UB(r){return r?{...BB(r),...Ck(r)}:null}function Ik({className:r,node:e}){const t=V.useMemo(()=>UB(e),[e]),n=V.useMemo(()=>!jp(e)||xk(e)?null:e.children.map((s,i)=>L.jsx(Ik,{node:s},i)),[e]);return L.jsx("span",{className:r,...t,children:n})}function zB(){const r=Vp();at(r);const{onGetStructTreeError:e,onGetStructTreeSuccess:t}=r,[n,s]=Yl(),{value:i,error:o}=n,{customTextRenderer:c,page:u}=r;function h(){i&&t&&t(i)}function f(){o&&(Pn(!1,o.toString()),e&&e(o))}return V.useEffect(function(){s({type:"RESET"})},[s,u]),V.useEffect(function(){if(c||!u)return;const y=Ah(u.getStructTree()),_=y;return y.promise.then(A=>{s({type:"RESOLVE",value:A})}).catch(A=>{s({type:"REJECT",error:A})}),()=>ya(_)},[c,u,s]),V.useEffect(()=>{if(i!==void 0){if(i===!1){f();return}h()}},[i]),i?L.jsx(Ik,{className:"react-pdf__Page__structTree structTree",node:i}):null}const tT=Ss;function $B(r){const e=Vp();at(e);const t={...e,...r},{_className:n,canvasBackground:s,devicePixelRatio:i=PB(),onRenderError:o,onRenderSuccess:c,page:u,renderForms:h,renderTextLayer:f,rotate:m,scale:y}=t,{canvasRef:_}=r;at(u);const A=V.useRef(null);function b(){u&&c&&c(nv(u,y))}function T(B){DB(B)||(Pn(!1,B.toString()),o&&o(B))}const x=V.useMemo(()=>u.getViewport({scale:y*i,rotation:m}),[i,u,m,y]),M=V.useMemo(()=>u.getViewport({scale:y,rotation:m}),[u,m,y]);V.useEffect(function(){if(!u)return;u.cleanup();const{current:O}=A;if(!O)return;O.width=x.width,O.height=x.height,O.style.width=`${Math.floor(M.width)}px`,O.style.height=`${Math.floor(M.height)}px`,O.style.visibility="hidden";const $={annotationMode:h?tT.ENABLE_FORMS:tT.ENABLE,canvasContext:O.getContext("2d",{alpha:!1}),viewport:x};s&&($.background=s);const k=u.render($),C=k;return k.promise.then(()=>{O.style.visibility="",b()}).catch(T),()=>ya(C)},[s,u,h,x,M]);const R=V.useCallback(()=>{const{current:B}=A;B&&(B.width=0,B.height=0)},[]);return V.useEffect(()=>R,[R]),L.jsx("canvas",{className:`${n}__canvas`,dir:"ltr",ref:bk(_,A),style:{display:"block",userSelect:"none"},children:f?L.jsx(zB,{}):null})}function HB(r){return"str"in r}function WB(){const r=Vp();at(r);const{customTextRenderer:e,onGetTextError:t,onGetTextSuccess:n,onRenderTextLayerError:s,onRenderTextLayerSuccess:i,page:o,pageIndex:c,pageNumber:u,rotate:h,scale:f}=r;at(o);const[m,y]=Yl(),{value:_,error:A}=m,b=V.useRef(null);Pn(Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10)===1,"TextLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-text-layer");function T(){_&&n&&n(_)}function x(){A&&(Pn(!1,A.toString()),t&&t(A))}V.useEffect(function(){y({type:"RESET"})},[o,y]),V.useEffect(function(){if(!o)return;const C=Ah(o.getTextContent()),P=C;return C.promise.then(N=>{y({type:"RESOLVE",value:N})}).catch(N=>{y({type:"REJECT",error:N})}),()=>ya(P)},[o,y]),V.useEffect(()=>{if(_!==void 0){if(_===!1){x();return}T()}},[_]);const M=V.useCallback(()=>{i&&i()},[i]),R=V.useCallback(k=>{Pn(!1,k.toString()),s&&s(k)},[s]);function B(){const k=b.current;k&&k.classList.add("selecting")}function O(){const k=b.current;k&&k.classList.remove("selecting")}const $=V.useMemo(()=>o.getViewport({scale:f,rotation:h}),[o,h,f]);return V.useLayoutEffect(function(){if(!o||!_)return;const{current:C}=b;if(!C)return;C.innerHTML="";const P=o.streamTextContent({includeMarkedContent:!0}),N={container:C,textContentSource:P,viewport:$},j=new Ku(N),z=j;return j.render().then(()=>{const F=document.createElement("div");F.className="endOfContent",C.append(F);const ue=C.querySelectorAll('[role="presentation"]');if(e){let ke=0;_.items.forEach((ie,Z)=>{if(!HB(ie))return;const te=ue[ke];if(!te)return;const de=e({pageIndex:c,pageNumber:u,itemIndex:Z,...ie});te.innerHTML=de,ke+=ie.str&&ie.hasEOL?2:1})}M()}).catch(R),()=>ya(z)},[e,R,M,o,c,u,_,$]),L.jsx("div",{className:Op("react-pdf__Page__textContent","textLayer"),onMouseUp:O,onMouseDown:B,ref:b})}const nT=1;function GB(r){const t={...Ak(),...r},{_className:n="react-pdf__Page",_enableRegisterUnregisterPage:s=!0,canvasBackground:i,canvasRef:o,children:c,className:u,customRenderer:h,customTextRenderer:f,devicePixelRatio:m,error:y="Failed to load the page.",height:_,inputRef:A,loading:b="Loading page…",noData:T="No page specified.",onGetAnnotationsError:x,onGetAnnotationsSuccess:M,onGetStructTreeError:R,onGetStructTreeSuccess:B,onGetTextError:O,onGetTextSuccess:$,onLoadError:k,onLoadSuccess:C,onRenderAnnotationLayerError:P,onRenderAnnotationLayerSuccess:N,onRenderError:j,onRenderSuccess:z,onRenderTextLayerError:F,onRenderTextLayerSuccess:ue,pageIndex:ke,pageNumber:ie,pdf:Z,registerPage:te,renderAnnotationLayer:de=!0,renderForms:ee=!1,renderMode:W="canvas",renderTextLayer:Y=!0,rotate:ae,scale:_e=nT,unregisterPage:Te,width:Pe,...Ee}=t,[Be,$e]=Yl(),{value:Ue,error:qt}=Be,vn=V.useRef(null);at(Z);const ze=Qo(ie)?ie-1:ke??null,et=ie??(Qo(ke)?ke+1:null),lt=ae??(Ue?Ue.rotate:null),yt=V.useMemo(()=>{if(!Ue)return null;let st=1;const _n=_e??nT;if(Pe||_){const Un=Ue.getViewport({scale:1,rotation:lt});Pe?st=Pe/Un.width:_&&(st=_/Un.height)}return _n*st},[_,Ue,lt,_e,Pe]);V.useEffect(function(){return()=>{Qo(ze)&&s&&Te&&Te(ze)}},[s,Z,ze,Te]);function dr(){if(C){if(!Ue||!yt)return;C(nv(Ue,yt))}if(s&&te){if(!Qo(ze)||!vn.current)return;te(ze,vn.current)}}function rs(){qt&&(Pn(!1,qt.toString()),k&&k(qt))}V.useEffect(function(){$e({type:"RESET"})},[$e,Z,ze]),V.useEffect(function(){if(!Z||!et)return;const _n=Ah(Z.getPage(et)),Un=_n;return _n.promise.then(fr=>{$e({type:"RESOLVE",value:fr})}).catch(fr=>{$e({type:"REJECT",error:fr})}),()=>ya(Un)},[$e,Z,et]),V.useEffect(()=>{if(Ue!==void 0){if(Ue===!1){rs();return}dr()}},[Ue,yt]);const ss=V.useMemo(()=>Qo(ze)&&et&&Qo(lt)&&Qo(yt)?{_className:n,canvasBackground:i,customTextRenderer:f,devicePixelRatio:m,onGetAnnotationsError:x,onGetAnnotationsSuccess:M,onGetStructTreeError:R,onGetStructTreeSuccess:B,onGetTextError:O,onGetTextSuccess:$,onRenderAnnotationLayerError:P,onRenderAnnotationLayerSuccess:N,onRenderError:j,onRenderSuccess:z,onRenderTextLayerError:F,onRenderTextLayerSuccess:ue,page:Ue,pageIndex:ze,pageNumber:et,renderForms:ee,renderTextLayer:Y,rotate:lt,scale:yt}:null,[n,i,f,m,x,M,R,B,O,$,P,N,j,z,F,ue,Ue,ze,et,ee,Y,lt,yt]),Dr=V.useMemo(()=>vk(Ee,()=>Ue&&(yt?nv(Ue,yt):void 0)),[Ee,Ue,yt]),Bn=`${ze}@${yt}/${lt}`;function Eo(){switch(W){case"custom":return at(h),L.jsx(h,{},`${Bn}_custom`);case"none":return null;case"canvas":default:return L.jsx($B,{canvasRef:o},`${Bn}_canvas`)}}function wi(){return Y?L.jsx(WB,{},`${Bn}_text`):null}function Ei(){return de?L.jsx(FB,{},`${Bn}_annotations`):null}function Ao(){function st(Un){return!!Un?.page}if(!st(ss))throw new Error("page is undefined");const _n=typeof c=="function"?c(ss):c;return L.jsxs(Tk.Provider,{value:ss,children:[Eo(),wi(),Ei(),_n]})}function Rt(){return et?Z===null||Ue===void 0||Ue===null?L.jsx(Fl,{type:"loading",children:typeof b=="function"?b():b}):Z===!1||Ue===!1?L.jsx(Fl,{type:"error",children:typeof y=="function"?y():y}):Ao():L.jsx(Fl,{type:"no-data",children:typeof T=="function"?T():T})}return L.jsx("div",{className:Op(n,u),"data-page-number":et,ref:bk(A,vn),style:{"--scale-round-x":"1px","--scale-round-y":"1px","--scale-factor":"1","--user-unit":`${yt}`,"--total-scale-factor":"calc(var(--scale-factor) * var(--user-unit))",backgroundColor:i||"white",position:"relative",minWidth:"min-content",minHeight:"min-content"},...Dr,children:Rt()})}RB();io.workerSrc="pdf.worker.mjs";io.workerSrc=`//unpkg.com/pdfjs-dist@${J0}/build/pdf.worker.min.js`;const qB=()=>L.jsxs(L.Fragment,{children:[L.jsx("link",{rel:"stylesheet",href:"https://unpkg.com/react-pdf@5.7.2/dist/esm/Page/AnnotationLayer.css"}),L.jsx("link",{rel:"stylesheet",href:"https://unpkg.com/react-pdf@5.7.2/dist/esm/Page/TextLayer.css"})]}),KB=({url:r,onClose:e})=>{const[t,n]=V.useState(null),[s,i]=V.useState(1),[o,c]=V.useState(1),u=({numPages:_})=>{n(_),i(1)},h=()=>i(_=>Math.max(_-1,1)),f=()=>i(_=>Math.min(_+1,t)),m=()=>c(_=>Math.min(_+.1,2)),y=()=>c(_=>Math.max(_-.1,.5));return L.jsx(bp,{children:r&&L.jsx(At.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex justify-center items-center z-50 p-4",children:L.jsxs(At.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},transition:{duration:.2,ease:"easeOut"},onClick:_=>_.stopPropagation(),className:"bg-background-light dark:bg-background-dark rounded-lg shadow-2xl w-full max-w-4xl h-[90vh] flex flex-col overflow-hidden relative",children:[L.jsxs("header",{className:"flex justify-between items-center p-4 border-b border-primary-light/10 dark:border-primary-dark/20",children:[L.jsx("h3",{className:"font-bold text-lg text-text-primary-light dark:text-text-primary-dark",children:"Certificate Viewer"}),L.jsxs("div",{className:"flex items-center space-x-2",children:[L.jsx("button",{onClick:y,className:"text-text-secondary-light dark:text-text-secondary-dark hover:text-secondary-light dark:hover:text-secondary-dark transition-colors p-1 rounded-full hover:bg-secondary-light/10 dark:hover:bg-secondary-dark/10","aria-label":"Zoom Out",children:L.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:L.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12H3"})})}),L.jsx("span",{className:"text-text-secondary-light dark:text-text-secondary-dark",children:`${Math.round(o*100)}%`}),L.jsx("button",{onClick:m,className:"text-text-secondary-light dark:text-text-secondary-dark hover:text-secondary-light dark:hover:text-secondary-dark transition-colors p-1 rounded-full hover:bg-secondary-light/10 dark:hover:bg-secondary-dark/10","aria-label":"Zoom In",children:L.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:L.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})}),L.jsx("button",{onClick:e,className:"text-text-secondary-light dark:text-text-secondary-dark hover:text-secondary-light dark:hover:text-secondary-dark transition-colors p-1 rounded-full hover:bg-secondary-light/10 dark:hover:bg-secondary-dark/10","aria-label":"Close",children:L.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:L.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),L.jsx("div",{className:"flex-grow flex items-center justify-center p-2 bg-background-alt-light dark:bg-background-alt-dark",children:L.jsx(OB,{file:r,onLoadSuccess:u,children:L.jsx(GB,{pageNumber:s,scale:o})})}),t>1&&L.jsxs("div",{className:"flex justify-center items-center py-4 space-x-4 border-t border-primary-light/10 dark:border-primary-dark/20",children:[L.jsx("button",{onClick:h,disabled:s<=1,className:"text-text-primary-light dark:text-text-primary-dark hover:text-secondary-light dark:hover:text-secondary-dark transition-colors disabled:opacity-30 disabled:cursor-not-allowed",children:L.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:L.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),L.jsx("span",{className:"text-text-secondary-light dark:text-text-secondary-dark font-mono",children:`Page ${s} of ${t}`}),L.jsx("button",{onClick:f,disabled:s>=t,className:"text-text-primary-light dark:text-text-primary-dark hover:text-secondary-light dark:hover:text-secondary-dark transition-colors disabled:opacity-30 disabled:cursor-not-allowed",children:L.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:L.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})]})})})},XB=ht.memo(({licensesPdfUrl:r,internshipsPdfUrl:e})=>{const[t,n]=V.useState(null),s=()=>n(r),i=()=>n(e),o=()=>n(null);return L.jsxs(L.Fragment,{children:[L.jsx(qB,{}),L.jsxs(_o,{id:"certifications",children:[L.jsx("h2",{className:"text-4xl font-bold text-text-primary-light dark:text-text-primary-dark text-center",children:"Certificates & Internships"}),L.jsx(wo,{}),L.jsxs("div",{className:"text-center flex flex-col md:flex-row justify-center items-center gap-6",children:[L.jsx(At.button,{onClick:s,whileHover:{scale:1.05,y:-2},whileTap:{scale:.95},className:"inline-block text-white dark:text-text-primary-dark font-bold py-4 px-8 text-lg rounded-full shadow-lg shadow-primary-light/30 dark:shadow-primary-dark/30 bg-gradient-to-r from-primary-light to-secondary-light dark:from-primary-dark dark:to-secondary-dark transition-all duration-300",children:"View Licenses & Certs"}),L.jsx(At.button,{onClick:i,whileHover:{scale:1.05,y:-2},whileTap:{scale:.95},className:"inline-block text-white dark:text-text-primary-dark font-bold py-4 px-8 text-lg rounded-full shadow-lg shadow-primary-light/30 dark:shadow-primary-dark/30 bg-gradient-to-r from-primary-light to-secondary-light dark:from-primary-dark dark:to-secondary-dark transition-all duration-300",children:"View Internship Certs"})]})]}),L.jsx(KB,{url:t,onClose:o})]})});function YB(r){return Bt({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"},child:[]}]})(r)}const QB=ht.memo(()=>{const[r,e]=V.useState({submitting:!1,succeeded:!1,error:null}),[t,n]=V.useState(null),s=V.useCallback(async u=>{u.preventDefault(),e({submitting:!0,succeeded:!1,error:null});const h=u.target,f=new FormData(h);try{const m=await fetch(h.action,{method:h.method,body:f,headers:{Accept:"application/json"}});if(m.ok)e({submitting:!1,succeeded:!0,error:null}),h.reset(),setTimeout(()=>e(y=>({...y,succeeded:!1})),5e3);else{const _=(await m.json()).errors?.map(A=>A.message).join(", ")||"An unknown error occurred.";throw new Error(_)}}catch(m){e({submitting:!1,succeeded:!1,error:m.message}),setTimeout(()=>e(y=>({...y,error:null})),5e3)}},[]),i=V.useCallback(()=>{navigator.clipboard.writeText("costaspinto312@gmail.com").then(()=>{n("Email copied to clipboard!"),setTimeout(()=>n(null),3e3)}).catch(h=>{console.error("Clipboard copy failed:",h),n("Could not copy email."),setTimeout(()=>n(null),3e3)})},[]),o=V.useCallback(()=>{window.scrollTo({top:0,behavior:"smooth"})},[]),c=[{name:"Instagram",icon:L.jsx(F9,{}),url:"https://instagram.com/costaspinto"},{name:"Dribbble",icon:L.jsx(M9,{}),url:"https://dribbble.com/costaspinto"},{name:"Twitter",icon:L.jsx(B9,{}),url:"https://twitter.com/costaspinto"},{name:"Facebook",icon:L.jsx(N9,{}),url:"https://facebook.com/costaspinto"}];return L.jsxs(_o,{id:"contact",className:"bg-background-alt-light dark:bg-background-alt-dark text-text-primary-light dark:text-text-primary-dark font-sans !py-0",children:[L.jsxs("div",{className:"container mx-auto px-6 py-20 max-w-7xl",children:[L.jsx("h2",{className:"text-4xl font-bold text-text-primary-light dark:text-text-primary-dark text-center",children:"Let’s Get Connected!"}),L.jsx(wo,{}),L.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start gap-16",children:[L.jsxs("div",{className:"flex-1 space-y-10",children:[L.jsx("p",{className:"text-lg text-text-secondary-light dark:text-text-secondary-dark max-w-md",children:"Have a project in mind or just want to say hello? Fill out the form or follow me on my social media."}),L.jsxs("div",{children:[L.jsx("p",{className:"text-lg font-semibold text-text-primary-light dark:text-text-primary-dark mb-4",children:"Follow Me"}),L.jsx("div",{className:"flex items-center gap-4",children:c.map(u=>L.jsx("a",{href:u.url,target:"_blank",rel:"noopener noreferrer","aria-label":u.name,className:"text-text-secondary-light dark:text-text-secondary-dark hover:text-secondary-light dark:hover:text-secondary-dark transition-colors duration-300 text-2xl",children:u.icon},u.name))})]})]}),L.jsx("div",{className:"flex-1 bg-background-light/90 dark:bg-background-dark/80 backdrop-blur-md p-8 rounded-2xl shadow-xl w-full max-w-lg border border-primary-light/10 dark:border-primary-dark/20",children:L.jsxs("form",{action:"https://formspree.io/f/mwpqwdnq",method:"POST",onSubmit:s,className:"space-y-6",children:[L.jsxs("div",{className:"relative",children:[L.jsx("label",{className:"block font-medium mb-1 text-text-secondary-light dark:text-text-secondary-dark",children:"Your Name *"}),L.jsx(Z9,{className:"absolute left-3 top-10 text-text-secondary-light/50 dark:text-text-secondary-dark/50"}),L.jsx("input",{name:"name",required:!0,className:"w-full pl-10 pr-4 py-2 border border-slate-300 dark:border-slate-600 rounded-xl bg-transparent text-text-primary-light dark:text-text-primary-dark focus:outline-none focus:ring-2 focus:ring-primary-light dark:focus:ring-primary-dark"})]}),L.jsxs("div",{className:"relative",children:[L.jsx("label",{className:"block font-medium mb-1 text-text-secondary-light dark:text-text-secondary-dark",children:"Your Email *"}),L.jsx(K9,{className:"absolute left-3 top-10 text-text-secondary-light/50 dark:text-text-secondary-dark/50"}),L.jsx("input",{name:"email",type:"email",required:!0,className:"w-full pl-10 pr-4 py-2 border border-slate-300 dark:border-slate-600 rounded-xl bg-transparent text-text-primary-light dark:text-text-primary-dark focus:outline-none focus:ring-2 focus:ring-primary-light dark:focus:ring-primary-dark"})]}),L.jsxs("div",{className:"relative",children:[L.jsx("label",{className:"block font-medium mb-1 text-text-secondary-light dark:text-text-secondary-dark",children:"Service you are looking for *"}),L.jsx(G9,{className:"absolute left-3 top-10 text-text-secondary-light/50 dark:text-text-secondary-dark/50"}),L.jsx("input",{name:"service",required:!0,className:"w-full pl-10 pr-4 py-2 border border-slate-300 dark:border-slate-600 rounded-xl bg-transparent text-text-primary-light dark:text-text-primary-dark focus:outline-none focus:ring-2 focus:ring-primary-light dark:focus:ring-primary-dark"})]}),L.jsxs("div",{children:[L.jsx("label",{className:"block font-medium mb-1 text-text-secondary-light dark:text-text-secondary-dark",children:"Your Message"}),L.jsx("textarea",{name:"message",rows:"4",className:"w-full px-4 py-2 border border-slate-300 dark:border-slate-600 rounded-xl bg-transparent text-text-primary-light dark:text-text-primary-dark focus:outline-none focus:ring-2 focus:ring-primary-light dark:focus:ring-primary-dark"})]}),L.jsx(At.button,{type:"submit",className:"w-full bg-gradient-to-r from-primary-light to-secondary-light dark:from-primary-dark dark:to-secondary-dark text-white dark:text-text-primary-dark font-semibold py-3 px-4 rounded-xl hover:brightness-110 transition-transform duration-200 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed",disabled:r.submitting,children:r.submitting?"Submitting...":"Submit"}),r.succeeded&&L.jsxs("p",{className:"flex items-center gap-2 text-primary-light dark:text-primary-dark text-sm mt-2",children:[L.jsx($9,{})," Thanks for your message! I'll get back to you soon."]}),r.error&&L.jsxs("p",{className:"flex items-center gap-2 text-red-600 text-sm mt-2",children:[L.jsx(X9,{})," Error: ",r.error]})]})})]})]}),L.jsx("footer",{className:"bg-background-dark dark:bg-background-alt-dark text-text-secondary-light dark:text-text-secondary-dark py-12 mt-20",children:L.jsxs("div",{className:"container mx-auto max-w-6xl px-6 flex flex-col gap-8",children:[L.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-6",children:[L.jsxs("div",{children:[L.jsx("h2",{className:"text-2xl font-bold text-text-primary-light dark:text-text-primary-dark mb-2",children:"I'm Available for Freelance Projects"}),L.jsx("p",{className:"text-text-secondary-light/70 dark:text-text-secondary-dark/70",children:"Feel free to initiate a project and let’s explore how we can collaborate."})]}),L.jsxs("div",{className:"flex gap-4 relative",children:[L.jsxs("button",{onClick:i,className:"flex items-center gap-2 border border-secondary-light dark:border-secondary-dark text-secondary-light dark:text-secondary-dark font-semibold py-2 px-4 rounded-xl hover:bg-secondary-light dark:hover:bg-secondary-dark hover:text-white dark:hover:text-text-primary-dark transition-colors",children:[L.jsx(YB,{})," COPY EMAIL"]}),t&&L.jsx("span",{className:"absolute -bottom-8 left-0 right-0 text-center text-sm text-primary-light dark:text-primary-dark",children:t})]})]}),L.jsxs("div",{className:"border-t border-background-dark/50 dark:border-background-alt-light/10 pt-6 flex flex-col md:flex-row justify-between items-center gap-4 text-sm text-text-secondary-light dark:text-text-secondary-dark",children:[L.jsx("span",{className:"font-semibold text-text-primary-light dark:text-text-primary-dark",children:"Costas Pinto"}),L.jsx("nav",{className:"flex gap-6",children:L.jsx(At.button,{onClick:o,className:"hover:text-secondary-light dark:hover:text-secondary-dark transition",children:"Home"})}),L.jsx("div",{className:"flex items-center gap-4",children:c.map(u=>L.jsx("a",{href:u.url,target:"_blank",rel:"noopener noreferrer",className:"hover:text-secondary-light dark:hover:text-secondary-dark transition text-lg",children:u.icon},u.name))})]}),L.jsxs("p",{className:"text-center text-xs text-text-secondary-light/70 pt-4",children:["© ",new Date().getFullYear()," Costas Pinto."]})]})})]})}),JB=V.lazy(()=>HP(()=>import("./AdminPanel-Bolf0F_4.js"),[])),ZB=()=>{const r=fT();return V.useEffect(()=>{const e=sessionStorage.getItem("redirect");if(e){sessionStorage.removeItem("redirect");const t=e.replace(/^\/Costas_Portfolio/,"");r(t||"/",{replace:!0})}},[r]),null},rT={apiKey:"AIzaSyAZjJnEruroTDXYEjbne6-BHPA-lJMRw1c",authDomain:"costas-portfolio.firebaseapp.com",projectId:"costas-portfolio",storageBucket:"costas-portfolio.appspot.com",messagingSenderId:"958634149930",appId:"1:958634149930:web:b847a2bc997021711a5b53",measurementId:"G-5ZT1KDPJPT"},eU=(r=768)=>{const[e,t]=V.useState(()=>window.innerWidth<r);return V.useEffect(()=>{const n=()=>t(window.innerWidth<r);return window.addEventListener("resize",n),()=>window.removeEventListener("resize",n)},[r]),e},tU=r=>{const[e,t]=V.useState(!1),n=V.useCallback(()=>t(!1),[]),s=V.useCallback(()=>t(i=>!i),[]);return L.jsxs(L.Fragment,{children:[L.jsx(t8,{isMobileMenuOpen:e,closeMobileMenu:n,toggleMobileMenu:s}),L.jsxs("main",{className:"relative z-10",children:[L.jsx(c8,{}),L.jsxs("div",{className:"container mx-auto px-6 space-y-16 md:space-y-24",children:[L.jsx(u8,{}),L.jsx(d8,{}),L.jsx(f8,{}),L.jsx(p8,{}),L.jsx(g8,{}),L.jsx(v8,{projects:r.projects,isMobile:r.isMobile}),L.jsx(XB,{...r})]})]}),L.jsx(QB,{})]})};function nU(){const[r,e]=V.useState({projects:[]}),[t,n]=V.useState(null),[s,i]=V.useState(!0),[o,c]=V.useState(null),u=eU(),h=V.useCallback(async f=>{try{const y=(await l4(KN(f,"projects"))).docs.map(T=>({id:T.id,...T.data()})),_=rx(f,"portfolioAssets","main"),A=await a4(_),b=A.exists()?A.data():{};e({projects:y,licensesPdfUrl:b.licensesPdfUrl||"",internshipsPdfUrl:b.internshipsPdfUrl||""})}catch(m){console.error("❌ Firebase fetch error:",m),c("Failed to load portfolio data. Please check your Firestore rules and collection names.")}},[]);return V.useEffect(()=>{(async()=>{try{if(Object.values(rT).some(b=>!b))throw new Error("One or more Firebase environment variables are missing. Please check your .env file.");const m=O1().length>0?O1()[0]:DT(rT),y=XN(m),_=_O(m),A=GO(m);n({db:y,auth:_,storage:A}),await h(y)}catch(m){console.error("🔥 Firebase initialization or data fetch failed:",m),c(`Failed to connect to services. Error: ${m.message}`)}finally{i(!1)}})()},[h]),s?L.jsx(Ab,{}):o?L.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",children:L.jsxs("div",{className:"text-center bg-red-100/50 border border-red-500 p-8 rounded-lg max-w-lg",children:[L.jsx("h2",{className:"text-2xl font-bold text-red-700 mb-4",children:"Application Error"}),L.jsx("p",{className:"text-slate-700",children:o})]})}):L.jsx(S9,{children:L.jsx(A9,{children:L.jsxs(r6,{features:v9,children:[L.jsx(x9,{}),L.jsx("div",{className:"relative font-sans overflow-x-hidden",children:L.jsxs(rR,{basename:"/Costas_Portfolio/",children:[L.jsx(ZB,{}),L.jsx(V.Suspense,{fallback:L.jsx(Ab,{}),children:L.jsxs(M2,{children:[L.jsx(ry,{path:"/",element:L.jsx(tU,{projects:r.projects,licensesPdfUrl:r.licensesPdfUrl,internshipsPdfUrl:r.internshipsPdfUrl,isMobile:u})}),L.jsx(ry,{path:"/admin",element:t&&L.jsx(JB,{...t})})]})})]})})]})})})}const rU=document.getElementById("root");UP.createRoot(rU).render(L.jsx(ht.StrictMode,{children:L.jsx(nU,{})}));export{bp as A,Ab as L,a4 as a,dU as b,KN as c,rx as d,lU as e,cU as f,l4 as g,aU as h,oU as i,L as j,At as m,hU as o,V as r,uU as s};
